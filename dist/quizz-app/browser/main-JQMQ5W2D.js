var v2=Object.defineProperty,_2=Object.defineProperties;var C2=Object.getOwnPropertyDescriptors;var l1=Object.getOwnPropertySymbols;var y2=Object.prototype.hasOwnProperty,w2=Object.prototype.propertyIsEnumerable;var d1=(e,n,t)=>n in e?v2(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,de=(e,n)=>{for(var t in n||={})y2.call(n,t)&&d1(e,t,n[t]);if(l1)for(var t of l1(n))w2.call(n,t)&&d1(e,t,n[t]);return e},qe=(e,n)=>_2(e,C2(n));var Au=(e,n,t)=>new Promise((r,i)=>{var o=c=>{try{a(t.next(c))}catch(d){i(d)}},s=c=>{try{a(t.throw(c))}catch(d){i(d)}},a=c=>c.done?r(c.value):Promise.resolve(c.value).then(o,s);a((t=t.apply(e,n)).next())});function f1(e,n){return Object.is(e,n)}var En=null,Tu=!1,Ou=1,Ri=Symbol("SIGNAL");function mt(e){let n=En;return En=e,n}function h1(){return En}var Xa={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function wf(e){if(Tu)throw new Error("");if(En===null)return;En.consumerOnSignalRead(e);let n=En.nextProducerIndex++;if(Fu(En),n<En.producerNode.length&&En.producerNode[n]!==e&&Qa(En)){let t=En.producerNode[n];Pu(t,En.producerIndexOfThis[n])}En.producerNode[n]!==e&&(En.producerNode[n]=e,En.producerIndexOfThis[n]=Qa(En)?x1(e,En,n):0),En.producerLastReadVersion[n]=e.version}function b2(){Ou++}function p1(e){if(!(Qa(e)&&!e.dirty)&&!(!e.dirty&&e.lastCleanEpoch===Ou)){if(!e.producerMustRecompute(e)&&!Df(e)){e.dirty=!1,e.lastCleanEpoch=Ou;return}e.producerRecomputeValue(e),e.dirty=!1,e.lastCleanEpoch=Ou}}function m1(e){if(e.liveConsumerNode===void 0)return;let n=Tu;Tu=!0;try{for(let t of e.liveConsumerNode)t.dirty||D2(t)}finally{Tu=n}}function g1(){return En?.consumerAllowSignalWrites!==!1}function D2(e){e.dirty=!0,m1(e),e.consumerMarkedDirty?.(e)}function ku(e){return e&&(e.nextProducerIndex=0),mt(e)}function bf(e,n){if(mt(n),!(!e||e.producerNode===void 0||e.producerIndexOfThis===void 0||e.producerLastReadVersion===void 0)){if(Qa(e))for(let t=e.nextProducerIndex;t<e.producerNode.length;t++)Pu(e.producerNode[t],e.producerIndexOfThis[t]);for(;e.producerNode.length>e.nextProducerIndex;)e.producerNode.pop(),e.producerLastReadVersion.pop(),e.producerIndexOfThis.pop()}}function Df(e){Fu(e);for(let n=0;n<e.producerNode.length;n++){let t=e.producerNode[n],r=e.producerLastReadVersion[n];if(r!==t.version||(p1(t),r!==t.version))return!0}return!1}function Sf(e){if(Fu(e),Qa(e))for(let n=0;n<e.producerNode.length;n++)Pu(e.producerNode[n],e.producerIndexOfThis[n]);e.producerNode.length=e.producerLastReadVersion.length=e.producerIndexOfThis.length=0,e.liveConsumerNode&&(e.liveConsumerNode.length=e.liveConsumerIndexOfThis.length=0)}function x1(e,n,t){if(E1(e),e.liveConsumerNode.length===0&&v1(e))for(let r=0;r<e.producerNode.length;r++)e.producerIndexOfThis[r]=x1(e.producerNode[r],e,r);return e.liveConsumerIndexOfThis.push(t),e.liveConsumerNode.push(n)-1}function Pu(e,n){if(E1(e),e.liveConsumerNode.length===1&&v1(e))for(let r=0;r<e.producerNode.length;r++)Pu(e.producerNode[r],e.producerIndexOfThis[r]);let t=e.liveConsumerNode.length-1;if(e.liveConsumerNode[n]=e.liveConsumerNode[t],e.liveConsumerIndexOfThis[n]=e.liveConsumerIndexOfThis[t],e.liveConsumerNode.length--,e.liveConsumerIndexOfThis.length--,n<e.liveConsumerNode.length){let r=e.liveConsumerIndexOfThis[n],i=e.liveConsumerNode[n];Fu(i),i.producerIndexOfThis[r]=n}}function Qa(e){return e.consumerIsAlwaysLive||(e?.liveConsumerNode?.length??0)>0}function Fu(e){e.producerNode??=[],e.producerIndexOfThis??=[],e.producerLastReadVersion??=[]}function E1(e){e.liveConsumerNode??=[],e.liveConsumerIndexOfThis??=[]}function v1(e){return e.producerNode!==void 0}function _1(e){let n=Object.create(S2);n.computation=e;let t=()=>{if(p1(n),wf(n),n.value===Iu)throw n.error;return n.value};return t[Ri]=n,t}var Cf=Symbol("UNSET"),yf=Symbol("COMPUTING"),Iu=Symbol("ERRORED"),S2=qe(de({},Xa),{value:Cf,dirty:!0,error:null,equal:f1,producerMustRecompute(e){return e.value===Cf||e.value===yf},producerRecomputeValue(e){if(e.value===yf)throw new Error("Detected cycle in computations.");let n=e.value;e.value=yf;let t=ku(e),r;try{r=e.computation()}catch(i){r=Iu,e.error=i}finally{bf(e,t)}if(n!==Cf&&n!==Iu&&r!==Iu&&e.equal(n,r)){e.value=n;return}e.value=r,e.version++}});function M2(){throw new Error}var C1=M2;function y1(){C1()}function w1(e){C1=e}var A2=null;function b1(e){let n=Object.create(S1);n.value=e;let t=()=>(wf(n),n.value);return t[Ri]=n,t}function Mf(e,n){g1()||y1(),e.equal(e.value,n)||(e.value=n,T2(e))}function D1(e,n){g1()||y1(),Mf(e,n(e.value))}var S1=qe(de({},Xa),{equal:f1,value:void 0});function T2(e){e.version++,b2(),m1(e),A2?.()}function Qe(e){return typeof e=="function"}function ks(e){let t=e(r=>{Error.call(r),r.stack=new Error().stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var Nu=ks(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:
${t.map((r,i)=>`${i+1}) ${r.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=t});function Ya(e,n){if(e){let t=e.indexOf(n);0<=t&&e.splice(t,1)}}var rn=class e{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;let{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(let o of t)o.remove(this);else t.remove(this);let{initialTeardown:r}=this;if(Qe(r))try{r()}catch(o){n=o instanceof Nu?o.errors:[o]}let{_finalizers:i}=this;if(i){this._finalizers=null;for(let o of i)try{M1(o)}catch(s){n=n??[],s instanceof Nu?n=[...n,...s.errors]:n.push(s)}}if(n)throw new Nu(n)}}add(n){var t;if(n&&n!==this)if(this.closed)M1(n);else{if(n instanceof e){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(n)}}_hasParent(n){let{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){let{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){let{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&Ya(t,n)}remove(n){let{_finalizers:t}=this;t&&Ya(t,n),n instanceof e&&n._removeParent(this)}};rn.EMPTY=(()=>{let e=new rn;return e.closed=!0,e})();var Af=rn.EMPTY;function Ru(e){return e instanceof rn||e&&"closed"in e&&Qe(e.remove)&&Qe(e.add)&&Qe(e.unsubscribe)}function M1(e){Qe(e)?e():e.unsubscribe()}var Yr={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var Ps={setTimeout(e,n,...t){let{delegate:r}=Ps;return r?.setTimeout?r.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){let{delegate:n}=Ps;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Bu(e){Ps.setTimeout(()=>{let{onUnhandledError:n}=Yr;if(n)n(e);else throw e})}function Ka(){}var A1=Tf("C",void 0,void 0);function T1(e){return Tf("E",void 0,e)}function O1(e){return Tf("N",e,void 0)}function Tf(e,n,t){return{kind:e,value:n,error:t}}var Qo=null;function Fs(e){if(Yr.useDeprecatedSynchronousErrorHandling){let n=!Qo;if(n&&(Qo={errorThrown:!1,error:null}),e(),n){let{errorThrown:t,error:r}=Qo;if(Qo=null,t)throw r}}else e()}function I1(e){Yr.useDeprecatedSynchronousErrorHandling&&Qo&&(Qo.errorThrown=!0,Qo.error=e)}var Xo=class extends rn{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,Ru(n)&&n.add(this)):this.destination=k2}static create(n,t,r){return new Ns(n,t,r)}next(n){this.isStopped?If(O1(n),this):this._next(n)}error(n){this.isStopped?If(T1(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?If(A1,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},O2=Function.prototype.bind;function Of(e,n){return O2.call(e,n)}var kf=class{constructor(n){this.partialObserver=n}next(n){let{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(r){Lu(r)}}error(n){let{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(r){Lu(r)}else Lu(n)}complete(){let{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){Lu(t)}}},Ns=class extends Xo{constructor(n,t,r){super();let i;if(Qe(n)||!n)i={next:n??void 0,error:t??void 0,complete:r??void 0};else{let o;this&&Yr.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),i={next:n.next&&Of(n.next,o),error:n.error&&Of(n.error,o),complete:n.complete&&Of(n.complete,o)}):i=n}this.destination=new kf(i)}};function Lu(e){Yr.useDeprecatedSynchronousErrorHandling?I1(e):Bu(e)}function I2(e){throw e}function If(e,n){let{onStoppedNotification:t}=Yr;t&&Ps.setTimeout(()=>t(e,n))}var k2={closed:!0,next:Ka,error:I2,complete:Ka};var Rs=typeof Symbol=="function"&&Symbol.observable||"@@observable";function wr(e){return e}function Pf(...e){return Ff(e)}function Ff(e){return e.length===0?wr:e.length===1?e[0]:function(t){return e.reduce((r,i)=>i(r),t)}}var ct=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){let r=new e;return r.source=this,r.operator=t,r}subscribe(t,r,i){let o=F2(t)?t:new Ns(t,r,i);return Fs(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return r=k1(r),new r((i,o)=>{let s=new Ns({next:a=>{try{t(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:i});this.subscribe(s)})}_subscribe(t){var r;return(r=this.source)===null||r===void 0?void 0:r.subscribe(t)}[Rs](){return this}pipe(...t){return Ff(t)(this)}toPromise(t){return t=k1(t),new t((r,i)=>{let o;this.subscribe(s=>o=s,s=>i(s),()=>r(o))})}}return e.create=n=>new e(n),e})();function k1(e){var n;return(n=e??Yr.Promise)!==null&&n!==void 0?n:Promise}function P2(e){return e&&Qe(e.next)&&Qe(e.error)&&Qe(e.complete)}function F2(e){return e&&e instanceof Xo||P2(e)&&Ru(e)}function Nf(e){return Qe(e?.lift)}function ut(e){return n=>{if(Nf(n))return n.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ot(e,n,t,r,i){return new Rf(e,n,t,r,i)}var Rf=class extends Xo{constructor(n,t,r,i,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=t?function(a){try{t(a)}catch(c){n.error(c)}}:super._next,this._error=i?function(a){try{i(a)}catch(c){n.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:t}=this;super.unsubscribe(),!t&&((n=this.onFinalize)===null||n===void 0||n.call(this))}}};function Bs(){return ut((e,n)=>{let t=null;e._refCount++;let r=ot(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount){t=null;return}let i=e._connection,o=t;t=null,i&&(!o||i===o)&&i.unsubscribe(),n.unsubscribe()});e.subscribe(r),r.closed||(t=e.connect())})}var Ls=class extends ct{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Nf(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){let n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new rn;let t=this.getSubject();n.add(this.source.subscribe(ot(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=rn.EMPTY)}return n}refCount(){return Bs()(this)}};var P1=ks(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var wn=(()=>{class e extends ct{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){let r=new Vu(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new P1}next(t){Fs(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let r of this.currentObservers)r.next(t)}})}error(t){Fs(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;let{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Fs(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){let{hasError:r,isStopped:i,observers:o}=this;return r||i?Af:(this.currentObservers=null,o.push(t),new rn(()=>{this.currentObservers=null,Ya(o,t)}))}_checkFinalizedStatuses(t){let{hasError:r,thrownError:i,isStopped:o}=this;r?t.error(i):o&&t.complete()}asObservable(){let t=new ct;return t.source=this,t}}return e.create=(n,t)=>new Vu(n,t),e})(),Vu=class extends wn{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.next)===null||r===void 0||r.call(t,n)}error(n){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.error)===null||r===void 0||r.call(t,n)}complete(){var n,t;(t=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||t===void 0||t.call(n)}_subscribe(n){var t,r;return(r=(t=this.source)===null||t===void 0?void 0:t.subscribe(n))!==null&&r!==void 0?r:Af}};var In=class extends wn{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){let t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){let{hasError:n,thrownError:t,_value:r}=this;if(n)throw t;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}};var br=new ct(e=>e.complete());function F1(e){return e&&Qe(e.schedule)}function N1(e){return e[e.length-1]}function Uu(e){return Qe(N1(e))?e.pop():void 0}function uo(e){return F1(N1(e))?e.pop():void 0}function B1(e,n,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(h){try{d(r.next(h))}catch(p){s(p)}}function c(h){try{d(r.throw(h))}catch(p){s(p)}}function d(h){h.done?o(h.value):i(h.value).then(a,c)}d((r=r.apply(e,n||[])).next())})}function R1(e){var n=typeof Symbol=="function"&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}function Yo(e){return this instanceof Yo?(this.v=e,this):new Yo(e)}function L1(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,n||[]),i,o=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),i[Symbol.asyncIterator]=function(){return this},i;function s(x){return function(v){return Promise.resolve(v).then(x,p)}}function a(x,v){r[x]&&(i[x]=function(E){return new Promise(function(_,M){o.push([x,E,_,M])>1||c(x,E)})},v&&(i[x]=v(i[x])))}function c(x,v){try{d(r[x](v))}catch(E){g(o[0][3],E)}}function d(x){x.value instanceof Yo?Promise.resolve(x.value.v).then(h,p):g(o[0][2],x)}function h(x){c("next",x)}function p(x){c("throw",x)}function g(x,v){x(v),o.shift(),o.length&&c(o[0][0],o[0][1])}}function V1(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=e[Symbol.asyncIterator],t;return n?n.call(e):(e=typeof R1=="function"?R1(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(o){t[o]=e[o]&&function(s){return new Promise(function(a,c){s=e[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(d){o({value:d,done:a})},s)}}var ju=e=>e&&typeof e.length=="number"&&typeof e!="function";function Hu(e){return Qe(e?.then)}function $u(e){return Qe(e[Rs])}function qu(e){return Symbol.asyncIterator&&Qe(e?.[Symbol.asyncIterator])}function Wu(e){return new TypeError(`You provided ${e!==null&&typeof e=="object"?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function N2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var zu=N2();function Gu(e){return Qe(e?.[zu])}function Qu(e){return L1(this,arguments,function*(){let t=e.getReader();try{for(;;){let{value:r,done:i}=yield Yo(t.read());if(i)return yield Yo(void 0);yield yield Yo(r)}}finally{t.releaseLock()}})}function Xu(e){return Qe(e?.getReader)}function on(e){if(e instanceof ct)return e;if(e!=null){if($u(e))return R2(e);if(ju(e))return B2(e);if(Hu(e))return L2(e);if(qu(e))return U1(e);if(Gu(e))return V2(e);if(Xu(e))return U2(e)}throw Wu(e)}function R2(e){return new ct(n=>{let t=e[Rs]();if(Qe(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function B2(e){return new ct(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}function L2(e){return new ct(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,Bu)})}function V2(e){return new ct(n=>{for(let t of e)if(n.next(t),n.closed)return;n.complete()})}function U1(e){return new ct(n=>{j2(e,n).catch(t=>n.error(t))})}function U2(e){return U1(Qu(e))}function j2(e,n){var t,r,i,o;return B1(this,void 0,void 0,function*(){try{for(t=V1(e);r=yield t.next(),!r.done;){let s=r.value;if(n.next(s),n.closed)return}}catch(s){i={error:s}}finally{try{r&&!r.done&&(o=t.return)&&(yield o.call(t))}finally{if(i)throw i.error}}n.complete()})}function ur(e,n,t,r=0,i=!1){let o=n.schedule(function(){t(),i?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(o),!i)return o}function Yu(e,n=0){return ut((t,r)=>{t.subscribe(ot(r,i=>ur(r,e,()=>r.next(i),n),()=>ur(r,e,()=>r.complete(),n),i=>ur(r,e,()=>r.error(i),n)))})}function Ku(e,n=0){return ut((t,r)=>{r.add(e.schedule(()=>t.subscribe(r),n))})}function j1(e,n){return on(e).pipe(Ku(n),Yu(n))}function H1(e,n){return on(e).pipe(Ku(n),Yu(n))}function $1(e,n){return new ct(t=>{let r=0;return n.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}function q1(e,n){return new ct(t=>{let r;return ur(t,n,()=>{r=e[zu](),ur(t,n,()=>{let i,o;try{({value:i,done:o}=r.next())}catch(s){t.error(s);return}o?t.complete():t.next(i)},0,!0)}),()=>Qe(r?.return)&&r.return()})}function Zu(e,n){if(!e)throw new Error("Iterable cannot be null");return new ct(t=>{ur(t,n,()=>{let r=e[Symbol.asyncIterator]();ur(t,n,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function W1(e,n){return Zu(Qu(e),n)}function z1(e,n){if(e!=null){if($u(e))return j1(e,n);if(ju(e))return $1(e,n);if(Hu(e))return H1(e,n);if(qu(e))return Zu(e,n);if(Gu(e))return q1(e,n);if(Xu(e))return W1(e,n)}throw Wu(e)}function At(e,n){return n?z1(e,n):on(e)}function Le(...e){let n=uo(e);return At(e,n)}function vn(e,n){let t=Qe(e)?e:()=>e,r=i=>i.error(t());return new ct(n?i=>n.schedule(r,0,i):r)}function Bf(e){return!!e&&(e instanceof ct||Qe(e.lift)&&Qe(e.subscribe))}var Bi=ks(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"});function Xe(e,n){return ut((t,r)=>{let i=0;t.subscribe(ot(r,o=>{r.next(e.call(n,o,i++))}))})}var{isArray:H2}=Array;function $2(e,n){return H2(n)?e(...n):e(n)}function Ju(e){return Xe(n=>$2(e,n))}var{isArray:q2}=Array,{getPrototypeOf:W2,prototype:z2,keys:G2}=Object;function el(e){if(e.length===1){let n=e[0];if(q2(n))return{args:n,keys:null};if(Q2(n)){let t=G2(n);return{args:t.map(r=>n[r]),keys:t}}}return{args:e,keys:null}}function Q2(e){return e&&typeof e=="object"&&W2(e)===z2}function tl(e,n){return e.reduce((t,r,i)=>(t[r]=n[i],t),{})}function Za(...e){let n=uo(e),t=Uu(e),{args:r,keys:i}=el(e);if(r.length===0)return At([],n);let o=new ct(X2(r,n,i?s=>tl(i,s):wr));return t?o.pipe(Ju(t)):o}function X2(e,n,t=wr){return r=>{G1(n,()=>{let{length:i}=e,o=new Array(i),s=i,a=i;for(let c=0;c<i;c++)G1(n,()=>{let d=At(e[c],n),h=!1;d.subscribe(ot(r,p=>{o[c]=p,h||(h=!0,a--),a||r.next(t(o.slice()))},()=>{--s||r.complete()}))},r)},r)}}function G1(e,n,t){e?ur(t,e,n):n()}function Q1(e,n,t,r,i,o,s,a){let c=[],d=0,h=0,p=!1,g=()=>{p&&!c.length&&!d&&n.complete()},x=E=>d<r?v(E):c.push(E),v=E=>{o&&n.next(E),d++;let _=!1;on(t(E,h++)).subscribe(ot(n,M=>{i?.(M),o?x(M):n.next(M)},()=>{_=!0},void 0,()=>{if(_)try{for(d--;c.length&&d<r;){let M=c.shift();s?ur(n,s,()=>v(M)):v(M)}g()}catch(M){n.error(M)}}))};return e.subscribe(ot(n,x,()=>{p=!0,g()})),()=>{a?.()}}function sn(e,n,t=1/0){return Qe(n)?sn((r,i)=>Xe((o,s)=>n(r,o,i,s))(on(e(r,i))),t):(typeof n=="number"&&(t=n),ut((r,i)=>Q1(r,i,e,t)))}function lo(e=1/0){return sn(wr,e)}function X1(){return lo(1)}function Vs(...e){return X1()(At(e,uo(e)))}function nl(e){return new ct(n=>{on(e()).subscribe(n)})}function Ja(...e){let n=Uu(e),{args:t,keys:r}=el(e),i=new ct(o=>{let{length:s}=t;if(!s){o.complete();return}let a=new Array(s),c=s,d=s;for(let h=0;h<s;h++){let p=!1;on(t[h]).subscribe(ot(o,g=>{p||(p=!0,d--),a[h]=g},()=>c--,void 0,()=>{(!c||!p)&&(d||o.next(r?tl(r,a):a),o.complete())}))}});return n?i.pipe(Ju(n)):i}function Bn(e,n){return ut((t,r)=>{let i=0;t.subscribe(ot(r,o=>e.call(n,o,i++)&&r.next(o)))})}function Et(e){return ut((n,t)=>{let r=null,i=!1,o;r=n.subscribe(ot(t,void 0,void 0,s=>{o=on(e(s,Et(e)(n))),r?(r.unsubscribe(),r=null,o.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,o.subscribe(t))})}function Y1(e,n,t,r,i){return(o,s)=>{let a=t,c=n,d=0;o.subscribe(ot(s,h=>{let p=d++;c=a?e(c,h,p):(a=!0,h),r&&s.next(c)},i&&(()=>{a&&s.next(c),s.complete()})))}}function Li(e,n){return Qe(n)?sn(e,n,1):sn(e,1)}function fo(e){return ut((n,t)=>{let r=!1;n.subscribe(ot(t,i=>{r=!0,t.next(i)},()=>{r||t.next(e),t.complete()}))})}function Vi(e){return e<=0?()=>br:ut((n,t)=>{let r=0;n.subscribe(ot(t,i=>{++r<=e&&(t.next(i),e<=r&&t.complete())}))})}function Lf(e){return Xe(()=>e)}function rl(e=Y2){return ut((n,t)=>{let r=!1;n.subscribe(ot(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(e())))})}function Y2(){return new Bi}function ho(e){return ut((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}function xi(e,n){let t=arguments.length>=2;return r=>r.pipe(e?Bn((i,o)=>e(i,o,r)):wr,Vi(1),t?fo(n):rl(()=>new Bi))}function Us(e){return e<=0?()=>br:ut((n,t)=>{let r=[];n.subscribe(ot(t,i=>{r.push(i),e<r.length&&r.shift()},()=>{for(let i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function Vf(e,n){let t=arguments.length>=2;return r=>r.pipe(e?Bn((i,o)=>e(i,o,r)):wr,Us(1),t?fo(n):rl(()=>new Bi))}function Uf(e,n){return ut(Y1(e,n,arguments.length>=2,!0))}function jf(...e){let n=uo(e);return ut((t,r)=>{(n?Vs(e,t,n):Vs(e,t)).subscribe(r)})}function lr(e,n){return ut((t,r)=>{let i=null,o=0,s=!1,a=()=>s&&!i&&r.complete();t.subscribe(ot(r,c=>{i?.unsubscribe();let d=0,h=o++;on(e(c,h)).subscribe(i=ot(r,p=>r.next(n?n(c,p,h,d++):p),()=>{i=null,a()}))},()=>{s=!0,a()}))})}function Hf(e){return ut((n,t)=>{on(e).subscribe(ot(t,()=>t.complete(),Ka)),!t.closed&&n.subscribe(t)})}function Ft(e,n,t){let r=Qe(e)||n||t?{next:e,error:n,complete:t}:e;return r?ut((i,o)=>{var s;(s=r.subscribe)===null||s===void 0||s.call(r);let a=!0;i.subscribe(ot(o,c=>{var d;(d=r.next)===null||d===void 0||d.call(r,c),o.next(c)},()=>{var c;a=!1,(c=r.complete)===null||c===void 0||c.call(r),o.complete()},c=>{var d;a=!1,(d=r.error)===null||d===void 0||d.call(r,c),o.error(c)},()=>{var c,d;a&&((c=r.unsubscribe)===null||c===void 0||c.call(r)),(d=r.finalize)===null||d===void 0||d.call(r)}))}):wr}var Rx="https://g.co/ng/security#xss",Ne=class extends Error{constructor(n,t){super(Ul(n,t)),this.code=n}};function Ul(e,n){return`${`NG0${Math.abs(e)}`}${n?": "+n:""}`}function cc(e){return{toString:e}.toString()}var il="__parameters__";function K2(e){return function(...t){if(e){let r=e(...t);for(let i in r)this[i]=r[i]}}}function Bx(e,n,t){return cc(()=>{let r=K2(n);function i(...o){if(this instanceof i)return r.apply(this,o),this;let s=new i(...o);return a.annotation=s,a;function a(c,d,h){let p=c.hasOwnProperty(il)?c[il]:Object.defineProperty(c,il,{value:[]})[il];for(;p.length<=h;)p.push(null);return(p[h]=p[h]||[]).push(s),c}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=e,i.annotationCls=i,i})}var Zo=globalThis;function St(e){for(let n in e)if(e[n]===St)return n;throw Error("Could not find renamed property on target object.")}function Z2(e,n){for(let t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function Zn(e){if(typeof e=="string")return e;if(Array.isArray(e))return"["+e.map(Zn).join(", ")+"]";if(e==null)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;let n=e.toString();if(n==null)return""+n;let t=n.indexOf(`
`);return t===-1?n:n.substring(0,t)}function K1(e,n){return e==null||e===""?n===null?"":n:n==null||n===""?e:e+" "+n}var J2=St({__forward_ref__:St});function fr(e){return e.__forward_ref__=fr,e.toString=function(){return Zn(this())},e}function Kn(e){return Lx(e)?e():e}function Lx(e){return typeof e=="function"&&e.hasOwnProperty(J2)&&e.__forward_ref__===fr}function Ae(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function ti(e){return{providers:e.providers||[],imports:e.imports||[]}}function jl(e){return Z1(e,Ux)||Z1(e,jx)}function Vx(e){return jl(e)!==null}function Z1(e,n){return e.hasOwnProperty(n)?e[n]:null}function eD(e){let n=e&&(e[Ux]||e[jx]);return n||null}function J1(e){return e&&(e.hasOwnProperty(ex)||e.hasOwnProperty(tD))?e[ex]:null}var Ux=St({\u0275prov:St}),ex=St({\u0275inj:St}),jx=St({ngInjectableDef:St}),tD=St({ngInjectorDef:St}),Ie=class{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,typeof t=="number"?this.__NG_ELEMENT_ID__=t:t!==void 0&&(this.\u0275prov=Ae({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function Hx(e){return e&&!!e.\u0275providers}var nD=St({\u0275cmp:St}),rD=St({\u0275dir:St}),iD=St({\u0275pipe:St}),oD=St({\u0275mod:St}),ml=St({\u0275fac:St}),tc=St({__NG_ELEMENT_ID__:St}),tx=St({__NG_ENV_ID__:St});function Gs(e){return typeof e=="string"?e:e==null?"":String(e)}function sD(e){return typeof e=="function"?e.name||e.toString():typeof e=="object"&&e!=null&&typeof e.type=="function"?e.type.name||e.type.toString():Gs(e)}function aD(e,n){let t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new Ne(-200,e)}function Jh(e,n){throw new Ne(-201,!1)}var tt=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}(tt||{}),rh;function $x(){return rh}function dr(e){let n=rh;return rh=e,n}function qx(e,n,t){let r=jl(e);if(r&&r.providedIn=="root")return r.value===void 0?r.value=r.factory():r.value;if(t&tt.Optional)return null;if(n!==void 0)return n;Jh(e,"Injector")}var cD={},nc=cD,ih="__NG_DI_FLAG__",gl="ngTempTokenPath",uD="ngTokenPath",lD=/\n/gm,dD="\u0275",nx="__source",Ws;function fD(){return Ws}function po(e){let n=Ws;return Ws=e,n}function hD(e,n=tt.Default){if(Ws===void 0)throw new Ne(-203,!1);return Ws===null?qx(e,void 0,n):Ws.get(e,n&tt.Optional?null:void 0,n)}function ke(e,n=tt.Default){return($x()||hD)(Kn(e),n)}function ue(e,n=tt.Default){return ke(e,Hl(n))}function Hl(e){return typeof e>"u"||typeof e=="number"?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function oh(e){let n=[];for(let t=0;t<e.length;t++){let r=Kn(e[t]);if(Array.isArray(r)){if(r.length===0)throw new Ne(900,!1);let i,o=tt.Default;for(let s=0;s<r.length;s++){let a=r[s],c=pD(a);typeof c=="number"?c===-1?i=a.token:o|=c:i=a}n.push(ke(i,o))}else n.push(ke(r))}return n}function Wx(e,n){return e[ih]=n,e.prototype[ih]=n,e}function pD(e){return e[ih]}function mD(e,n,t,r){let i=e[gl];throw n[nx]&&i.unshift(n[nx]),e.message=gD(`
`+e.message,i,t,r),e[uD]=i,e[gl]=null,e}function gD(e,n,t,r=null){e=e&&e.charAt(0)===`
`&&e.charAt(1)==dD?e.slice(2):e;let i=Zn(n);if(Array.isArray(n))i=n.map(Zn).join(" -> ");else if(typeof n=="object"){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+(typeof a=="string"?JSON.stringify(a):Zn(a)))}i=`{${o.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${e.replace(lD,`
  `)}`}var $l=Wx(Bx("Optional"),8);var ep=Wx(Bx("SkipSelf"),4);function es(e,n){let t=e.hasOwnProperty(ml);return t?e[ml]:null}function xD(e,n,t){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){let i=e[r],o=n[r];if(t&&(i=t(i),o=t(o)),o!==i)return!1}return!0}function ED(e){return e.flat(Number.POSITIVE_INFINITY)}function tp(e,n){e.forEach(t=>Array.isArray(t)?tp(t,n):n(t))}function zx(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function xl(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function vD(e,n,t,r){let i=e.length;if(i==n)e.push(t,r);else if(i===1)e.push(r,e[0]),e[0]=t;else{for(i--,e.push(e[i-1],e[i]);i>n;){let o=i-2;e[i]=e[o],i--}e[n]=t,e[n+1]=r}}function _D(e,n,t){let r=uc(e,n);return r>=0?e[r|1]=t:(r=~r,vD(e,r,n,t)),r}function $f(e,n){let t=uc(e,n);if(t>=0)return e[t|1]}function uc(e,n){return CD(e,n,1)}function CD(e,n,t){let r=0,i=e.length>>t;for(;i!==r;){let o=r+(i-r>>1),s=e[o<<t];if(n===s)return o<<t;s>n?i=o:r=o+1}return~(i<<t)}var Qs={},Nr=[],Xs=new Ie(""),Gx=new Ie("",-1),Qx=new Ie(""),El=class{get(n,t=nc){if(t===nc){let r=new Error(`NullInjectorError: No provider for ${Zn(n)}!`);throw r.name="NullInjectorError",r}return t}},Xx=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}(Xx||{}),_i=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}(_i||{}),xo=function(e){return e[e.None=0]="None",e[e.SignalBased=1]="SignalBased",e[e.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",e}(xo||{});function yD(e,n,t){let r=e.length;for(;;){let i=e.indexOf(n,t);if(i===-1)return i;if(i===0||e.charCodeAt(i-1)<=32){let o=n.length;if(i+o===r||e.charCodeAt(i+o)<=32)return i}t=i+1}}function sh(e,n,t){let r=0;for(;r<t.length;){let i=t[r];if(typeof i=="number"){if(i!==0)break;r++;let o=t[r++],s=t[r++],a=t[r++];e.setAttribute(n,s,a,o)}else{let o=i,s=t[++r];wD(o)?e.setProperty(n,o,s):e.setAttribute(n,o,s),r++}}return r}function Yx(e){return e===3||e===4||e===6}function wD(e){return e.charCodeAt(0)===64}function rc(e,n){if(!(n===null||n.length===0))if(e===null||e.length===0)e=n.slice();else{let t=-1;for(let r=0;r<n.length;r++){let i=n[r];typeof i=="number"?t=i:t===0||(t===-1||t===2?rx(e,t,i,null,n[++r]):rx(e,t,i,null,null))}}return e}function rx(e,n,t,r,i){let o=0,s=e.length;if(n===-1)s=-1;else for(;o<e.length;){let a=e[o++];if(typeof a=="number"){if(a===n){s=-1;break}else if(a>n){s=o-1;break}}}for(;o<e.length;){let a=e[o];if(typeof a=="number")break;if(a===t){if(r===null){i!==null&&(e[o+1]=i);return}else if(r===e[o+1]){e[o+2]=i;return}}o++,r!==null&&o++,i!==null&&o++}s!==-1&&(e.splice(s,0,n),o=s+1),e.splice(o++,0,t),r!==null&&e.splice(o++,0,r),i!==null&&e.splice(o++,0,i)}var Kx="ng-template";function bD(e,n,t,r){let i=0;if(r){for(;i<n.length&&typeof n[i]=="string";i+=2)if(n[i]==="class"&&yD(n[i+1].toLowerCase(),t,0)!==-1)return!0}else if(np(e))return!1;if(i=n.indexOf(1,i),i>-1){let o;for(;++i<n.length&&typeof(o=n[i])=="string";)if(o.toLowerCase()===t)return!0}return!1}function np(e){return e.type===4&&e.value!==Kx}function DD(e,n,t){let r=e.type===4&&!t?Kx:e.value;return n===r}function SD(e,n,t){let r=4,i=e.attrs,o=i!==null?TD(i):0,s=!1;for(let a=0;a<n.length;a++){let c=n[a];if(typeof c=="number"){if(!s&&!Kr(r)&&!Kr(c))return!1;if(s&&Kr(c))continue;s=!1,r=c|r&1;continue}if(!s)if(r&4){if(r=2|r&1,c!==""&&!DD(e,c,t)||c===""&&n.length===1){if(Kr(r))return!1;s=!0}}else if(r&8){if(i===null||!bD(e,i,c,t)){if(Kr(r))return!1;s=!0}}else{let d=n[++a],h=MD(c,i,np(e),t);if(h===-1){if(Kr(r))return!1;s=!0;continue}if(d!==""){let p;if(h>o?p="":p=i[h+1].toLowerCase(),r&2&&d!==p){if(Kr(r))return!1;s=!0}}}}return Kr(r)||s}function Kr(e){return(e&1)===0}function MD(e,n,t,r){if(n===null)return-1;let i=0;if(r||!t){let o=!1;for(;i<n.length;){let s=n[i];if(s===e)return i;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=n[++i];for(;typeof a=="string";)a=n[++i];continue}else{if(s===4)break;if(s===0){i+=4;continue}}i+=o?1:2}return-1}else return OD(n,e)}function AD(e,n,t=!1){for(let r=0;r<n.length;r++)if(SD(e,n[r],t))return!0;return!1}function TD(e){for(let n=0;n<e.length;n++){let t=e[n];if(Yx(t))return n}return e.length}function OD(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){let r=e[t];if(typeof r=="number")return-1;if(r===n)return t;t++}return-1}function ix(e,n){return e?":not("+n.trim()+")":n}function ID(e){let n=e[0],t=1,r=2,i="",o=!1;for(;t<e.length;){let s=e[t];if(typeof s=="string")if(r&2){let a=e[++t];i+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else r&8?i+="."+s:r&4&&(i+=" "+s);else i!==""&&!Kr(s)&&(n+=ix(o,i),i=""),r=s,o=o||!Kr(r);t++}return i!==""&&(n+=ix(o,i)),n}function kD(e){return e.map(ID).join(",")}function PD(e){let n=[],t=[],r=1,i=2;for(;r<e.length;){let o=e[r];if(typeof o=="string")i===2?o!==""&&n.push(o,e[++r]):i===8&&t.push(o);else{if(!Kr(i))break;i=o}r++}return{attrs:n,classes:t}}function Se(e){return cc(()=>{let n=rE(e),t=qe(de({},n),{decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Xx.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,signals:e.signals??!1,data:e.data||{},encapsulation:e.encapsulation||_i.Emulated,styles:e.styles||Nr,_:null,schemas:e.schemas||null,tView:null,id:""});iE(t);let r=e.dependencies;return t.directiveDefs=sx(r,!1),t.pipeDefs=sx(r,!0),t.id=RD(t),t})}function FD(e){return Eo(e)||Jx(e)}function ND(e){return e!==null}function ni(e){return cc(()=>({type:e.type,bootstrap:e.bootstrap||Nr,declarations:e.declarations||Nr,imports:e.imports||Nr,exports:e.exports||Nr,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function ox(e,n){if(e==null)return Qs;let t={};for(let r in e)if(e.hasOwnProperty(r)){let i=e[r],o,s,a=xo.None;Array.isArray(i)?(a=i[0],o=i[1],s=i[2]??o):(o=i,s=i),n?(t[o]=a!==xo.None?[r,a]:r,n[o]=s):t[o]=r}return t}function bt(e){return cc(()=>{let n=rE(e);return iE(n),n})}function Zx(e){return{type:e.type,name:e.name,factory:null,pure:e.pure!==!1,standalone:e.standalone===!0,onDestroy:e.type.prototype.ngOnDestroy||null}}function Eo(e){return e[nD]||null}function Jx(e){return e[rD]||null}function eE(e){return e[iD]||null}function tE(e){let n=Eo(e)||Jx(e)||eE(e);return n!==null?n.standalone:!1}function nE(e,n){let t=e[oD]||null;if(!t&&n===!0)throw new Error(`Type ${Zn(e)} does not have '\u0275mod' property.`);return t}function rE(e){let n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:e.inputs||Qs,exportAs:e.exportAs||null,standalone:e.standalone===!0,signals:e.signals===!0,selectors:e.selectors||Nr,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ox(e.inputs,n),outputs:ox(e.outputs),debugInfo:null}}function iE(e){e.features?.forEach(n=>n(e))}function sx(e,n){if(!e)return null;let t=n?eE:FD;return()=>(typeof e=="function"?e():e).map(r=>t(r)).filter(ND)}function RD(e){let n=0,t=[e.selectors,e.ngContentSelectors,e.hostVars,e.hostAttrs,e.consts,e.vars,e.decls,e.encapsulation,e.standalone,e.signals,e.exportAs,JSON.stringify(e.inputs),JSON.stringify(e.outputs),Object.getOwnPropertyNames(e.type.prototype),!!e.contentQueries,!!e.viewQuery].join("|");for(let i of t)n=Math.imul(31,n)+i.charCodeAt(0)<<0;return n+=2147483648,"c"+n}function lc(e){return{\u0275providers:e}}function BD(...e){return{\u0275providers:oE(!0,e),\u0275fromNgModule:!0}}function oE(e,...n){let t=[],r=new Set,i,o=s=>{t.push(s)};return tp(n,s=>{let a=s;ah(a,o,[],r)&&(i||=[],i.push(a))}),i!==void 0&&sE(i,o),t}function sE(e,n){for(let t=0;t<e.length;t++){let{ngModule:r,providers:i}=e[t];rp(i,o=>{n(o,r)})}}function ah(e,n,t,r){if(e=Kn(e),!e)return!1;let i=null,o=J1(e),s=!o&&Eo(e);if(!o&&!s){let c=e.ngModule;if(o=J1(c),o)i=c;else return!1}else{if(s&&!s.standalone)return!1;i=e}let a=r.has(i);if(s){if(a)return!1;if(r.add(i),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let d of c)ah(d,n,t,r)}}else if(o){if(o.imports!=null&&!a){r.add(i);let d;try{tp(o.imports,h=>{ah(h,n,t,r)&&(d||=[],d.push(h))})}finally{}d!==void 0&&sE(d,n)}if(!a){let d=es(i)||(()=>new i);n({provide:i,useFactory:d,deps:Nr},i),n({provide:Qx,useValue:i,multi:!0},i),n({provide:Xs,useValue:()=>ke(i),multi:!0},i)}let c=o.providers;if(c!=null&&!a){let d=e;rp(c,h=>{n(h,d)})}}else return!1;return i!==e&&e.providers!==void 0}function rp(e,n){for(let t of e)Hx(t)&&(t=t.\u0275providers),Array.isArray(t)?rp(t,n):n(t)}var LD=St({provide:String,useValue:St});function aE(e){return e!==null&&typeof e=="object"&&LD in e}function VD(e){return!!(e&&e.useExisting)}function UD(e){return!!(e&&e.useFactory)}function Ys(e){return typeof e=="function"}function jD(e){return!!e.useClass}var ql=new Ie(""),ul={},HD={},qf;function ip(){return qf===void 0&&(qf=new El),qf}var Jn=class{},ic=class extends Jn{get destroyed(){return this._destroyed}constructor(n,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,uh(n,s=>this.processProvider(s)),this.records.set(Gx,js(void 0,this)),i.has("environment")&&this.records.set(Jn,js(void 0,this));let o=this.records.get(ql);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Qx,Nr,tt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;let n=mt(null);try{for(let r of this._ngOnDestroyHooks)r.ngOnDestroy();let t=this._onDestroyHooks;this._onDestroyHooks=[];for(let r of t)r()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),mt(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();let t=po(this),r=dr(void 0),i;try{return n()}finally{po(t),dr(r)}}get(n,t=nc,r=tt.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(tx))return n[tx](this);r=Hl(r);let i,o=po(this),s=dr(void 0);try{if(!(r&tt.SkipSelf)){let c=this.records.get(n);if(c===void 0){let d=GD(n)&&jl(n);d&&this.injectableDefInScope(d)?c=js(ch(n),ul):c=null,this.records.set(n,c)}if(c!=null)return this.hydrate(n,c)}let a=r&tt.Self?ip():this.parent;return t=r&tt.Optional&&t===nc?null:t,a.get(n,t)}catch(a){if(a.name==="NullInjectorError"){if((a[gl]=a[gl]||[]).unshift(Zn(n)),o)throw a;return mD(a,n,"R3InjectorError",this.source)}else throw a}finally{dr(s),po(o)}}resolveInjectorInitializers(){let n=mt(null),t=po(this),r=dr(void 0),i;try{let o=this.get(Xs,Nr,tt.Self);for(let s of o)s()}finally{po(t),dr(r),mt(n)}}toString(){let n=[],t=this.records;for(let r of t.keys())n.push(Zn(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ne(205,!1)}processProvider(n){n=Kn(n);let t=Ys(n)?n:Kn(n&&n.provide),r=qD(n);if(!Ys(n)&&n.multi===!0){let i=this.records.get(t);i||(i=js(void 0,ul,!0),i.factory=()=>oh(i.multi),this.records.set(t,i)),t=n,i.multi.push(n)}this.records.set(t,r)}hydrate(n,t){let r=mt(null);try{return t.value===ul&&(t.value=HD,t.value=t.factory()),typeof t.value=="object"&&t.value&&zD(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}finally{mt(r)}}injectableDefInScope(n){if(!n.providedIn)return!1;let t=Kn(n.providedIn);return typeof t=="string"?t==="any"||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(n){let t=this._onDestroyHooks.indexOf(n);t!==-1&&this._onDestroyHooks.splice(t,1)}};function ch(e){let n=jl(e),t=n!==null?n.factory:es(e);if(t!==null)return t;if(e instanceof Ie)throw new Ne(204,!1);if(e instanceof Function)return $D(e);throw new Ne(204,!1)}function $D(e){if(e.length>0)throw new Ne(204,!1);let t=eD(e);return t!==null?()=>t.factory(e):()=>new e}function qD(e){if(aE(e))return js(void 0,e.useValue);{let n=cE(e);return js(n,ul)}}function cE(e,n,t){let r;if(Ys(e)){let i=Kn(e);return es(i)||ch(i)}else if(aE(e))r=()=>Kn(e.useValue);else if(UD(e))r=()=>e.useFactory(...oh(e.deps||[]));else if(VD(e))r=()=>ke(Kn(e.useExisting));else{let i=Kn(e&&(e.useClass||e.provide));if(WD(e))r=()=>new i(...oh(e.deps));else return es(i)||ch(i)}return r}function js(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function WD(e){return!!e.deps}function zD(e){return e!==null&&typeof e=="object"&&typeof e.ngOnDestroy=="function"}function GD(e){return typeof e=="function"||typeof e=="object"&&e instanceof Ie}function uh(e,n){for(let t of e)Array.isArray(t)?uh(t,n):t&&Hx(t)?uh(t.\u0275providers,n):n(t)}function Br(e,n){e instanceof ic&&e.assertNotDestroyed();let t,r=po(e),i=dr(void 0);try{return n()}finally{po(r),dr(i)}}function uE(){return $x()!==void 0||fD()!=null}function QD(e){if(!uE())throw new Ne(-203,!1)}function XD(e){return typeof e=="function"}var $i=0,Ke=1,je=2,Ln=3,Zr=4,ri=5,vl=6,_l=7,Jr=8,Ks=9,Ci=10,Gt=11,oc=12,ax=13,oa=14,yi=15,ts=16,Hs=17,Ui=18,Wl=19,lE=20,mo=21,Wf=22,Rr=23,Sr=25,dE=1;var ns=7,Cl=8,Zs=9,Dr=10,yl=function(e){return e[e.None=0]="None",e[e.HasTransplantedViews=2]="HasTransplantedViews",e}(yl||{});function go(e){return Array.isArray(e)&&typeof e[dE]=="object"}function qi(e){return Array.isArray(e)&&e[dE]===!0}function op(e){return(e.flags&4)!==0}function zl(e){return e.componentOffset>-1}function Gl(e){return(e.flags&1)===1}function vo(e){return!!e.template}function lh(e){return(e[je]&512)!==0}var dh=class{constructor(n,t,r){this.previousValue=n,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}};function fE(e,n,t,r){n!==null?n.applyValueToInputSignal(n,r):e[t]=r}function ii(){return hE}function hE(e){return e.type.prototype.ngOnChanges&&(e.setInput=KD),YD}ii.ngInherit=!0;function YD(){let e=mE(this),n=e?.current;if(n){let t=e.previous;if(t===Qs)e.previous=n;else for(let r in n)t[r]=n[r];e.current=null,this.ngOnChanges(n)}}function KD(e,n,t,r,i){let o=this.declaredInputs[r],s=mE(e)||ZD(e,{previous:Qs,current:null}),a=s.current||(s.current={}),c=s.previous,d=c[o];a[o]=new dh(d&&d.currentValue,t,c===Qs),fE(e,n,i,t)}var pE="__ngSimpleChanges__";function mE(e){return e[pE]||null}function ZD(e,n){return e[pE]=n}var cx=null;var Ei=function(e,n,t){cx?.(e,n,t)},JD="svg",eS="math";function wi(e){for(;Array.isArray(e);)e=e[$i];return e}function gE(e,n){return wi(n[e])}function Lr(e,n){return wi(n[e.index])}function xE(e,n){return e.data[n]}function sp(e,n){return e[n]}function wo(e,n){let t=n[e];return go(t)?t:t[$i]}function tS(e){return(e[je]&4)===4}function ap(e){return(e[je]&128)===128}function nS(e){return qi(e[Ln])}function Js(e,n){return n==null?null:e[n]}function EE(e){e[Hs]=0}function vE(e){e[je]&1024||(e[je]|=1024,ap(e)&&Xl(e))}function rS(e,n){for(;e>0;)n=n[oa],e--;return n}function Ql(e){return!!(e[je]&9216||e[Rr]?.dirty)}function fh(e){e[Ci].changeDetectionScheduler?.notify(8),e[je]&64&&(e[je]|=1024),Ql(e)&&Xl(e)}function Xl(e){e[Ci].changeDetectionScheduler?.notify(0);let n=rs(e);for(;n!==null&&!(n[je]&8192||(n[je]|=8192,!ap(n)));)n=rs(n)}function _E(e,n){if((e[je]&256)===256)throw new Ne(911,!1);e[mo]===null&&(e[mo]=[]),e[mo].push(n)}function iS(e,n){if(e[mo]===null)return;let t=e[mo].indexOf(n);t!==-1&&e[mo].splice(t,1)}function rs(e){let n=e[Ln];return qi(n)?n[Ln]:n}var et={lFrame:OE(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var CE=!1;function oS(){return et.lFrame.elementDepthCount}function sS(){et.lFrame.elementDepthCount++}function aS(){et.lFrame.elementDepthCount--}function yE(){return et.bindingsEnabled}function cS(){return et.skipHydrationRootTNode!==null}function uS(e){return et.skipHydrationRootTNode===e}function lS(){et.skipHydrationRootTNode=null}function nt(){return et.lFrame.lView}function an(){return et.lFrame.tView}function U(e){return et.lFrame.contextLView=e,e[Jr]}function j(e){return et.lFrame.contextLView=null,e}function kn(){let e=wE();for(;e!==null&&e.type===64;)e=e.parent;return e}function wE(){return et.lFrame.currentTNode}function dS(){let e=et.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}function ls(e,n){let t=et.lFrame;t.currentTNode=e,t.isParent=n}function cp(){return et.lFrame.isParent}function bE(){et.lFrame.isParent=!1}function fS(){return et.lFrame.contextLView}function DE(){return CE}function ux(e){CE=e}function sa(){let e=et.lFrame,n=e.bindingRootIndex;return n===-1&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function hS(){return et.lFrame.bindingIndex}function pS(e){return et.lFrame.bindingIndex=e}function Yl(){return et.lFrame.bindingIndex++}function SE(e){let n=et.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function mS(){return et.lFrame.inI18n}function gS(e,n){let t=et.lFrame;t.bindingIndex=t.bindingRootIndex=e,hh(n)}function xS(){return et.lFrame.currentDirectiveIndex}function hh(e){et.lFrame.currentDirectiveIndex=e}function ES(e){let n=et.lFrame.currentDirectiveIndex;return n===-1?null:e[n]}function ME(){return et.lFrame.currentQueryIndex}function up(e){et.lFrame.currentQueryIndex=e}function vS(e){let n=e[Ke];return n.type===2?n.declTNode:n.type===1?e[ri]:null}function AE(e,n,t){if(t&tt.SkipSelf){let i=n,o=e;for(;i=i.parent,i===null&&!(t&tt.Host);)if(i=vS(o),i===null||(o=o[oa],i.type&10))break;if(i===null)return!1;n=i,e=o}let r=et.lFrame=TE();return r.currentTNode=n,r.lView=e,!0}function lp(e){let n=TE(),t=e[Ke];et.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function TE(){let e=et.lFrame,n=e===null?null:e.child;return n===null?OE(e):n}function OE(e){let n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return e!==null&&(e.child=n),n}function IE(){let e=et.lFrame;return et.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var kE=IE;function dp(){let e=IE();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function _S(e){return(et.lFrame.contextLView=rS(e,et.lFrame.contextLView))[Jr]}function ds(){return et.lFrame.selectedIndex}function is(e){et.lFrame.selectedIndex=e}function dc(){let e=et.lFrame;return xE(e.tView,e.selectedIndex)}function CS(){return et.lFrame.currentNamespace}var PE=!0;function Kl(){return PE}function Zl(e){PE=e}function yS(e,n,t){let{ngOnChanges:r,ngOnInit:i,ngDoCheck:o}=n.type.prototype;if(r){let s=hE(n);(t.preOrderHooks??=[]).push(e,s),(t.preOrderCheckHooks??=[]).push(e,s)}i&&(t.preOrderHooks??=[]).push(0-e,i),o&&((t.preOrderHooks??=[]).push(e,o),(t.preOrderCheckHooks??=[]).push(e,o))}function Jl(e,n){for(let t=n.directiveStart,r=n.directiveEnd;t<r;t++){let o=e.data[t].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:d,ngOnDestroy:h}=o;s&&(e.contentHooks??=[]).push(-t,s),a&&((e.contentHooks??=[]).push(t,a),(e.contentCheckHooks??=[]).push(t,a)),c&&(e.viewHooks??=[]).push(-t,c),d&&((e.viewHooks??=[]).push(t,d),(e.viewCheckHooks??=[]).push(t,d)),h!=null&&(e.destroyHooks??=[]).push(t,h)}}function ll(e,n,t){FE(e,n,3,t)}function dl(e,n,t,r){(e[je]&3)===t&&FE(e,n,t,r)}function zf(e,n){let t=e[je];(t&3)===n&&(t&=16383,t+=1,e[je]=t)}function FE(e,n,t,r){let i=r!==void 0?e[Hs]&65535:0,o=r??-1,s=n.length-1,a=0;for(let c=i;c<s;c++)if(typeof n[c+1]=="number"){if(a=n[c],r!=null&&a>=r)break}else n[c]<0&&(e[Hs]+=65536),(a<o||o==-1)&&(wS(e,t,n,c),e[Hs]=(e[Hs]&4294901760)+c+2),c++}function lx(e,n){Ei(4,e,n);let t=mt(null);try{n.call(e)}finally{mt(t),Ei(5,e,n)}}function wS(e,n,t,r){let i=t[r]<0,o=t[r+1],s=i?-t[r]:t[r],a=e[s];i?e[je]>>14<e[Hs]>>16&&(e[je]&3)===n&&(e[je]+=16384,lx(a,o)):lx(a,o)}var zs=-1,os=class{constructor(n,t,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}};function bS(e){return e instanceof os}function DS(e){return(e.flags&8)!==0}function SS(e){return(e.flags&16)!==0}var Gf={},ph=class{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,r){r=Hl(r);let i=this.injector.get(n,Gf,r);return i!==Gf||t===Gf?i:this.parentInjector.get(n,t,r)}};function NE(e){return e!==zs}function wl(e){return e&32767}function MS(e){return e>>16}function bl(e,n){let t=MS(e),r=n;for(;t>0;)r=r[oa],t--;return r}var mh=!0;function Dl(e){let n=mh;return mh=e,n}var AS=256,RE=AS-1,BE=5,TS=0,vi={};function OS(e,n,t){let r;typeof t=="string"?r=t.charCodeAt(0)||0:t.hasOwnProperty(tc)&&(r=t[tc]),r==null&&(r=t[tc]=TS++);let i=r&RE,o=1<<i;n.data[e+(i>>BE)]|=o}function Sl(e,n){let t=LE(e,n);if(t!==-1)return t;let r=n[Ke];r.firstCreatePass&&(e.injectorIndex=n.length,Qf(r.data,e),Qf(n,null),Qf(r.blueprint,null));let i=fp(e,n),o=e.injectorIndex;if(NE(i)){let s=wl(i),a=bl(i,n),c=a[Ke].data;for(let d=0;d<8;d++)n[o+d]=a[s+d]|c[s+d]}return n[o+8]=i,o}function Qf(e,n){e.push(0,0,0,0,0,0,0,0,n)}function LE(e,n){return e.injectorIndex===-1||e.parent&&e.parent.injectorIndex===e.injectorIndex||n[e.injectorIndex+8]===null?-1:e.injectorIndex}function fp(e,n){if(e.parent&&e.parent.injectorIndex!==-1)return e.parent.injectorIndex;let t=0,r=null,i=n;for(;i!==null;){if(r=$E(i),r===null)return zs;if(t++,i=i[oa],r.injectorIndex!==-1)return r.injectorIndex|t<<16}return zs}function gh(e,n,t){OS(e,n,t)}function IS(e,n){if(n==="class")return e.classes;if(n==="style")return e.styles;let t=e.attrs;if(t){let r=t.length,i=0;for(;i<r;){let o=t[i];if(Yx(o))break;if(o===0)i=i+2;else if(typeof o=="number")for(i++;i<r&&typeof t[i]=="string";)i++;else{if(o===n)return t[i+1];i=i+2}}}return null}function VE(e,n,t){if(t&tt.Optional||e!==void 0)return e;Jh(n,"NodeInjector")}function UE(e,n,t,r){if(t&tt.Optional&&r===void 0&&(r=null),!(t&(tt.Self|tt.Host))){let i=e[Ks],o=dr(void 0);try{return i?i.get(n,r,t&tt.Optional):qx(n,r,t&tt.Optional)}finally{dr(o)}}return VE(r,n,t)}function jE(e,n,t,r=tt.Default,i){if(e!==null){if(n[je]&2048&&!(r&tt.Self)){let s=NS(e,n,t,r,vi);if(s!==vi)return s}let o=HE(e,n,t,r,vi);if(o!==vi)return o}return UE(n,t,r,i)}function HE(e,n,t,r,i){let o=PS(t);if(typeof o=="function"){if(!AE(n,e,r))return r&tt.Host?VE(i,t,r):UE(n,t,r,i);try{let s;if(s=o(r),s==null&&!(r&tt.Optional))Jh(t);else return s}finally{kE()}}else if(typeof o=="number"){let s=null,a=LE(e,n),c=zs,d=r&tt.Host?n[yi][ri]:null;for((a===-1||r&tt.SkipSelf)&&(c=a===-1?fp(e,n):n[a+8],c===zs||!fx(r,!1)?a=-1:(s=n[Ke],a=wl(c),n=bl(c,n)));a!==-1;){let h=n[Ke];if(dx(o,a,h.data)){let p=kS(a,n,t,s,r,d);if(p!==vi)return p}c=n[a+8],c!==zs&&fx(r,n[Ke].data[a+8]===d)&&dx(o,a,n)?(s=h,a=wl(c),n=bl(c,n)):a=-1}}return i}function kS(e,n,t,r,i,o){let s=n[Ke],a=s.data[e+8],c=r==null?zl(a)&&mh:r!=s&&(a.type&3)!==0,d=i&tt.Host&&o===a,h=fl(a,s,t,c,d);return h!==null?ss(n,s,h,a):vi}function fl(e,n,t,r,i){let o=e.providerIndexes,s=n.data,a=o&1048575,c=e.directiveStart,d=e.directiveEnd,h=o>>20,p=r?a:a+h,g=i?a+h:d;for(let x=p;x<g;x++){let v=s[x];if(x<c&&t===v||x>=c&&v.type===t)return x}if(i){let x=s[c];if(x&&vo(x)&&x.type===t)return c}return null}function ss(e,n,t,r){let i=e[t],o=n.data;if(bS(i)){let s=i;s.resolving&&aD(sD(o[t]));let a=Dl(s.canSeeViewProviders);s.resolving=!0;let c,d=s.injectImpl?dr(s.injectImpl):null,h=AE(e,r,tt.Default);try{i=e[t]=s.factory(void 0,o,e,r),n.firstCreatePass&&t>=r.directiveStart&&yS(t,o[t],n)}finally{d!==null&&dr(d),Dl(a),s.resolving=!1,kE()}}return i}function PS(e){if(typeof e=="string")return e.charCodeAt(0)||0;let n=e.hasOwnProperty(tc)?e[tc]:void 0;return typeof n=="number"?n>=0?n&RE:FS:n}function dx(e,n,t){let r=1<<e;return!!(t[n+(e>>BE)]&r)}function fx(e,n){return!(e&tt.Self)&&!(e&tt.Host&&n)}var Jo=class{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,r){return jE(this._tNode,this._lView,n,Hl(r),t)}};function FS(){return new Jo(kn(),nt())}function oi(e){return cc(()=>{let n=e.prototype.constructor,t=n[ml]||xh(n),r=Object.prototype,i=Object.getPrototypeOf(e.prototype).constructor;for(;i&&i!==r;){let o=i[ml]||xh(i);if(o&&o!==t)return o;i=Object.getPrototypeOf(i)}return o=>new o})}function xh(e){return Lx(e)?()=>{let n=xh(Kn(e));return n&&n()}:es(e)}function NS(e,n,t,r,i){let o=e,s=n;for(;o!==null&&s!==null&&s[je]&2048&&!(s[je]&512);){let a=HE(o,s,t,r|tt.Self,vi);if(a!==vi)return a;let c=o.parent;if(!c){let d=s[lE];if(d){let h=d.get(t,vi,r);if(h!==vi)return h}c=$E(s),s=s[oa]}o=c}return i}function $E(e){let n=e[Ke],t=n.type;return t===2?n.declTNode:t===1?e[ri]:null}function hp(e){return IS(kn(),e)}function hx(e,n=null,t=null,r){let i=qE(e,n,t,r);return i.resolveInjectorInitializers(),i}function qE(e,n=null,t=null,r,i=new Set){let o=[t||Nr,BD(e)];return r=r||(typeof e=="object"?void 0:Zn(e)),new ic(o,n||ip(),r||null,i)}var ei=class e{static{this.THROW_IF_NOT_FOUND=nc}static{this.NULL=new El}static create(n,t){if(Array.isArray(n))return hx({name:""},t,n,"");{let r=n.name??"";return hx({name:r},n.parent,n.providers,r)}}static{this.\u0275prov=Ae({token:e,providedIn:"any",factory:()=>ke(Gx)})}static{this.__NG_ELEMENT_ID__=-1}};var RS=new Ie("");RS.__NG_ELEMENT_ID__=e=>{let n=kn();if(n===null)throw new Ne(204,!1);if(n.type&2)return n.value;if(e&tt.Optional)return null;throw new Ne(204,!1)};var BS="ngOriginalError";function Xf(e){return e[BS]}var WE=!0,pp=(()=>{class e{static{this.__NG_ELEMENT_ID__=LS}static{this.__NG_ENV_ID__=t=>t}}return e})(),Eh=class extends pp{constructor(n){super(),this._lView=n}onDestroy(n){return _E(this._lView,n),()=>iS(this._lView,n)}};function LS(){return new Eh(nt())}var Wi=(()=>{class e{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new In(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static{this.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>new e})}}return e})();var vh=class extends wn{constructor(n=!1){super(),this.destroyRef=void 0,this.pendingTasks=void 0,this.__isAsync=n,uE()&&(this.destroyRef=ue(pp,{optional:!0})??void 0,this.pendingTasks=ue(Wi,{optional:!0})??void 0)}emit(n){let t=mt(null);try{super.next(n)}finally{mt(t)}}subscribe(n,t,r){let i=n,o=t||(()=>null),s=r;if(n&&typeof n=="object"){let c=n;i=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),i&&(i=this.wrapInTimeout(i)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:i,error:o,complete:s});return n instanceof rn&&n.add(a),a}wrapInTimeout(n){return t=>{let r=this.pendingTasks?.add();setTimeout(()=>{n(t),r!==void 0&&this.pendingTasks?.remove(r)})}}},Ut=vh;function Ml(...e){}function zE(e){let n,t;function r(){e=Ml;try{t!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(t),n!==void 0&&clearTimeout(n)}catch{}}return n=setTimeout(()=>{e(),r()}),typeof requestAnimationFrame=="function"&&(t=requestAnimationFrame(()=>{e(),r()})),()=>r()}function px(e){return queueMicrotask(()=>e()),()=>{e=Ml}}var mp="isAngularZone",Al=mp+"_ID",VS=0,qt=class e{constructor(n){this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Ut(!1),this.onMicrotaskEmpty=new Ut(!1),this.onStable=new Ut(!1),this.onError=new Ut(!1);let{enableLongStackTrace:t=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:i=!1,scheduleInRootZone:o=WE}=n;if(typeof Zone>"u")throw new Ne(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),t&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!i&&r,s.shouldCoalesceRunChangeDetection=i,s.callbackScheduled=!1,s.scheduleInRootZone=o,HS(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(mp)===!0}static assertInAngularZone(){if(!e.isInAngularZone())throw new Ne(909,!1)}static assertNotInAngularZone(){if(e.isInAngularZone())throw new Ne(909,!1)}run(n,t,r){return this._inner.run(n,t,r)}runTask(n,t,r,i){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+i,n,US,Ml,Ml);try{return o.runTask(s,t,r)}finally{o.cancelTask(s)}}runGuarded(n,t,r){return this._inner.runGuarded(n,t,r)}runOutsideAngular(n){return this._outer.run(n)}},US={};function gp(e){if(e._nesting==0&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function jS(e){if(e.isCheckStableRunning||e.callbackScheduled)return;e.callbackScheduled=!0;function n(){zE(()=>{e.callbackScheduled=!1,_h(e),e.isCheckStableRunning=!0,gp(e),e.isCheckStableRunning=!1})}e.scheduleInRootZone?Zone.root.run(()=>{n()}):e._outer.run(()=>{n()}),_h(e)}function HS(e){let n=()=>{jS(e)},t=VS++;e._inner=e._inner.fork({name:"angular",properties:{[mp]:!0,[Al]:t,[Al+t]:!0},onInvokeTask:(r,i,o,s,a,c)=>{if($S(c))return r.invokeTask(o,s,a,c);try{return mx(e),r.invokeTask(o,s,a,c)}finally{(e.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||e.shouldCoalesceRunChangeDetection)&&n(),gx(e)}},onInvoke:(r,i,o,s,a,c,d)=>{try{return mx(e),r.invoke(o,s,a,c,d)}finally{e.shouldCoalesceRunChangeDetection&&!e.callbackScheduled&&!qS(c)&&n(),gx(e)}},onHasTask:(r,i,o,s)=>{r.hasTask(o,s),i===o&&(s.change=="microTask"?(e._hasPendingMicrotasks=s.microTask,_h(e),gp(e)):s.change=="macroTask"&&(e.hasPendingMacrotasks=s.macroTask))},onHandleError:(r,i,o,s)=>(r.handleError(o,s),e.runOutsideAngular(()=>e.onError.emit(s)),!1)})}function _h(e){e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&e.callbackScheduled===!0?e.hasPendingMicrotasks=!0:e.hasPendingMicrotasks=!1}function mx(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function gx(e){e._nesting--,gp(e)}var Ch=class{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Ut,this.onMicrotaskEmpty=new Ut,this.onStable=new Ut,this.onError=new Ut}run(n,t,r){return n.apply(t,r)}runGuarded(n,t,r){return n.apply(t,r)}runOutsideAngular(n){return n()}runTask(n,t,r,i){return n.apply(t,r)}};function $S(e){return GE(e,"__ignore_ng_zone__")}function qS(e){return GE(e,"__scheduler_tick__")}function GE(e,n){return!Array.isArray(e)||e.length!==1?!1:e[0]?.data?.[n]===!0}var ji=class{constructor(){this._console=console}handleError(n){let t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&Xf(n);for(;t&&Xf(t);)t=Xf(t);return t||null}},WS=new Ie("",{providedIn:"root",factory:()=>{let e=ue(qt),n=ue(ji);return t=>e.runOutsideAngular(()=>n.handleError(t))}});function zS(){return aa(kn(),nt())}function aa(e,n){return new er(Lr(e,n))}var er=(()=>{class e{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=zS}}return e})();function GS(e){return e instanceof er?e.nativeElement:e}function QS(){return this._results[Symbol.iterator]()}var yh=class e{get changes(){return this._changes??=new Ut}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;let t=e.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=QS)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){this.dirty=!1;let r=ED(n);(this._changesDetected=!xD(this._results,r,t))&&(this._results=r,this.length=r.length,this.last=r[this.length-1],this.first=r[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}};function QE(e){return(e.flags&128)===128}var XE=new Map,XS=0;function YS(){return XS++}function KS(e){XE.set(e[Wl],e)}function wh(e){XE.delete(e[Wl])}var xx="__ngContext__";function _o(e,n){go(n)?(e[xx]=n[Wl],KS(n)):e[xx]=n}function YE(e){return ZE(e[oc])}function KE(e){return ZE(e[Zr])}function ZE(e){for(;e!==null&&!qi(e);)e=e[Zr];return e}var bh;function JE(e){bh=e}function ZS(){if(bh!==void 0)return bh;if(typeof document<"u")return document;throw new Ne(210,!1)}var xp=new Ie("",{providedIn:"root",factory:()=>JS}),JS="ng",Ep=new Ie(""),bi=new Ie("",{providedIn:"platform",factory:()=>"unknown"});var vp=new Ie("",{providedIn:"root",factory:()=>ZS().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var eM="h",tM="b";var nM=()=>null;function _p(e,n,t=!1){return nM(e,n,t)}var ev=!1,rM=new Ie("",{providedIn:"root",factory:()=>ev});var ol;function iM(){if(ol===void 0&&(ol=null,Zo.trustedTypes))try{ol=Zo.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return ol}function Ex(e){return iM()?.createScriptURL(e)||e}var Tl=class{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Rx})`}};function fc(e){return e instanceof Tl?e.changingThisBreaksApplicationSecurity:e}function Cp(e,n){let t=oM(e);if(t!=null&&t!==n){if(t==="ResourceURL"&&n==="URL")return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${Rx})`)}return t===n}function oM(e){return e instanceof Tl&&e.getTypeName()||null}var sM=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function tv(e){return e=String(e),e.match(sM)?e:"unsafe:"+e}var e0=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}(e0||{});function Qt(e){let n=rv();return n?n.sanitize(e0.URL,e)||"":Cp(e,"URL")?fc(e):tv(Gs(e))}function aM(e){let n=rv();if(n)return Ex(n.sanitize(e0.RESOURCE_URL,e)||"");if(Cp(e,"ResourceURL"))return Ex(fc(e));throw new Ne(904,!1)}function cM(e,n){return n==="src"&&(e==="embed"||e==="frame"||e==="iframe"||e==="media"||e==="script")||n==="href"&&(e==="base"||e==="link")?aM:Qt}function nv(e,n,t){return cM(n,t)(e)}function rv(){let e=nt();return e&&e[Ci].sanitizer}var uM=/^>|^->|<!--|-->|--!>|<!-$/g,lM=/(<|>)/g,dM="\u200B$1\u200B";function fM(e){return e.replace(uM,n=>n.replace(lM,dM))}function iv(e){return e instanceof Function?e():e}function hM(e){return(e??ue(ei)).get(bi)==="browser"}var Hi=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}(Hi||{}),pM;function yp(e,n){return pM(e,n)}function $s(e,n,t,r,i){if(r!=null){let o,s=!1;qi(r)?o=r:go(r)&&(s=!0,r=r[$i]);let a=wi(r);e===0&&t!==null?i==null?uv(n,t,a):Ol(n,t,a,i||null,!0):e===1&&t!==null?Ol(n,t,a,i||null,!0):e===2?OM(n,a,s):e===3&&n.destroyNode(a),o!=null&&kM(n,e,o,t,i)}}function mM(e,n){return e.createText(n)}function gM(e,n,t){e.setValue(n,t)}function xM(e,n){return e.createComment(fM(n))}function ov(e,n,t){return e.createElement(n,t)}function EM(e,n){sv(e,n),n[$i]=null,n[ri]=null}function vM(e,n,t,r,i,o){r[$i]=i,r[ri]=n,n0(e,r,t,1,i,o)}function sv(e,n){n[Ci].changeDetectionScheduler?.notify(9),n0(e,n,n[Gt],2,null,null)}function _M(e){let n=e[oc];if(!n)return Yf(e[Ke],e);for(;n;){let t=null;if(go(n))t=n[oc];else{let r=n[Dr];r&&(t=r)}if(!t){for(;n&&!n[Zr]&&n!==e;)go(n)&&Yf(n[Ke],n),n=n[Ln];n===null&&(n=e),go(n)&&Yf(n[Ke],n),t=n&&n[Zr]}n=t}}function CM(e,n,t,r){let i=Dr+r,o=t.length;r>0&&(t[i-1][Zr]=n),r<o-Dr?(n[Zr]=t[i],zx(t,Dr+r,n)):(t.push(n),n[Zr]=null),n[Ln]=t;let s=n[ts];s!==null&&t!==s&&av(s,n);let a=n[Ui];a!==null&&a.insertView(e),fh(n),n[je]|=128}function av(e,n){let t=e[Zs],r=n[Ln];if(go(r))e[je]|=yl.HasTransplantedViews;else{let i=r[Ln][yi];n[yi]!==i&&(e[je]|=yl.HasTransplantedViews)}t===null?e[Zs]=[n]:t.push(n)}function wp(e,n){let t=e[Zs],r=t.indexOf(n);t.splice(r,1)}function Dh(e,n){if(e.length<=Dr)return;let t=Dr+n,r=e[t];if(r){let i=r[ts];i!==null&&i!==e&&wp(i,r),n>0&&(e[t-1][Zr]=r[Zr]);let o=xl(e,Dr+n);EM(r[Ke],r);let s=o[Ui];s!==null&&s.detachView(o[Ke]),r[Ln]=null,r[Zr]=null,r[je]&=-129}return r}function cv(e,n){if(!(n[je]&256)){let t=n[Gt];t.destroyNode&&n0(e,n,t,3,null,null),_M(n)}}function Yf(e,n){if(n[je]&256)return;let t=mt(null);try{n[je]&=-129,n[je]|=256,n[Rr]&&Sf(n[Rr]),wM(e,n),yM(e,n),n[Ke].type===1&&n[Gt].destroy();let r=n[ts];if(r!==null&&qi(n[Ln])){r!==n[Ln]&&wp(r,n);let i=n[Ui];i!==null&&i.detachView(e)}wh(n)}finally{mt(t)}}function yM(e,n){let t=e.cleanup,r=n[_l];if(t!==null)for(let o=0;o<t.length-1;o+=2)if(typeof t[o]=="string"){let s=t[o+3];s>=0?r[s]():r[-s].unsubscribe(),o+=2}else{let s=r[t[o+1]];t[o].call(s)}r!==null&&(n[_l]=null);let i=n[mo];if(i!==null){n[mo]=null;for(let o=0;o<i.length;o++){let s=i[o];s()}}}function wM(e,n){let t;if(e!=null&&(t=e.destroyHooks)!=null)for(let r=0;r<t.length;r+=2){let i=n[t[r]];if(!(i instanceof os)){let o=t[r+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=i[o[s]],c=o[s+1];Ei(4,a,c);try{c.call(a)}finally{Ei(5,a,c)}}else{Ei(4,i,o);try{o.call(i)}finally{Ei(5,i,o)}}}}}function bM(e,n,t){return DM(e,n.parent,t)}function DM(e,n,t){let r=n;for(;r!==null&&r.type&168;)n=r,r=n.parent;if(r===null)return t[$i];{let{componentOffset:i}=r;if(i>-1){let{encapsulation:o}=e.data[r.directiveStart+i];if(o===_i.None||o===_i.Emulated)return null}return Lr(r,t)}}function Ol(e,n,t,r,i){e.insertBefore(n,t,r,i)}function uv(e,n,t){e.appendChild(n,t)}function vx(e,n,t,r,i){r!==null?Ol(e,n,t,r,i):uv(e,n,t)}function lv(e,n){return e.parentNode(n)}function SM(e,n){return e.nextSibling(n)}function MM(e,n,t){return TM(e,n,t)}function AM(e,n,t){return e.type&40?Lr(e,t):null}var TM=AM,_x;function t0(e,n,t,r){let i=bM(e,r,n),o=n[Gt],s=r.parent||n[ri],a=MM(s,r,n);if(i!=null)if(Array.isArray(t))for(let c=0;c<t.length;c++)vx(o,i,t[c],a,!1);else vx(o,i,t,a,!1);_x!==void 0&&_x(o,r,n,t,i)}function ec(e,n){if(n!==null){let t=n.type;if(t&3)return Lr(n,e);if(t&4)return Sh(-1,e[n.index]);if(t&8){let r=n.child;if(r!==null)return ec(e,r);{let i=e[n.index];return qi(i)?Sh(-1,i):wi(i)}}else{if(t&128)return ec(e,n.next);if(t&32)return yp(n,e)()||wi(e[n.index]);{let r=dv(e,n);if(r!==null){if(Array.isArray(r))return r[0];let i=rs(e[yi]);return ec(i,r)}else return ec(e,n.next)}}}return null}function dv(e,n){if(n!==null){let r=e[yi][ri],i=n.projection;return r.projection[i]}return null}function Sh(e,n){let t=Dr+e+1;if(t<n.length){let r=n[t],i=r[Ke].firstChild;if(i!==null)return ec(r,i)}return n[ns]}function OM(e,n,t){e.removeChild(null,n,t)}function bp(e,n,t,r,i,o,s){for(;t!=null;){if(t.type===128){t=t.next;continue}let a=r[t.index],c=t.type;if(s&&n===0&&(a&&_o(wi(a),r),t.flags|=2),(t.flags&32)!==32)if(c&8)bp(e,n,t.child,r,i,o,!1),$s(n,e,i,a,o);else if(c&32){let d=yp(t,r),h;for(;h=d();)$s(n,e,i,h,o);$s(n,e,i,a,o)}else c&16?IM(e,n,r,t,i,o):$s(n,e,i,a,o);t=s?t.projectionNext:t.next}}function n0(e,n,t,r,i,o){bp(t,r,e.firstChild,n,i,o,!1)}function IM(e,n,t,r,i,o){let s=t[yi],c=s[ri].projection[r.projection];if(Array.isArray(c))for(let d=0;d<c.length;d++){let h=c[d];$s(n,e,i,h,o)}else{let d=c,h=s[Ln];QE(r)&&(d.flags|=128),bp(e,n,d,h,i,o,!0)}}function kM(e,n,t,r,i){let o=t[ns],s=wi(t);o!==s&&$s(n,e,r,o,i);for(let a=Dr;a<t.length;a++){let c=t[a];n0(c[Ke],c,e,n,r,o)}}function PM(e,n,t,r,i){if(n)i?e.addClass(t,r):e.removeClass(t,r);else{let o=r.indexOf("-")===-1?void 0:Hi.DashCase;i==null?e.removeStyle(t,r,o):(typeof i=="string"&&i.endsWith("!important")&&(i=i.slice(0,-10),o|=Hi.Important),e.setStyle(t,r,i,o))}}function FM(e,n,t){e.setAttribute(n,"style",t)}function fv(e,n,t){t===""?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function hv(e,n,t){let{mergedAttrs:r,classes:i,styles:o}=t;r!==null&&sh(e,n,r),i!==null&&fv(e,n,i),o!==null&&FM(e,n,o)}var Vr={};function m(e=1){pv(an(),nt(),ds()+e,!1)}function pv(e,n,t,r){if(!r)if((n[je]&3)===3){let o=e.preOrderCheckHooks;o!==null&&ll(n,o,t)}else{let o=e.preOrderHooks;o!==null&&dl(n,o,0,t)}is(t)}function Q(e,n=tt.Default){let t=nt();if(t===null)return ke(e,n);let r=kn();return jE(r,t,Kn(e),n)}function mv(){let e="invalid";throw new Error(e)}function gv(e,n,t,r,i,o){let s=mt(null);try{let a=null;i&xo.SignalBased&&(a=n[r][Ri]),a!==null&&a.transformFn!==void 0&&(o=a.transformFn(o)),i&xo.HasDecoratorInputTransform&&(o=e.inputTransforms[r].call(n,o)),e.setInput!==null?e.setInput(n,a,o,t,r):fE(n,a,r,o)}finally{mt(s)}}function NM(e,n){let t=e.hostBindingOpCodes;if(t!==null)try{for(let r=0;r<t.length;r++){let i=t[r];if(i<0)is(~i);else{let o=i,s=t[++r],a=t[++r];gS(s,o);let c=n[o];a(2,c)}}}finally{is(-1)}}function r0(e,n,t,r,i,o,s,a,c,d,h){let p=n.blueprint.slice();return p[$i]=i,p[je]=r|4|128|8|64,(d!==null||e&&e[je]&2048)&&(p[je]|=2048),EE(p),p[Ln]=p[oa]=e,p[Jr]=t,p[Ci]=s||e&&e[Ci],p[Gt]=a||e&&e[Gt],p[Ks]=c||e&&e[Ks]||null,p[ri]=o,p[Wl]=YS(),p[vl]=h,p[lE]=d,p[yi]=n.type==2?e[yi]:p,p}function hc(e,n,t,r,i){let o=e.data[n];if(o===null)o=RM(e,n,t,r,i),mS()&&(o.flags|=32);else if(o.type&64){o.type=t,o.value=r,o.attrs=i;let s=dS();o.injectorIndex=s===null?-1:s.injectorIndex}return ls(o,!0),o}function RM(e,n,t,r,i){let o=wE(),s=cp(),a=s?o:o&&o.parent,c=e.data[n]=HM(e,a,t,n,r,i);return e.firstChild===null&&(e.firstChild=c),o!==null&&(s?o.child==null&&c.parent!==null&&(o.child=c):o.next===null&&(o.next=c,c.prev=o)),c}function xv(e,n,t,r){if(t===0)return-1;let i=n.length;for(let o=0;o<t;o++)n.push(r),e.blueprint.push(r),e.data.push(null);return i}function Ev(e,n,t,r,i){let o=ds(),s=r&2;try{is(-1),s&&n.length>Sr&&pv(e,n,Sr,!1),Ei(s?2:0,i),t(r,i)}finally{is(o),Ei(s?3:1,i)}}function Dp(e,n,t){if(op(n)){let r=mt(null);try{let i=n.directiveStart,o=n.directiveEnd;for(let s=i;s<o;s++){let a=e.data[s];if(a.contentQueries){let c=t[s];a.contentQueries(1,c,s)}}}finally{mt(r)}}}function Sp(e,n,t){yE()&&(QM(e,n,t,Lr(t,n)),(t.flags&64)===64&&Cv(e,n,t))}function Mp(e,n,t=Lr){let r=n.localNames;if(r!==null){let i=n.index+1;for(let o=0;o<r.length;o+=2){let s=r[o+1],a=s===-1?t(n,e):e[s];e[i++]=a}}}function vv(e){let n=e.tView;return n===null||n.incompleteFirstPass?e.tView=Ap(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts,e.id):n}function Ap(e,n,t,r,i,o,s,a,c,d,h){let p=Sr+r,g=p+i,x=BM(p,g),v=typeof d=="function"?d():d;return x[Ke]={type:e,blueprint:x,template:t,queries:null,viewQuery:a,declTNode:n,data:x.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:g,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:v,incompleteFirstPass:!1,ssrId:h}}function BM(e,n){let t=[];for(let r=0;r<n;r++)t.push(r<e?null:Vr);return t}function LM(e,n,t,r){let o=r.get(rM,ev)||t===_i.ShadowDom,s=e.selectRootElement(n,o);return VM(s),s}function VM(e){UM(e)}var UM=()=>null;function jM(e,n,t,r){let i=bv(n);i.push(t),e.firstCreatePass&&Dv(e).push(r,i.length-1)}function HM(e,n,t,r,i,o){let s=n?n.injectorIndex:-1,a=0;return cS()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}function Cx(e,n,t,r,i){for(let o in n){if(!n.hasOwnProperty(o))continue;let s=n[o];if(s===void 0)continue;r??={};let a,c=xo.None;Array.isArray(s)?(a=s[0],c=s[1]):a=s;let d=o;if(i!==null){if(!i.hasOwnProperty(o))continue;d=i[o]}e===0?yx(r,t,d,a,c):yx(r,t,d,a)}return r}function yx(e,n,t,r,i){let o;e.hasOwnProperty(t)?(o=e[t]).push(n,r):o=e[t]=[n,r],i!==void 0&&o.push(i)}function $M(e,n,t){let r=n.directiveStart,i=n.directiveEnd,o=e.data,s=n.attrs,a=[],c=null,d=null;for(let h=r;h<i;h++){let p=o[h],g=t?t.get(p):null,x=g?g.inputs:null,v=g?g.outputs:null;c=Cx(0,p.inputs,h,c,x),d=Cx(1,p.outputs,h,d,v);let E=c!==null&&s!==null&&!np(n)?oA(c,h,s):null;a.push(E)}c!==null&&(c.hasOwnProperty("class")&&(n.flags|=8),c.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=c,n.outputs=d}function qM(e){return e==="class"?"className":e==="for"?"htmlFor":e==="formaction"?"formAction":e==="innerHtml"?"innerHTML":e==="readonly"?"readOnly":e==="tabindex"?"tabIndex":e}function i0(e,n,t,r,i,o,s,a){let c=Lr(n,t),d=n.inputs,h;!a&&d!=null&&(h=d[r])?(Op(e,t,h,r,i),zl(n)&&WM(t,n.index)):n.type&3?(r=qM(r),i=s!=null?s(i,n.value||"",r):i,o.setProperty(c,r,i)):n.type&12}function WM(e,n){let t=wo(n,e);t[je]&16||(t[je]|=64)}function Tp(e,n,t,r){if(yE()){let i=r===null?null:{"":-1},o=YM(e,t),s,a;o===null?s=a=null:[s,a]=o,s!==null&&_v(e,n,t,s,i,a),i&&KM(t,r,i)}t.mergedAttrs=rc(t.mergedAttrs,t.attrs)}function _v(e,n,t,r,i,o){for(let d=0;d<r.length;d++)gh(Sl(t,n),e,r[d].type);JM(t,e.data.length,r.length);for(let d=0;d<r.length;d++){let h=r[d];h.providersResolver&&h.providersResolver(h)}let s=!1,a=!1,c=xv(e,n,r.length,null);for(let d=0;d<r.length;d++){let h=r[d];t.mergedAttrs=rc(t.mergedAttrs,h.hostAttrs),eA(e,t,n,c,h),ZM(c,h,i),h.contentQueries!==null&&(t.flags|=4),(h.hostBindings!==null||h.hostAttrs!==null||h.hostVars!==0)&&(t.flags|=64);let p=h.type.prototype;!s&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((e.preOrderHooks??=[]).push(t.index),s=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((e.preOrderCheckHooks??=[]).push(t.index),a=!0),c++}$M(e,t,o)}function zM(e,n,t,r,i){let o=i.hostBindings;if(o){let s=e.hostBindingOpCodes;s===null&&(s=e.hostBindingOpCodes=[]);let a=~n.index;GM(s)!=a&&s.push(a),s.push(t,r,o)}}function GM(e){let n=e.length;for(;n>0;){let t=e[--n];if(typeof t=="number"&&t<0)return t}return 0}function QM(e,n,t,r){let i=t.directiveStart,o=t.directiveEnd;zl(t)&&tA(n,t,e.data[i+t.componentOffset]),e.firstCreatePass||Sl(t,n),_o(r,n);let s=t.initialInputs;for(let a=i;a<o;a++){let c=e.data[a],d=ss(n,e,a,t);if(_o(d,n),s!==null&&iA(n,a-i,d,c,t,s),vo(c)){let h=wo(t.index,n);h[Jr]=ss(n,e,a,t)}}}function Cv(e,n,t){let r=t.directiveStart,i=t.directiveEnd,o=t.index,s=xS();try{is(o);for(let a=r;a<i;a++){let c=e.data[a],d=n[a];hh(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&XM(c,d)}}finally{is(-1),hh(s)}}function XM(e,n){e.hostBindings!==null&&e.hostBindings(1,n)}function YM(e,n){let t=e.directiveRegistry,r=null,i=null;if(t)for(let o=0;o<t.length;o++){let s=t[o];if(AD(n,s.selectors,!1))if(r||(r=[]),vo(s))if(s.findHostDirectiveDefs!==null){let a=[];i=i||new Map,s.findHostDirectiveDefs(s,a,i),r.unshift(...a,s);let c=a.length;Mh(e,n,c)}else r.unshift(s),Mh(e,n,0);else i=i||new Map,s.findHostDirectiveDefs?.(s,r,i),r.push(s)}return r===null?null:[r,i]}function Mh(e,n,t){n.componentOffset=t,(e.components??=[]).push(n.index)}function KM(e,n,t){if(n){let r=e.localNames=[];for(let i=0;i<n.length;i+=2){let o=t[n[i+1]];if(o==null)throw new Ne(-301,!1);r.push(n[i],o)}}}function ZM(e,n,t){if(t){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)t[n.exportAs[r]]=e;vo(n)&&(t[""]=e)}}function JM(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}function eA(e,n,t,r,i){e.data[r]=i;let o=i.factory||(i.factory=es(i.type,!0)),s=new os(o,vo(i),Q);e.blueprint[r]=s,t[r]=s,zM(e,n,r,xv(e,t,i.hostVars,Vr),i)}function tA(e,n,t){let r=Lr(n,e),i=vv(t),o=e[Ci].rendererFactory,s=16;t.signals?s=4096:t.onPush&&(s=64);let a=o0(e,r0(e,i,null,s,r,n,null,o.createRenderer(r,t),null,null,null));e[n.index]=a}function nA(e,n,t,r,i,o){let s=Lr(e,n);rA(n[Gt],s,o,e.value,t,r,i)}function rA(e,n,t,r,i,o,s){if(o==null)e.removeAttribute(n,i,t);else{let a=s==null?Gs(o):s(o,r||"",i);e.setAttribute(n,i,a,t)}}function iA(e,n,t,r,i,o){let s=o[n];if(s!==null)for(let a=0;a<s.length;){let c=s[a++],d=s[a++],h=s[a++],p=s[a++];gv(r,t,c,d,h,p)}}function oA(e,n,t){let r=null,i=0;for(;i<t.length;){let o=t[i];if(o===0){i+=4;continue}else if(o===5){i+=2;continue}if(typeof o=="number")break;if(e.hasOwnProperty(o)){r===null&&(r=[]);let s=e[o];for(let a=0;a<s.length;a+=3)if(s[a]===n){r.push(o,s[a+1],s[a+2],t[i+1]);break}}i+=2}return r}function yv(e,n,t,r){return[e,!0,0,n,null,r,null,t,null,null]}function wv(e,n){let t=e.contentQueries;if(t!==null){let r=mt(null);try{for(let i=0;i<t.length;i+=2){let o=t[i],s=t[i+1];if(s!==-1){let a=e.data[s];up(o),a.contentQueries(2,n[s],s)}}}finally{mt(r)}}}function o0(e,n){return e[oc]?e[ax][Zr]=n:e[oc]=n,e[ax]=n,n}function Ah(e,n,t){up(0);let r=mt(null);try{n(e,t)}finally{mt(r)}}function bv(e){return e[_l]??=[]}function Dv(e){return e.cleanup??=[]}function Sv(e,n){let t=e[Ks],r=t?t.get(ji,null):null;r&&r.handleError(n)}function Op(e,n,t,r,i){for(let o=0;o<t.length;){let s=t[o++],a=t[o++],c=t[o++],d=n[s],h=e.data[s];gv(h,d,r,a,c,i)}}function Mv(e,n,t){let r=gE(n,e);gM(e[Gt],r,t)}function sA(e,n){let t=wo(n,e),r=t[Ke];aA(r,t);let i=t[$i];i!==null&&t[vl]===null&&(t[vl]=_p(i,t[Ks])),Ip(r,t,t[Jr])}function aA(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])}function Ip(e,n,t){lp(n);try{let r=e.viewQuery;r!==null&&Ah(1,r,t);let i=e.template;i!==null&&Ev(e,n,i,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),n[Ui]?.finishViewCreation(e),e.staticContentQueries&&wv(e,n),e.staticViewQueries&&Ah(2,e.viewQuery,t);let o=e.components;o!==null&&cA(n,o)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{n[je]&=-5,dp()}}function cA(e,n){for(let t=0;t<n.length;t++)sA(e,n[t])}function uA(e,n,t,r){let i=mt(null);try{let o=n.tView,a=e[je]&4096?4096:16,c=r0(e,o,t,a,null,n,null,null,r?.injector??null,r?.embeddedViewInjector??null,r?.dehydratedView??null),d=e[n.index];c[ts]=d;let h=e[Ui];return h!==null&&(c[Ui]=h.createEmbeddedView(o)),Ip(o,c,t),c}finally{mt(i)}}function wx(e,n){return!n||n.firstChild===null||QE(e)}function lA(e,n,t,r=!0){let i=n[Ke];if(CM(i,n,e,t),r){let s=Sh(t,e),a=n[Gt],c=lv(a,e[ns]);c!==null&&vM(i,e[ri],a,n,c,s)}let o=n[vl];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Il(e,n,t,r,i=!1){for(;t!==null;){if(t.type===128){t=i?t.projectionNext:t.next;continue}let o=n[t.index];o!==null&&r.push(wi(o)),qi(o)&&dA(o,r);let s=t.type;if(s&8)Il(e,n,t.child,r);else if(s&32){let a=yp(t,n),c;for(;c=a();)r.push(c)}else if(s&16){let a=dv(n,t);if(Array.isArray(a))r.push(...a);else{let c=rs(n[yi]);Il(c[Ke],c,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function dA(e,n){for(let t=Dr;t<e.length;t++){let r=e[t],i=r[Ke].firstChild;i!==null&&Il(r[Ke],r,i,n)}e[ns]!==e[$i]&&n.push(e[ns])}var Av=[];function fA(e){return e[Rr]??hA(e)}function hA(e){let n=Av.pop()??Object.create(mA);return n.lView=e,n}function pA(e){e.lView[Rr]!==e&&(e.lView=null,Av.push(e))}var mA=qe(de({},Xa),{consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{Xl(e.lView)},consumerOnSignalRead(){this.lView[Rr]=this}});function gA(e){let n=e[Rr]??Object.create(xA);return n.lView=e,n}var xA=qe(de({},Xa),{consumerIsAlwaysLive:!0,consumerMarkedDirty:e=>{let n=rs(e.lView);for(;n&&!Tv(n[Ke]);)n=rs(n);n&&vE(n)},consumerOnSignalRead(){this.lView[Rr]=this}});function Tv(e){return e.type!==2}var EA=100;function Ov(e,n=!0,t=0){let r=e[Ci],i=r.rendererFactory,o=!1;o||i.begin?.();try{vA(e,t)}catch(s){throw n&&Sv(e,s),s}finally{o||(i.end?.(),r.inlineEffectRunner?.flush())}}function vA(e,n){let t=DE();try{ux(!0),Th(e,n);let r=0;for(;Ql(e);){if(r===EA)throw new Ne(103,!1);r++,Th(e,1)}}finally{ux(t)}}function _A(e,n,t,r){let i=n[je];if((i&256)===256)return;let o=!1,s=!1;!o&&n[Ci].inlineEffectRunner?.flush(),lp(n);let a=!0,c=null,d=null;o||(Tv(e)?(d=fA(n),c=ku(d)):h1()===null?(a=!1,d=gA(n),c=ku(d)):n[Rr]&&(Sf(n[Rr]),n[Rr]=null));try{EE(n),pS(e.bindingStartIndex),t!==null&&Ev(e,n,t,2,r);let h=(i&3)===3;if(!o)if(h){let x=e.preOrderCheckHooks;x!==null&&ll(n,x,null)}else{let x=e.preOrderHooks;x!==null&&dl(n,x,0,null),zf(n,0)}if(s||CA(n),Iv(n,0),e.contentQueries!==null&&wv(e,n),!o)if(h){let x=e.contentCheckHooks;x!==null&&ll(n,x)}else{let x=e.contentHooks;x!==null&&dl(n,x,1),zf(n,1)}NM(e,n);let p=e.components;p!==null&&Pv(n,p,0);let g=e.viewQuery;if(g!==null&&Ah(2,g,r),!o)if(h){let x=e.viewCheckHooks;x!==null&&ll(n,x)}else{let x=e.viewHooks;x!==null&&dl(n,x,2),zf(n,2)}if(e.firstUpdatePass===!0&&(e.firstUpdatePass=!1),n[Wf]){for(let x of n[Wf])x();n[Wf]=null}o||(n[je]&=-73)}catch(h){throw o||Xl(n),h}finally{d!==null&&(bf(d,c),a&&pA(d)),dp()}}function Iv(e,n){for(let t=YE(e);t!==null;t=KE(t))for(let r=Dr;r<t.length;r++){let i=t[r];kv(i,n)}}function CA(e){for(let n=YE(e);n!==null;n=KE(n)){if(!(n[je]&yl.HasTransplantedViews))continue;let t=n[Zs];for(let r=0;r<t.length;r++){let i=t[r];vE(i)}}}function yA(e,n,t){let r=wo(n,e);kv(r,t)}function kv(e,n){ap(e)&&Th(e,n)}function Th(e,n){let r=e[Ke],i=e[je],o=e[Rr],s=!!(n===0&&i&16);if(s||=!!(i&64&&n===0),s||=!!(i&1024),s||=!!(o?.dirty&&Df(o)),s||=!1,o&&(o.dirty=!1),e[je]&=-9217,s)_A(r,e,r.template,e[Jr]);else if(i&8192){Iv(e,1);let a=r.components;a!==null&&Pv(e,a,1)}}function Pv(e,n,t){for(let r=0;r<n.length;r++)yA(e,n[r],t)}function kp(e,n){let t=DE()?64:1088;for(e[Ci].changeDetectionScheduler?.notify(n);e;){e[je]|=t;let r=rs(e);if(lh(e)&&!r)return e;e=r}return null}var as=class{get rootNodes(){let n=this._lView,t=n[Ke];return Il(t,n,t.firstChild,[])}constructor(n,t,r=!0){this._lView=n,this._cdRefInjectingView=t,this.notifyErrorHandler=r,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Jr]}set context(n){this._lView[Jr]=n}get destroyed(){return(this._lView[je]&256)===256}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let n=this._lView[Ln];if(qi(n)){let t=n[Cl],r=t?t.indexOf(this):-1;r>-1&&(Dh(n,r),xl(t,r))}this._attachedToViewContainer=!1}cv(this._lView[Ke],this._lView)}onDestroy(n){_E(this._lView,n)}markForCheck(){kp(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[je]&=-129}reattach(){fh(this._lView),this._lView[je]|=128}detectChanges(){this._lView[je]|=1024,Ov(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Ne(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let n=lh(this._lView),t=this._lView[ts];t!==null&&!n&&wp(t,this._lView),sv(this._lView[Ke],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Ne(902,!1);this._appRef=n;let t=lh(this._lView),r=this._lView[ts];r!==null&&!t&&av(r,this._lView),fh(this._lView)}},cs=(()=>{class e{static{this.__NG_ELEMENT_ID__=DA}}return e})(),wA=cs,bA=class extends wA{constructor(n,t,r){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,t){return this.createEmbeddedViewImpl(n,t)}createEmbeddedViewImpl(n,t,r){let i=uA(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:t,dehydratedView:r});return new as(i)}};function DA(){return s0(kn(),nt())}function s0(e,n){return e.type&4?new bA(n,e,aa(e,n)):null}var ZW=new RegExp(`^(\\d+)*(${tM}|${eM})*(.*)`);var SA=()=>null;function bx(e,n){return SA(e,n)}var ea=class{},Pp=new Ie("",{providedIn:"root",factory:()=>!1});var Fv=new Ie(""),Nv=new Ie(""),Oh=class{},kl=class{};function MA(e){let n=Error(`No component factory found for ${Zn(e)}.`);return n[AA]=e,n}var AA="ngComponent";var Ih=class{resolveComponentFactory(n){throw MA(n)}},ta=class{static{this.NULL=new Ih}},na=class{},si=(()=>{class e{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>TA()}}return e})();function TA(){let e=nt(),n=kn(),t=wo(n.index,e);return(go(t)?t:e)[Gt]}var OA=(()=>{class e{static{this.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>null})}}return e})();function Pl(e,n,t){let r=t?e.styles:null,i=t?e.classes:null,o=0;if(n!==null)for(let s=0;s<n.length;s++){let a=n[s];if(typeof a=="number")o=a;else if(o==1)i=K1(i,a);else if(o==2){let c=a,d=n[++s];r=K1(r,c+": "+d+";")}}t?e.styles=r:e.stylesWithoutHost=r,t?e.classes=i:e.classesWithoutHost=i}var Fl=class extends ta{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){let t=Eo(n);return new ra(t,this.ngModule)}};function Dx(e,n){let t=[];for(let r in e){if(!e.hasOwnProperty(r))continue;let i=e[r];if(i===void 0)continue;let o=Array.isArray(i),s=o?i[0]:i,a=o?i[1]:xo.None;n?t.push({propName:s,templateName:r,isSignal:(a&xo.SignalBased)!==0}):t.push({propName:s,templateName:r})}return t}function IA(e){let n=e.toLowerCase();return n==="svg"?JD:n==="math"?eS:null}var ra=class extends kl{get inputs(){let n=this.componentDef,t=n.inputTransforms,r=Dx(n.inputs,!0);if(t!==null)for(let i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return Dx(this.componentDef.outputs,!1)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=kD(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,r,i){let o=mt(null);try{i=i||this.ngModule;let s=i instanceof Jn?i:i?.injector;s&&this.componentDef.getStandaloneInjector!==null&&(s=this.componentDef.getStandaloneInjector(s)||s);let a=s?new ph(n,s):n,c=a.get(na,null);if(c===null)throw new Ne(407,!1);let d=a.get(OA,null),h=a.get(ea,null),p={rendererFactory:c,sanitizer:d,inlineEffectRunner:null,changeDetectionScheduler:h},g=c.createRenderer(null,this.componentDef),x=this.componentDef.selectors[0][0]||"div",v=r?LM(g,r,this.componentDef.encapsulation,a):ov(g,x,IA(x)),E=512;this.componentDef.signals?E|=4096:this.componentDef.onPush||(E|=16);let _=null;v!==null&&(_=_p(v,a,!0));let M=Ap(0,null,null,1,0,null,null,null,null,null,null),I=r0(null,M,null,E,null,null,p,g,a,null,_);lp(I);let y,q,ee=null;try{let R=this.componentDef,k,z=null;R.findHostDirectiveDefs?(k=[],z=new Map,R.findHostDirectiveDefs(R,k,z),k.push(R)):k=[R];let V=kA(I,v);ee=PA(V,v,R,k,I,p,g),q=xE(M,Sr),v&&RA(g,R,v,r),t!==void 0&&BA(q,this.ngContentSelectors,t),y=NA(ee,R,k,z,I,[LA]),Ip(M,I,null)}catch(R){throw ee!==null&&wh(ee),wh(I),R}finally{dp()}return new kh(this.componentType,y,aa(q,I),I,q)}finally{mt(o)}}},kh=class extends Oh{constructor(n,t,r,i,o){super(),this.location=r,this._rootLView=i,this._tNode=o,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new as(i,void 0,!1),this.componentType=n}setInput(n,t){let r=this._tNode.inputs,i;if(r!==null&&(i=r[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),t))return;let o=this._rootLView;Op(o[Ke],o,i,n,t),this.previousInputValues.set(n,t);let s=wo(this._tNode.index,o);kp(s,1)}}get injector(){return new Jo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}};function kA(e,n){let t=e[Ke],r=Sr;return e[r]=n,hc(t,r,2,"#host",null)}function PA(e,n,t,r,i,o,s){let a=i[Ke];FA(r,e,n,s);let c=null;n!==null&&(c=_p(n,i[Ks]));let d=o.rendererFactory.createRenderer(n,t),h=16;t.signals?h=4096:t.onPush&&(h=64);let p=r0(i,vv(t),null,h,i[e.index],e,o,d,null,null,c);return a.firstCreatePass&&Mh(a,e,r.length-1),o0(i,p),i[e.index]=p}function FA(e,n,t,r){for(let i of e)n.mergedAttrs=rc(n.mergedAttrs,i.hostAttrs);n.mergedAttrs!==null&&(Pl(n,n.mergedAttrs,!0),t!==null&&hv(r,t,n))}function NA(e,n,t,r,i,o){let s=kn(),a=i[Ke],c=Lr(s,i);_v(a,i,s,t,null,r);for(let h=0;h<t.length;h++){let p=s.directiveStart+h,g=ss(i,a,p,s);_o(g,i)}Cv(a,i,s),c&&_o(c,i);let d=ss(i,a,s.directiveStart+s.componentOffset,s);if(e[Jr]=i[Jr]=d,o!==null)for(let h of o)h(d,n);return Dp(a,s,i),d}function RA(e,n,t,r){if(r)sh(e,t,["ng-version","18.2.13"]);else{let{attrs:i,classes:o}=PD(n.selectors[0]);i&&sh(e,t,i),o&&o.length>0&&fv(e,t,o.join(" "))}}function BA(e,n,t){let r=e.projection=[];for(let i=0;i<n.length;i++){let o=t[i];r.push(o!=null?Array.from(o):null)}}function LA(){let e=kn();Jl(nt()[Ke],e)}var bo=(()=>{class e{static{this.__NG_ELEMENT_ID__=VA}}return e})();function VA(){let e=kn();return Bv(e,nt())}var UA=bo,Rv=class extends UA{constructor(n,t,r){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=r}get element(){return aa(this._hostTNode,this._hostLView)}get injector(){return new Jo(this._hostTNode,this._hostLView)}get parentInjector(){let n=fp(this._hostTNode,this._hostLView);if(NE(n)){let t=bl(n,this._hostLView),r=wl(n),i=t[Ke].data[r+8];return new Jo(i,t)}else return new Jo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){let t=Sx(this._lContainer);return t!==null&&t[n]||null}get length(){return this._lContainer.length-Dr}createEmbeddedView(n,t,r){let i,o;typeof r=="number"?i=r:r!=null&&(i=r.index,o=r.injector);let s=bx(this._lContainer,n.ssrId),a=n.createEmbeddedViewImpl(t||{},o,s);return this.insertImpl(a,i,wx(this._hostTNode,s)),a}createComponent(n,t,r,i,o){let s=n&&!XD(n),a;if(s)a=t;else{let v=t||{};a=v.index,r=v.injector,i=v.projectableNodes,o=v.environmentInjector||v.ngModuleRef}let c=s?n:new ra(Eo(n)),d=r||this.parentInjector;if(!o&&c.ngModule==null){let E=(s?d:this.parentInjector).get(Jn,null);E&&(o=E)}let h=Eo(c.componentType??{}),p=bx(this._lContainer,h?.id??null),g=p?.firstChild??null,x=c.create(d,i,g,o);return this.insertImpl(x.hostView,a,wx(this._hostTNode,p)),x}insert(n,t){return this.insertImpl(n,t,!0)}insertImpl(n,t,r){let i=n._lView;if(nS(i)){let a=this.indexOf(n);if(a!==-1)this.detach(a);else{let c=i[Ln],d=new Rv(c,c[ri],c[Ln]);d.detach(d.indexOf(n))}}let o=this._adjustIndex(t),s=this._lContainer;return lA(s,i,o,r),n.attachToViewContainerRef(),zx(Kf(s),o,n),n}move(n,t){return this.insert(n,t)}indexOf(n){let t=Sx(this._lContainer);return t!==null?t.indexOf(n):-1}remove(n){let t=this._adjustIndex(n,-1),r=Dh(this._lContainer,t);r&&(xl(Kf(this._lContainer),t),cv(r[Ke],r))}detach(n){let t=this._adjustIndex(n,-1),r=Dh(this._lContainer,t);return r&&xl(Kf(this._lContainer),t)!=null?new as(r):null}_adjustIndex(n,t=0){return n??this.length+t}};function Sx(e){return e[Cl]}function Kf(e){return e[Cl]||(e[Cl]=[])}function Bv(e,n){let t,r=n[e.index];return qi(r)?t=r:(t=yv(r,n,null,e),n[e.index]=t,o0(n,t)),HA(t,n,e,r),new Rv(t,e,n)}function jA(e,n){let t=e[Gt],r=t.createComment(""),i=Lr(n,e),o=lv(t,i);return Ol(t,o,r,SM(t,i),!1),r}var HA=WA,$A=()=>!1;function qA(e,n,t){return $A(e,n,t)}function WA(e,n,t,r){if(e[ns])return;let i;t.type&8?i=wi(r):i=jA(n,t),e[ns]=i}var Ph=class e{constructor(n){this.queryList=n,this.matches=null}clone(){return new e(this.queryList)}setDirty(){this.queryList.setDirty()}},Fh=class e{constructor(n=[]){this.queries=n}createEmbeddedView(n){let t=n.queries;if(t!==null){let r=n.contentQueries!==null?n.contentQueries[0]:t.length,i=[];for(let o=0;o<r;o++){let s=t.getByIndex(o),a=this.queries[s.indexInDeclarationView];i.push(a.clone())}return new e(i)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)Fp(n,t).matches!==null&&this.queries[t].setDirty()}},Nh=class{constructor(n,t,r=null){this.flags=t,this.read=r,typeof n=="string"?this.predicate=JA(n):this.predicate=n}},Rh=class e{constructor(n=[]){this.queries=n}elementStart(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let r=0;r<this.length;r++){let i=t!==null?t.length:0,o=this.getByIndex(r).embeddedTView(n,i);o&&(o.indexInDeclarationView=r,t!==null?t.push(o):t=[o])}return t!==null?new e(t):null}template(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}},Bh=class e{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new e(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let t=this._declarationNodeIndex,r=n.parent;for(;r!==null&&r.type&8&&r.index!==t;)r=r.parent;return t===(r!==null?r.index:-1)}return this._appliesToNextNode}matchTNode(n,t){let r=this.metadata.predicate;if(Array.isArray(r))for(let i=0;i<r.length;i++){let o=r[i];this.matchTNodeWithReadOption(n,t,zA(t,o)),this.matchTNodeWithReadOption(n,t,fl(t,n,o,!1,!1))}else r===cs?t.type&4&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,fl(t,n,r,!1,!1))}matchTNodeWithReadOption(n,t,r){if(r!==null){let i=this.metadata.read;if(i!==null)if(i===er||i===bo||i===cs&&t.type&4)this.addMatch(t.index,-2);else{let o=fl(t,n,i,!1,!1);o!==null&&this.addMatch(t.index,o)}else this.addMatch(t.index,r)}}addMatch(n,t){this.matches===null?this.matches=[n,t]:this.matches.push(n,t)}};function zA(e,n){let t=e.localNames;if(t!==null){for(let r=0;r<t.length;r+=2)if(t[r]===n)return t[r+1]}return null}function GA(e,n){return e.type&11?aa(e,n):e.type&4?s0(e,n):null}function QA(e,n,t,r){return t===-1?GA(n,e):t===-2?XA(e,n,r):ss(e,e[Ke],t,n)}function XA(e,n,t){if(t===er)return aa(n,e);if(t===cs)return s0(n,e);if(t===bo)return Bv(n,e)}function Lv(e,n,t,r){let i=n[Ui].queries[r];if(i.matches===null){let o=e.data,s=t.matches,a=[];for(let c=0;s!==null&&c<s.length;c+=2){let d=s[c];if(d<0)a.push(null);else{let h=o[d];a.push(QA(n,h,s[c+1],t.metadata.read))}}i.matches=a}return i.matches}function Lh(e,n,t,r){let i=e.queries.getByIndex(t),o=i.matches;if(o!==null){let s=Lv(e,n,i,t);for(let a=0;a<o.length;a+=2){let c=o[a];if(c>0)r.push(s[a/2]);else{let d=o[a+1],h=n[-c];for(let p=Dr;p<h.length;p++){let g=h[p];g[ts]===g[Ln]&&Lh(g[Ke],g,d,r)}if(h[Zs]!==null){let p=h[Zs];for(let g=0;g<p.length;g++){let x=p[g];Lh(x[Ke],x,d,r)}}}}}return r}function YA(e,n){return e[Ui].queries[n].queryList}function KA(e,n,t){let r=new yh((t&4)===4);return jM(e,n,r,r.destroy),(n[Ui]??=new Fh).queries.push(new Ph(r))-1}function ZA(e,n,t,r){let i=an();if(i.firstCreatePass){let o=kn();eT(i,new Nh(n,t,r),o.index),tT(i,e),(t&2)===2&&(i.staticContentQueries=!0)}return KA(i,nt(),t)}function JA(e){return e.split(",").map(n=>n.trim())}function eT(e,n,t){e.queries===null&&(e.queries=new Rh),e.queries.track(new Bh(n,t))}function tT(e,n){let t=e.contentQueries||(e.contentQueries=[]),r=t.length?t[t.length-1]:-1;n!==r&&t.push(e.queries.length-1,n)}function Fp(e,n){return e.queries.getByIndex(n)}function nT(e,n){let t=e[Ke],r=Fp(t,n);return r.crossesNgTemplate?Lh(t,e,n,[]):Lv(t,e,r,n)}var Mx=new Set;function ca(e){Mx.has(e)||(Mx.add(e),performance?.mark?.("mark_feature_usage",{detail:{feature:e}}))}function rT(e){return typeof e=="function"&&e[Ri]!==void 0}function ua(e,n){ca("NgSignals");let t=b1(e),r=t[Ri];return n?.equal&&(r.equal=n.equal),t.set=i=>Mf(r,i),t.update=i=>D1(r,i),t.asReadonly=iT.bind(t),t}function iT(){let e=this[Ri];if(e.readonlyFn===void 0){let n=()=>this();n[Ri]=e,e.readonlyFn=n}return e.readonlyFn}function Vv(e){return rT(e)&&typeof e.set=="function"}function oT(e){return Object.getPrototypeOf(e.prototype).constructor}function Vn(e){let n=oT(e.type),t=!0,r=[e];for(;n;){let i;if(vo(e))i=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Ne(903,!1);i=n.\u0275dir}if(i){if(t){r.push(i);let s=e;s.inputs=sl(e.inputs),s.inputTransforms=sl(e.inputTransforms),s.declaredInputs=sl(e.declaredInputs),s.outputs=sl(e.outputs);let a=i.hostBindings;a&&lT(e,a);let c=i.viewQuery,d=i.contentQueries;if(c&&cT(e,c),d&&uT(e,d),sT(e,i),Z2(e.outputs,i.outputs),vo(i)&&i.data.animation){let h=e.data;h.animation=(h.animation||[]).concat(i.data.animation)}}let o=i.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(e),a===Vn&&(t=!1)}}n=Object.getPrototypeOf(n)}aT(r)}function sT(e,n){for(let t in n.inputs){if(!n.inputs.hasOwnProperty(t)||e.inputs.hasOwnProperty(t))continue;let r=n.inputs[t];if(r!==void 0&&(e.inputs[t]=r,e.declaredInputs[t]=n.declaredInputs[t],n.inputTransforms!==null)){let i=Array.isArray(r)?r[0]:r;if(!n.inputTransforms.hasOwnProperty(i))continue;e.inputTransforms??={},e.inputTransforms[i]=n.inputTransforms[i]}}}function aT(e){let n=0,t=null;for(let r=e.length-1;r>=0;r--){let i=e[r];i.hostVars=n+=i.hostVars,i.hostAttrs=rc(i.hostAttrs,t=rc(t,i.hostAttrs))}}function sl(e){return e===Qs?{}:e===Nr?[]:e}function cT(e,n){let t=e.viewQuery;t?e.viewQuery=(r,i)=>{n(r,i),t(r,i)}:e.viewQuery=n}function uT(e,n){let t=e.contentQueries;t?e.contentQueries=(r,i,o)=>{n(r,i,o),t(r,i,o)}:e.contentQueries=n}function lT(e,n){let t=e.hostBindings;t?e.hostBindings=(r,i)=>{n(r,i),t(r,i)}:e.hostBindings=n}function Np(e){let n=e.inputConfig,t={};for(let r in n)if(n.hasOwnProperty(r)){let i=n[r];Array.isArray(i)&&i[3]&&(t[r]=i[3])}e.inputTransforms=t}var Co=class{},sc=class{};var Vh=class extends Co{constructor(n,t,r,i=!0){super(),this.ngModuleType=n,this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Fl(this);let o=nE(n);this._bootstrapComponents=iv(o.bootstrap),this._r3Injector=qE(n,t,[{provide:Co,useValue:this},{provide:ta,useValue:this.componentFactoryResolver},...r],Zn(n),new Set(["environment"])),i&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}},Uh=class extends sc{constructor(n){super(),this.moduleType=n}create(n){return new Vh(this.moduleType,n,[])}};var Nl=class extends Co{constructor(n){super(),this.componentFactoryResolver=new Fl(this),this.instance=null;let t=new ic([...n.providers,{provide:Co,useValue:this},{provide:ta,useValue:this.componentFactoryResolver}],n.parent||ip(),n.debugName,new Set(["environment"]));this.injector=t,n.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}};function a0(e,n,t=null){return new Nl({providers:e,parent:n,debugName:t,runEnvironmentInitializers:!0}).injector}function Uv(e){return fT(e)?Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e:!1}function dT(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{let t=e[Symbol.iterator](),r;for(;!(r=t.next()).done;)n(r.value)}}function fT(e){return e!==null&&(typeof e=="function"||typeof e=="object")}function c0(e,n,t){return e[n]=t}function hT(e,n){return e[n]}function yo(e,n,t){let r=e[n];return Object.is(r,t)?!1:(e[n]=t,!0)}function Rl(e,n,t,r){let i=yo(e,n,t);return yo(e,n+1,r)||i}function pT(e,n,t,r,i,o){let s=Rl(e,n,t,r);return Rl(e,n+2,i,o)||s}function mT(e){return(e.flags&32)===32}function gT(e,n,t,r,i,o,s,a,c){let d=n.consts,h=hc(n,e,4,s||null,a||null);Tp(n,t,h,Js(d,c)),Jl(n,h);let p=h.tView=Ap(2,h,r,i,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,d,null);return n.queries!==null&&(n.queries.template(n,h),p.queries=n.queries.embeddedTView(h)),h}function xT(e,n,t,r,i,o,s,a,c,d){let h=t+Sr,p=n.firstCreatePass?gT(h,n,e,r,i,o,s,a,c):n.data[h];ls(p,!1);let g=ET(n,e,p,t);Kl()&&t0(n,e,g,p),_o(g,e);let x=yv(g,e,g,p);return e[h]=x,o0(e,x),qA(x,p,e),Gl(p)&&Sp(n,e,p),c!=null&&Mp(e,p,d),p}function G(e,n,t,r,i,o,s,a){let c=nt(),d=an(),h=Js(d.consts,o);return xT(c,d,e,n,t,r,i,h,s,a),G}var ET=vT;function vT(e,n,t,r){return Zl(!0),n[Gt].createComment("")}var qs=function(e){return e[e.EarlyRead=0]="EarlyRead",e[e.Write=1]="Write",e[e.MixedReadWrite=2]="MixedReadWrite",e[e.Read=3]="Read",e}(qs||{}),jv=(()=>{class e{constructor(){this.impl=null}execute(){this.impl?.execute()}static{this.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>new e})}}return e})(),jh=class e{constructor(){this.ngZone=ue(qt),this.scheduler=ue(ea),this.errorHandler=ue(ji,{optional:!0}),this.sequences=new Set,this.deferredRegistrations=new Set,this.executing=!1}static{this.PHASES=[qs.EarlyRead,qs.Write,qs.MixedReadWrite,qs.Read]}execute(){this.executing=!0;for(let n of e.PHASES)for(let t of this.sequences)if(!(t.erroredOrDestroyed||!t.hooks[n]))try{t.pipelinedValue=this.ngZone.runOutsideAngular(()=>t.hooks[n](t.pipelinedValue))}catch(r){t.erroredOrDestroyed=!0,this.errorHandler?.handleError(r)}this.executing=!1;for(let n of this.sequences)n.afterRun(),n.once&&(this.sequences.delete(n),n.destroy());for(let n of this.deferredRegistrations)this.sequences.add(n);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear()}register(n){this.executing?this.deferredRegistrations.add(n):(this.sequences.add(n),this.scheduler.notify(6))}unregister(n){this.executing&&this.sequences.has(n)?(n.erroredOrDestroyed=!0,n.pipelinedValue=void 0,n.once=!0):(this.sequences.delete(n),this.deferredRegistrations.delete(n))}static{this.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>new e})}},Hh=class{constructor(n,t,r,i){this.impl=n,this.hooks=t,this.once=r,this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.unregisterOnDestroy=i?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.()}};function Rp(e,n){!n?.injector&&QD(Rp);let t=n?.injector??ue(ei);return hM(t)?(ca("NgAfterNextRender"),CT(e,t,n,!0)):yT}function _T(e,n){if(e instanceof Function){let t=[void 0,void 0,void 0,void 0];return t[n]=e,t}else return[e.earlyRead,e.write,e.mixedReadWrite,e.read]}function CT(e,n,t,r){let i=n.get(jv);i.impl??=n.get(jh);let o=t?.phase??qs.MixedReadWrite,s=t?.manualCleanup!==!0?n.get(pp):null,a=new Hh(i.impl,_T(e,o),r,s);return i.impl.register(a),a}var yT={destroy(){}};function la(e,n,t,r){let i=nt(),o=Yl();if(yo(i,o,n)){let s=an(),a=dc();nA(a,i,e,n,t,r)}return la}function Hv(e,n,t,r){return yo(e,Yl(),t)?n+Gs(t)+r:Vr}function $v(e,n,t,r,i,o){let s=hS(),a=Rl(e,s,t,i);return SE(2),a?n+Gs(t)+r+Gs(i)+o:Vr}function al(e,n){return e<<17|n<<2}function us(e){return e>>17&32767}function wT(e){return(e&2)==2}function bT(e,n){return e&131071|n<<17}function $h(e){return e|2}function ia(e){return(e&131068)>>2}function Zf(e,n){return e&-131069|n<<2}function DT(e){return(e&1)===1}function qh(e){return e|1}function ST(e,n,t,r,i,o){let s=o?n.classBindings:n.styleBindings,a=us(s),c=ia(s);e[r]=t;let d=!1,h;if(Array.isArray(t)){let p=t;h=p[1],(h===null||uc(p,h)>0)&&(d=!0)}else h=t;if(i)if(c!==0){let g=us(e[a+1]);e[r+1]=al(g,a),g!==0&&(e[g+1]=Zf(e[g+1],r)),e[a+1]=bT(e[a+1],r)}else e[r+1]=al(a,0),a!==0&&(e[a+1]=Zf(e[a+1],r)),a=r;else e[r+1]=al(c,0),a===0?a=r:e[c+1]=Zf(e[c+1],r),c=r;d&&(e[r+1]=$h(e[r+1])),Ax(e,h,r,!0),Ax(e,h,r,!1),MT(n,h,e,r,o),s=al(a,c),o?n.classBindings=s:n.styleBindings=s}function MT(e,n,t,r,i){let o=i?e.residualClasses:e.residualStyles;o!=null&&typeof n=="string"&&uc(o,n)>=0&&(t[r+1]=qh(t[r+1]))}function Ax(e,n,t,r){let i=e[t+1],o=n===null,s=r?us(i):ia(i),a=!1;for(;s!==0&&(a===!1||o);){let c=e[s],d=e[s+1];AT(c,n)&&(a=!0,e[s+1]=r?qh(d):$h(d)),s=r?us(d):ia(d)}a&&(e[t+1]=r?$h(i):qh(i))}function AT(e,n){return e===null||n==null||(Array.isArray(e)?e[1]:e)===n?!0:Array.isArray(e)&&typeof n=="string"?uc(e,n)>=0:!1}function O(e,n,t){let r=nt(),i=Yl();if(yo(r,i,n)){let o=an(),s=dc();i0(o,s,r,e,n,r[Gt],t,!1)}return O}function Tx(e,n,t,r,i){let o=n.inputs,s=i?"class":"style";Op(e,t,o[s],s,r)}function u0(e,n,t){return qv(e,n,t,!1),u0}function xt(e,n){return qv(e,n,null,!0),xt}function qv(e,n,t,r){let i=nt(),o=an(),s=SE(2);if(o.firstUpdatePass&&OT(o,e,s,r),n!==Vr&&yo(i,s,n)){let a=o.data[ds()];NT(o,a,i,i[Gt],e,i[s+1]=RT(n,t),r,s)}}function TT(e,n){return n>=e.expandoStartIndex}function OT(e,n,t,r){let i=e.data;if(i[t+1]===null){let o=i[ds()],s=TT(e,t);BT(o,r)&&n===null&&!s&&(n=!1),n=IT(i,o,n,r),ST(i,o,n,t,s,r)}}function IT(e,n,t,r){let i=ES(e),o=r?n.residualClasses:n.residualStyles;if(i===null)(r?n.classBindings:n.styleBindings)===0&&(t=Jf(null,e,n,t,r),t=ac(t,n.attrs,r),o=null);else{let s=n.directiveStylingLast;if(s===-1||e[s]!==i)if(t=Jf(i,e,n,t,r),o===null){let c=kT(e,n,r);c!==void 0&&Array.isArray(c)&&(c=Jf(null,e,n,c[1],r),c=ac(c,n.attrs,r),PT(e,n,r,c))}else o=FT(e,n,r)}return o!==void 0&&(r?n.residualClasses=o:n.residualStyles=o),t}function kT(e,n,t){let r=t?n.classBindings:n.styleBindings;if(ia(r)!==0)return e[us(r)]}function PT(e,n,t,r){let i=t?n.classBindings:n.styleBindings;e[us(i)]=r}function FT(e,n,t){let r,i=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<i;o++){let s=e[o].hostAttrs;r=ac(r,s,t)}return ac(r,n.attrs,t)}function Jf(e,n,t,r,i){let o=null,s=t.directiveEnd,a=t.directiveStylingLast;for(a===-1?a=t.directiveStart:a++;a<s&&(o=n[a],r=ac(r,o.hostAttrs,i),o!==e);)a++;return e!==null&&(t.directiveStylingLast=a),r}function ac(e,n,t){let r=t?1:2,i=-1;if(n!==null)for(let o=0;o<n.length;o++){let s=n[o];typeof s=="number"?i=s:i===r&&(Array.isArray(e)||(e=e===void 0?[]:["",e]),_D(e,s,t?!0:n[++o]))}return e===void 0?null:e}function NT(e,n,t,r,i,o,s,a){if(!(n.type&3))return;let c=e.data,d=c[a+1],h=DT(d)?Ox(c,n,t,i,ia(d),s):void 0;if(!Bl(h)){Bl(o)||wT(d)&&(o=Ox(c,null,t,i,a,s));let p=gE(ds(),t);PM(r,s,p,i,o)}}function Ox(e,n,t,r,i,o){let s=n===null,a;for(;i>0;){let c=e[i],d=Array.isArray(c),h=d?c[1]:c,p=h===null,g=t[i+1];g===Vr&&(g=p?Nr:void 0);let x=p?$f(g,r):h===r?g:void 0;if(d&&!Bl(x)&&(x=$f(c,r)),Bl(x)&&(a=x,s))return a;let v=e[i+1];i=s?us(v):ia(v)}if(n!==null){let c=o?n.residualClasses:n.residualStyles;c!=null&&(a=$f(c,r))}return a}function Bl(e){return e!==void 0}function RT(e,n){return e==null||e===""||(typeof n=="string"?e=e+n:typeof e=="object"&&(e=Zn(fc(e)))),e}function BT(e,n){return(e.flags&(n?8:16))!==0}function LT(e,n,t,r,i,o){let s=n.consts,a=Js(s,i),c=hc(n,e,2,r,a);return Tp(n,t,c,Js(s,o)),c.attrs!==null&&Pl(c,c.attrs,!1),c.mergedAttrs!==null&&Pl(c,c.mergedAttrs,!0),n.queries!==null&&n.queries.elementStart(n,c),c}function l(e,n,t,r){let i=nt(),o=an(),s=Sr+e,a=i[Gt],c=o.firstCreatePass?LT(s,o,i,n,t,r):o.data[s],d=VT(o,i,c,a,n,e);i[s]=d;let h=Gl(c);return ls(c,!0),hv(a,d,c),!mT(c)&&Kl()&&t0(o,i,d,c),oS()===0&&_o(d,i),sS(),h&&(Sp(o,i,c),Dp(o,c,i)),r!==null&&Mp(i,c),l}function u(){let e=kn();cp()?bE():(e=e.parent,ls(e,!1));let n=e;uS(n)&&lS(),aS();let t=an();return t.firstCreatePass&&(Jl(t,e),op(e)&&t.queries.elementEnd(e)),n.classesWithoutHost!=null&&DS(n)&&Tx(t,n,nt(),n.classesWithoutHost,!0),n.stylesWithoutHost!=null&&SS(n)&&Tx(t,n,nt(),n.stylesWithoutHost,!1),u}function N(e,n,t,r){return l(e,n,t,r),u(),N}var VT=(e,n,t,r,i,o)=>(Zl(!0),ov(r,i,CS()));function UT(e,n,t,r,i){let o=n.consts,s=Js(o,r),a=hc(n,e,8,"ng-container",s);s!==null&&Pl(a,s,!0);let c=Js(o,i);return Tp(n,t,a,c),n.queries!==null&&n.queries.elementStart(n,a),a}function cn(e,n,t){let r=nt(),i=an(),o=e+Sr,s=i.firstCreatePass?UT(o,i,r,n,t):i.data[o];ls(s,!0);let a=jT(i,r,s,e);return r[o]=a,Kl()&&t0(i,r,a,s),_o(a,r),Gl(s)&&(Sp(i,r,s),Dp(i,s,r)),t!=null&&Mp(r,s),cn}function un(){let e=kn(),n=an();return cp()?bE():(e=e.parent,ls(e,!1)),n.firstCreatePass&&(Jl(n,e),op(e)&&n.queries.elementEnd(e)),un}var jT=(e,n,t,r)=>(Zl(!0),xM(n[Gt],""));function ve(){return nt()}var Ko=void 0;function HT(e){let n=e,t=Math.floor(Math.abs(e)),r=e.toString().replace(/^[^.]*\.?/,"").length;return t===1&&r===0?1:5}var $T=["en",[["a","p"],["AM","PM"],Ko],[["AM","PM"],Ko,Ko],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Ko,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Ko,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Ko,"{1} 'at' {0}",Ko],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",HT],eh={};function Ur(e){let n=qT(e),t=Ix(n);if(t)return t;let r=n.split("-")[0];if(t=Ix(r),t)return t;if(r==="en")return $T;throw new Ne(701,!1)}function Ix(e){return e in eh||(eh[e]=Zo.ng&&Zo.ng.common&&Zo.ng.common.locales&&Zo.ng.common.locales[e]),eh[e]}var Jt=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}(Jt||{});function qT(e){return e.toLowerCase().replace(/_/g,"-")}var Ll="en-US";var WT=Ll;function zT(e){typeof e=="string"&&(WT=e.toLowerCase().replace(/_/g,"-"))}var GT=(e,n,t)=>{};function H(e,n,t,r){let i=nt(),o=an(),s=kn();return Wv(o,i,i[Gt],s,e,n,r),H}function QT(e,n,t,r){let i=e.cleanup;if(i!=null)for(let o=0;o<i.length-1;o+=2){let s=i[o];if(s===t&&i[o+1]===r){let a=n[_l],c=i[o+2];return a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function Wv(e,n,t,r,i,o,s){let a=Gl(r),d=e.firstCreatePass&&Dv(e),h=n[Jr],p=bv(n),g=!0;if(r.type&3||s){let E=Lr(r,n),_=s?s(E):E,M=p.length,I=s?q=>s(wi(q[r.index])):r.index,y=null;if(!s&&a&&(y=QT(e,n,i,r.index)),y!==null){let q=y.__ngLastListenerFn__||y;q.__ngNextListenerFn__=o,y.__ngLastListenerFn__=o,g=!1}else{o=Px(r,n,h,o),GT(E,i,o);let q=t.listen(_,i,o);p.push(o,q),d&&d.push(i,I,M,M+1)}}else o=Px(r,n,h,o);let x=r.outputs,v;if(g&&x!==null&&(v=x[i])){let E=v.length;if(E)for(let _=0;_<E;_+=2){let M=v[_],I=v[_+1],ee=n[M][I].subscribe(o),R=p.length;p.push(o,ee),d&&d.push(i,r.index,R,-(R+1))}}}function kx(e,n,t,r){let i=mt(null);try{return Ei(6,n,t),t(r)!==!1}catch(o){return Sv(e,o),!1}finally{Ei(7,n,t),mt(i)}}function Px(e,n,t,r){return function i(o){if(o===Function)return r;let s=e.componentOffset>-1?wo(e.index,n):n;kp(s,5);let a=kx(n,t,r,o),c=i.__ngNextListenerFn__;for(;c;)a=kx(n,t,c,o)&&a,c=c.__ngNextListenerFn__;return a}}function D(e=1){return _S(e)}function fs(e,n,t,r,i){let o=nt(),s=Hv(o,n,t,r);if(s!==Vr){let a=an(),c=dc();i0(a,c,o,e,s,o[Gt],i,!1)}return fs}function Bp(e,n,t,r,i,o,s){let a=nt(),c=$v(a,n,t,r,i,o);if(c!==Vr){let d=an(),h=dc();i0(d,h,a,e,c,a[Gt],s,!1)}return Bp}function zv(e,n,t,r){ZA(e,n,t,r)}function Gv(e){let n=nt(),t=an(),r=ME();up(r+1);let i=Fp(t,r);if(e.dirty&&tS(n)===((i.metadata.flags&2)===2)){if(i.matches===null)e.reset([]);else{let o=nT(n,r);e.reset(o,GS),e.notifyOnChanges()}return!0}return!1}function Qv(){return YA(nt(),ME())}function XT(e,n,t,r){t>=e.data.length&&(e.data[t]=null,e.blueprint[t]=null),n[t]=r}function Nt(e){let n=fS();return sp(n,Sr+e)}function f(e,n=""){let t=nt(),r=an(),i=e+Sr,o=r.firstCreatePass?hc(r,i,1,n,null):r.data[i],s=YT(r,t,o,n,e);t[i]=s,Kl()&&t0(r,t,s,o),ls(o,!1)}var YT=(e,n,t,r,i)=>(Zl(!0),mM(n[Gt],r));function ae(e){return te("",e,""),ae}function te(e,n,t){let r=nt(),i=Hv(r,e,n,t);return i!==Vr&&Mv(r,ds(),i),te}function Wt(e,n,t,r,i){let o=nt(),s=$v(o,e,n,t,r,i);return s!==Vr&&Mv(o,ds(),s),Wt}function me(e,n,t){Vv(n)&&(n=n());let r=nt(),i=Yl();if(yo(r,i,n)){let o=an(),s=dc();i0(o,s,r,e,n,r[Gt],t,!1)}return me}function xe(e,n){let t=Vv(e);return t&&e.set(n),t}function ge(e,n){let t=nt(),r=an(),i=kn();return Wv(r,t,t[Gt],i,e,n),ge}function KT(e,n,t){let r=an();if(r.firstCreatePass){let i=vo(e);Wh(t,r.data,r.blueprint,i,!0),Wh(n,r.data,r.blueprint,i,!1)}}function Wh(e,n,t,r,i){if(e=Kn(e),Array.isArray(e))for(let o=0;o<e.length;o++)Wh(e[o],n,t,r,i);else{let o=an(),s=nt(),a=kn(),c=Ys(e)?e:Kn(e.provide),d=cE(e),h=a.providerIndexes&1048575,p=a.directiveStart,g=a.providerIndexes>>20;if(Ys(e)||!e.multi){let x=new os(d,i,Q),v=nh(c,n,i?h:h+g,p);v===-1?(gh(Sl(a,s),o,c),th(o,e,n.length),n.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(x),s.push(x)):(t[v]=x,s[v]=x)}else{let x=nh(c,n,h+g,p),v=nh(c,n,h,h+g),E=x>=0&&t[x],_=v>=0&&t[v];if(i&&!_||!i&&!E){gh(Sl(a,s),o,c);let M=eO(i?JT:ZT,t.length,i,r,d);!i&&_&&(t[v].providerFactory=M),th(o,e,n.length,0),n.push(c),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(M),s.push(M)}else{let M=Xv(t[i?v:x],d,!i&&r);th(o,e,x>-1?x:v,M)}!i&&r&&_&&t[v].componentProviders++}}}function th(e,n,t,r){let i=Ys(n),o=jD(n);if(i||o){let c=(o?Kn(n.useClass):n).prototype.ngOnDestroy;if(c){let d=e.destroyHooks||(e.destroyHooks=[]);if(!i&&n.multi){let h=d.indexOf(t);h===-1?d.push(t,[r,c]):d[h+1].push(r,c)}else d.push(t,c)}}}function Xv(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function nh(e,n,t,r){for(let i=t;i<r;i++)if(n[i]===e)return i;return-1}function ZT(e,n,t,r){return zh(this.multi,[])}function JT(e,n,t,r){let i=this.multi,o;if(this.providerFactory){let s=this.providerFactory.componentProviders,a=ss(t,t[Ke],this.providerFactory.index,r);o=a.slice(0,s),zh(i,o);for(let c=s;c<a.length;c++)o.push(a[c])}else o=[],zh(i,o);return o}function zh(e,n){for(let t=0;t<e.length;t++){let r=e[t];n.push(r())}return n}function eO(e,n,t,r,i){let o=new os(e,t,Q);return o.multi=[],o.index=n,o.componentProviders=0,Xv(o,i,r&&!t),o}function jr(e,n=[]){return t=>{t.providersResolver=(r,i)=>KT(r,i?i(e):e,n)}}var tO=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){let r=oE(!1,t.type),i=r.length>0?a0([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(let t of this.cachedInjectors.values())t!==null&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Ae({token:e,providedIn:"environment",factory:()=>new e(ke(Jn))})}}return e})();function Me(e){ca("NgStandalone"),e.getStandaloneInjector=n=>n.get(tO).getOrCreateStandaloneInjector(e)}function Yv(e,n,t){let r=sa()+e,i=nt();return i[r]===Vr?c0(i,r,t?n.call(t):n()):hT(i,r)}function Kv(e,n,t,r){return Zv(nt(),sa(),e,n,t,r)}function Do(e,n,t,r,i){return Jv(nt(),sa(),e,n,t,r,i)}function l0(e,n,t,r,i,o,s){return nO(nt(),sa(),e,n,t,r,i,o,s)}function Lp(e,n){let t=e[n];return t===Vr?void 0:t}function Zv(e,n,t,r,i,o){let s=n+t;return yo(e,s,i)?c0(e,s+1,o?r.call(o,i):r(i)):Lp(e,s+1)}function Jv(e,n,t,r,i,o,s){let a=n+t;return Rl(e,a,i,o)?c0(e,a+2,s?r.call(s,i,o):r(i,o)):Lp(e,a+2)}function nO(e,n,t,r,i,o,s,a,c){let d=n+t;return pT(e,d,i,o,s,a)?c0(e,d+4,c?r.call(c,i,o,s,a):r(i,o,s,a)):Lp(e,d+4)}function zt(e,n){let t=an(),r,i=e+Sr;t.firstCreatePass?(r=rO(n,t.pipeRegistry),t.data[i]=r,r.onDestroy&&(t.destroyHooks??=[]).push(i,r.onDestroy)):r=t.data[i];let o=r.factory||(r.factory=es(r.type,!0)),s,a=dr(Q);try{let c=Dl(!1),d=o();return Dl(c),XT(t,nt(),i,d),d}finally{dr(a)}}function rO(e,n){if(n)for(let t=n.length-1;t>=0;t--){let r=n[t];if(e===r.name)return r}}function tr(e,n,t){let r=e+Sr,i=nt(),o=sp(i,r);return e_(i,r)?Zv(i,sa(),n,o.transform,t,o):o.transform(t)}function So(e,n,t,r){let i=e+Sr,o=nt(),s=sp(o,i);return e_(o,i)?Jv(o,sa(),n,s.transform,t,r,s):s.transform(t,r)}function e_(e,n){return e[Ke].data[n].pure}function nr(e,n){return s0(e,n)}var d0=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"platform"})}}return e})();var t_=new Ie("");function hs(e){return!!e&&typeof e.then=="function"}function n_(e){return!!e&&typeof e.subscribe=="function"}var f0=new Ie(""),r_=(()=>{class e{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=ue(f0,{optional:!0})??[]}runInitializers(){if(this.initialized)return;let t=[];for(let i of this.appInits){let o=i();if(hs(o))t.push(o);else if(n_(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});t.push(s)}}let r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),t.length===0&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),pc=new Ie("");function iO(){w1(()=>{throw new Ne(600,!1)})}function oO(e){return e.isBoundToModule}var sO=10;function aO(e,n,t){try{let r=t();return hs(r)?r.catch(i=>{throw n.runOutsideAngular(()=>e.handleError(i)),i}):r}catch(r){throw n.runOutsideAngular(()=>e.handleError(r)),r}}var Mo=(()=>{class e{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ue(WS),this.afterRenderManager=ue(jv),this.zonelessEnabled=ue(Pp),this.dirtyFlags=0,this.deferredDirtyFlags=0,this.externalTestViews=new Set,this.beforeRender=new wn,this.afterTick=new wn,this.componentTypes=[],this.components=[],this.isStable=ue(Wi).hasPendingTasks.pipe(Xe(t=>!t)),this._injector=ue(Jn)}get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}whenStable(){let t;return new Promise(r=>{t=this.isStable.subscribe({next:i=>{i&&r()}})}).finally(()=>{t.unsubscribe()})}get injector(){return this._injector}bootstrap(t,r){let i=t instanceof kl;if(!this._injector.get(r_).done){let g=!i&&tE(t),x=!1;throw new Ne(405,x)}let s;i?s=t:s=this._injector.get(ta).resolveComponentFactory(t),this.componentTypes.push(s.componentType);let a=oO(s)?void 0:this._injector.get(Co),c=r||s.selector,d=s.create(ei.NULL,[],c,a),h=d.location.nativeElement,p=d.injector.get(t_,null);return p?.registerApplication(h),d.onDestroy(()=>{this.detachView(d.hostView),hl(this.components,d),p?.unregisterApplication(h)}),this._loadComponent(d),d}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){if(this._runningTick)throw new Ne(101,!1);let t=mt(null);try{this._runningTick=!0,this.synchronize()}catch(r){this.internalErrorHandler(r)}finally{this._runningTick=!1,mt(t),this.afterTick.next()}}synchronize(){let t=null;this._injector.destroyed||(t=this._injector.get(na,null,{optional:!0})),this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0;let r=0;for(;this.dirtyFlags!==0&&r++<sO;)this.synchronizeOnce(t)}synchronizeOnce(t){if(this.dirtyFlags|=this.deferredDirtyFlags,this.deferredDirtyFlags=0,this.dirtyFlags&7){let r=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8,this.beforeRender.next(r);for(let{_lView:i,notifyErrorHandler:o}of this._views)cO(i,o,r,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&7)return}else t?.begin?.(),t?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:t})=>Ql(t))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(t){let r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){let r=t;hl(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);let r=this._injector.get(pc,[]);[...this._bootstrapListeners,...r].forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>hl(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new Ne(406,!1);let t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function hl(e,n){let t=e.indexOf(n);t>-1&&e.splice(t,1)}function cO(e,n,t,r){if(!t&&!Ql(e))return;Ov(e,n,t&&!r?0:1)}var Gh=class{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}},h0=(()=>{class e{compileModuleSync(t){return new Uh(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){let r=this.compileModuleSync(t),i=nE(t),o=iv(i.declarations).reduce((s,a)=>{let c=Eo(a);return c&&s.push(new ra(c)),s},[]);return new Gh(r,o)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var uO=(()=>{class e{constructor(){this.zone=ue(qt),this.changeDetectionScheduler=ue(ea),this.applicationRef=ue(Mo)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function lO({ngZoneFactory:e,ignoreChangesOutsideZone:n,scheduleInRootZone:t}){return e??=()=>new qt(qe(de({},dO()),{scheduleInRootZone:t})),[{provide:qt,useFactory:e},{provide:Xs,multi:!0,useFactory:()=>{let r=ue(uO,{optional:!0});return()=>r.initialize()}},{provide:Xs,multi:!0,useFactory:()=>{let r=ue(fO);return()=>{r.initialize()}}},n===!0?{provide:Fv,useValue:!0}:[],{provide:Nv,useValue:t??WE}]}function dO(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:e?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:e?.runCoalescing??!1}}var fO=(()=>{class e{constructor(){this.subscription=new rn,this.initialized=!1,this.zone=ue(qt),this.pendingTasks=ue(Wi)}initialize(){if(this.initialized)return;this.initialized=!0;let t=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(t=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{qt.assertNotInAngularZone(),queueMicrotask(()=>{t!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(t),t=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{qt.assertInAngularZone(),t??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var hO=(()=>{class e{constructor(){this.appRef=ue(Mo),this.taskService=ue(Wi),this.ngZone=ue(qt),this.zonelessEnabled=ue(Pp),this.disableScheduling=ue(Fv,{optional:!0})??!1,this.zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run,this.schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}],this.subscriptions=new rn,this.angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Al):null,this.scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(ue(Nv,{optional:!0})??!1),this.cancelScheduledCallback=null,this.useMicrotaskScheduler=!1,this.runningTick=!1,this.pendingRenderTaskId=null,this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Ch||!this.zoneIsDefined)}notify(t){if(!this.zonelessEnabled&&t===5)return;switch(t){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 7:{this.appRef.deferredDirtyFlags|=8;break}case 9:case 8:case 6:case 10:default:this.appRef.dirtyFlags|=8}if(!this.shouldScheduleTick())return;let r=this.useMicrotaskScheduler?px:zE;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(){return!(this.disableScheduling||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Al+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let t=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(r){throw this.taskService.remove(t),r}finally{this.cleanup()}this.useMicrotaskScheduler=!0,px(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(t)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let t=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(t)}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function pO(){return typeof $localize<"u"&&$localize.locale||Ll}var p0=new Ie("",{providedIn:"root",factory:()=>ue(p0,tt.Optional|tt.SkipSelf)||pO()});var Qh=new Ie("");function cl(e){return!e.moduleRef}function mO(e){let n=cl(e)?e.r3Injector:e.moduleRef.injector,t=n.get(qt);return t.run(()=>{cl(e)?e.r3Injector.resolveInjectorInitializers():e.moduleRef.resolveInjectorInitializers();let r=n.get(ji,null),i;if(t.runOutsideAngular(()=>{i=t.onError.subscribe({next:o=>{r.handleError(o)}})}),cl(e)){let o=()=>n.destroy(),s=e.platformInjector.get(Qh);s.add(o),n.onDestroy(()=>{i.unsubscribe(),s.delete(o)})}else{let o=()=>e.moduleRef.destroy(),s=e.platformInjector.get(Qh);s.add(o),e.moduleRef.onDestroy(()=>{hl(e.allPlatformModules,e.moduleRef),i.unsubscribe(),s.delete(o)})}return aO(r,t,()=>{let o=n.get(r_);return o.runInitializers(),o.donePromise.then(()=>{let s=n.get(p0,Ll);if(zT(s||Ll),cl(e)){let a=n.get(Mo);return e.rootComponent!==void 0&&a.bootstrap(e.rootComponent),a}else return gO(e.moduleRef,e.allPlatformModules),e.moduleRef})})})}function gO(e,n){let t=e.injector.get(Mo);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>t.bootstrap(r));else if(e.instance.ngDoBootstrap)e.instance.ngDoBootstrap(t);else throw new Ne(-403,!1);n.push(e)}var pl=null;function xO(e=[],n){return ei.create({name:n,providers:[{provide:ql,useValue:"platform"},{provide:Qh,useValue:new Set([()=>pl=null])},...e]})}function EO(e=[]){if(pl)return pl;let n=xO(e);return pl=n,iO(),vO(n),n}function vO(e){e.get(Ep,null)?.forEach(t=>t())}var Ao=(()=>{class e{static{this.__NG_ELEMENT_ID__=_O}}return e})();function _O(e){return CO(kn(),nt(),(e&16)===16)}function CO(e,n,t){if(zl(e)&&!t){let r=wo(e.index,n);return new as(r,r)}else if(e.type&175){let r=n[yi];return new as(r,n)}return null}var Xh=class{constructor(){}supports(n){return Uv(n)}create(n){return new Yh(n)}},yO=(e,n)=>n,Yh=class{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||yO}forEachItem(n){let t;for(t=this._itHead;t!==null;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,r=this._removalsHead,i=0,o=null;for(;t||r;){let s=!r||t&&t.currentIndex<Fx(r,i,o)?t:r,a=Fx(s,i,o),c=s.currentIndex;if(s===r)i--,r=r._nextRemoved;else if(t=t._next,s.previousIndex==null)i++;else{o||(o=[]);let d=a-i,h=c-i;if(d!=h){for(let g=0;g<d;g++){let x=g<o.length?o[g]:o[g]=0,v=x+g;h<=v&&v<d&&(o[g]=x+1)}let p=s.previousIndex;o[p]=h-d}}a!==c&&n(s,a,c)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;t!==null;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;t!==null;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;t!==null;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;t!==null;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;t!==null;t=t._nextIdentityChange)n(t)}diff(n){if(n==null&&(n=[]),!Uv(n))throw new Ne(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._itHead,r=!1,i,o,s;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,o,s,a),r=!0):(r&&(t=this._verifyReinsertion(t,o,s,a)),Object.is(t.item,o)||this._addIdentityChange(t,o)),t=t._next}else i=0,dT(n,a=>{s=this._trackByFn(i,a),t===null||!Object.is(t.trackById,s)?(t=this._mismatch(t,a,s,i),r=!0):(r&&(t=this._verifyReinsertion(t,a,s,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;n!==null;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;n!==null;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;n!==null;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,r,i){let o;return n===null?o=this._itTail:(o=n._prev,this._remove(n)),n=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null),n!==null?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,o,i)):(n=this._linkedRecords===null?null:this._linkedRecords.get(r,i),n!==null?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,o,i)):n=this._addAfter(new Kh(t,r),o,i)),n}_verifyReinsertion(n,t,r,i){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(r,null);return o!==null?n=this._reinsertAfter(o,n._prev,i):n.currentIndex!=i&&(n.currentIndex=i,this._addToMoves(n,i)),n}_truncate(n){for(;n!==null;){let t=n._next;this._addToRemovals(this._unlink(n)),n=t}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,r){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(n);let i=n._prevRemoved,o=n._nextRemoved;return i===null?this._removalsHead=o:i._nextRemoved=o,o===null?this._removalsTail=i:o._prevRemoved=i,this._insertAfter(n,t,r),this._addToMoves(n,r),n}_moveAfter(n,t,r){return this._unlink(n),this._insertAfter(n,t,r),this._addToMoves(n,r),n}_addAfter(n,t,r){return this._insertAfter(n,t,r),this._additionsTail===null?this._additionsTail=this._additionsHead=n:this._additionsTail=this._additionsTail._nextAdded=n,n}_insertAfter(n,t,r){let i=t===null?this._itHead:t._next;return n._next=i,n._prev=t,i===null?this._itTail=n:i._prev=n,t===null?this._itHead=n:t._next=n,this._linkedRecords===null&&(this._linkedRecords=new Vl),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){this._linkedRecords!==null&&this._linkedRecords.remove(n);let t=n._prev,r=n._next;return t===null?this._itHead=r:t._next=r,r===null?this._itTail=t:r._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail===null?this._movesTail=this._movesHead=n:this._movesTail=this._movesTail._nextMoved=n),n}_addToRemovals(n){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Vl),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=n:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=n,n}},Kh=class{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}},Zh=class{constructor(){this._head=null,this._tail=null}add(n){this._head===null?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let r;for(r=this._head;r!==null;r=r._nextDup)if((t===null||t<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){let t=n._prevDup,r=n._nextDup;return t===null?this._head=r:t._nextDup=r,r===null?this._tail=t:r._prevDup=t,this._head===null}},Vl=class{constructor(){this.map=new Map}put(n){let t=n.trackById,r=this.map.get(t);r||(r=new Zh,this.map.set(t,r)),r.add(n)}get(n,t){let r=n,i=this.map.get(r);return i?i.get(n,t):null}remove(n){let t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function Fx(e,n,t){let r=e.previousIndex;if(r===null)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+n+i}function Nx(){return new Vp([new Xh])}var Vp=(()=>{class e{static{this.\u0275prov=Ae({token:e,providedIn:"root",factory:Nx})}constructor(t){this.factories=t}static create(t,r){if(r!=null){let i=r.factories.slice();t=t.concat(i)}return new e(t)}static extend(t){return{provide:e,useFactory:r=>e.create(t,r||Nx()),deps:[[e,new ep,new $l]]}}find(t){let r=this.factories.find(i=>i.supports(t));if(r!=null)return r;throw new Ne(901,!1)}}return e})();function i_(e){try{let{rootComponent:n,appProviders:t,platformProviders:r}=e,i=EO(r),o=[lO({}),{provide:ea,useExisting:hO},...t||[]],s=new Nl({providers:o,parent:i,debugName:"",runEnvironmentInitializers:!1});return mO({r3Injector:s.injector,platformInjector:i,rootComponent:n})}catch(n){return Promise.reject(n)}}function To(e){return typeof e=="boolean"?e:e!=null&&e!=="false"}function da(e,n){ca("NgSignals");let t=_1(e);return n?.equal&&(t[Ri].equal=n.equal),t}function Di(e){let n=mt(null);try{return e()}finally{mt(n)}}function o_(e){let n=Eo(e);if(!n)return null;let t=new ra(n);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return n.standalone},get isSignal(){return n.signals}}}var f_=null;function Xi(){return f_}function h_(e){f_??=e}var w0=class{};var Un=new Ie(""),Xp=(()=>{class e{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>ue(bO),providedIn:"platform"})}}return e})(),p_=new Ie(""),bO=(()=>{class e extends Xp{constructor(){super(),this._doc=ue(Un),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Xi().getBaseHref(this._doc)}onPopState(t){let r=Xi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){let r=Xi().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>new e,providedIn:"platform"})}}return e})();function Yp(e,n){if(e.length==0)return n;if(n.length==0)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,t==2?e+n.substring(1):t==1?e+n:e+"/"+n}function s_(e){let n=e.match(/#|\?|$/),t=n&&n.index||e.length,r=t-(e[t-1]==="/"?1:0);return e.slice(0,r)+e.slice(t)}function Gi(e){return e&&e[0]!=="?"?"?"+e:e}var Yi=(()=>{class e{historyGo(t){throw new Error("")}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>ue(Kp),providedIn:"root"})}}return e})(),m_=new Ie(""),Kp=(()=>{class e extends Yi{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??ue(Un).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return Yp(this._baseHref,t)}path(t=!1){let r=this._platformLocation.pathname+Gi(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Gi(o));this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Gi(o));this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||e)(ke(Xp),ke(m_,8))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),g_=(()=>{class e extends Yi{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],r!=null&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash??"#";return r.length>0?r.substring(1):r}prepareExternalUrl(t){let r=Yp(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,o){let s=this.prepareExternalUrl(i+Gi(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.pushState(t,r,s)}replaceState(t,r,i,o){let s=this.prepareExternalUrl(i+Gi(o));s.length==0&&(s=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||e)(ke(Xp),ke(m_,8))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),ha=(()=>{class e{constructor(t){this._subject=new Ut,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;let r=this._locationStrategy.getBaseHref();this._basePath=MO(s_(a_(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Gi(r))}normalize(t){return e.stripTrailingSlash(SO(this._basePath,a_(t)))}prepareExternalUrl(t){return t&&t[0]!=="/"&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Gi(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Gi(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription??=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}),()=>{let r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Gi}static{this.joinWithSlash=Yp}static{this.stripTrailingSlash=s_}static{this.\u0275fac=function(r){return new(r||e)(ke(Yi))}}static{this.\u0275prov=Ae({token:e,factory:()=>DO(),providedIn:"root"})}}return e})();function DO(){return new ha(ke(Yi))}function SO(e,n){if(!e||!n.startsWith(e))return n;let t=n.substring(e.length);return t===""||["/",";","?","#"].includes(t[0])?t:n}function a_(e){return e.replace(/\/index.html$/,"")}function MO(e){if(new RegExp("^(https?:)?//").test(e)){let[,t]=e.split(/\/\/[^\/]+/);return t}return e}var rr=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}(rr||{}),Mt=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}(Mt||{}),Mr=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}(Mr||{}),Oo={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function AO(e){return Ur(e)[Jt.LocaleId]}function TO(e,n,t){let r=Ur(e),i=[r[Jt.DayPeriodsFormat],r[Jt.DayPeriodsStandalone]],o=Hr(i,n);return Hr(o,t)}function OO(e,n,t){let r=Ur(e),i=[r[Jt.DaysFormat],r[Jt.DaysStandalone]],o=Hr(i,n);return Hr(o,t)}function IO(e,n,t){let r=Ur(e),i=[r[Jt.MonthsFormat],r[Jt.MonthsStandalone]],o=Hr(i,n);return Hr(o,t)}function kO(e,n){let r=Ur(e)[Jt.Eras];return Hr(r,n)}function m0(e,n){let t=Ur(e);return Hr(t[Jt.DateFormat],n)}function g0(e,n){let t=Ur(e);return Hr(t[Jt.TimeFormat],n)}function x0(e,n){let r=Ur(e)[Jt.DateTimeFormat];return Hr(r,n)}function D0(e,n){let t=Ur(e),r=t[Jt.NumberSymbols][n];if(typeof r>"u"){if(n===Oo.CurrencyDecimal)return t[Jt.NumberSymbols][Oo.Decimal];if(n===Oo.CurrencyGroup)return t[Jt.NumberSymbols][Oo.Group]}return r}function x_(e){if(!e[Jt.ExtraData])throw new Error(`Missing extra locale data for the locale "${e[Jt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function PO(e){let n=Ur(e);return x_(n),(n[Jt.ExtraData][2]||[]).map(r=>typeof r=="string"?Up(r):[Up(r[0]),Up(r[1])])}function FO(e,n,t){let r=Ur(e);x_(r);let i=[r[Jt.ExtraData][0],r[Jt.ExtraData][1]],o=Hr(i,n)||[];return Hr(o,t)||[]}function Hr(e,n){for(let t=n;t>-1;t--)if(typeof e[t]<"u")return e[t];throw new Error("Locale data API: locale data undefined")}function Up(e){let[n,t]=e.split(":");return{hours:+n,minutes:+t}}var NO=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,E0={},RO=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Qi=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}(Qi||{}),_t=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}(_t||{}),vt=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}(vt||{});function BO(e,n,t,r){let i=zO(e);n=zi(t,n)||n;let s=[],a;for(;n;)if(a=RO.exec(n),a){s=s.concat(a.slice(1));let h=s.pop();if(!h)break;n=h}else{s.push(n);break}let c=i.getTimezoneOffset();r&&(c=v_(r,c),i=WO(i,r,!0));let d="";return s.forEach(h=>{let p=$O(h);d+=p?p(i,t,c):h==="''"?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),d}function b0(e,n,t){let r=new Date(0);return r.setFullYear(e,n,t),r.setHours(0,0,0),r}function zi(e,n){let t=AO(e);if(E0[t]??={},E0[t][n])return E0[t][n];let r="";switch(n){case"shortDate":r=m0(e,Mr.Short);break;case"mediumDate":r=m0(e,Mr.Medium);break;case"longDate":r=m0(e,Mr.Long);break;case"fullDate":r=m0(e,Mr.Full);break;case"shortTime":r=g0(e,Mr.Short);break;case"mediumTime":r=g0(e,Mr.Medium);break;case"longTime":r=g0(e,Mr.Long);break;case"fullTime":r=g0(e,Mr.Full);break;case"short":let i=zi(e,"shortTime"),o=zi(e,"shortDate");r=v0(x0(e,Mr.Short),[i,o]);break;case"medium":let s=zi(e,"mediumTime"),a=zi(e,"mediumDate");r=v0(x0(e,Mr.Medium),[s,a]);break;case"long":let c=zi(e,"longTime"),d=zi(e,"longDate");r=v0(x0(e,Mr.Long),[c,d]);break;case"full":let h=zi(e,"fullTime"),p=zi(e,"fullDate");r=v0(x0(e,Mr.Full),[h,p]);break}return r&&(E0[t][n]=r),r}function v0(e,n){return n&&(e=e.replace(/\{([^}]+)}/g,function(t,r){return n!=null&&r in n?n[r]:t})),e}function ai(e,n,t="-",r,i){let o="";(e<0||i&&e<=0)&&(i?e=-e+1:(e=-e,o=t));let s=String(e);for(;s.length<n;)s="0"+s;return r&&(s=s.slice(s.length-n)),o+s}function LO(e,n){return ai(e,3).substring(0,n)}function ln(e,n,t=0,r=!1,i=!1){return function(o,s){let a=VO(e,o);if((t>0||a>-t)&&(a+=t),e===_t.Hours)a===0&&t===-12&&(a=12);else if(e===_t.FractionalSeconds)return LO(a,n);let c=D0(s,Oo.MinusSign);return ai(a,n,c,r,i)}}function VO(e,n){switch(e){case _t.FullYear:return n.getFullYear();case _t.Month:return n.getMonth();case _t.Date:return n.getDate();case _t.Hours:return n.getHours();case _t.Minutes:return n.getMinutes();case _t.Seconds:return n.getSeconds();case _t.FractionalSeconds:return n.getMilliseconds();case _t.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${e}".`)}}function Tt(e,n,t=rr.Format,r=!1){return function(i,o){return UO(i,o,e,n,t,r)}}function UO(e,n,t,r,i,o){switch(t){case vt.Months:return IO(n,i,r)[e.getMonth()];case vt.Days:return OO(n,i,r)[e.getDay()];case vt.DayPeriods:let s=e.getHours(),a=e.getMinutes();if(o){let d=PO(n),h=FO(n,i,r),p=d.findIndex(g=>{if(Array.isArray(g)){let[x,v]=g,E=s>=x.hours&&a>=x.minutes,_=s<v.hours||s===v.hours&&a<v.minutes;if(x.hours<v.hours){if(E&&_)return!0}else if(E||_)return!0}else if(g.hours===s&&g.minutes===a)return!0;return!1});if(p!==-1)return h[p]}return TO(n,i,r)[s<12?0:1];case vt.Eras:return kO(n,r)[e.getFullYear()<=0?0:1];default:let c=t;throw new Error(`unexpected translation type ${c}`)}}function _0(e){return function(n,t,r){let i=-1*r,o=D0(t,Oo.MinusSign),s=i>0?Math.floor(i/60):Math.ceil(i/60);switch(e){case Qi.Short:return(i>=0?"+":"")+ai(s,2,o)+ai(Math.abs(i%60),2,o);case Qi.ShortGMT:return"GMT"+(i>=0?"+":"")+ai(s,1,o);case Qi.Long:return"GMT"+(i>=0?"+":"")+ai(s,2,o)+":"+ai(Math.abs(i%60),2,o);case Qi.Extended:return r===0?"Z":(i>=0?"+":"")+ai(s,2,o)+":"+ai(Math.abs(i%60),2,o);default:throw new Error(`Unknown zone width "${e}"`)}}}var jO=0,y0=4;function HO(e){let n=b0(e,jO,1).getDay();return b0(e,0,1+(n<=y0?y0:y0+7)-n)}function E_(e){let n=e.getDay(),t=n===0?-3:y0-n;return b0(e.getFullYear(),e.getMonth(),e.getDate()+t)}function jp(e,n=!1){return function(t,r){let i;if(n){let o=new Date(t.getFullYear(),t.getMonth(),1).getDay()-1,s=t.getDate();i=1+Math.floor((s+o)/7)}else{let o=E_(t),s=HO(o.getFullYear()),a=o.getTime()-s.getTime();i=1+Math.round(a/6048e5)}return ai(i,e,D0(r,Oo.MinusSign))}}function C0(e,n=!1){return function(t,r){let o=E_(t).getFullYear();return ai(o,e,D0(r,Oo.MinusSign),n)}}var Hp={};function $O(e){if(Hp[e])return Hp[e];let n;switch(e){case"G":case"GG":case"GGG":n=Tt(vt.Eras,Mt.Abbreviated);break;case"GGGG":n=Tt(vt.Eras,Mt.Wide);break;case"GGGGG":n=Tt(vt.Eras,Mt.Narrow);break;case"y":n=ln(_t.FullYear,1,0,!1,!0);break;case"yy":n=ln(_t.FullYear,2,0,!0,!0);break;case"yyy":n=ln(_t.FullYear,3,0,!1,!0);break;case"yyyy":n=ln(_t.FullYear,4,0,!1,!0);break;case"Y":n=C0(1);break;case"YY":n=C0(2,!0);break;case"YYY":n=C0(3);break;case"YYYY":n=C0(4);break;case"M":case"L":n=ln(_t.Month,1,1);break;case"MM":case"LL":n=ln(_t.Month,2,1);break;case"MMM":n=Tt(vt.Months,Mt.Abbreviated);break;case"MMMM":n=Tt(vt.Months,Mt.Wide);break;case"MMMMM":n=Tt(vt.Months,Mt.Narrow);break;case"LLL":n=Tt(vt.Months,Mt.Abbreviated,rr.Standalone);break;case"LLLL":n=Tt(vt.Months,Mt.Wide,rr.Standalone);break;case"LLLLL":n=Tt(vt.Months,Mt.Narrow,rr.Standalone);break;case"w":n=jp(1);break;case"ww":n=jp(2);break;case"W":n=jp(1,!0);break;case"d":n=ln(_t.Date,1);break;case"dd":n=ln(_t.Date,2);break;case"c":case"cc":n=ln(_t.Day,1);break;case"ccc":n=Tt(vt.Days,Mt.Abbreviated,rr.Standalone);break;case"cccc":n=Tt(vt.Days,Mt.Wide,rr.Standalone);break;case"ccccc":n=Tt(vt.Days,Mt.Narrow,rr.Standalone);break;case"cccccc":n=Tt(vt.Days,Mt.Short,rr.Standalone);break;case"E":case"EE":case"EEE":n=Tt(vt.Days,Mt.Abbreviated);break;case"EEEE":n=Tt(vt.Days,Mt.Wide);break;case"EEEEE":n=Tt(vt.Days,Mt.Narrow);break;case"EEEEEE":n=Tt(vt.Days,Mt.Short);break;case"a":case"aa":case"aaa":n=Tt(vt.DayPeriods,Mt.Abbreviated);break;case"aaaa":n=Tt(vt.DayPeriods,Mt.Wide);break;case"aaaaa":n=Tt(vt.DayPeriods,Mt.Narrow);break;case"b":case"bb":case"bbb":n=Tt(vt.DayPeriods,Mt.Abbreviated,rr.Standalone,!0);break;case"bbbb":n=Tt(vt.DayPeriods,Mt.Wide,rr.Standalone,!0);break;case"bbbbb":n=Tt(vt.DayPeriods,Mt.Narrow,rr.Standalone,!0);break;case"B":case"BB":case"BBB":n=Tt(vt.DayPeriods,Mt.Abbreviated,rr.Format,!0);break;case"BBBB":n=Tt(vt.DayPeriods,Mt.Wide,rr.Format,!0);break;case"BBBBB":n=Tt(vt.DayPeriods,Mt.Narrow,rr.Format,!0);break;case"h":n=ln(_t.Hours,1,-12);break;case"hh":n=ln(_t.Hours,2,-12);break;case"H":n=ln(_t.Hours,1);break;case"HH":n=ln(_t.Hours,2);break;case"m":n=ln(_t.Minutes,1);break;case"mm":n=ln(_t.Minutes,2);break;case"s":n=ln(_t.Seconds,1);break;case"ss":n=ln(_t.Seconds,2);break;case"S":n=ln(_t.FractionalSeconds,1);break;case"SS":n=ln(_t.FractionalSeconds,2);break;case"SSS":n=ln(_t.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=_0(Qi.Short);break;case"ZZZZZ":n=_0(Qi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=_0(Qi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=_0(Qi.Long);break;default:return null}return Hp[e]=n,n}function v_(e,n){e=e.replace(/:/g,"");let t=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(t)?n:t}function qO(e,n){return e=new Date(e.getTime()),e.setMinutes(e.getMinutes()+n),e}function WO(e,n,t){let r=t?-1:1,i=e.getTimezoneOffset(),o=v_(n,i);return qO(e,r*(o-i))}function zO(e){if(c_(e))return e;if(typeof e=="number"&&!isNaN(e))return new Date(e);if(typeof e=="string"){if(e=e.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(e)){let[i,o=1,s=1]=e.split("-").map(a=>+a);return b0(i,o-1,s)}let t=parseFloat(e);if(!isNaN(e-t))return new Date(t);let r;if(r=e.match(NO))return GO(r)}let n=new Date(e);if(!c_(n))throw new Error(`Unable to convert "${e}" into a date`);return n}function GO(e){let n=new Date(0),t=0,r=0,i=e[8]?n.setUTCFullYear:n.setFullYear,o=e[8]?n.setUTCHours:n.setHours;e[9]&&(t=Number(e[9]+e[10]),r=Number(e[9]+e[11])),i.call(n,Number(e[1]),Number(e[2])-1,Number(e[3]));let s=Number(e[4]||0)-t,a=Number(e[5]||0)-r,c=Number(e[6]||0),d=Math.floor(parseFloat("0."+(e[7]||0))*1e3);return o.call(n,s,a,c,d),n}function c_(e){return e instanceof Date&&!isNaN(e.valueOf())}function S0(e,n){n=encodeURIComponent(n);for(let t of e.split(";")){let r=t.indexOf("="),[i,o]=r==-1?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===n)return decodeURIComponent(o)}return null}var $p=/\s+/,u_=[],hr=(()=>{class e{constructor(t,r){this._ngEl=t,this._renderer=r,this.initialClasses=u_,this.stateMap=new Map}set klass(t){this.initialClasses=t!=null?t.trim().split($p):u_}set ngClass(t){this.rawClass=typeof t=="string"?t.trim().split($p):t}ngDoCheck(){for(let r of this.initialClasses)this._updateState(r,!0);let t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(let r of t)this._updateState(r,!0);else if(t!=null)for(let r of Object.keys(t))this._updateState(r,!!t[r]);this._applyStateDiff()}_updateState(t,r){let i=this.stateMap.get(t);i!==void 0?(i.enabled!==r&&(i.changed=!0,i.enabled=r),i.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(let t of this.stateMap){let r=t[0],i=t[1];i.changed?(this._toggleClass(r,i.enabled),i.changed=!1):i.touched||(i.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),i.touched=!1}}_toggleClass(t,r){t=t.trim(),t.length>0&&t.split($p).forEach(i=>{r?this._renderer.addClass(this._ngEl.nativeElement,i):this._renderer.removeClass(this._ngEl.nativeElement,i)})}static{this.\u0275fac=function(r){return new(r||e)(Q(er),Q(si))}}static{this.\u0275dir=bt({type:e,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"},standalone:!0})}}return e})();var qp=class{constructor(n,t,r,i){this.$implicit=n,this.ngForOf=t,this.index=r,this.count=i}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},lt=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let t=this._ngForOf;if(!this._differ&&t)if(0)try{}catch{}else this._differ=this._differs.find(t).create(this.ngForTrackBy)}if(this._differ){let t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){let r=this._viewContainer;t.forEachOperation((i,o,s)=>{if(i.previousIndex==null)r.createEmbeddedView(this._template,new qp(i.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)r.remove(o===null?void 0:o);else if(o!==null){let a=r.get(o);r.move(a,s),l_(a,i)}});for(let i=0,o=r.length;i<o;i++){let a=r.get(i).context;a.index=i,a.count=o,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{let o=r.get(i.currentIndex);l_(o,i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||e)(Q(bo),Q(cs),Q(Vp))}}static{this.\u0275dir=bt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return e})();function l_(e,n){e.context.$implicit=n.item}var We=(()=>{class e{constructor(t,r){this._viewContainer=t,this._context=new Wp,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){d_("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){d_("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||e)(Q(bo),Q(cs))}}static{this.\u0275dir=bt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return e})(),Wp=class{constructor(){this.$implicit=null,this.ngIf=null}};function d_(e,n){if(!!!(!n||n.createEmbeddedView))throw new Error(`${e} must be a TemplateRef, but received '${Zn(n)}'.`)}function QO(e,n){return new Ne(2100,!1)}var XO="mediumDate",YO=new Ie(""),KO=new Ie(""),pr=(()=>{class e{constructor(t,r,i){this.locale=t,this.defaultTimezone=r,this.defaultOptions=i}transform(t,r,i,o){if(t==null||t===""||t!==t)return null;try{let s=r??this.defaultOptions?.dateFormat??XO,a=i??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return BO(t,s,o||this.locale,a)}catch(s){throw QO(e,s.message)}}static{this.\u0275fac=function(r){return new(r||e)(Q(p0,16),Q(YO,24),Q(KO,24))}}static{this.\u0275pipe=Zx({name:"date",type:e,pure:!0,standalone:!0})}}return e})();var Ue=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=ni({type:e})}static{this.\u0275inj=ti({})}}return e})(),Zp="browser",ZO="server";function JO(e){return e===Zp}function M0(e){return e===ZO}var __=(()=>{class e{static{this.\u0275prov=Ae({token:e,providedIn:"root",factory:()=>JO(ue(bi))?new zp(ue(Un),window):new Gp})}}return e})(),zp=class{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){Array.isArray(n)?this.offset=()=>n:this.offset=n}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(n){this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){let t=eI(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){this.window.history.scrollRestoration=n}scrollToElement(n){let t=n.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(r-o[0],i-o[1])}};function eI(e,n){let t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if(typeof e.createTreeWalker=="function"&&e.body&&typeof e.body.attachShadow=="function"){let r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT),i=r.currentNode;for(;i;){let o=i.shadowRoot;if(o){let s=o.getElementById(n)||o.querySelector(`[name="${n}"]`);if(s)return s}i=r.nextNode()}}return null}var Gp=class{setOffset(n){}getScrollPosition(){return[0,0]}scrollToPosition(n){}scrollToAnchor(n){}setHistoryScrollRestoration(n){}},fa=class{};var gc=class{},T0=class{},Bt=class e{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?typeof n=="string"?this.lazyInit=()=>{this.headers=new Map,n.split(`
`).forEach(t=>{let r=t.indexOf(":");if(r>0){let i=t.slice(0,r),o=i.toLowerCase(),s=t.slice(r+1).trim();this.maybeSetNormalizedName(i,o),this.headers.has(o)?this.headers.get(o).push(s):this.headers.set(o,[s])}})}:typeof Headers<"u"&&n instanceof Headers?(this.headers=new Map,n.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(n).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();let t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof e?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){let t=new e;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof e?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){let t=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if(typeof r=="string"&&(r=[r]),r.length===0)return;this.maybeSetNormalizedName(n.name,t);let i=(n.op==="a"?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":let o=n.value;if(!o)this.headers.delete(t),this.normalizedNames.delete(t);else{let s=this.headers.get(t);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,s)}break}}setHeaderEntries(n,t){let r=(Array.isArray(t)?t:[t]).map(o=>o.toString()),i=n.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(n,i)}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}};var em=class{encodeKey(n){return C_(n)}encodeValue(n){return C_(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}};function tI(e,n){let t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(i=>{let o=i.indexOf("="),[s,a]=o==-1?[n.decodeKey(i),""]:[n.decodeKey(i.slice(0,o)),n.decodeValue(i.slice(o+1))],c=t.get(s)||[];c.push(a),t.set(s,c)}),t}var nI=/%(\d[a-f0-9])/gi,rI={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function C_(e){return encodeURIComponent(e).replace(nI,(n,t)=>rI[t]??n)}function A0(e){return`${e}`}var ko=class e{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new em,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=tI(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{let r=n.fromObject[t],i=Array.isArray(r)?r.map(A0):[A0(r)];this.map.set(t,i)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();let t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){let t=[];return Object.keys(n).forEach(r=>{let i=n[r];Array.isArray(i)?i.forEach(o=>{t.push({param:r,value:o,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{let t=this.encoder.encodeKey(n);return this.map.get(n).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>n!=="").join("&")}clone(n){let t=new e({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":let t=(n.op==="a"?this.map.get(n.param):void 0)||[];t.push(A0(n.value)),this.map.set(n.param,t);break;case"d":if(n.value!==void 0){let r=this.map.get(n.param)||[],i=r.indexOf(A0(n.value));i!==-1&&r.splice(i,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}else{this.map.delete(n.param);break}}}),this.cloneFrom=this.updates=null)}};var tm=class{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}};function iI(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function y_(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function w_(e){return typeof Blob<"u"&&e instanceof Blob}function b_(e){return typeof FormData<"u"&&e instanceof FormData}function oI(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}var mc=class e{constructor(n,t,r,i){this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase();let o;if(iI(this.method)||i?(this.body=r!==void 0?r:null,o=i):o=r,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Bt,this.context??=new tm,!this.params)this.params=new ko,this.urlWithParams=t;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=t;else{let a=t.indexOf("?"),c=a===-1?"?":a<t.length-1?"&":"";this.urlWithParams=t+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||y_(this.body)||w_(this.body)||b_(this.body)||oI(this.body)?this.body:this.body instanceof ko?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||b_(this.body)?null:w_(this.body)?this.body.type||null:y_(this.body)?null:typeof this.body=="string"?"text/plain":this.body instanceof ko?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?"application/json":null}clone(n={}){let t=n.method||this.method,r=n.url||this.url,i=n.responseType||this.responseType,o=n.transferCache??this.transferCache,s=n.body!==void 0?n.body:this.body,a=n.withCredentials??this.withCredentials,c=n.reportProgress??this.reportProgress,d=n.headers||this.headers,h=n.params||this.params,p=n.context??this.context;return n.setHeaders!==void 0&&(d=Object.keys(n.setHeaders).reduce((g,x)=>g.set(x,n.setHeaders[x]),d)),n.setParams&&(h=Object.keys(n.setParams).reduce((g,x)=>g.set(x,n.setParams[x]),h)),new e(t,r,s,{params:h,headers:d,context:p,reportProgress:c,responseType:i,withCredentials:a,transferCache:o})}},Po=function(e){return e[e.Sent=0]="Sent",e[e.UploadProgress=1]="UploadProgress",e[e.ResponseHeader=2]="ResponseHeader",e[e.DownloadProgress=3]="DownloadProgress",e[e.Response=4]="Response",e[e.User=5]="User",e}(Po||{}),xc=class{constructor(n,t=200,r="OK"){this.headers=n.headers||new Bt,this.status=n.status!==void 0?n.status:t,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}},O0=class e extends xc{constructor(n={}){super(n),this.type=Po.ResponseHeader}clone(n={}){return new e({headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Ec=class e extends xc{constructor(n={}){super(n),this.type=Po.Response,this.body=n.body!==void 0?n.body:null}clone(n={}){return new e({body:n.body!==void 0?n.body:this.body,headers:n.headers||this.headers,status:n.status!==void 0?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}},Io=class extends xc{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${n.url||"(unknown url)"}`:this.message=`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}},T_=200,sI=204;function Jp(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials,transferCache:e.transferCache}}var Ki=(()=>{class e{constructor(t){this.handler=t}request(t,r,i={}){let o;if(t instanceof mc)o=t;else{let c;i.headers instanceof Bt?c=i.headers:c=new Bt(i.headers);let d;i.params&&(i.params instanceof ko?d=i.params:d=new ko({fromObject:i.params})),o=new mc(t,r,i.body!==void 0?i.body:null,{headers:c,context:i.context,params:d,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials,transferCache:i.transferCache})}let s=Le(o).pipe(Li(c=>this.handler.handle(c)));if(t instanceof mc||i.observe==="events")return s;let a=s.pipe(Bn(c=>c instanceof Ec));switch(i.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(Xe(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return c.body}));case"blob":return a.pipe(Xe(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new Error("Response is not a Blob.");return c.body}));case"text":return a.pipe(Xe(c=>{if(c.body!==null&&typeof c.body!="string")throw new Error("Response is not a string.");return c.body}));case"json":default:return a.pipe(Xe(c=>c.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:new ko().append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,Jp(i,r))}post(t,r,i={}){return this.request("POST",t,Jp(i,r))}put(t,r,i={}){return this.request("PUT",t,Jp(i,r))}static{this.\u0275fac=function(r){return new(r||e)(ke(gc))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),aI=/^\)\]\}',?\n/,cI="X-Request-URL";function D_(e){if(e.url)return e.url;let n=cI.toLocaleLowerCase();return e.headers.get(n)}var uI=(()=>{class e{constructor(){this.fetchImpl=ue(nm,{optional:!0})?.fetch??((...t)=>globalThis.fetch(...t)),this.ngZone=ue(qt)}handle(t){return new ct(r=>{let i=new AbortController;return this.doRequest(t,i.signal,r).then(rm,o=>r.error(new Io({error:o}))),()=>i.abort()})}doRequest(t,r,i){return Au(this,null,function*(){let o=this.createRequestInit(t),s;try{let x=this.ngZone.runOutsideAngular(()=>this.fetchImpl(t.urlWithParams,de({signal:r},o)));lI(x),i.next({type:Po.Sent}),s=yield x}catch(x){i.error(new Io({error:x,status:x.status??0,statusText:x.statusText,url:t.urlWithParams,headers:x.headers}));return}let a=new Bt(s.headers),c=s.statusText,d=D_(s)??t.urlWithParams,h=s.status,p=null;if(t.reportProgress&&i.next(new O0({headers:a,status:h,statusText:c,url:d})),s.body){let x=s.headers.get("content-length"),v=[],E=s.body.getReader(),_=0,M,I,y=typeof Zone<"u"&&Zone.current;yield this.ngZone.runOutsideAngular(()=>Au(this,null,function*(){for(;;){let{done:ee,value:R}=yield E.read();if(ee)break;if(v.push(R),_+=R.length,t.reportProgress){I=t.responseType==="text"?(I??"")+(M??=new TextDecoder).decode(R,{stream:!0}):void 0;let k=()=>i.next({type:Po.DownloadProgress,total:x?+x:void 0,loaded:_,partialText:I});y?y.run(k):k()}}}));let q=this.concatChunks(v,_);try{let ee=s.headers.get("Content-Type")??"";p=this.parseBody(t,q,ee)}catch(ee){i.error(new Io({error:ee,headers:new Bt(s.headers),status:s.status,statusText:s.statusText,url:D_(s)??t.urlWithParams}));return}}h===0&&(h=p?T_:0),h>=200&&h<300?(i.next(new Ec({body:p,headers:a,status:h,statusText:c,url:d})),i.complete()):i.error(new Io({error:p,headers:a,status:h,statusText:c,url:d}))})}parseBody(t,r,i){switch(t.responseType){case"json":let o=new TextDecoder().decode(r).replace(aI,"");return o===""?null:JSON.parse(o);case"text":return new TextDecoder().decode(r);case"blob":return new Blob([r],{type:i});case"arraybuffer":return r.buffer}}createRequestInit(t){let r={},i=t.withCredentials?"include":void 0;if(t.headers.forEach((o,s)=>r[o]=s.join(",")),t.headers.has("Accept")||(r.Accept="application/json, text/plain, */*"),!t.headers.has("Content-Type")){let o=t.detectContentTypeHeader();o!==null&&(r["Content-Type"]=o)}return{body:t.serializeBody(),method:t.method,headers:r,credentials:i}}concatChunks(t,r){let i=new Uint8Array(r),o=0;for(let s of t)i.set(s,o),o+=s.length;return i}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),nm=class{};function rm(){}function lI(e){e.then(rm,rm)}function O_(e,n){return n(e)}function dI(e,n){return(t,r)=>n.intercept(t,{handle:i=>e(i,r)})}function fI(e,n,t){return(r,i)=>Br(t,()=>n(r,o=>e(o,i)))}var hI=new Ie(""),im=new Ie(""),pI=new Ie(""),I_=new Ie("",{providedIn:"root",factory:()=>!0});function mI(){let e=null;return(n,t)=>{e===null&&(e=(ue(hI,{optional:!0})??[]).reduceRight(dI,O_));let r=ue(Wi);if(ue(I_)){let o=r.add();return e(n,t).pipe(ho(()=>r.remove(o)))}else return e(n,t)}}var S_=(()=>{class e extends gc{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=ue(Wi),this.contributeToStability=ue(I_)}handle(t){if(this.chain===null){let r=Array.from(new Set([...this.injector.get(im),...this.injector.get(pI,[])]));this.chain=r.reduceRight((i,o)=>fI(i,o,this.injector),O_)}if(this.contributeToStability){let r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(ho(()=>this.pendingTasks.remove(r)))}else return this.chain(t,r=>this.backend.handle(r))}static{this.\u0275fac=function(r){return new(r||e)(ke(T0),ke(Jn))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})();var gI=/^\)\]\}',?\n/;function xI(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}var M_=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if(t.method==="JSONP")throw new Ne(-2800,!1);let r=this.xhrFactory;return(r.\u0275loadImpl?At(r.\u0275loadImpl()):Le(null)).pipe(lr(()=>new ct(o=>{let s=r.build();if(s.open(t.method,t.urlWithParams),t.withCredentials&&(s.withCredentials=!0),t.headers.forEach((E,_)=>s.setRequestHeader(E,_.join(","))),t.headers.has("Accept")||s.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){let E=t.detectContentTypeHeader();E!==null&&s.setRequestHeader("Content-Type",E)}if(t.responseType){let E=t.responseType.toLowerCase();s.responseType=E!=="json"?E:"text"}let a=t.serializeBody(),c=null,d=()=>{if(c!==null)return c;let E=s.statusText||"OK",_=new Bt(s.getAllResponseHeaders()),M=xI(s)||t.url;return c=new O0({headers:_,status:s.status,statusText:E,url:M}),c},h=()=>{let{headers:E,status:_,statusText:M,url:I}=d(),y=null;_!==sI&&(y=typeof s.response>"u"?s.responseText:s.response),_===0&&(_=y?T_:0);let q=_>=200&&_<300;if(t.responseType==="json"&&typeof y=="string"){let ee=y;y=y.replace(gI,"");try{y=y!==""?JSON.parse(y):null}catch(R){y=ee,q&&(q=!1,y={error:R,text:y})}}q?(o.next(new Ec({body:y,headers:E,status:_,statusText:M,url:I||void 0})),o.complete()):o.error(new Io({error:y,headers:E,status:_,statusText:M,url:I||void 0}))},p=E=>{let{url:_}=d(),M=new Io({error:E,status:s.status||0,statusText:s.statusText||"Unknown Error",url:_||void 0});o.error(M)},g=!1,x=E=>{g||(o.next(d()),g=!0);let _={type:Po.DownloadProgress,loaded:E.loaded};E.lengthComputable&&(_.total=E.total),t.responseType==="text"&&s.responseText&&(_.partialText=s.responseText),o.next(_)},v=E=>{let _={type:Po.UploadProgress,loaded:E.loaded};E.lengthComputable&&(_.total=E.total),o.next(_)};return s.addEventListener("load",h),s.addEventListener("error",p),s.addEventListener("timeout",p),s.addEventListener("abort",p),t.reportProgress&&(s.addEventListener("progress",x),a!==null&&s.upload&&s.upload.addEventListener("progress",v)),s.send(a),o.next({type:Po.Sent}),()=>{s.removeEventListener("error",p),s.removeEventListener("abort",p),s.removeEventListener("load",h),s.removeEventListener("timeout",p),t.reportProgress&&(s.removeEventListener("progress",x),a!==null&&s.upload&&s.upload.removeEventListener("progress",v)),s.readyState!==s.DONE&&s.abort()}})))}static{this.\u0275fac=function(r){return new(r||e)(ke(fa))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),k_=new Ie(""),EI="XSRF-TOKEN",vI=new Ie("",{providedIn:"root",factory:()=>EI}),_I="X-XSRF-TOKEN",CI=new Ie("",{providedIn:"root",factory:()=>_I}),I0=class{},yI=(()=>{class e{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if(this.platform==="server")return null;let t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=S0(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(r){return new(r||e)(ke(Un),ke(bi),ke(vI))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})();function wI(e,n){let t=e.url.toLowerCase();if(!ue(k_)||e.method==="GET"||e.method==="HEAD"||t.startsWith("http://")||t.startsWith("https://"))return n(e);let r=ue(I0).getToken(),i=ue(CI);return r!=null&&!e.headers.has(i)&&(e=e.clone({headers:e.headers.set(i,r)})),n(e)}var P_=function(e){return e[e.Interceptors=0]="Interceptors",e[e.LegacyInterceptors=1]="LegacyInterceptors",e[e.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",e[e.NoXsrfProtection=3]="NoXsrfProtection",e[e.JsonpSupport=4]="JsonpSupport",e[e.RequestsMadeViaParent=5]="RequestsMadeViaParent",e[e.Fetch=6]="Fetch",e}(P_||{});function bI(e,n){return{\u0275kind:e,\u0275providers:n}}function om(...e){let n=[Ki,M_,S_,{provide:gc,useExisting:S_},{provide:T0,useFactory:()=>ue(uI,{optional:!0})??ue(M_)},{provide:im,useValue:wI,multi:!0},{provide:k_,useValue:!0},{provide:I0,useClass:yI}];for(let t of e)n.push(...t.\u0275providers);return lc(n)}var A_=new Ie("");function DI(){return bI(P_.LegacyInterceptors,[{provide:A_,useFactory:mI},{provide:im,useExisting:A_,multi:!0}])}var F_=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=ni({type:e})}static{this.\u0275inj=ti({providers:[om(DI())]})}}return e})();var cm=class extends w0{constructor(){super(...arguments),this.supportsDOMEvents=!0}},um=class e extends cm{static makeCurrent(){h_(new e)}onAndCancel(n,t,r){return n.addEventListener(t,r),()=>{n.removeEventListener(t,r)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.remove()}createElement(n,t){return t=t||this.getDefaultDocument(),t.createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return t==="window"?window:t==="document"?n:t==="body"?n.body:null}getBaseHref(n){let t=SI();return t==null?null:MI(t)}resetBaseElement(){vc=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return S0(document.cookie,n)}},vc=null;function SI(){return vc=vc||document.querySelector("base"),vc?vc.getAttribute("href"):null}function MI(e){return new URL(e,document.baseURI).pathname}var AI=(()=>{class e{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),lm=new Ie(""),L_=(()=>{class e{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(o=>o.supports(t)),!r)throw new Ne(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||e)(ke(lm),ke(qt))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),P0=class{constructor(n){this._doc=n}},sm="ng-app-id",V_=(()=>{class e{constructor(t,r,i,o={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=M0(o),this.resetHostNodes()}addStyles(t){for(let r of t)this.changeUsageCount(r,1)===1&&this.onStyleAdded(r)}removeStyles(t){for(let r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){let t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(let r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(let r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(let r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){let r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){let t=this.doc.head?.querySelectorAll(`style[${sm}="${this.appId}"]`);if(t?.length){let r=new Map;return t.forEach(i=>{i.textContent!=null&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){let i=this.styleRef;if(i.has(t)){let o=i.get(t);return o.usage+=r,o.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){let i=this.styleNodesInDOM,o=i?.get(r);if(o?.parentNode===t)return i.delete(r),o.removeAttribute(sm),o;{let s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=r,this.platformIsServer&&s.setAttribute(sm,this.appId),t.appendChild(s),s}}addStyleToHost(t,r){let i=this.getStyleElement(t,r),o=this.styleRef,s=o.get(r)?.elements;s?s.push(i):o.set(r,{elements:[i],usage:1})}resetHostNodes(){let t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||e)(ke(Un),ke(xp),ke(vp,8),ke(bi))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),am={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},fm=/%COMP%/g,U_="%COMP%",TI=`_nghost-${U_}`,OI=`_ngcontent-${U_}`,II=!0,kI=new Ie("",{providedIn:"root",factory:()=>II});function PI(e){return OI.replace(fm,e)}function FI(e){return TI.replace(fm,e)}function j_(e,n){return n.map(t=>t.replace(fm,e))}var N_=(()=>{class e{constructor(t,r,i,o,s,a,c,d=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=M0(a),this.defaultRenderer=new _c(t,s,c,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===_i.ShadowDom&&(r=qe(de({},r),{encapsulation:_i.Emulated}));let i=this.getOrCreateRenderer(t,r);return i instanceof F0?i.applyToHost(t):i instanceof Cc&&i.applyStyles(),i}getOrCreateRenderer(t,r){let i=this.rendererByCompId,o=i.get(r.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,d=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case _i.Emulated:o=new F0(c,d,r,this.appId,h,s,a,p);break;case _i.ShadowDom:return new dm(c,d,t,r,s,a,this.nonce,p);default:o=new Cc(c,d,r,h,s,a,p);break}i.set(r.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||e)(ke(L_),ke(V_),ke(xp),ke(kI),ke(Un),ke(bi),ke(qt),ke(vp))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),_c=class{constructor(n,t,r,i){this.eventManager=n,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,t){return t?this.doc.createElementNS(am[t]||t,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,t){(R_(n)?n.content:n).appendChild(t)}insertBefore(n,t,r){n&&(R_(n)?n.content:n).insertBefore(t,r)}removeChild(n,t){t.remove()}selectRootElement(n,t){let r=typeof n=="string"?this.doc.querySelector(n):n;if(!r)throw new Ne(-5104,!1);return t||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,r,i){if(i){t=i+":"+t;let o=am[i];o?n.setAttributeNS(o,t,r):n.setAttribute(t,r)}else n.setAttribute(t,r)}removeAttribute(n,t,r){if(r){let i=am[r];i?n.removeAttributeNS(i,t):n.removeAttribute(`${r}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,r,i){i&(Hi.DashCase|Hi.Important)?n.style.setProperty(t,r,i&Hi.Important?"important":""):n.style[t]=r}removeStyle(n,t,r){r&Hi.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,r){n!=null&&(n[t]=r)}setValue(n,t){n.nodeValue=t}listen(n,t,r){if(typeof n=="string"&&(n=Xi().getGlobalEventTarget(this.doc,n),!n))throw new Error(`Unsupported event target ${n} for event ${t}`);return this.eventManager.addEventListener(n,t,this.decoratePreventDefault(r))}decoratePreventDefault(n){return t=>{if(t==="__ngUnwrap__")return n;(this.platformIsServer?this.ngZone.runGuarded(()=>n(t)):n(t))===!1&&t.preventDefault()}}};function R_(e){return e.tagName==="TEMPLATE"&&e.content!==void 0}var dm=class extends _c{constructor(n,t,r,i,o,s,a,c){super(n,o,s,c),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let d=j_(i.id,i.styles);for(let h of d){let p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=h,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,r){return super.insertBefore(this.nodeOrShadowRoot(n),t,r)}removeChild(n,t){return super.removeChild(null,t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Cc=class extends _c{constructor(n,t,r,i,o,s,a,c){super(n,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?j_(c,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},F0=class extends Cc{constructor(n,t,r,i,o,s,a,c){let d=i+"-"+r.id;super(n,t,r,o,s,a,c,d),this.contentAttr=PI(d),this.hostAttr=FI(d)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){let r=super.createElement(n,t);return super.setAttribute(r,this.contentAttr,""),r}},NI=(()=>{class e extends P0{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||e)(ke(Un))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})(),B_=["alt","control","meta","shift"],RI={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},BI={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey},LI=(()=>{class e extends P0{constructor(t){super(t)}supports(t){return e.parseEventName(t)!=null}addEventListener(t,r,i){let o=e.parseEventName(r),s=e.eventCallback(o.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Xi().onAndCancel(t,o.domEventName,s))}static parseEventName(t){let r=t.toLowerCase().split("."),i=r.shift();if(r.length===0||!(i==="keydown"||i==="keyup"))return null;let o=e._normalizeKey(r.pop()),s="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),s="code."),B_.forEach(d=>{let h=r.indexOf(d);h>-1&&(r.splice(h,1),s+=d+".")}),s+=o,r.length!=0||o.length===0)return null;let c={};return c.domEventName=i,c.fullKey=s,c}static matchEventFullKeyCode(t,r){let i=RI[t.key]||t.key,o="";return r.indexOf("code.")>-1&&(i=t.code,o="code."),i==null||!i?!1:(i=i.toLowerCase(),i===" "?i="space":i==="."&&(i="dot"),B_.forEach(s=>{if(s!==i){let a=BI[s];a(t)&&(o+=s+".")}}),o+=i,o===r)}static eventCallback(t,r,i){return o=>{e.matchEventFullKeyCode(o,t)&&i.runGuarded(()=>r(o))}}static _normalizeKey(t){return t==="esc"?"escape":t}static{this.\u0275fac=function(r){return new(r||e)(ke(Un))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})();function H_(e,n){return i_(de({rootComponent:e},VI(n)))}function VI(e){return{appProviders:[...qI,...e?.providers??[]],platformProviders:$I}}function UI(){um.makeCurrent()}function jI(){return new ji}function HI(){return JE(document),document}var $I=[{provide:bi,useValue:Zp},{provide:Ep,useValue:UI,multi:!0},{provide:Un,useFactory:HI,deps:[]}];var qI=[{provide:ql,useValue:"root"},{provide:ji,useFactory:jI,deps:[]},{provide:lm,useClass:NI,multi:!0,deps:[Un,qt,bi]},{provide:lm,useClass:LI,multi:!0,deps:[Un]},N_,V_,L_,{provide:na,useExisting:N_},{provide:fa,useClass:AI,deps:[]},[]];var $_=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||e)(ke(Un))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Je="primary",Rc=Symbol("RouteTitle"),xm=class{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){let t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){let t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function va(e){return new xm(e)}function zI(e,n,t){let r=t.path.split("/");if(r.length>e.length||t.pathMatch==="full"&&(n.hasChildren()||r.length<e.length))return null;let i={};for(let o=0;o<r.length;o++){let s=r[o],a=e[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:e.slice(0,r.length),posParams:i}}function GI(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!Si(e[t],n[t]))return!1;return!0}function Si(e,n){let t=e?Em(e):void 0,r=n?Em(n):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!eC(e[i],n[i]))return!1;return!0}function Em(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}function eC(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;let t=[...e].sort(),r=[...n].sort();return t.every((i,o)=>r[o]===i)}else return e===n}function tC(e){return e.length>0?e[e.length-1]:null}function No(e){return Bf(e)?e:hs(e)?At(Promise.resolve(e)):Le(e)}var QI={exact:rC,subset:iC},nC={exact:XI,subset:YI,ignored:()=>!0};function q_(e,n,t){return QI[t.paths](e.root,n.root,t.matrixParams)&&nC[t.queryParams](e.queryParams,n.queryParams)&&!(t.fragment==="exact"&&e.fragment!==n.fragment)}function XI(e,n){return Si(e,n)}function rC(e,n,t){if(!ms(e.segments,n.segments)||!B0(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(let r in n.children)if(!e.children[r]||!rC(e.children[r],n.children[r],t))return!1;return!0}function YI(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>eC(e[t],n[t]))}function iC(e,n,t){return oC(e,n,n.segments,t)}function oC(e,n,t,r){if(e.segments.length>t.length){let i=e.segments.slice(0,t.length);return!(!ms(i,t)||n.hasChildren()||!B0(i,t,r))}else if(e.segments.length===t.length){if(!ms(e.segments,t)||!B0(e.segments,t,r))return!1;for(let i in n.children)if(!e.children[i]||!iC(e.children[i],n.children[i],r))return!1;return!0}else{let i=t.slice(0,e.segments.length),o=t.slice(e.segments.length);return!ms(e.segments,i)||!B0(e.segments,i,r)||!e.children[Je]?!1:oC(e.children[Je],n,o,r)}}function B0(e,n,t){return n.every((r,i)=>nC[t](e[i].parameters,r.parameters))}var Ji=class{constructor(n=new yt([],{}),t={},r=null){this.root=n,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap??=va(this.queryParams),this._queryParamMap}toString(){return JI.serialize(this)}},yt=class{constructor(n,t){this.segments=n,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return L0(this)}},ps=class{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap??=va(this.parameters),this._parameterMap}toString(){return aC(this)}};function KI(e,n){return ms(e,n)&&e.every((t,r)=>Si(t.parameters,n[r].parameters))}function ms(e,n){return e.length!==n.length?!1:e.every((t,r)=>t.path===n[r].path)}function ZI(e,n){let t=[];return Object.entries(e.children).forEach(([r,i])=>{r===Je&&(t=t.concat(n(i,r)))}),Object.entries(e.children).forEach(([r,i])=>{r!==Je&&(t=t.concat(n(i,r)))}),t}var Bc=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>new _a,providedIn:"root"})}}return e})(),_a=class{parse(n){let t=new _m(n);return new Ji(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){let t=`/${yc(n.root,!0)}`,r=nk(n.queryParams),i=typeof n.fragment=="string"?`#${ek(n.fragment)}`:"";return`${t}${r}${i}`}},JI=new _a;function L0(e){return e.segments.map(n=>aC(n)).join("/")}function yc(e,n){if(!e.hasChildren())return L0(e);if(n){let t=e.children[Je]?yc(e.children[Je],!1):"",r=[];return Object.entries(e.children).forEach(([i,o])=>{i!==Je&&r.push(`${i}:${yc(o,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}else{let t=ZI(e,(r,i)=>i===Je?[yc(e.children[Je],!1)]:[`${i}:${yc(r,!1)}`]);return Object.keys(e.children).length===1&&e.children[Je]!=null?`${L0(e)}/${t[0]}`:`${L0(e)}/(${t.join("//")})`}}function sC(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function N0(e){return sC(e).replace(/%3B/gi,";")}function ek(e){return encodeURI(e)}function vm(e){return sC(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function V0(e){return decodeURIComponent(e)}function W_(e){return V0(e.replace(/\+/g,"%20"))}function aC(e){return`${vm(e.path)}${tk(e.parameters)}`}function tk(e){return Object.entries(e).map(([n,t])=>`;${vm(n)}=${vm(t)}`).join("")}function nk(e){let n=Object.entries(e).map(([t,r])=>Array.isArray(r)?r.map(i=>`${N0(t)}=${N0(i)}`).join("&"):`${N0(t)}=${N0(r)}`).filter(t=>t);return n.length?`?${n.join("&")}`:""}var rk=/^[^\/()?;#]+/;function hm(e){let n=e.match(rk);return n?n[0]:""}var ik=/^[^\/()?;=#]+/;function ok(e){let n=e.match(ik);return n?n[0]:""}var sk=/^[^=?&#]+/;function ak(e){let n=e.match(sk);return n?n[0]:""}var ck=/^[^&#]+/;function uk(e){let n=e.match(ck);return n?n[0]:""}var _m=class{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new yt([],{}):new yt([],this.parseChildren())}parseQueryParams(){let n={};if(this.consumeOptional("?"))do this.parseQueryParam(n);while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(r[Je]=new yt(n,t)),r}parseSegment(){let n=hm(this.remaining);if(n===""&&this.peekStartsWith(";"))throw new Ne(4009,!1);return this.capture(n),new ps(V0(n),this.parseMatrixParams())}parseMatrixParams(){let n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){let t=ok(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let i=hm(this.remaining);i&&(r=i,this.capture(r))}n[V0(t)]=V0(r)}parseQueryParam(n){let t=ak(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){let s=uk(this.remaining);s&&(r=s,this.capture(r))}let i=W_(t),o=W_(r);if(n.hasOwnProperty(i)){let s=n[i];Array.isArray(s)||(s=[s],n[i]=s),s.push(o)}else n[i]=o}parseParens(n){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let r=hm(this.remaining),i=this.remaining[r.length];if(i!=="/"&&i!==")"&&i!==";")throw new Ne(4010,!1);let o;r.indexOf(":")>-1?(o=r.slice(0,r.indexOf(":")),this.capture(o),this.capture(":")):n&&(o=Je);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[Je]:new yt([],s),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return this.peekStartsWith(n)?(this.remaining=this.remaining.substring(n.length),!0):!1}capture(n){if(!this.consumeOptional(n))throw new Ne(4011,!1)}};function cC(e){return e.segments.length>0?new yt([],{[Je]:e}):e}function uC(e){let n={};for(let[r,i]of Object.entries(e.children)){let o=uC(i);if(r===Je&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))n[s]=a;else(o.segments.length>0||o.hasChildren())&&(n[r]=o)}let t=new yt(e.segments,n);return lk(t)}function lk(e){if(e.numberOfChildren===1&&e.children[Je]){let n=e.children[Je];return new yt(e.segments.concat(n.segments),n.children)}return e}function gs(e){return e instanceof Ji}function dk(e,n,t=null,r=null){let i=lC(e);return dC(i,n,t,r)}function lC(e){let n;function t(o){let s={};for(let c of o.children){let d=t(c);s[c.outlet]=d}let a=new yt(o.url,s);return o===e&&(n=a),a}let r=t(e.root),i=cC(r);return n??i}function dC(e,n,t,r){let i=e;for(;i.parent;)i=i.parent;if(n.length===0)return pm(i,i,i,t,r);let o=fk(n);if(o.toRoot())return pm(i,i,new yt([],{}),t,r);let s=hk(o,i,e),a=s.processChildren?Dc(s.segmentGroup,s.index,o.commands):hC(s.segmentGroup,s.index,o.commands);return pm(i,s.segmentGroup,a,t,r)}function U0(e){return typeof e=="object"&&e!=null&&!e.outlets&&!e.segmentPath}function Ac(e){return typeof e=="object"&&e!=null&&e.outlets}function pm(e,n,t,r,i){let o={};r&&Object.entries(r).forEach(([c,d])=>{o[c]=Array.isArray(d)?d.map(h=>`${h}`):`${d}`});let s;e===n?s=t:s=fC(e,n,t);let a=cC(uC(s));return new Ji(a,o,i)}function fC(e,n,t){let r={};return Object.entries(e.children).forEach(([i,o])=>{o===n?r[i]=t:r[i]=fC(o,n,t)}),new yt(e.segments,r)}var j0=class{constructor(n,t,r){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=r,n&&r.length>0&&U0(r[0]))throw new Ne(4003,!1);let i=r.find(Ac);if(i&&i!==tC(r))throw new Ne(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function fk(e){if(typeof e[0]=="string"&&e.length===1&&e[0]==="/")return new j0(!0,0,e);let n=0,t=!1,r=e.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,d])=>{a[c]=typeof d=="string"?d.split("/"):d}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?n++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new j0(t,n,r)}var ga=class{constructor(n,t,r){this.segmentGroup=n,this.processChildren=t,this.index=r}};function hk(e,n,t){if(e.isAbsolute)return new ga(n,!0,0);if(!t)return new ga(n,!1,NaN);if(t.parent===null)return new ga(t,!0,0);let r=U0(e.commands[0])?0:1,i=t.segments.length-1+r;return pk(t,i,e.numberOfDoubleDots)}function pk(e,n,t){let r=e,i=n,o=t;for(;o>i;){if(o-=i,r=r.parent,!r)throw new Ne(4005,!1);i=r.segments.length}return new ga(r,!1,i-o)}function mk(e){return Ac(e[0])?e[0].outlets:{[Je]:e}}function hC(e,n,t){if(e??=new yt([],{}),e.segments.length===0&&e.hasChildren())return Dc(e,n,t);let r=gk(e,n,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){let o=new yt(e.segments.slice(0,r.pathIndex),{});return o.children[Je]=new yt(e.segments.slice(r.pathIndex),e.children),Dc(o,0,i)}else return r.match&&i.length===0?new yt(e.segments,{}):r.match&&!e.hasChildren()?Cm(e,n,t):r.match?Dc(e,0,i):Cm(e,n,t)}function Dc(e,n,t){if(t.length===0)return new yt(e.segments,{});{let r=mk(t),i={};if(Object.keys(r).some(o=>o!==Je)&&e.children[Je]&&e.numberOfChildren===1&&e.children[Je].segments.length===0){let o=Dc(e.children[Je],n,t);return new yt(e.segments,o.children)}return Object.entries(r).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=hC(e.children[o],n,s))}),Object.entries(e.children).forEach(([o,s])=>{r[o]===void 0&&(i[o]=s)}),new yt(e.segments,i)}}function gk(e,n,t){let r=0,i=n,o={match:!1,pathIndex:0,commandIndex:0};for(;i<e.segments.length;){if(r>=t.length)return o;let s=e.segments[i],a=t[r];if(Ac(a))break;let c=`${a}`,d=r<t.length-1?t[r+1]:null;if(i>0&&c===void 0)break;if(c&&d&&typeof d=="object"&&d.outlets===void 0){if(!G_(c,d,s))return o;r+=2}else{if(!G_(c,{},s))return o;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}function Cm(e,n,t){let r=e.segments.slice(0,n),i=0;for(;i<t.length;){let o=t[i];if(Ac(o)){let c=xk(o.outlets);return new yt(r,c)}if(i===0&&U0(t[0])){let c=e.segments[n];r.push(new ps(c.path,z_(t[0]))),i++;continue}let s=Ac(o)?o.outlets[Je]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&U0(a)?(r.push(new ps(s,z_(a))),i+=2):(r.push(new ps(s,{})),i++)}return new yt(r,{})}function xk(e){let n={};return Object.entries(e).forEach(([t,r])=>{typeof r=="string"&&(r=[r]),r!==null&&(n[t]=Cm(new yt([],{}),0,r))}),n}function z_(e){let n={};return Object.entries(e).forEach(([t,r])=>n[t]=`${r}`),n}function G_(e,n,t){return e==t.path&&Si(n,t.parameters)}var Sc="imperative",Dn=function(e){return e[e.NavigationStart=0]="NavigationStart",e[e.NavigationEnd=1]="NavigationEnd",e[e.NavigationCancel=2]="NavigationCancel",e[e.NavigationError=3]="NavigationError",e[e.RoutesRecognized=4]="RoutesRecognized",e[e.ResolveStart=5]="ResolveStart",e[e.ResolveEnd=6]="ResolveEnd",e[e.GuardsCheckStart=7]="GuardsCheckStart",e[e.GuardsCheckEnd=8]="GuardsCheckEnd",e[e.RouteConfigLoadStart=9]="RouteConfigLoadStart",e[e.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",e[e.ChildActivationStart=11]="ChildActivationStart",e[e.ChildActivationEnd=12]="ChildActivationEnd",e[e.ActivationStart=13]="ActivationStart",e[e.ActivationEnd=14]="ActivationEnd",e[e.Scroll=15]="Scroll",e[e.NavigationSkipped=16]="NavigationSkipped",e}(Dn||{}),$r=class{constructor(n,t){this.id=n,this.url=t}},Ca=class extends $r{constructor(n,t,r="imperative",i=null){super(n,t),this.type=Dn.NavigationStart,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Or=class extends $r{constructor(n,t,r){super(n,t),this.urlAfterRedirects=r,this.type=Dn.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Tr=function(e){return e[e.Redirect=0]="Redirect",e[e.SupersededByNewNavigation=1]="SupersededByNewNavigation",e[e.NoDataFromResolver=2]="NoDataFromResolver",e[e.GuardRejected=3]="GuardRejected",e}(Tr||{}),H0=function(e){return e[e.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",e[e.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",e}(H0||{}),Zi=class extends $r{constructor(n,t,r,i){super(n,t),this.reason=r,this.code=i,this.type=Dn.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},Fo=class extends $r{constructor(n,t,r,i){super(n,t),this.reason=r,this.code=i,this.type=Dn.NavigationSkipped}},Tc=class extends $r{constructor(n,t,r,i){super(n,t),this.error=r,this.target=i,this.type=Dn.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},$0=class extends $r{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Dn.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},ym=class extends $r{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Dn.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},wm=class extends $r{constructor(n,t,r,i,o){super(n,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=o,this.type=Dn.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},bm=class extends $r{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Dn.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Dm=class extends $r{constructor(n,t,r,i){super(n,t),this.urlAfterRedirects=r,this.state=i,this.type=Dn.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Sm=class{constructor(n){this.route=n,this.type=Dn.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Mm=class{constructor(n){this.route=n,this.type=Dn.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Am=class{constructor(n){this.snapshot=n,this.type=Dn.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Tm=class{constructor(n){this.snapshot=n,this.type=Dn.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Om=class{constructor(n){this.snapshot=n,this.type=Dn.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Im=class{constructor(n){this.snapshot=n,this.type=Dn.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},q0=class{constructor(n,t,r){this.routerEvent=n,this.position=t,this.anchor=r,this.type=Dn.Scroll}toString(){let n=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${n}')`}},Oc=class{},ya=class{constructor(n,t){this.url=n,this.navigationBehaviorOptions=t}};function Ek(e,n){return e.providers&&!e._injector&&(e._injector=a0(e.providers,n,`Route: ${e.path}`)),e._injector??n}function ci(e){return e.outlet||Je}function vk(e,n){let t=e.filter(r=>ci(r)===n);return t.push(...e.filter(r=>ci(r)!==n)),t}function Lc(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){let t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var km=class{get injector(){return Lc(this.route?.snapshot)??this.rootInjector}set injector(n){}constructor(n){this.rootInjector=n,this.outlet=null,this.route=null,this.children=new Vc(this.rootInjector),this.attachRef=null}},Vc=(()=>{class e{constructor(t){this.rootInjector=t,this.contexts=new Map}onChildOutletCreated(t,r){let i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){let r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){let t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new km(this.rootInjector),this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||e)(ke(Jn))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),W0=class{constructor(n){this._root=n}get root(){return this._root.value}parent(n){let t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){let t=Pm(n,this._root);return t?t.children.map(r=>r.value):[]}firstChild(n){let t=Pm(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){let t=Fm(n,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==n)}pathFromRoot(n){return Fm(n,this._root).map(t=>t.value)}};function Pm(e,n){if(e===n.value)return n;for(let t of n.children){let r=Pm(e,t);if(r)return r}return null}function Fm(e,n){if(e===n.value)return[n];for(let t of n.children){let r=Fm(e,t);if(r.length)return r.unshift(n),r}return[]}var Ar=class{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}};function ma(e){let n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}var z0=class extends W0{constructor(n,t){super(n),this.snapshot=t,$m(this,n)}toString(){return this.snapshot.toString()}};function pC(e){let n=_k(e),t=new In([new ps("",{})]),r=new In({}),i=new In({}),o=new In({}),s=new In(""),a=new dn(t,r,o,s,i,Je,e,n.root);return a.snapshot=n.root,new z0(new Ar(a,[]),n)}function _k(e){let n={},t={},r={},i="",o=new xa([],n,r,i,t,Je,e,null,{});return new Q0("",new Ar(o,[]))}var dn=class{constructor(n,t,r,i,o,s,a,c){this.urlSubject=n,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(Xe(d=>d[Rc]))??Le(void 0),this.url=n,this.params=t,this.queryParams=r,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Xe(n=>va(n))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Xe(n=>va(n))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function G0(e,n,t="emptyOnly"){let r,{routeConfig:i}=e;return n!==null&&(t==="always"||i?.path===""||!n.component&&!n.routeConfig?.loadComponent)?r={params:de(de({},n.params),e.params),data:de(de({},n.data),e.data),resolve:de(de(de(de({},e.data),n.data),i?.data),e._resolvedData)}:r={params:de({},e.params),data:de({},e.data),resolve:de(de({},e.data),e._resolvedData??{})},i&&gC(i)&&(r.resolve[Rc]=i.title),r}var xa=class{get title(){return this.data?.[Rc]}constructor(n,t,r,i,o,s,a,c,d){this.url=n,this.params=t,this.queryParams=r,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=d}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=va(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=va(this.queryParams),this._queryParamMap}toString(){let n=this.url.map(r=>r.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${n}', path:'${t}')`}},Q0=class extends W0{constructor(n,t){super(t),this.url=n,$m(this,t)}toString(){return mC(this._root)}};function $m(e,n){n.value._routerState=e,n.children.forEach(t=>$m(e,t))}function mC(e){let n=e.children.length>0?` { ${e.children.map(mC).join(", ")} } `:"";return`${e.value}${n}`}function mm(e){if(e.snapshot){let n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,Si(n.queryParams,t.queryParams)||e.queryParamsSubject.next(t.queryParams),n.fragment!==t.fragment&&e.fragmentSubject.next(t.fragment),Si(n.params,t.params)||e.paramsSubject.next(t.params),GI(n.url,t.url)||e.urlSubject.next(t.url),Si(n.data,t.data)||e.dataSubject.next(t.data)}else e.snapshot=e._futureSnapshot,e.dataSubject.next(e._futureSnapshot.data)}function Nm(e,n){let t=Si(e.params,n.params)&&KI(e.url,n.url),r=!e.parent!=!n.parent;return t&&!r&&(!e.parent||Nm(e.parent,n.parent))}function gC(e){return typeof e.title=="string"||e.title===null}var qm=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=Je,this.activateEvents=new Ut,this.deactivateEvents=new Ut,this.attachEvents=new Ut,this.detachEvents=new Ut,this.parentContexts=ue(Vc),this.location=ue(bo),this.changeDetector=ue(Ao),this.inputBinder=ue(Z0,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){let{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Ne(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Ne(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Ne(4012,!1);this.location.detach();let t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){let t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new Ne(4013,!1);this._activatedRoute=t;let i=this.location,s=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new Rm(t,a,i.injector);this.activated=i.createComponent(s,{index:i.length,injector:c,environmentInjector:r}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=bt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[ii]})}}return e})(),Rm=class e{__ngOutletInjector(n){return new e(this.route,this.childContexts,n)}constructor(n,t,r){this.route=n,this.childContexts=t,this.parent=r}get(n,t){return n===dn?this.route:n===Vc?this.childContexts:this.parent.get(n,t)}},Z0=new Ie(""),Q_=(()=>{class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){let{activatedRoute:r}=t,i=Za([r.queryParams,r.params,r.data]).pipe(lr(([o,s,a],c)=>(a=de(de(de({},o),s),a),c===0?Le(a):Promise.resolve(a)))).subscribe(o=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||r.component===null){this.unsubscribeFromRouteData(t);return}let s=o_(r.component);if(!s){this.unsubscribeFromRouteData(t);return}for(let{templateName:a}of s.inputs)t.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})();function Ck(e,n,t){let r=Ic(e,n._root,t?t._root:void 0);return new z0(r,n)}function Ic(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){let r=t.value;r._futureSnapshot=n.value;let i=yk(e,n,t);return new Ar(r,i)}else{if(e.shouldAttach(n.value)){let o=e.retrieve(n.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=n.value,s.children=n.children.map(a=>Ic(e,a)),s}}let r=wk(n.value),i=n.children.map(o=>Ic(e,o));return new Ar(r,i)}}function yk(e,n,t){return n.children.map(r=>{for(let i of t.children)if(e.shouldReuseRoute(r.value,i.value.snapshot))return Ic(e,r,i);return Ic(e,r)})}function wk(e){return new dn(new In(e.url),new In(e.params),new In(e.queryParams),new In(e.fragment),new In(e.data),e.outlet,e.component,e)}var kc=class{constructor(n,t){this.redirectTo=n,this.navigationBehaviorOptions=t}},xC="ngNavigationCancelingError";function X0(e,n){let{redirectTo:t,navigationBehaviorOptions:r}=gs(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,i=EC(!1,Tr.Redirect);return i.url=t,i.navigationBehaviorOptions=r,i}function EC(e,n){let t=new Error(`NavigationCancelingError: ${e||""}`);return t[xC]=!0,t.cancellationCode=n,t}function bk(e){return vC(e)&&gs(e.url)}function vC(e){return!!e&&e[xC]}var Dk=(e,n,t,r)=>Xe(i=>(new Bm(n,i.targetRouterState,i.currentRouterState,t,r).activate(e),i)),Bm=class{constructor(n,t,r,i,o){this.routeReuseStrategy=n,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=o}activate(n){let t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,n),mm(this.futureState.root),this.activateChildRoutes(t,r,n)}deactivateChildRoutes(n,t,r){let i=ma(t);n.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],r),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,r)})}deactivateRoutes(n,t,r){let i=n.value,o=t?t.value:null;if(i===o)if(i.component){let s=r.getContext(i.outlet);s&&this.deactivateChildRoutes(n,t,s.children)}else this.deactivateChildRoutes(n,t,r);else o&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){let r=t.getContext(n.value.outlet),i=r&&n.value.component?r.children:t,o=ma(n);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(r&&r.outlet){let s=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:s,route:n,contexts:a})}}deactivateRouteAndOutlet(n,t){let r=t.getContext(n.value.outlet),i=r&&n.value.component?r.children:t,o=ma(n);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(n,t,r){let i=ma(t);n.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],r),this.forwardEvent(new Im(o.value.snapshot))}),n.children.length&&this.forwardEvent(new Tm(n.value.snapshot))}activateRoutes(n,t,r){let i=n.value,o=t?t.value:null;if(mm(i),i===o)if(i.component){let s=r.getOrCreateContext(i.outlet);this.activateChildRoutes(n,t,s.children)}else this.activateChildRoutes(n,t,r);else if(i.component){let s=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),mm(a.route.value),this.activateChildRoutes(n,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(n,null,s.children)}else this.activateChildRoutes(n,null,r)}},Y0=class{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}},Ea=class{constructor(n,t){this.component=n,this.route=t}};function Sk(e,n,t){let r=e._root,i=n?n._root:null;return wc(r,i,t,[r.value])}function Mk(e){let n=e.routeConfig?e.routeConfig.canActivateChild:null;return!n||n.length===0?null:{node:e,guards:n}}function ba(e,n){let t=Symbol(),r=n.get(e,t);return r===t?typeof e=="function"&&!Vx(e)?e:n.get(e):r}function wc(e,n,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=ma(n);return e.children.forEach(s=>{Ak(s,o[s.value.outlet],t,r.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>Mc(a,t.getContext(s),i)),i}function Ak(e,n,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=e.value,s=n?n.value:null,a=t?t.getContext(e.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=Tk(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new Y0(r)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?wc(e,n,a?a.children:null,r,i):wc(e,n,t,r,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new Ea(a.outlet.component,s))}else s&&Mc(n,a,i),i.canActivateChecks.push(new Y0(r)),o.component?wc(e,null,a?a.children:null,r,i):wc(e,null,t,r,i);return i}function Tk(e,n,t){if(typeof t=="function")return t(e,n);switch(t){case"pathParamsChange":return!ms(e.url,n.url);case"pathParamsOrQueryParamsChange":return!ms(e.url,n.url)||!Si(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Nm(e,n)||!Si(e.queryParams,n.queryParams);case"paramsChange":default:return!Nm(e,n)}}function Mc(e,n,t){let r=ma(e),i=e.value;Object.entries(r).forEach(([o,s])=>{i.component?n?Mc(s,n.children.getContext(o),t):Mc(s,null,t):Mc(s,n,t)}),i.component?n&&n.outlet&&n.outlet.isActivated?t.canDeactivateChecks.push(new Ea(n.outlet.component,i)):t.canDeactivateChecks.push(new Ea(null,i)):t.canDeactivateChecks.push(new Ea(null,i))}function Uc(e){return typeof e=="function"}function Ok(e){return typeof e=="boolean"}function Ik(e){return e&&Uc(e.canLoad)}function kk(e){return e&&Uc(e.canActivate)}function Pk(e){return e&&Uc(e.canActivateChild)}function Fk(e){return e&&Uc(e.canDeactivate)}function Nk(e){return e&&Uc(e.canMatch)}function _C(e){return e instanceof Bi||e?.name==="EmptyError"}var R0=Symbol("INITIAL_VALUE");function wa(){return lr(e=>Za(e.map(n=>n.pipe(Vi(1),jf(R0)))).pipe(Xe(n=>{for(let t of n)if(t!==!0){if(t===R0)return R0;if(t===!1||Rk(t))return t}return!0}),Bn(n=>n!==R0),Vi(1)))}function Rk(e){return gs(e)||e instanceof kc}function Bk(e,n){return sn(t=>{let{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Le(qe(de({},t),{guardsResult:!0})):Lk(s,r,i,e).pipe(sn(a=>a&&Ok(a)?Vk(r,o,e,n):Le(a)),Xe(a=>qe(de({},t),{guardsResult:a})))})}function Lk(e,n,t,r){return At(e).pipe(sn(i=>qk(i.component,i.route,t,n,r)),xi(i=>i!==!0,!0))}function Vk(e,n,t,r){return At(n).pipe(Li(i=>Vs(jk(i.route.parent,r),Uk(i.route,r),$k(e,i.path,t),Hk(e,i.route,t))),xi(i=>i!==!0,!0))}function Uk(e,n){return e!==null&&n&&n(new Om(e)),Le(!0)}function jk(e,n){return e!==null&&n&&n(new Am(e)),Le(!0)}function Hk(e,n,t){let r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||r.length===0)return Le(!0);let i=r.map(o=>nl(()=>{let s=Lc(n)??t,a=ba(o,s),c=kk(a)?a.canActivate(n,e):Br(s,()=>a(n,e));return No(c).pipe(xi())}));return Le(i).pipe(wa())}function $k(e,n,t){let r=n[n.length-1],o=n.slice(0,n.length-1).reverse().map(s=>Mk(s)).filter(s=>s!==null).map(s=>nl(()=>{let a=s.guards.map(c=>{let d=Lc(s.node)??t,h=ba(c,d),p=Pk(h)?h.canActivateChild(r,e):Br(d,()=>h(r,e));return No(p).pipe(xi())});return Le(a).pipe(wa())}));return Le(o).pipe(wa())}function qk(e,n,t,r,i){let o=n&&n.routeConfig?n.routeConfig.canDeactivate:null;if(!o||o.length===0)return Le(!0);let s=o.map(a=>{let c=Lc(n)??i,d=ba(a,c),h=Fk(d)?d.canDeactivate(e,n,t,r):Br(c,()=>d(e,n,t,r));return No(h).pipe(xi())});return Le(s).pipe(wa())}function Wk(e,n,t,r){let i=n.canLoad;if(i===void 0||i.length===0)return Le(!0);let o=i.map(s=>{let a=ba(s,e),c=Ik(a)?a.canLoad(n,t):Br(e,()=>a(n,t));return No(c)});return Le(o).pipe(wa(),CC(r))}function CC(e){return Pf(Ft(n=>{if(typeof n!="boolean")throw X0(e,n)}),Xe(n=>n===!0))}function zk(e,n,t,r){let i=n.canMatch;if(!i||i.length===0)return Le(!0);let o=i.map(s=>{let a=ba(s,e),c=Nk(a)?a.canMatch(n,t):Br(e,()=>a(n,t));return No(c)});return Le(o).pipe(wa(),CC(r))}var Pc=class{constructor(n){this.segmentGroup=n||null}},Fc=class extends Error{constructor(n){super(),this.urlTree=n}};function pa(e){return vn(new Pc(e))}function Gk(e){return vn(new Ne(4e3,!1))}function Qk(e){return vn(EC(!1,Tr.GuardRejected))}var Lm=class{constructor(n,t){this.urlSerializer=n,this.urlTree=t}lineralizeSegments(n,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),i.numberOfChildren===0)return Le(r);if(i.numberOfChildren>1||!i.children[Je])return Gk(`${n.redirectTo}`);i=i.children[Je]}}applyRedirectCommands(n,t,r,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:d,routeConfig:h,url:p,outlet:g,params:x,data:v,title:E}=i,_=Br(o,()=>a({params:x,data:v,queryParams:c,fragment:d,routeConfig:h,url:p,outlet:g,title:E}));if(_ instanceof Ji)throw new Fc(_);t=_}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,r);if(t[0]==="/")throw new Fc(s);return s}applyRedirectCreateUrlTree(n,t,r,i){let o=this.createSegmentGroup(n,t.root,r,i);return new Ji(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){let r={};return Object.entries(n).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);r[i]=t[a]}else r[i]=o}),r}createSegmentGroup(n,t,r,i){let o=this.createSegments(n,t.segments,r,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(n,c,r,i)}),new yt(o,s)}createSegments(n,t,r,i){return t.map(o=>o.path[0]===":"?this.findPosParam(n,o,i):this.findOrReturn(o,r))}findPosParam(n,t,r){let i=r[t.path.substring(1)];if(!i)throw new Ne(4001,!1);return i}findOrReturn(n,t){let r=0;for(let i of t){if(i.path===n.path)return t.splice(r),i;r++}return n}},Vm={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Xk(e,n,t,r,i){let o=yC(e,n,t);return o.matched?(r=Ek(n,r),zk(r,n,t,i).pipe(Xe(s=>s===!0?o:de({},Vm)))):Le(o)}function yC(e,n,t){if(n.path==="**")return Yk(t);if(n.path==="")return n.pathMatch==="full"&&(e.hasChildren()||t.length>0)?de({},Vm):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(n.matcher||zI)(t,e,n);if(!i)return de({},Vm);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?de(de({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function Yk(e){return{matched:!0,parameters:e.length>0?tC(e).parameters:{},consumedSegments:e,remainingSegments:[],positionalParamSegments:{}}}function X_(e,n,t,r){return t.length>0&&Jk(e,t,r)?{segmentGroup:new yt(n,Zk(r,new yt(t,e.children))),slicedSegments:[]}:t.length===0&&e3(e,t,r)?{segmentGroup:new yt(e.segments,Kk(e,t,r,e.children)),slicedSegments:t}:{segmentGroup:new yt(e.segments,e.children),slicedSegments:t}}function Kk(e,n,t,r){let i={};for(let o of t)if(J0(e,n,o)&&!r[ci(o)]){let s=new yt([],{});i[ci(o)]=s}return de(de({},r),i)}function Zk(e,n){let t={};t[Je]=n;for(let r of e)if(r.path===""&&ci(r)!==Je){let i=new yt([],{});t[ci(r)]=i}return t}function Jk(e,n,t){return t.some(r=>J0(e,n,r)&&ci(r)!==Je)}function e3(e,n,t){return t.some(r=>J0(e,n,r))}function J0(e,n,t){return(e.hasChildren()||n.length>0)&&t.pathMatch==="full"?!1:t.path===""}function t3(e,n,t){return n.length===0&&!e.children[t]}var Um=class{};function n3(e,n,t,r,i,o,s="emptyOnly"){return new jm(e,n,t,r,i,s,o).recognize()}var r3=31,jm=class{constructor(n,t,r,i,o,s,a){this.injector=n,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new Lm(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(n){return new Ne(4002,`'${n.segmentGroup}'`)}recognize(){let n=X_(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(n).pipe(Xe(({children:t,rootSnapshot:r})=>{let i=new Ar(r,t),o=new Q0("",i),s=dk(r,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(n){let t=new xa([],Object.freeze({}),Object.freeze(de({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),Je,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,n,Je,t).pipe(Xe(r=>({children:r,rootSnapshot:t})),Et(r=>{if(r instanceof Fc)return this.urlTree=r.urlTree,this.match(r.urlTree.root);throw r instanceof Pc?this.noMatchError(r):r}))}processSegmentGroup(n,t,r,i,o){return r.segments.length===0&&r.hasChildren()?this.processChildren(n,t,r,o):this.processSegment(n,t,r,r.segments,i,!0,o).pipe(Xe(s=>s instanceof Ar?[s]:[]))}processChildren(n,t,r,i){let o=[];for(let s of Object.keys(r.children))s==="primary"?o.unshift(s):o.push(s);return At(o).pipe(Li(s=>{let a=r.children[s],c=vk(t,s);return this.processSegmentGroup(n,c,a,s,i)}),Uf((s,a)=>(s.push(...a),s)),fo(null),Vf(),sn(s=>{if(s===null)return pa(r);let a=wC(s);return i3(a),Le(a)}))}processSegment(n,t,r,i,o,s,a){return At(t).pipe(Li(c=>this.processSegmentAgainstRoute(c._injector??n,t,c,r,i,o,s,a).pipe(Et(d=>{if(d instanceof Pc)return Le(null);throw d}))),xi(c=>!!c),Et(c=>{if(_C(c))return t3(r,i,o)?Le(new Um):pa(r);throw c}))}processSegmentAgainstRoute(n,t,r,i,o,s,a,c){return ci(r)!==s&&(s===Je||!J0(i,o,r))?pa(i):r.redirectTo===void 0?this.matchSegmentAgainstRoute(n,i,r,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(n,i,t,r,o,s,c):pa(i)}expandSegmentAgainstRouteUsingRedirect(n,t,r,i,o,s,a){let{matched:c,parameters:d,consumedSegments:h,positionalParamSegments:p,remainingSegments:g}=yC(t,i,o);if(!c)return pa(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>r3&&(this.allowRedirects=!1));let x=new xa(o,d,Object.freeze(de({},this.urlTree.queryParams)),this.urlTree.fragment,Y_(i),ci(i),i.component??i._loadedComponent??null,i,K_(i)),v=G0(x,a,this.paramsInheritanceStrategy);x.params=Object.freeze(v.params),x.data=Object.freeze(v.data);let E=this.applyRedirects.applyRedirectCommands(h,i.redirectTo,p,x,n);return this.applyRedirects.lineralizeSegments(i,E).pipe(sn(_=>this.processSegment(n,r,t,_.concat(g),s,!1,a)))}matchSegmentAgainstRoute(n,t,r,i,o,s){let a=Xk(t,r,i,n,this.urlSerializer);return r.path==="**"&&(t.children={}),a.pipe(lr(c=>c.matched?(n=r._injector??n,this.getChildConfig(n,r,i).pipe(lr(({routes:d})=>{let h=r._loadedInjector??n,{parameters:p,consumedSegments:g,remainingSegments:x}=c,v=new xa(g,p,Object.freeze(de({},this.urlTree.queryParams)),this.urlTree.fragment,Y_(r),ci(r),r.component??r._loadedComponent??null,r,K_(r)),E=G0(v,s,this.paramsInheritanceStrategy);v.params=Object.freeze(E.params),v.data=Object.freeze(E.data);let{segmentGroup:_,slicedSegments:M}=X_(t,g,x,d);if(M.length===0&&_.hasChildren())return this.processChildren(h,d,_,v).pipe(Xe(y=>new Ar(v,y)));if(d.length===0&&M.length===0)return Le(new Ar(v,[]));let I=ci(r)===o;return this.processSegment(h,d,_,M,I?Je:o,!0,v).pipe(Xe(y=>new Ar(v,y instanceof Ar?[y]:[])))}))):pa(t)))}getChildConfig(n,t,r){return t.children?Le({routes:t.children,injector:n}):t.loadChildren?t._loadedRoutes!==void 0?Le({routes:t._loadedRoutes,injector:t._loadedInjector}):Wk(n,t,r,this.urlSerializer).pipe(sn(i=>i?this.configLoader.loadChildren(n,t).pipe(Ft(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):Qk(t))):Le({routes:[],injector:n})}};function i3(e){e.sort((n,t)=>n.value.outlet===Je?-1:t.value.outlet===Je?1:n.value.outlet.localeCompare(t.value.outlet))}function o3(e){let n=e.value.routeConfig;return n&&n.path===""}function wC(e){let n=[],t=new Set;for(let r of e){if(!o3(r)){n.push(r);continue}let i=n.find(o=>r.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...r.children),t.add(i)):n.push(r)}for(let r of t){let i=wC(r.children);n.push(new Ar(r.value,i))}return n.filter(r=>!t.has(r))}function Y_(e){return e.data||{}}function K_(e){return e.resolve||{}}function s3(e,n,t,r,i,o){return sn(s=>n3(e,n,t,r,s.extractedUrl,i,o).pipe(Xe(({state:a,tree:c})=>qe(de({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function a3(e,n){return sn(t=>{let{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return Le(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let d of bC(c))s.add(d);let a=0;return At(s).pipe(Li(c=>o.has(c)?c3(c,r,e,n):(c.data=G0(c,c.parent,e).resolve,Le(void 0))),Ft(()=>a++),Us(1),sn(c=>a===s.size?Le(t):br))})}function bC(e){let n=e.children.map(t=>bC(t)).flat();return[e,...n]}function c3(e,n,t,r){let i=e.routeConfig,o=e._resolve;return i?.title!==void 0&&!gC(i)&&(o[Rc]=i.title),u3(o,e,n,r).pipe(Xe(s=>(e._resolvedData=s,e.data=G0(e,e.parent,t).resolve,null)))}function u3(e,n,t,r){let i=Em(e);if(i.length===0)return Le({});let o={};return At(i).pipe(sn(s=>l3(e[s],n,t,r).pipe(xi(),Ft(a=>{if(a instanceof kc)throw X0(new _a,a);o[s]=a}))),Us(1),Lf(o),Et(s=>_C(s)?br:vn(s)))}function l3(e,n,t,r){let i=Lc(n)??r,o=ba(e,i),s=o.resolve?o.resolve(n,t):Br(i,()=>o(n,t));return No(s)}function gm(e){return lr(n=>{let t=e(n);return t?At(t).pipe(Xe(()=>n)):Le(n)})}var DC=(()=>{class e{buildTitle(t){let r,i=t.root;for(;i!==void 0;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(o=>o.outlet===Je);return r}getResolvedTitleForRoute(t){return t.data[Rc]}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>ue(d3),providedIn:"root"})}}return e})(),d3=(()=>{class e extends DC{constructor(t){super(),this.title=t}updateTitle(t){let r=this.buildTitle(t);r!==void 0&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||e)(ke($_))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),jc=new Ie("",{providedIn:"root",factory:()=>({})}),f3=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275cmp=Se({type:e,selectors:[["ng-component"]],standalone:!0,features:[Me],decls:1,vars:0,template:function(r,i){r&1&&N(0,"router-outlet")},dependencies:[qm],encapsulation:2})}}return e})();function Wm(e){let n=e.children&&e.children.map(Wm),t=n?qe(de({},e),{children:n}):de({},e);return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==Je&&(t.component=f3),t}var Nc=new Ie(""),zm=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ue(h0)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Le(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);let r=No(t.loadComponent()).pipe(Xe(SC),Ft(o=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=o}),ho(()=>{this.componentLoaders.delete(t)})),i=new Ls(r,()=>new wn).pipe(Bs());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Le({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);let o=h3(r,this.compiler,t,this.onLoadEndListener).pipe(ho(()=>{this.childrenLoaders.delete(r)})),s=new Ls(o,()=>new wn).pipe(Bs());return this.childrenLoaders.set(r,s),s}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function h3(e,n,t,r){return No(e.loadChildren()).pipe(Xe(SC),sn(i=>i instanceof sc||Array.isArray(i)?Le(i):At(n.compileModuleAsync(i))),Xe(i=>{r&&r(e);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Nc,[],{optional:!0,self:!0}).flat()),{routes:s.map(Wm),injector:o}}))}function p3(e){return e&&typeof e=="object"&&"default"in e}function SC(e){return p3(e)?e.default:e}var Gm=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>ue(m3),providedIn:"root"})}}return e})(),m3=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),MC=new Ie(""),AC=new Ie("");function g3(e,n,t){let r=e.get(AC),i=e.get(Un);return e.get(qt).runOutsideAngular(()=>{if(!i.startViewTransition||r.skipNextTransition)return r.skipNextTransition=!1,new Promise(d=>setTimeout(d));let o,s=new Promise(d=>{o=d}),a=i.startViewTransition(()=>(o(),x3(e))),{onViewTransitionCreated:c}=r;return c&&Br(e,()=>c({transition:a,from:n,to:t})),s})}function x3(e){return new Promise(n=>{Rp({read:()=>setTimeout(n)},{injector:e})})}var E3=new Ie(""),Qm=(()=>{class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new wn,this.transitionAbortSubject=new wn,this.configLoader=ue(zm),this.environmentInjector=ue(Jn),this.urlSerializer=ue(Bc),this.rootContexts=ue(Vc),this.location=ue(ha),this.inputBindingEnabled=ue(Z0,{optional:!0})!==null,this.titleStrategy=ue(DC),this.options=ue(jc,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=ue(Gm),this.createViewTransition=ue(MC,{optional:!0}),this.navigationErrorHandler=ue(E3,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Le(void 0),this.rootComponentType=null;let t=i=>this.events.next(new Sm(i)),r=i=>this.events.next(new Mm(i));this.configLoader.onLoadEndListener=r,this.configLoader.onLoadStartListener=t}complete(){this.transitions?.complete()}handleNavigationRequest(t){let r=++this.navigationId;this.transitions?.next(qe(de(de({},this.transitions.value),t),{id:r}))}setupNavigations(t,r,i){return this.transitions=new In({id:0,currentUrlTree:r,currentRawUrl:r,extractedUrl:this.urlHandlingStrategy.extract(r),urlAfterRedirects:this.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:Sc,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Bn(o=>o.id!==0),Xe(o=>qe(de({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),lr(o=>{let s=!1,a=!1;return Le(o).pipe(lr(c=>{if(this.navigationId>o.id)return this.cancelNavigationTransition(o,"",Tr.SupersededByNewNavigation),br;this.currentTransition=o,this.currentNavigation={id:c.id,initialUrl:c.rawUrl,extractedUrl:c.extractedUrl,targetBrowserUrl:typeof c.extras.browserUrl=="string"?this.urlSerializer.parse(c.extras.browserUrl):c.extras.browserUrl,trigger:c.source,extras:c.extras,previousNavigation:this.lastSuccessfulNavigation?qe(de({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!t.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),h=c.extras.onSameUrlNavigation??t.onSameUrlNavigation;if(!d&&h!=="reload"){let p="";return this.events.next(new Fo(c.id,this.urlSerializer.serialize(c.rawUrl),p,H0.IgnoredSameUrlNavigation)),c.resolve(!1),br}if(this.urlHandlingStrategy.shouldProcessUrl(c.rawUrl))return Le(c).pipe(lr(p=>{let g=this.transitions?.getValue();return this.events.next(new Ca(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),g!==this.transitions?.getValue()?br:Promise.resolve(p)}),s3(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,this.paramsInheritanceStrategy),Ft(p=>{o.targetSnapshot=p.targetSnapshot,o.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=qe(de({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new $0(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(c.currentRawUrl)){let{id:p,extractedUrl:g,source:x,restoredState:v,extras:E}=c,_=new Ca(p,this.urlSerializer.serialize(g),x,v);this.events.next(_);let M=pC(this.rootComponentType).snapshot;return this.currentTransition=o=qe(de({},c),{targetSnapshot:M,urlAfterRedirects:g,extras:qe(de({},E),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,Le(o)}else{let p="";return this.events.next(new Fo(c.id,this.urlSerializer.serialize(c.extractedUrl),p,H0.IgnoredByUrlHandlingStrategy)),c.resolve(!1),br}}),Ft(c=>{let d=new ym(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(d)}),Xe(c=>(this.currentTransition=o=qe(de({},c),{guards:Sk(c.targetSnapshot,c.currentSnapshot,this.rootContexts)}),o)),Bk(this.environmentInjector,c=>this.events.next(c)),Ft(c=>{if(o.guardsResult=c.guardsResult,c.guardsResult&&typeof c.guardsResult!="boolean")throw X0(this.urlSerializer,c.guardsResult);let d=new wm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot,!!c.guardsResult);this.events.next(d)}),Bn(c=>c.guardsResult?!0:(this.cancelNavigationTransition(c,"",Tr.GuardRejected),!1)),gm(c=>{if(c.guards.canActivateChecks.length)return Le(c).pipe(Ft(d=>{let h=new bm(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}),lr(d=>{let h=!1;return Le(d).pipe(a3(this.paramsInheritanceStrategy,this.environmentInjector),Ft({next:()=>h=!0,complete:()=>{h||this.cancelNavigationTransition(d,"",Tr.NoDataFromResolver)}}))}),Ft(d=>{let h=new Dm(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(h)}))}),gm(c=>{let d=h=>{let p=[];h.routeConfig?.loadComponent&&!h.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(h.routeConfig).pipe(Ft(g=>{h.component=g}),Xe(()=>{})));for(let g of h.children)p.push(...d(g));return p};return Za(d(c.targetSnapshot.root)).pipe(fo(null),Vi(1))}),gm(()=>this.afterPreactivation()),lr(()=>{let{currentSnapshot:c,targetSnapshot:d}=o,h=this.createViewTransition?.(this.environmentInjector,c.root,d.root);return h?At(h).pipe(Xe(()=>o)):Le(o)}),Xe(c=>{let d=Ck(t.routeReuseStrategy,c.targetSnapshot,c.currentRouterState);return this.currentTransition=o=qe(de({},c),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,o}),Ft(()=>{this.events.next(new Oc)}),Dk(this.rootContexts,t.routeReuseStrategy,c=>this.events.next(c),this.inputBindingEnabled),Vi(1),Ft({next:c=>{s=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Or(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects))),this.titleStrategy?.updateTitle(c.targetRouterState.snapshot),c.resolve(!0)},complete:()=>{s=!0}}),Hf(this.transitionAbortSubject.pipe(Ft(c=>{throw c}))),ho(()=>{!s&&!a&&this.cancelNavigationTransition(o,"",Tr.SupersededByNewNavigation),this.currentTransition?.id===o.id&&(this.currentNavigation=null,this.currentTransition=null)}),Et(c=>{if(a=!0,vC(c))this.events.next(new Zi(o.id,this.urlSerializer.serialize(o.extractedUrl),c.message,c.cancellationCode)),bk(c)?this.events.next(new ya(c.url,c.navigationBehaviorOptions)):o.resolve(!1);else{let d=new Tc(o.id,this.urlSerializer.serialize(o.extractedUrl),c,o.targetSnapshot??void 0);try{let h=Br(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(h instanceof kc){let{message:p,cancellationCode:g}=X0(this.urlSerializer,h);this.events.next(new Zi(o.id,this.urlSerializer.serialize(o.extractedUrl),p,g)),this.events.next(new ya(h.redirectTo,h.navigationBehaviorOptions))}else{this.events.next(d);let p=t.errorHandler(c);o.resolve(!!p)}}catch(h){this.options.resolveNavigationPromiseOnError?o.resolve(!1):o.reject(h)}}return br}))}))}cancelNavigationTransition(t,r,i){let o=new Zi(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(o),t.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let t=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),r=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return t.toString()!==r?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function v3(e){return e!==Sc}var _3=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>ue(C3),providedIn:"root"})}}return e})(),Hm=class{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}},C3=(()=>{class e extends Hm{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),TC=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:()=>ue(y3),providedIn:"root"})}}return e})(),y3=(()=>{class e extends TC{constructor(){super(...arguments),this.location=ue(ha),this.urlSerializer=ue(Bc),this.options=ue(jc,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=ue(Gm),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Ji,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=pC(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(t){return this.location.subscribe(r=>{r.type==="popstate"&&t(r.url,r.state)})}handleRouterEvent(t,r){if(t instanceof Ca)this.stateMemento=this.createStateMemento();else if(t instanceof Fo)this.rawUrlTree=r.initialUrl;else if(t instanceof $0){if(this.urlUpdateStrategy==="eager"&&!r.extras.skipLocationChange){let i=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl);this.setBrowserUrl(r.targetBrowserUrl??i,r)}}else t instanceof Oc?(this.currentUrlTree=r.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(r.finalUrl,r.initialUrl),this.routerState=r.targetRouterState,this.urlUpdateStrategy==="deferred"&&!r.extras.skipLocationChange&&this.setBrowserUrl(r.targetBrowserUrl??this.rawUrlTree,r)):t instanceof Zi&&(t.code===Tr.GuardRejected||t.code===Tr.NoDataFromResolver)?this.restoreHistory(r):t instanceof Tc?this.restoreHistory(r,!0):t instanceof Or&&(this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId)}setBrowserUrl(t,r){let i=t instanceof Ji?this.urlSerializer.serialize(t):t;if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){let o=this.browserPageId,s=de(de({},r.extras.state),this.generateNgRouterState(r.id,o));this.location.replaceState(i,"",s)}else{let o=de(de({},r.extras.state),this.generateNgRouterState(r.id,this.browserPageId+1));this.location.go(i,"",o)}}restoreHistory(t,r=!1){if(this.canceledNavigationResolution==="computed"){let i=this.browserPageId,o=this.currentPageId-i;o!==0?this.location.historyGo(o):this.currentUrlTree===t.finalUrl&&o===0&&(this.resetState(t),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return this.canceledNavigationResolution==="computed"?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),bc=function(e){return e[e.COMPLETE=0]="COMPLETE",e[e.FAILED=1]="FAILED",e[e.REDIRECTING=2]="REDIRECTING",e}(bc||{});function OC(e,n){e.events.pipe(Bn(t=>t instanceof Or||t instanceof Zi||t instanceof Tc||t instanceof Fo),Xe(t=>t instanceof Or||t instanceof Fo?bc.COMPLETE:(t instanceof Zi?t.code===Tr.Redirect||t.code===Tr.SupersededByNewNavigation:!1)?bc.REDIRECTING:bc.FAILED),Bn(t=>t!==bc.REDIRECTING),Vi(1)).subscribe(()=>{n()})}function w3(e){throw e}var b3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},D3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Re=(()=>{class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=ue(d0),this.stateManager=ue(TC),this.options=ue(jc,{optional:!0})||{},this.pendingTasks=ue(Wi),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=ue(Qm),this.urlSerializer=ue(Bc),this.location=ue(ha),this.urlHandlingStrategy=ue(Gm),this._events=new wn,this.errorHandler=this.options.errorHandler||w3,this.navigated=!1,this.routeReuseStrategy=ue(_3),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=ue(Nc,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!ue(Z0,{optional:!0}),this.eventsSubscription=new rn,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:t=>{this.console.warn(t)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let t=this.navigationTransitions.events.subscribe(r=>{try{let i=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(i!==null&&o!==null){if(this.stateManager.handleRouterEvent(r,o),r instanceof Zi&&r.code!==Tr.Redirect&&r.code!==Tr.SupersededByNewNavigation)this.navigated=!0;else if(r instanceof Or)this.navigated=!0;else if(r instanceof ya){let s=r.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),c=de({browserUrl:i.extras.browserUrl,info:i.extras.info,skipLocationChange:i.extras.skipLocationChange,replaceUrl:i.extras.replaceUrl||this.urlUpdateStrategy==="eager"||v3(i.source)},s);this.scheduleNavigation(a,Sc,null,c,{resolve:i.resolve,reject:i.reject,promise:i.promise})}}M3(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Sc,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((t,r)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(t,"popstate",r)},0)})}navigateToSyncWithBrowser(t,r,i){let o={replaceUrl:!0},s=i?.navigationId?i:null;if(i){let c=de({},i);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(t);this.scheduleNavigation(a,r,s,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(Wm),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){let{relativeTo:i,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=r,d=c?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=de(de({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let p;try{let g=i?i.snapshot:this.routerState.snapshot.root;p=lC(g)}catch{(typeof t[0]!="string"||t[0][0]!=="/")&&(t=[]),p=this.currentUrlTree.root}return dC(p,t,h,d??null)}navigateByUrl(t,r={skipLocationChange:!1}){let i=gs(t)?t:this.parseUrl(t),o=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(o,Sc,null,r)}navigate(t,r={skipLocationChange:!1}){return S3(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){try{return this.urlSerializer.parse(t)}catch{return this.urlSerializer.parse("/")}}isActive(t,r){let i;if(r===!0?i=de({},b3):r===!1?i=de({},D3):i=r,gs(t))return q_(this.currentUrlTree,t,i);let o=this.parseUrl(t);return q_(this.currentUrlTree,o,i)}removeEmptyProps(t){return Object.entries(t).reduce((r,[i,o])=>(o!=null&&(r[i]=o),r),{})}scheduleNavigation(t,r,i,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,d;s?(a=s.resolve,c=s.reject,d=s.promise):d=new Promise((p,g)=>{a=p,c=g});let h=this.pendingTasks.add();return OC(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:o,resolve:a,reject:c,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(p=>Promise.reject(p))}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function S3(e){for(let n=0;n<e.length;n++)if(e[n]==null)throw new Ne(4008,!1)}function M3(e){return!(e instanceof Oc)&&!(e instanceof ya)}var bn=(()=>{class e{constructor(t,r,i,o,s,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=o,this.el=s,this.locationStrategy=a,this.href=null,this.onChanges=new wn,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area",this.isAnchorElement?this.subscription=t.events.subscribe(d=>{d instanceof Or&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){t==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(gs(t)?this.routerLinkInput=t:this.routerLinkInput=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0"))}onClick(t,r,i,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(t!==0||r||i||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let t=this.urlTree;this.href=t!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(t)):null;let r=this.href===null?null:nv(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",r)}applyAttributeValue(t,r){let i=this.renderer,o=this.el.nativeElement;r!==null?i.setAttribute(o,t,r):i.removeAttribute(o,t)}get urlTree(){return this.routerLinkInput===null?null:gs(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||e)(Q(Re),Q(dn),hp("tabindex"),Q(si),Q(er),Q(Yi))}}static{this.\u0275dir=bt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){r&1&&H("click",function(s){return i.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),r&2&&la("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",To],skipLocationChange:[2,"skipLocationChange","skipLocationChange",To],replaceUrl:[2,"replaceUrl","replaceUrl",To],routerLink:"routerLink"},standalone:!0,features:[Np,ii]})}}return e})(),ed=(()=>{class e{get isActive(){return this._isActive}constructor(t,r,i,o,s){this.router=t,this.element=r,this.renderer=i,this.cdr=o,this.link=s,this.classes=[],this._isActive=!1,this.routerLinkActiveOptions={exact:!1},this.isActiveChange=new Ut,this.routerEventsSubscription=t.events.subscribe(a=>{a instanceof Or&&this.update()})}ngAfterContentInit(){Le(this.links.changes,Le(null)).pipe(lo()).subscribe(t=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let t=[...this.links.toArray(),this.link].filter(r=>!!r).map(r=>r.onChanges);this.linkInputChangesSubscription=At(t).pipe(lo()).subscribe(r=>{this._isActive!==this.isLinkActive(this.router)(r)&&this.update()})}set routerLinkActive(t){let r=Array.isArray(t)?t:t.split(" ");this.classes=r.filter(i=>!!i)}ngOnChanges(t){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let t=this.hasActiveLinks();this.classes.forEach(r=>{t?this.renderer.addClass(this.element.nativeElement,r):this.renderer.removeClass(this.element.nativeElement,r)}),t&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==t&&(this._isActive=t,this.cdr.markForCheck(),this.isActiveChange.emit(t))})}isLinkActive(t){let r=A3(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return i=>{let o=i.urlTree;return o?t.isActive(o,r):!1}}hasActiveLinks(){let t=this.isLinkActive(this.router);return this.link&&t(this.link)||this.links.some(t)}static{this.\u0275fac=function(r){return new(r||e)(Q(Re),Q(er),Q(si),Q(Ao),Q(bn,8))}}static{this.\u0275dir=bt({type:e,selectors:[["","routerLinkActive",""]],contentQueries:function(r,i,o){if(r&1&&zv(o,bn,5),r&2){let s;Gv(s=Qv())&&(i.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],standalone:!0,features:[ii]})}}return e})();function A3(e){return!!e.paths}var K0=class{};var T3=(()=>{class e{constructor(t,r,i,o,s){this.router=t,this.injector=i,this.preloadingStrategy=o,this.loader=s}setUpPreloading(){this.subscription=this.router.events.pipe(Bn(t=>t instanceof Or),Li(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){let i=[];for(let o of r){o.providers&&!o._injector&&(o._injector=a0(o.providers,t,`Route: ${o.path}`));let s=o._injector??t,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&i.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&i.push(this.processRoutes(a,o.children??o._loadedRoutes))}return At(i).pipe(lo())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;r.loadChildren&&r.canLoad===void 0?i=this.loader.loadChildren(t,r):i=Le(null);let o=i.pipe(sn(s=>s===null?Le(void 0):(r._loadedRoutes=s.routes,r._loadedInjector=s.injector,this.processRoutes(s.injector??t,s.routes))));if(r.loadComponent&&!r._loadedComponent){let s=this.loader.loadComponent(r);return At([o,s]).pipe(lo())}else return o})}static{this.\u0275fac=function(r){return new(r||e)(ke(Re),ke(h0),ke(Jn),ke(K0),ke(zm))}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})(),IC=new Ie(""),O3=(()=>{class e{constructor(t,r,i,o,s={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=o,this.options=s,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Ca?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof Or?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Fo&&t.code===H0.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof q0&&(t.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(t.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new q0(t,this.lastSource==="popstate"?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){mv()}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac})}}return e})();function kC(e,...n){return lc([{provide:Nc,multi:!0,useValue:e},[],{provide:dn,useFactory:PC,deps:[Re]},{provide:pc,multi:!0,useFactory:FC},n.map(t=>t.\u0275providers)])}function PC(e){return e.routerState.root}function Hc(e,n){return{\u0275kind:e,\u0275providers:n}}function FC(){let e=ue(ei);return n=>{let t=e.get(Mo);if(n!==t.components[0])return;let r=e.get(Re),i=e.get(NC);e.get(Xm)===1&&r.initialNavigation(),e.get(RC,null,tt.Optional)?.setUpPreloading(),e.get(IC,null,tt.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var NC=new Ie("",{factory:()=>new wn}),Xm=new Ie("",{providedIn:"root",factory:()=>1});function I3(){return Hc(2,[{provide:Xm,useValue:0},{provide:f0,multi:!0,deps:[ei],useFactory:n=>{let t=n.get(p_,Promise.resolve());return()=>t.then(()=>new Promise(r=>{let i=n.get(Re),o=n.get(NC);OC(i,()=>{r(!0)}),n.get(Qm).afterPreactivation=()=>(r(!0),o.closed?Le(void 0):o),i.initialNavigation()}))}}])}function k3(){return Hc(3,[{provide:f0,multi:!0,useFactory:()=>{let n=ue(Re);return()=>{n.setUpLocationChangeListener()}}},{provide:Xm,useValue:2}])}var RC=new Ie("");function P3(e){return Hc(0,[{provide:RC,useExisting:T3},{provide:K0,useExisting:e}])}function F3(){return Hc(8,[Q_,{provide:Z0,useExisting:Q_}])}function N3(e){let n=[{provide:MC,useValue:g3},{provide:AC,useValue:de({skipNextTransition:!!e?.skipInitialTransition},e)}];return Hc(9,n)}var Z_=new Ie("ROUTER_FORROOT_GUARD"),R3=[ha,{provide:Bc,useClass:_a},Re,Vc,{provide:dn,useFactory:PC,deps:[Re]},zm,[]],mr=(()=>{class e{constructor(t){}static forRoot(t,r){return{ngModule:e,providers:[R3,[],{provide:Nc,multi:!0,useValue:t},{provide:Z_,useFactory:U3,deps:[[Re,new $l,new ep]]},{provide:jc,useValue:r||{}},r?.useHash?L3():V3(),B3(),r?.preloadingStrategy?P3(r.preloadingStrategy).\u0275providers:[],r?.initialNavigation?j3(r):[],r?.bindToComponentInputs?F3().\u0275providers:[],r?.enableViewTransitions?N3().\u0275providers:[],H3()]}}static forChild(t){return{ngModule:e,providers:[{provide:Nc,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||e)(ke(Z_,8))}}static{this.\u0275mod=ni({type:e})}static{this.\u0275inj=ti({})}}return e})();function B3(){return{provide:IC,useFactory:()=>{let e=ue(__),n=ue(qt),t=ue(jc),r=ue(Qm),i=ue(Bc);return t.scrollOffset&&e.setOffset(t.scrollOffset),new O3(i,r,e,n,t)}}}function L3(){return{provide:Yi,useClass:g_}}function V3(){return{provide:Yi,useClass:Kp}}function U3(e){return"guarded"}function j3(e){return[e.initialNavigation==="disabled"?k3().\u0275providers:[],e.initialNavigation==="enabledBlocking"?I3().\u0275providers:[]]}var J_=new Ie("");function H3(){return[{provide:J_,useFactory:FC},{provide:pc,multi:!0,useExisting:J_}]}var zC=(()=>{class e{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||e)(Q(si),Q(er))}}static{this.\u0275dir=bt({type:e})}}return e})(),Xc=(()=>{class e extends zC{static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,features:[Vn]})}}return e})(),Es=new Ie(""),$3={provide:Es,useExisting:fr(()=>Yc),multi:!0},Yc=(()=>{class e extends Xc{writeValue(t){this.setProperty("checked",t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(r,i){r&1&&H("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[jr([$3]),Vn]})}}return e})(),q3={provide:Es,useExisting:fr(()=>jt),multi:!0};function W3(){let e=Xi()?Xi().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}var z3=new Ie(""),jt=(()=>{class e extends zC{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,this._compositionMode==null&&(this._compositionMode=!W3())}writeValue(t){let r=t??"";this.setProperty("value",r)}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||e)(Q(si),Q(er),Q(z3,8))}}static{this.\u0275dir=bt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){r&1&&H("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[jr([q3]),Vn]})}}return e})();function Ro(e){return e==null||(typeof e=="string"||Array.isArray(e))&&e.length===0}function GC(e){return e!=null&&typeof e.length=="number"}var Oa=new Ie(""),ld=new Ie(""),G3=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Ma=class{static min(n){return QC(n)}static max(n){return Q3(n)}static required(n){return XC(n)}static requiredTrue(n){return X3(n)}static email(n){return Y3(n)}static minLength(n){return K3(n)}static maxLength(n){return Z3(n)}static pattern(n){return J3(n)}static nullValidator(n){return nd(n)}static compose(n){return ty(n)}static composeAsync(n){return ny(n)}};function QC(e){return n=>{if(Ro(n.value)||Ro(e))return null;let t=parseFloat(n.value);return!isNaN(t)&&t<e?{min:{min:e,actual:n.value}}:null}}function Q3(e){return n=>{if(Ro(n.value)||Ro(e))return null;let t=parseFloat(n.value);return!isNaN(t)&&t>e?{max:{max:e,actual:n.value}}:null}}function XC(e){return Ro(e.value)?{required:!0}:null}function X3(e){return e.value===!0?null:{required:!0}}function Y3(e){return Ro(e.value)||G3.test(e.value)?null:{email:!0}}function K3(e){return n=>Ro(n.value)||!GC(n.value)?null:n.value.length<e?{minlength:{requiredLength:e,actualLength:n.value.length}}:null}function Z3(e){return n=>GC(n.value)&&n.value.length>e?{maxlength:{requiredLength:e,actualLength:n.value.length}}:null}function J3(e){if(!e)return nd;let n,t;return typeof e=="string"?(t="",e.charAt(0)!=="^"&&(t+="^"),t+=e,e.charAt(e.length-1)!=="$"&&(t+="$"),n=new RegExp(t)):(t=e.toString(),n=e),r=>{if(Ro(r.value))return null;let i=r.value;return n.test(i)?null:{pattern:{requiredPattern:t,actualValue:i}}}}function nd(e){return null}function YC(e){return e!=null}function KC(e){return hs(e)?At(e):e}function ZC(e){let n={};return e.forEach(t=>{n=t!=null?de(de({},n),t):n}),Object.keys(n).length===0?null:n}function JC(e,n){return n.map(t=>t(e))}function eP(e){return!e.validate}function ey(e){return e.map(n=>eP(n)?n:t=>n.validate(t))}function ty(e){if(!e)return null;let n=e.filter(YC);return n.length==0?null:function(t){return ZC(JC(t,n))}}function tg(e){return e!=null?ty(ey(e)):null}function ny(e){if(!e)return null;let n=e.filter(YC);return n.length==0?null:function(t){let r=JC(t,n).map(KC);return Ja(r).pipe(Xe(ZC))}}function ng(e){return e!=null?ny(ey(e)):null}function BC(e,n){return e===null?[n]:Array.isArray(e)?[...e,n]:[e,n]}function ry(e){return e._rawValidators}function iy(e){return e._rawAsyncValidators}function Ym(e){return e?Array.isArray(e)?e:[e]:[]}function rd(e,n){return Array.isArray(e)?e.includes(n):e===n}function LC(e,n){let t=Ym(n);return Ym(e).forEach(i=>{rd(t,i)||t.push(i)}),t}function VC(e,n){return Ym(n).filter(t=>!rd(e,t))}var id=class{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=tg(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=ng(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,t){return this.control?this.control.hasError(n,t):!1}getError(n,t){return this.control?this.control.getError(n,t):null}},eo=class extends id{get formDirective(){return null}get path(){return null}},xs=class extends id{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}},od=class{constructor(n){this._cd=n}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},tP={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},BG=qe(de({},tP),{"[class.ng-submitted]":"isSubmitted"}),Ot=(()=>{class e extends od{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||e)(Q(xs,2))}}static{this.\u0275dir=bt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){r&2&&xt("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[Vn]})}}return e})(),Sn=(()=>{class e extends od{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||e)(Q(eo,10))}}static{this.\u0275dir=bt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){r&2&&xt("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[Vn]})}}return e})();var $c="VALID",td="INVALID",Da="PENDING",qc="DISABLED",Bo=class{},sd=class extends Bo{constructor(n,t){super(),this.value=n,this.source=t}},zc=class extends Bo{constructor(n,t){super(),this.pristine=n,this.source=t}},Gc=class extends Bo{constructor(n,t){super(),this.touched=n,this.source=t}},Sa=class extends Bo{constructor(n,t){super(),this.status=n,this.source=t}},Km=class extends Bo{constructor(n){super(),this.source=n}},Zm=class extends Bo{constructor(n){super(),this.source=n}};function rg(e){return(dd(e)?e.validators:e)||null}function nP(e){return Array.isArray(e)?tg(e):e||null}function ig(e,n){return(dd(n)?n.asyncValidators:e)||null}function rP(e){return Array.isArray(e)?ng(e):e||null}function dd(e){return e!=null&&!Array.isArray(e)&&typeof e=="object"}function oy(e,n,t){let r=e.controls;if(!(n?Object.keys(r):r).length)throw new Ne(1e3,"");if(!r[t])throw new Ne(1001,"")}function sy(e,n,t){e._forEachChild((r,i)=>{if(t[i]===void 0)throw new Ne(1002,"")})}var Aa=class{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=null,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this._status=da(()=>this.statusReactive()),this.statusReactive=ua(void 0),this._pristine=da(()=>this.pristineReactive()),this.pristineReactive=ua(!0),this._touched=da(()=>this.touchedReactive()),this.touchedReactive=ua(!1),this._events=new wn,this.events=this._events.asObservable(),this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get status(){return Di(this.statusReactive)}set status(n){Di(()=>this.statusReactive.set(n))}get valid(){return this.status===$c}get invalid(){return this.status===td}get pending(){return this.status==Da}get disabled(){return this.status===qc}get enabled(){return this.status!==qc}get pristine(){return Di(this.pristineReactive)}set pristine(n){Di(()=>this.pristineReactive.set(n))}get dirty(){return!this.pristine}get touched(){return Di(this.touchedReactive)}set touched(n){Di(()=>this.touchedReactive.set(n))}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(LC(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(LC(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(VC(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(VC(n,this._rawAsyncValidators))}hasValidator(n){return rd(this._rawValidators,n)}hasAsyncValidator(n){return rd(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){let t=this.touched===!1;this.touched=!0;let r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsTouched(qe(de({},n),{sourceControl:r})),t&&n.emitEvent!==!1&&this._events.next(new Gc(!0,r))}markAllAsTouched(n={}){this.markAsTouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:this}),this._forEachChild(t=>t.markAllAsTouched(n))}markAsUntouched(n={}){let t=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let r=n.sourceControl??this;this._forEachChild(i=>{i.markAsUntouched({onlySelf:!0,emitEvent:n.emitEvent,sourceControl:r})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,r),t&&n.emitEvent!==!1&&this._events.next(new Gc(!1,r))}markAsDirty(n={}){let t=this.pristine===!0;this.pristine=!1;let r=n.sourceControl??this;this._parent&&!n.onlySelf&&this._parent.markAsDirty(qe(de({},n),{sourceControl:r})),t&&n.emitEvent!==!1&&this._events.next(new zc(!1,r))}markAsPristine(n={}){let t=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let r=n.sourceControl??this;this._forEachChild(i=>{i.markAsPristine({onlySelf:!0,emitEvent:n.emitEvent})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n,r),t&&n.emitEvent!==!1&&this._events.next(new zc(!0,r))}markAsPending(n={}){this.status=Da;let t=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new Sa(this.status,t)),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.markAsPending(qe(de({},n),{sourceControl:t}))}disable(n={}){let t=this._parentMarkedDirty(n.onlySelf);this.status=qc,this.errors=null,this._forEachChild(i=>{i.disable(qe(de({},n),{onlySelf:!0}))}),this._updateValue();let r=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new sd(this.value,r)),this._events.next(new Sa(this.status,r)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(qe(de({},n),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){let t=this._parentMarkedDirty(n.onlySelf);this.status=$c,this._forEachChild(r=>{r.enable(qe(de({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(qe(de({},n),{skipPristineCheck:t}),this),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n,t){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine({},t),this._parent._updateTouched({},t))}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let r=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===$c||this.status===Da)&&this._runAsyncValidator(r,n.emitEvent)}let t=n.sourceControl??this;n.emitEvent!==!1&&(this._events.next(new sd(this.value,t)),this._events.next(new Sa(this.status,t)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(qe(de({},n),{sourceControl:t}))}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?qc:$c}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n,t){if(this.asyncValidator){this.status=Da,this._hasOwnPendingAsyncValidator={emitEvent:t!==!1};let r=KC(this.asyncValidator(this));this._asyncValidationSubscription=r.subscribe(i=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(i,{emitEvent:t,shouldHaveEmitted:n})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let n=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,n}return!1}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(t.emitEvent!==!1,this,t.shouldHaveEmitted)}get(n){let t=n;return t==null||(Array.isArray(t)||(t=t.split(".")),t.length===0)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(n,t){let r=t?this.get(t):this;return r&&r.errors?r.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n,t,r){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),(n||r)&&this._events.next(new Sa(this.status,t)),this._parent&&this._parent._updateControlsErrors(n,t,r)}_initObservables(){this.valueChanges=new Ut,this.statusChanges=new Ut}_calculateStatus(){return this._allControlsDisabled()?qc:this.errors?td:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Da)?Da:this._anyControlsHaveStatus(td)?td:$c}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n,t){let r=!this._anyControlsDirty(),i=this.pristine!==r;this.pristine=r,this._parent&&!n.onlySelf&&this._parent._updatePristine(n,t),i&&this._events.next(new zc(this.pristine,t))}_updateTouched(n={},t){this.touched=this._anyControlsTouched(),this._events.next(new Gc(this.touched,t)),this._parent&&!n.onlySelf&&this._parent._updateTouched(n,t)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){dd(n)&&n.updateOn!=null&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){let t=this._parent&&this._parent.dirty;return!n&&!!t&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=nP(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=rP(this._rawAsyncValidators)}},Ta=class extends Aa{constructor(n,t,r){super(rg(t),ig(r,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,r={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){sy(this,!0,n),Object.keys(n).forEach(r=>{oy(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){n!=null&&(Object.keys(n).forEach(r=>{let i=this.controls[r];i&&i.patchValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((r,i)=>{r.reset(n?n[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,r)=>(n[r]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,r)=>r._syncPendingControls()?!0:t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{let r=this.controls[t];r&&n(r,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(let[t,r]of Object.entries(this.controls))if(this.contains(t)&&n(r))return!0;return!1}_reduceValue(){let n={};return this._reduceChildren(n,(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(n,t){let r=n;return this._forEachChild((i,o)=>{r=t(r,i,o)}),r}_allControlsDisabled(){for(let n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}};var Jm=class extends Ta{};var Kc=new Ie("CallSetDisabledState",{providedIn:"root",factory:()=>fd}),fd="always";function ay(e,n){return[...n.path,e]}function ad(e,n,t=fd){og(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||t==="always")&&n.valueAccessor.setDisabledState?.(e.disabled),oP(e,n),aP(e,n),sP(e,n),iP(e,n)}function UC(e,n,t=!0){let r=()=>{};n.valueAccessor&&(n.valueAccessor.registerOnChange(r),n.valueAccessor.registerOnTouched(r)),ud(e,n),e&&(n._invokeOnDestroyCallbacks(),e._registerOnCollectionChange(()=>{}))}function cd(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function iP(e,n){if(n.valueAccessor.setDisabledState){let t=r=>{n.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}function og(e,n){let t=ry(e);n.validator!==null?e.setValidators(BC(t,n.validator)):typeof t=="function"&&e.setValidators([t]);let r=iy(e);n.asyncValidator!==null?e.setAsyncValidators(BC(r,n.asyncValidator)):typeof r=="function"&&e.setAsyncValidators([r]);let i=()=>e.updateValueAndValidity();cd(n._rawValidators,i),cd(n._rawAsyncValidators,i)}function ud(e,n){let t=!1;if(e!==null){if(n.validator!==null){let i=ry(e);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==n.validator);o.length!==i.length&&(t=!0,e.setValidators(o))}}if(n.asyncValidator!==null){let i=iy(e);if(Array.isArray(i)&&i.length>0){let o=i.filter(s=>s!==n.asyncValidator);o.length!==i.length&&(t=!0,e.setAsyncValidators(o))}}}let r=()=>{};return cd(n._rawValidators,r),cd(n._rawAsyncValidators,r),t}function oP(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,e.updateOn==="change"&&cy(e,n)})}function sP(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,e.updateOn==="blur"&&e._pendingChange&&cy(e,n),e.updateOn!=="submit"&&e.markAsTouched()})}function cy(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function aP(e,n){let t=(r,i)=>{n.valueAccessor.writeValue(r),i&&n.viewToModelUpdate(r)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}function uy(e,n){e==null,og(e,n)}function cP(e,n){return ud(e,n)}function ly(e,n){if(!e.hasOwnProperty("model"))return!1;let t=e.model;return t.isFirstChange()?!0:!Object.is(n,t.currentValue)}function uP(e){return Object.getPrototypeOf(e.constructor)===Xc}function dy(e,n){e._syncPendingControls(),n.forEach(t=>{let r=t.control;r.updateOn==="submit"&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}function fy(e,n){if(!n)return null;Array.isArray(n);let t,r,i;return n.forEach(o=>{o.constructor===jt?t=o:uP(o)?r=o:i=o}),i||r||t||null}function lP(e,n){let t=e.indexOf(n);t>-1&&e.splice(t,1)}var dP={provide:eo,useExisting:fr(()=>Pn)},Wc=Promise.resolve(),Pn=(()=>{class e extends eo{get submitted(){return Di(this.submittedReactive)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=da(()=>this.submittedReactive()),this.submittedReactive=ua(!1),this._directives=new Set,this.ngSubmit=new Ut,this.form=new Ta({},tg(t),ng(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){Wc.then(()=>{let r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),ad(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){Wc.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){Wc.then(()=>{let r=this._findContainer(t.path),i=new Ta({});uy(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){Wc.then(()=>{let r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){Wc.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submittedReactive.set(!0),dy(this.form,this._directives),this.ngSubmit.emit(t),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(r){return new(r||e)(Q(Oa,10),Q(ld,10),Q(Kc,8))}}static{this.\u0275dir=bt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){r&1&&H("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[jr([dP]),Vn]})}}return e})();function jC(e,n){let t=e.indexOf(n);t>-1&&e.splice(t,1)}function HC(e){return typeof e=="object"&&e!==null&&Object.keys(e).length===2&&"value"in e&&"disabled"in e}var Qc=class extends Aa{constructor(n=null,t,r){super(rg(t),ig(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),dd(t)&&(t.nonNullable||t.initialValueIsDefault)&&(HC(n)?this.defaultValue=n.value:this.defaultValue=n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&t.emitModelToViewChange!==!1&&this._onChange.forEach(r=>r(this.value,t.emitViewToModelChange!==!1)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){jC(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){jC(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(n){HC(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}};var fP=e=>e instanceof Qc;var hP={provide:xs,useExisting:fr(()=>Vt)},$C=Promise.resolve(),Vt=(()=>{class e extends xs{constructor(t,r,i,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new Qc,this._registered=!1,this.name="",this.update=new Ut,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=fy(this,o)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){let r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),ly(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){ad(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(t){$C.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){let r=t.isDisabled.currentValue,i=r!==0&&To(r);$C.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?ay(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||e)(Q(eo,9),Q(Oa,10),Q(ld,10),Q(Es,10),Q(Ao,8),Q(Kc,8))}}static{this.\u0275dir=bt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[jr([hP]),Vn,ii]})}}return e})(),Mn=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=bt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return e})(),pP={provide:Es,useExisting:fr(()=>Zc),multi:!0},Zc=(()=>{class e extends Xc{writeValue(t){let r=t??"";this.setProperty("value",r)}registerOnChange(t){this.onChange=r=>{t(r==""?null:parseFloat(r))}}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(r,i){r&1&&H("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[jr([pP]),Vn]})}}return e})();var hy=new Ie("");var mP={provide:eo,useExisting:fr(()=>sg)},sg=(()=>{class e extends eo{get submitted(){return Di(this._submittedReactive)}set submitted(t){this._submittedReactive.set(t)}constructor(t,r,i){super(),this.callSetDisabledState=i,this._submitted=da(()=>this._submittedReactive()),this._submittedReactive=ua(!1),this._onCollectionChange=()=>this._updateDomValue(),this.directives=[],this.form=null,this.ngSubmit=new Ut,this._setValidators(t),this._setAsyncValidators(r)}ngOnChanges(t){this._checkFormPresent(),t.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(ud(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(t){let r=this.form.get(t.path);return ad(r,t,this.callSetDisabledState),r.updateValueAndValidity({emitEvent:!1}),this.directives.push(t),r}getControl(t){return this.form.get(t.path)}removeControl(t){UC(t.control||null,t,!1),lP(this.directives,t)}addFormGroup(t){this._setUpFormContainer(t)}removeFormGroup(t){this._cleanUpFormContainer(t)}getFormGroup(t){return this.form.get(t.path)}addFormArray(t){this._setUpFormContainer(t)}removeFormArray(t){this._cleanUpFormContainer(t)}getFormArray(t){return this.form.get(t.path)}updateModel(t,r){this.form.get(t.path).setValue(r)}onSubmit(t){return this._submittedReactive.set(!0),dy(this.form,this.directives),this.ngSubmit.emit(t),this.form._events.next(new Km(this.control)),t?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this._submittedReactive.set(!1),this.form._events.next(new Zm(this.form))}_updateDomValue(){this.directives.forEach(t=>{let r=t.control,i=this.form.get(t.path);r!==i&&(UC(r||null,t),fP(i)&&(ad(i,t,this.callSetDisabledState),t.control=i))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(t){let r=this.form.get(t.path);uy(r,t),r.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(t){if(this.form){let r=this.form.get(t.path);r&&cP(r,t)&&r.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){og(this.form,this),this._oldForm&&ud(this._oldForm,this)}_checkFormPresent(){this.form}static{this.\u0275fac=function(r){return new(r||e)(Q(Oa,10),Q(ld,10),Q(Kc,8))}}static{this.\u0275dir=bt({type:e,selectors:[["","formGroup",""]],hostBindings:function(r,i){r&1&&H("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[jr([mP]),Vn,ii]})}}return e})();var gP={provide:xs,useExisting:fr(()=>ag)},ag=(()=>{class e extends xs{set isDisabled(t){}static{this._ngModelWarningSentOnce=!1}constructor(t,r,i,o,s){super(),this._ngModelWarningConfig=s,this._added=!1,this.name=null,this.update=new Ut,this._ngModelWarningSent=!1,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=fy(this,o)}ngOnChanges(t){this._added||this._setUpControl(),ly(t,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}get path(){return ay(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}_setUpControl(){this._checkParentType(),this.control=this.formDirective.addControl(this),this._added=!0}static{this.\u0275fac=function(r){return new(r||e)(Q(eo,13),Q(Oa,10),Q(ld,10),Q(Es,10),Q(hy,8))}}static{this.\u0275dir=bt({type:e,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},features:[jr([gP]),Vn,ii]})}}return e})(),xP={provide:Es,useExisting:fr(()=>jn),multi:!0};function py(e,n){return e==null?`${n}`:(n&&typeof n=="object"&&(n="Object"),`${e}: ${n}`.slice(0,50))}function EP(e){return e.split(":")[0]}var jn=(()=>{class e extends Xc{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r=this._getOptionId(t),i=py(r,t);this.setProperty("value",i)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){let r=EP(t);return this._optionMap.has(r)?this._optionMap.get(r):t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(r,i){r&1&&H("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[jr([xP]),Vn]})}}return e})(),gr=(()=>{class e{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption())}set ngValue(t){this._select!=null&&(this._select._optionMap.set(this.id,t),this._setElementValue(py(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||e)(Q(er),Q(si),Q(jn,9))}}static{this.\u0275dir=bt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return e})(),vP={provide:Es,useExisting:fr(()=>my),multi:!0};function qC(e,n){return e==null?`${n}`:(typeof n=="string"&&(n=`'${n}'`),n&&typeof n=="object"&&(n="Object"),`${e}: ${n}`.slice(0,50))}function _P(e){return e.split(":")[0]}var my=(()=>{class e extends Xc{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;let r;if(Array.isArray(t)){let i=t.map(o=>this._getOptionId(o));r=(o,s)=>{o._setSelected(i.indexOf(s.toString())>-1)}}else r=(i,o)=>{i._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{let i=[],o=r.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],d=this._getOptionValue(c.value);i.push(d)}}else{let s=r.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let d=this._getOptionValue(c.value);i.push(d)}}}this.value=i,t(i)}}_registerOption(t){let r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(let r of this._optionMap.keys())if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){let r=_P(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(r,i){r&1&&H("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[jr([vP]),Vn]})}}return e})(),xr=(()=>{class e{constructor(t,r,i){this._element=t,this._renderer=r,this._select=i,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){this._select!=null&&(this._value=t,this._setElementValue(qC(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(qC(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static{this.\u0275fac=function(r){return new(r||e)(Q(er),Q(si),Q(my,9))}}static{this.\u0275dir=bt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}}return e})();function CP(e){return typeof e=="number"?e:parseFloat(e)}var gy=(()=>{class e{constructor(){this._validator=nd}ngOnChanges(t){if(this.inputName in t){let r=this.normalizeInput(t[this.inputName].currentValue);this._enabled=this.enabled(r),this._validator=this._enabled?this.createValidator(r):nd,this._onChange&&this._onChange()}}validate(t){return this._validator(t)}registerOnValidatorChange(t){this._onChange=t}enabled(t){return t!=null}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275dir=bt({type:e,features:[ii]})}}return e})();var yP={provide:Oa,useExisting:fr(()=>Jc),multi:!0},Jc=(()=>{class e extends gy{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=t=>CP(t),this.createValidator=t=>QC(t)}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(r,i){r&2&&la("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[jr([yP]),Vn]})}}return e})(),wP={provide:Oa,useExisting:fr(()=>_n),multi:!0};var _n=(()=>{class e extends gy{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=To,this.createValidator=t=>XC}enabled(t){return t}static{this.\u0275fac=(()=>{let t;return function(i){return(t||(t=oi(e)))(i||e)}})()}static{this.\u0275dir=bt({type:e,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(r,i){r&2&&la("required",i._enabled?"":null)},inputs:{required:"required"},features:[jr([wP]),Vn]})}}return e})();var xy=(()=>{class e{static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=ni({type:e})}static{this.\u0275inj=ti({})}}return e})(),eg=class extends Aa{constructor(n,t,r){super(rg(t),ig(r,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[this._adjustIndex(n)]}push(n,t={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}insert(n,t,r={}){this.controls.splice(n,0,t),this._registerControl(t),this.updateValueAndValidity({emitEvent:r.emitEvent})}removeAt(n,t={}){let r=this._adjustIndex(n);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),this.updateValueAndValidity({emitEvent:t.emitEvent})}setControl(n,t,r={}){let i=this._adjustIndex(n);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),t&&(this.controls.splice(i,0,t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,t={}){sy(this,!1,n),n.forEach((r,i)=>{oy(this,!1,i),this.at(i).setValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){n!=null&&(n.forEach((r,i)=>{this.at(i)&&this.at(i).patchValue(r,{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n=[],t={}){this._forEachChild((r,i)=>{r.reset(n[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t,this),this._updateTouched(t,this),this.updateValueAndValidity(t)}getRawValue(){return this.controls.map(n=>n.getRawValue())}clear(n={}){this.controls.length<1||(this._forEachChild(t=>t._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_adjustIndex(n){return n<0?n+this.length:n}_syncPendingControls(){let n=this.controls.reduce((t,r)=>r._syncPendingControls()?!0:t,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((t,r)=>{n(t,r)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(t=>t.enabled&&n(t))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(let n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}_find(n){return this.at(n)??null}};function WC(e){return!!e&&(e.asyncValidators!==void 0||e.validators!==void 0||e.updateOn!==void 0)}var Ey=(()=>{class e{constructor(){this.useNonNullable=!1}get nonNullable(){let t=new e;return t.useNonNullable=!0,t}group(t,r=null){let i=this._reduceControls(t),o={};return WC(r)?o=r:r!==null&&(o.validators=r.validator,o.asyncValidators=r.asyncValidator),new Ta(i,o)}record(t,r=null){let i=this._reduceControls(t);return new Jm(i,r)}control(t,r,i){let o={};return this.useNonNullable?(WC(r)?o=r:(o.validators=r,o.asyncValidators=i),new Qc(t,qe(de({},o),{nonNullable:!0}))):new Qc(t,r,i)}array(t,r,i){let o=t.map(s=>this._createControl(s));return new eg(o,r,i)}_reduceControls(t){let r={};return Object.keys(t).forEach(i=>{r[i]=this._createControl(t[i])}),r}_createControl(t){if(t instanceof Qc)return t;if(t instanceof Aa)return t;if(Array.isArray(t)){let r=t[0],i=t.length>1?t[1]:null,o=t.length>2?t[2]:null;return this.control(r,i,o)}else return this.control(t)}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var He=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:Kc,useValue:t.callSetDisabledState??fd}]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=ni({type:e})}static{this.\u0275inj=ti({imports:[xy]})}}return e})(),vy=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:hy,useValue:t.warnOnNgModelWithFormControl??"always"},{provide:Kc,useValue:t.callSetDisabledState??fd}]}}static{this.\u0275fac=function(r){return new(r||e)}}static{this.\u0275mod=ni({type:e})}static{this.\u0275inj=ti({imports:[xy]})}}return e})();var ze=class e{constructor(n){this.http=n}apiUrl="http://localhost:3000";signIn(n){return this.http.post(`${this.apiUrl}/sign-in`,n).pipe(Ft(t=>{console.log("\u0110\u0103ng nh\u1EADp th\xE0nh c\xF4ng:",t),t.user&&t.token?(localStorage.setItem("user",JSON.stringify(t.user)),this.saveToken(t.token)):console.error("Ph\u1EA3n h\u1ED3i \u0111\u0103ng nh\u1EADp kh\xF4ng c\xF3 token ho\u1EB7c user")}),Et(this.handleError))}saveToken(n){localStorage.setItem("auth_token",n)}getToken(){return localStorage.getItem("auth_token")}checkEmailExist(n){return this.http.get(`${this.apiUrl}/check-email?email=${n}`)}register(n){return this.http.post(`${this.apiUrl}/sign-up`,n).pipe(Et(this.handleError))}updateUserRole(n,t){let r=this.getToken(),i=new Bt({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/users/${n}/role`,{role:t},{headers:i}).pipe(Et(this.handleError))}getCurrentUser(){let n=localStorage.getItem("user");return console.log("User from localStorage:",n),n?JSON.parse(n):null}getCurrentUserFromApi(){let n=this.getToken();if(!n)return console.error("Token kh\xF4ng t\u1ED3n t\u1EA1i"),vn("Token kh\xF4ng t\u1ED3n t\u1EA1i");let t=new Bt({Authorization:`Bearer ${n}`});return this.http.get(`${this.apiUrl}/user`,{headers:t}).pipe(Et(r=>(console.error("L\u1ED7i khi g\u1ECDi API:",r),vn(r))))}getAllUsers(){let n=this.getToken(),t=new Bt({Authorization:`Bearer ${n}`});return this.http.get(`${this.apiUrl}/users`,{headers:t}).pipe(Et(this.handleError))}updateUser(n){let t=this.getToken(),r=new Bt({Authorization:`Bearer ${t}`});return this.http.put(`${this.apiUrl}/users/${n._id}`,n,{headers:r}).pipe(Et(this.handleError))}getUserId(){let n=this.getCurrentUser();return n?n._id:null}getUserById(n){let t=this.getToken();if(!t)return console.error("Token kh\xF4ng t\u1ED3n t\u1EA1i"),vn("Token kh\xF4ng t\u1ED3n t\u1EA1i");let r=new Bt({Authorization:`Bearer ${t}`});return this.http.get(`${this.apiUrl}/users/${n}`,{headers:r}).pipe(Et(i=>(console.error("L\u1ED7i khi l\u1EA5y th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng:",i),vn(i))))}logout(){return this.http.post(`${this.apiUrl}/logout`,{}).pipe(Ft(()=>{localStorage.removeItem("user"),localStorage.removeItem("auth_token")}),Et(this.handleError))}handleError(n){return console.error("L\u1ED7i trong qu\xE1 tr\xECnh x\u1EED l\xFD:",n),n.status===401?alert("Email ho\u1EB7c m\u1EADt kh\u1EA9u kh\xF4ng \u0111\xFAng!"):alert("\u0110\xE3 x\u1EA3y ra l\u1ED7i. Vui l\xF2ng th\u1EED l\u1EA1i."),vn(n)}static \u0275fac=function(t){return new(t||e)(ke(Ki))};static \u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})};function bP(e,n){if(e&1&&(l(0,"div",22),f(1),u()),e&2){let t=D();m(),te(" ",t.errorMessage," ")}}var hd=class e{constructor(n,t,r){this.formBuilder=n;this.authService=t;this.router=r;this.loginForm=this.formBuilder.group({email:["",[Ma.required,Ma.email]],password:["",Ma.required]})}loginForm;errorMessage=null;onSubmit(){this.loginForm.valid?(console.log("\u0110ang th\u1EF1c hi\u1EC7n g\u1EEDi bi\u1EC3u m\u1EABu:",this.loginForm.value),this.authService.signIn(this.loginForm.value).subscribe({next:n=>{console.log("\u0110\u0103ng nh\u1EADp th\xE0nh c\xF4ng:",n),this.router.navigate(["/role"]),localStorage.setItem("user",JSON.stringify(n.user)),n.user.role==="admin"?this.router.navigate(["/admin-dashboard"]):this.router.navigate(["/role"])},error:n=>{console.error("\u0110\u0103ng nh\u1EADp th\u1EA5t b\u1EA1i:",n),this.errorMessage="Invalid credentials"}})):console.log("Form kh\xF4ng h\u1EE3p l\u1EC7")}static \u0275fac=function(t){return new(t||e)(Q(Ey),Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-login"]],standalone:!0,features:[Me],decls:33,vars:2,consts:[[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"row"],[1,"col-md-6"],[1,"login-form","bg-white","p-4","rounded","shadow"],[1,"text-center"],[1,"text-muted","text-center"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","formControlName","email","id","email","required","",1,"form-control"],["for","password",1,"form-label"],["type","password","formControlName","password","id","password","required","",1,"form-control"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],["type","checkbox","id","remember",1,"me-1"],["for","remember"],["routerLink","/forgot-password",1,"forgot-password","text-danger"],["type","submit",1,"btn","btn-primary","w-100"],["class","error-message text-danger",4,"ngIf"],[1,"text-center","mt-3"],["routerLink","/register",1,"text-danger"],[1,"col-md-6","d-none","d-md-block","d-flex","align-items-center","justify-content-center",2,"padding-left","150px","padding-top","50px"],["src","../../assets/img/login.png","alt","Description","width","500","height","500",1,"img-fluid"],[1,"error-message","text-danger"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),f(5,"\u0110\u0103ng nh\u1EADp"),u(),l(6,"p",5),f(7,"\u0110\u0103ng nh\u1EADp \u0111\u1EC3 truy c\u1EADp t\xE0i kho\u1EA3n c\u1EE7a b\u1EA1n"),u(),l(8,"form",6),H("ngSubmit",function(){return r.onSubmit()}),l(9,"div",7)(10,"label",8),f(11,"Email:"),u(),N(12,"input",9),u(),l(13,"div",7)(14,"label",10),f(15,"Password:"),u(),N(16,"input",11),u(),l(17,"div",12)(18,"div"),N(19,"input",13),l(20,"label",14),f(21,"L\u01B0u m\u1EADt kh\u1EA9u"),u()(),l(22,"a",15),f(23,"Qu\xEAn m\u1EADt kh\u1EA9u?"),u()(),l(24,"button",16),f(25,"\u0110\u0103ng nh\u1EADp"),u(),G(26,bP,2,1,"div",17),l(27,"p",18),f(28,"B\u1EA1n ch\u01B0a c\xF3 t\xE0i kho\u1EA3n? "),l(29,"a",19),f(30,"\u0110\u0103ng k\xED t\u1EA1i \u0111\xE2y"),u()()()()(),l(31,"div",20),N(32,"img",21),u()()()),t&2&&(m(8),O("formGroup",r.loginForm),m(18),O("ngIf",r.errorMessage))},dependencies:[bn,He,Mn,jt,Ot,Sn,_n,vy,sg,ag,Ue,We],styles:['@charset "UTF-8";input.form-control[_ngcontent-%COMP%]{border:2px solid #86c0ff;border-radius:4px}input.form-control[_ngcontent-%COMP%]:focus{border-color:#0056b3;box-shadow:0 0 5px #007bff80}.login-options[_ngcontent-%COMP%]{display:flex;flex-direction:space-between;align-items:center;margin-top:20px}.login-options[_ngcontent-%COMP%]   .login-option[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;width:50%;max-width:300px;padding:20px;border-radius:4px;background:#fff;border:1px solid #ddd;box-shadow:0 2px 4px #0000001a;margin-bottom:10px;transition:background-color .2s,box-shadow .2s}.login-options[_ngcontent-%COMP%]   .login-option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;box-shadow:0 4px 8px #0000001a}.register-link[_ngcontent-%COMP%]{color:red;text-decoration:none}.register-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.forgot-password[_ngcontent-%COMP%]{color:red;text-decoration:none}.forgot-password[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};function DP(e,n){e&1&&(l(0,"div",29),f(1,"T\xEAn l\xE0 b\u1EAFt bu\u1ED9c"),u())}function SP(e,n){e&1&&(l(0,"div",29),f(1,"H\u1ECD l\xE0 b\u1EAFt bu\u1ED9c"),u())}function MP(e,n){e&1&&(l(0,"div",29),f(1,"Email l\xE0 b\u1EAFt bu\u1ED9c"),u())}function AP(e,n){e&1&&(l(0,"div",29),f(1,"Email kh\xF4ng h\u1EE3p l\u1EC7"),u())}function TP(e,n){e&1&&(l(0,"div",29),f(1,"Email \u0111\xE3 \u0111\u01B0\u1EE3c s\u1EED d\u1EE5ng"),u())}function OP(e,n){e&1&&(l(0,"div",29),f(1,"M\u1EADt kh\u1EA9u l\xE0 b\u1EAFt bu\u1ED9c"),u())}function IP(e,n){e&1&&(l(0,"div",29),f(1,"M\u1EADt kh\u1EA9u ph\u1EA3i c\xF3 \xEDt nh\u1EA5t 8 k\xFD t\u1EF1, m\u1ED9t ch\u1EEF hoa v\xE0 m\u1ED9t s\u1ED1"),u())}function kP(e,n){e&1&&(l(0,"div",29),f(1,"M\u1EADt kh\u1EA9u kh\xF4ng kh\u1EDBp"),u())}function PP(e,n){if(e&1&&(l(0,"div",30),f(1),u()),e&2){let t=D();m(),ae(t.errorMessage)}}function FP(e,n){if(e&1&&(l(0,"div",31),f(1),u()),e&2){let t=D();m(),ae(t.successMessage)}}var pd=class e{constructor(n,t){this.router=n;this.authService=t}firstName="";lastName="";email="";password="";confirmPassword="";errorMessage="";successMessage="";emailExists;navigateToLogin(){this.router.navigate(["/login"])}onSubmit(n){if(this.errorMessage="",this.successMessage="",!n.valid){this.errorMessage="Vui l\xF2ng \u0111i\u1EC1n \u0111\u1EA7y \u0111\u1EE7 th\xF4ng tin!";return}if(this.password!==this.confirmPassword){this.errorMessage="M\u1EADt kh\u1EA9u kh\xF4ng kh\u1EDBp!";return}if(!this.isValidEmail(this.email)){this.errorMessage="Email kh\xF4ng h\u1EE3p l\u1EC7!";return}this.authService.checkEmailExist(this.email).subscribe({next:t=>{if(t){this.emailExists=!0,this.errorMessage="Email \u0111\xE3 \u0111\u01B0\u1EE3c \u0111\u0103ng k\xFD!";return}this.emailExists=!1,this.registerUser()},error:t=>{console.error("L\u1ED7i khi ki\u1EC3m tra email:",t),this.errorMessage="C\xF3 l\u1ED7i x\u1EA3y ra, vui l\xF2ng th\u1EED l\u1EA1i."}})}registerUser(){let n={username:`${this.firstName} ${this.lastName}`,email:this.email,password:this.password};this.authService.register(n).subscribe({next:()=>{this.successMessage="\u0110\u0103ng k\xFD th\xE0nh c\xF4ng! Vui l\xF2ng \u0111\u0103ng nh\u1EADp.",setTimeout(()=>{this.navigateToLogin()},2e3)},error:t=>{console.error("L\u1ED7i khi \u0111\u0103ng k\xFD:",t),this.errorMessage="C\xF3 l\u1ED7i x\u1EA3y ra khi \u0111\u0103ng k\xFD, vui l\xF2ng th\u1EED l\u1EA1i."}})}isValidEmail(n){return/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/.test(n)}isValidPassword(n){return/^(?=.*[A-Z])(?=.*\d).{8,}$/.test(n)}static \u0275fac=function(t){return new(t||e)(Q(Re),Q(ze))};static \u0275cmp=Se({type:e,selectors:[["app-register"]],standalone:!0,features:[Me],decls:53,vars:16,consts:[["registerForm","ngForm"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"row"],[1,"register-form","bg-white","p-3","rounded","shadow",2,"max-width","500px","width","100%"],[1,"text-muted"],[3,"ngSubmit"],[1,"mb-6"],["for","firstName",1,"form-label"],["type","text","name","firstName","id","firstName","required","",1,"form-control",3,"ngModelChange","ngModel"],["class","text-danger",4,"ngIf"],["for","lastName",1,"form-label"],["type","text","name","lastName","id","lastName","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","email",1,"form-label"],["type","email","name","email","id","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","password",1,"form-label"],["type","password","name","password","id","password","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"mb-3"],["for","confirm-password",1,"form-label"],["type","password","name","confirmPassword","id","confirm-password","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check","mb-3"],["type","checkbox","required","",1,"form-check-input"],["for","terms",1,"form-check-label","terms-conditions"],["type","submit",1,"btn","btn-primary","w-100",3,"disabled"],[1,"text-center","mt-3"],["routerLink","/login",1,"register-link"],["class","error-message",4,"ngIf"],["class","success-message",4,"ngIf"],[1,"col-md-6","d-none","d-md-block","text-end"],["src","../../assets/img/user.png","alt","Description","width","400","height","400",1,"img-fluid"],[1,"text-danger"],[1,"error-message"],[1,"success-message"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",1)(1,"div",2)(2,"div",3)(3,"h2"),f(4,"\u0110\u0103ng k\xFD"),u(),l(5,"p",4),f(6,"T\u1EA1o t\xE0i kho\u1EA3n \u0111\u1EC3 tr\u1EA3i nghi\u1EC7m l\u1ED9 tr\xECnh h\u1ECDc hot nh\u1EA5t"),u(),l(7,"form",5,0),H("ngSubmit",function(){U(i);let s=Nt(8);return j(r.onSubmit(s))}),l(9,"div",6)(10,"label",7),f(11,"T\xEAn:"),u(),l(12,"input",8),ge("ngModelChange",function(s){return U(i),xe(r.firstName,s)||(r.firstName=s),j(s)}),u(),G(13,DP,2,0,"div",9),u(),l(14,"div",6)(15,"label",10),f(16,"H\u1ECD:"),u(),l(17,"input",11),ge("ngModelChange",function(s){return U(i),xe(r.lastName,s)||(r.lastName=s),j(s)}),u(),G(18,SP,2,0,"div",9),u(),l(19,"div",6)(20,"label",12),f(21,"Email:"),u(),l(22,"input",13),ge("ngModelChange",function(s){return U(i),xe(r.email,s)||(r.email=s),j(s)}),u(),G(23,MP,2,0,"div",9)(24,AP,2,0,"div",9)(25,TP,2,0,"div",9),u(),l(26,"div",6)(27,"label",14),f(28,"M\u1EADt kh\u1EA9u:"),u(),l(29,"input",15),ge("ngModelChange",function(s){return U(i),xe(r.password,s)||(r.password=s),j(s)}),u(),G(30,OP,2,0,"div",9)(31,IP,2,0,"div",9),u(),l(32,"div",16)(33,"label",17),f(34,"Nh\u1EADp l\u1EA1i m\u1EADt kh\u1EA9u:"),u(),l(35,"input",18),ge("ngModelChange",function(s){return U(i),xe(r.confirmPassword,s)||(r.confirmPassword=s),j(s)}),u(),G(36,kP,2,0,"div",9),u(),l(37,"div",19),N(38,"input",20),l(39,"label",21),f(40,"T\xF4i \u0111\u1ED3ng \xFD v\u1EDBi t\u1EA5t c\u1EA3 c\xE1c "),l(41,"b"),f(42,"\u0110i\u1EC1u kho\u1EA3n v\xE0 Ch\xEDnh s\xE1ch quy\u1EC1n ri\xEAng t\u01B0"),u()()(),l(43,"button",22),f(44,"T\u1EA1o t\xE0i kho\u1EA3n"),u(),l(45,"p",23),f(46,"B\u1EA1n \u0111\xE3 c\xF3 t\xE0i kho\u1EA3n? "),l(47,"a",24),f(48,"\u0110\u0103ng nh\u1EADp"),u()()(),G(49,PP,2,1,"div",25)(50,FP,2,1,"div",26),u()(),l(51,"div",27),N(52,"img",28),u()()}if(t&2){let i=Nt(8);m(12),me("ngModel",r.firstName),m(),O("ngIf",i.submitted&&!r.firstName),m(4),me("ngModel",r.lastName),m(),O("ngIf",i.submitted&&!r.lastName),m(4),me("ngModel",r.email),m(),O("ngIf",i.submitted&&!r.email),m(),O("ngIf",i.submitted&&r.email&&!r.isValidEmail(r.email)),m(),O("ngIf",i.submitted&&r.email&&r.emailExists),m(4),me("ngModel",r.password),m(),O("ngIf",i.submitted&&!r.password),m(),O("ngIf",i.submitted&&r.password&&!r.isValidPassword(r.password)),m(4),me("ngModel",r.confirmPassword),m(),O("ngIf",i.submitted&&r.confirmPassword!==r.password),m(7),O("disabled",!i.valid),m(6),O("ngIf",r.errorMessage),m(),O("ngIf",r.successMessage)}},dependencies:[He,Mn,jt,Ot,Sn,_n,Vt,Pn,mr,bn,Ue,We,F_],styles:["input.form-control[_ngcontent-%COMP%]{border:2px solid #86c0ff;border-radius:4px}input.form-control[_ngcontent-%COMP%]:focus{border-color:#0056b3;box-shadow:0 0 5px #007bff80}input.form-control.ng-invalid.ng-touched[_ngcontent-%COMP%]{border-color:#dc3545;box-shadow:0 0 5px #dc354580}.register-options[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:20px}.register-option[_ngcontent-%COMP%]{display:flex;align-items:center;cursor:pointer;padding:10px;border-radius:4px;background:#fff;border:1px solid #ddd;box-shadow:0 2px 4px #0000001a;transition:background-color .2s,box-shadow .2s}.register-option[_ngcontent-%COMP%]:hover{background-color:#f0f0f0;box-shadow:0 4px 8px #0000001a}.error-message[_ngcontent-%COMP%]{color:#dc3545;font-size:14px;margin-top:10px;text-align:center}.success-message[_ngcontent-%COMP%]{color:#28a745;font-size:14px;margin-top:10px;text-align:center}.login-link[_ngcontent-%COMP%]{color:red;text-decoration:none}.login-link[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};var md=class e{constructor(n){this.router=n}email="";onSubmit(n){if(!n.email){alert("Please enter your email address!");return}let t={email:n.email};console.log("Forgot Password Data:",t),alert("M\u1ED9t li\xEAn k\u1EBFt \u0111\u1EB7t l\u1EA1i m\u1EADt kh\u1EA9u \u0111\xE3 \u0111\u01B0\u1EE3c g\u1EEDi \u0111\u1EBFn \u0111\u1ECBa ch\u1EC9 email c\u1EE7a b\u1EA1n."),this.router.navigate(["/qrcode"])}static \u0275fac=function(t){return new(t||e)(Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-forgot-password"]],standalone:!0,features:[Me],decls:21,vars:1,consts:[["frm1","ngForm"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"row","w-100"],[1,"col-md-6"],[1,"text-start"],["routerLink","/login",1,"text-dark"],[1,"fa-solid","fa-chevron-left","me-2"],[1,"text-muted"],[3,"ngSubmit"],[1,"mb-3"],["for","email",1,"form-label"],["type","email","name","email","id","email","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","w-100"],[1,"col-md-6","d-none","d-md-block","d-flex","align-items-center","justify-content-center",2,"padding-left","150px","padding-top","50px"],["src","../../assets/img/secure.png","alt","Description","width","400","height","400",1,"img-fluid"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",1)(1,"div",2)(2,"div",3)(3,"p",4)(4,"a",5),N(5,"i",6),f(6,"Quay l\u1EA1i \u0111\u0103ng nh\u1EADp "),u()(),l(7,"h2"),f(8,"B\u1EA1n qu\xEAn m\u1EADt kh\u1EA9u"),u(),l(9,"p",7),f(10,"\u0110\u1EEBng lo l\u1EAFng. H\xE3y nh\u1EADp mail c\u1EE7a b\u1EA1n \u0111\u1EC3 ch\xFAng t\xF4i kh\u1EDFi t\u1EA1o m\u1EADt kh\u1EA9u m\u1EDBi!"),u(),l(11,"form",8,0),H("ngSubmit",function(){U(i);let s=Nt(12);return j(r.onSubmit(s.value))}),l(13,"div",9)(14,"label",10),f(15,"Email:"),u(),l(16,"input",11),ge("ngModelChange",function(s){return U(i),xe(r.email,s)||(r.email=s),j(s)}),u()(),l(17,"button",12),f(18,"Ch\u1EA5p nh\u1EADn"),u()()(),l(19,"div",13),N(20,"img",14),u()()()}t&2&&(m(16),me("ngModel",r.email))},dependencies:[bn,mr,He,Mn,jt,Ot,Sn,_n,Vt,Pn],styles:['@charset "UTF-8";input.form-control[_ngcontent-%COMP%]{border:2px solid #86c0ff;border-radius:4px}input.form-control[_ngcontent-%COMP%]:focus{border-color:#0056b3;box-shadow:0 0 5px #007bff80}.text-dark[_ngcontent-%COMP%]{text-decoration:none}.text-dark[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};var gd=class e{constructor(n){this.router=n}pincode="";onSubmit(n){if(!n.pincode){alert("Please enter pincode!");return}let t={pincode:n.pincode};console.log("Forgot Password Data:",t),this.router.navigate(["/reset-password"])}static \u0275fac=function(t){return new(t||e)(Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-qrcode"]],standalone:!0,features:[Me],decls:25,vars:1,consts:[["frm1","ngForm"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"row","w-100"],[1,"col-md-6"],[1,"text-start"],["routerLink","/login",1,"text-dark"],[1,"fa-solid","fa-chevron-left","me-2"],[1,"text-muted"],[3,"ngSubmit"],[1,"mb-3"],["for","pincode",1,"form-label"],["type","text","name","pincode","id","pincode","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"forgot-password","text-danger"],["type","submit",1,"btn","btn-primary","w-100"],[1,"col-md-6","d-none","d-md-block","d-flex","align-items-center","justify-content-center",2,"padding-left","150px","padding-top","50px"],["src","../../assets/img/qrcode.png","alt","Description","width","300","height","300",1,"img-fluid"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",1)(1,"div",2)(2,"div",3)(3,"p",4)(4,"a",5),N(5,"i",6),f(6,"Quay l\u1EA1i \u0111\u0103ng nh\u1EADp "),u()(),l(7,"h2"),f(8,"M\xE3 x\xE1c minh"),u(),l(9,"p",7),f(10,"M\xE3 t\u1EF1 \u0111\u1ED9ng \u0111\u01B0\u1EE3c g\u1EEDi v\xE0o mail c\u1EE7a b\u1EA1n"),u(),l(11,"form",8,0),H("ngSubmit",function(){U(i);let s=Nt(12);return j(r.onSubmit(s.value))}),l(13,"div",9)(14,"label",10),f(15,"Nh\u1EADp m\xE3:"),u(),l(16,"input",11),ge("ngModelChange",function(s){return U(i),xe(r.pincode,s)||(r.pincode=s),j(s)}),u()(),l(17,"p"),f(18,"B\u1EA1n ch\u01B0a nh\u1EADn \u0111\u01B0\u1EE3c m\xE3 x\xE1c minh? "),l(19,"a",12),f(20,"G\u1EEDi l\u1EA1i"),u()(),l(21,"button",13),f(22,"Ch\u1EA5p nh\u1EADn"),u()()(),l(23,"div",14),N(24,"img",15),u()()()}t&2&&(m(16),me("ngModel",r.pincode))},dependencies:[bn,mr,He,Mn,jt,Ot,Sn,_n,Vt,Pn],styles:['@charset "UTF-8";input.form-control[_ngcontent-%COMP%]{border:2px solid #86c0ff;border-radius:4px}input.form-control[_ngcontent-%COMP%]:focus{border-color:#0056b3;box-shadow:0 0 5px #007bff80}.text-dark[_ngcontent-%COMP%]{text-decoration:none}.text-dark[_ngcontent-%COMP%]:hover{text-decoration:underline}.forgot-password[_ngcontent-%COMP%]{color:red;text-decoration:none}.forgot-password[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};var xd=class e{constructor(n){this.router=n}password="";confirmPassword="";errorMessage="";onSubmit(n){if(console.log("th\xE0nh c\xF4ng !"),this.errorMessage="",this.password!==this.confirmPassword){this.errorMessage="M\u1EADt kh\u1EA9u kh\xF4ng kh\u1EDBp!";return}let t={password:n.password,confirmPasswordail:n.confirmPassword};console.log("D\u1EEF li\u1EC7u",t),alert("\u0110\u1ED5i m\u1EADt kh\u1EA9u th\xE0nh c\xF4ng chuy\u1EC3n \u0111\u1EBFn trang \u0111\u0103ng nh\u1EADp ngay b\xE2y gi\u1EDD!"),this.router.navigate(["/login"])}static \u0275fac=function(t){return new(t||e)(Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-reset-pw"]],standalone:!0,features:[Me],decls:25,vars:2,consts:[["frm1","ngForm"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"row","w-100"],[1,"col-md-6"],[1,"text-start"],["routerLink","/login",1,"text-dark"],[1,"fa-solid","fa-chevron-left","me-2"],[1,"text-muted"],[3,"ngSubmit"],[1,"mb-3"],["for","password",1,"form-label"],["type","password","name","password","id","password","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","confirm-password",1,"form-label"],["type","password","name","confirmPassword","id","confirm-password","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","submit",1,"btn","btn-primary","w-100"],[1,"col-md-6","d-none","d-md-block","d-flex","align-items-center","justify-content-center",2,"padding-left","150px","padding-top","50px"],["src","../../assets/img/secure.png","alt","Description","width","400","height","400",1,"img-fluid"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",1)(1,"div",2)(2,"div",3)(3,"p",4)(4,"a",5),N(5,"i",6),f(6,"Quay l\u1EA1i "),u()(),l(7,"h2"),f(8,"\u0110\u1EB7t l\u1EA1i m\u1EADt kh\u1EA9u"),u(),l(9,"p",7),f(10,"Y\xEAu c\u1EA7u \u0111\u1EB7t l\u1EA1i m\u1EADt kh\u1EA9u c\u1EE7a b\u1EA1n \u0111\xE3 \u0111\u01B0\u1EE3c x\xE1c minh. H\xE3y \u0111\u1EB7t l\u1EA1i m\u1EADt kh\u1EA9u m\u1EDBi"),u(),l(11,"form",8,0),H("ngSubmit",function(){U(i);let s=Nt(12);return j(r.onSubmit(s.value))}),l(13,"div",9)(14,"label",10),f(15,"T\u1EA1o m\u1EADt kh\u1EA9u:"),u(),l(16,"input",11),ge("ngModelChange",function(s){return U(i),xe(r.password,s)||(r.password=s),j(s)}),u()(),l(17,"div",9)(18,"label",12),f(19,"Nh\u1EADp l\u1EA1i m\u1EADt kh\u1EA9u:"),u(),l(20,"input",13),ge("ngModelChange",function(s){return U(i),xe(r.confirmPassword,s)||(r.confirmPassword=s),j(s)}),u()(),l(21,"button",14),f(22,"\u0110\u1EB7t l\u1EA1i m\u1EADt kh\u1EA9u"),u()()(),l(23,"div",15),N(24,"img",16),u()()()}t&2&&(m(16),me("ngModel",r.password),m(4),me("ngModel",r.confirmPassword))},dependencies:[bn,mr,He,Mn,jt,Ot,Sn,_n,Vt,Pn],styles:['@charset "UTF-8";input.form-control[_ngcontent-%COMP%]{border:2px solid #86c0ff;border-radius:4px}input.form-control[_ngcontent-%COMP%]:focus{border-color:#0056b3;box-shadow:0 0 5px #007bff80}.text-dark[_ngcontent-%COMP%]{text-decoration:none}.text-dark[_ngcontent-%COMP%]:hover{text-decoration:underline}']})};var Ed=class e{email="support@example.com";scrollToSection(n){let t=document.getElementById(n);t&&t.scrollIntoView({behavior:"smooth",block:"start"})}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Se({type:e,selectors:[["app-home"]],standalone:!0,features:[Me],decls:198,vars:1,consts:[[1,"body"],[1,"navbar","navbar-expand-lg","navbar-light"],[1,"container-fluid"],["href","/home",1,"navbar-brand","text-primary"],["id","navbarTogglerDemo03",1,"collapse","navbar-collapse"],[1,"navbar-nav","me-auto","mb-4","mb-lg-0"],[1,"nav-item","ms-4"],["aria-current","page","href","/home",1,"nav-link","active"],[1,"nav-link",3,"click"],["href","/register",1,"nav-link","text-primary"],["href","/login",1,"nav-link","text-danger","ms-2"],[2,"background-color","#b3ffff","padding-top","200px","padding-bottom","200px"],[1,"container"],[1,"row","align-items-center"],[1,"col-md-6"],["src",".../../../../assets/img/logo.png","width","500","height","500",1,"img-responsive"],[1,"col-md-6","text-center"],[1,"my-4"],[1,"text-center"],[1,"row","mb-3"],[1,"col"],["href","/register","tabindex","-1","role","button","aria-disabled","true",1,"btn","btn-primary","btn-lg","w-50","shadow-lg"],[1,"row"],["href","/login","tabindex","-1","role","button","aria-disabled","true",1,"btn","btn-light","btn-lg","w-50","shadow-lg"],["id","feature-section",2,"padding-top","20px","padding-bottom","100px"],[1,"col-md-6","text-start"],[1,"text-start"],[1,"fa-solid","fa-circle-check",2,"color","#00ff04","margin-right","5px"],["src","../../assets/img/doll.png","alt","Description","width","400","height","400",1,"img-fluid"],[2,"padding-top","20px","padding-bottom","100px"],["src","../../assets/img/image1.png","alt","Description",1,"img-fluid"],["src","../../assets/img/image4.png","alt","Description",1,"img-fluid"],["src","../../assets/img/image2.png","alt","Description",1,"img-fluid"],["src","../../assets/img/image3.png","alt","Description","width","600","height","600",1,"img-fluid"],["id","contact",2,"padding-top","20px","padding-bottom","100px"],[1,"fa-solid","fa-phone",2,"margin-right","5px"],[1,"fa-solid","fa-envelope",2,"margin-right","5px"],[1,"fa-solid","fa-location-dot",2,"margin-right","5px"],["href","/terms"],["href","/privacy"],["href","/guide"],["href","/contact"],[2,"border","1px solid #000","margin","0"],[1,"text-black","text-center","py-3","footer"],["href","#"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"nav",1)(2,"div",2)(3,"a",3),f(4,"English"),u(),l(5,"div",4)(6,"ul",5)(7,"li",6)(8,"a",7),f(9,"TRANG CH\u1EE6"),u()(),l(10,"li",6)(11,"a",8),H("click",function(){return r.scrollToSection("feature-section")}),f(12,"T\xCDNH N\u0102NG"),u()(),l(13,"li",6)(14,"a",8),H("click",function(){return r.scrollToSection("feature-section")}),f(15,"BLOG"),u()(),l(16,"li",6)(17,"a",8),H("click",function(){return r.scrollToSection("contact")}),f(18,"CH\xCDNH S\xC1CH"),u()(),l(19,"li",6)(20,"a",8),H("click",function(){return r.scrollToSection("contact")}),f(21,"LI\xCAN H\u1EC6"),u()()(),l(22,"a",9),f(23,"\u0110\u0102NG K\xDD/"),u(),l(24,"a",10),f(25,"\u0110\u0102NG NH\u1EACP"),u()()()(),l(26,"div",11)(27,"div",12)(28,"div",13)(29,"div",14),N(30,"img",15),u(),l(31,"div",16)(32,"h1",17),f(33,"\u0110\u0102NG K\xDD \u0110\u1EC2 H\u1ECCC TH\u1EEC MI\u1EC4N PH\xCD C\xD9NG CH\xDANG T\xD4I"),u(),l(34,"div",18)(35,"div",19)(36,"div",20)(37,"a",21),f(38,"B\u1EAFt \u0111\u1EA7u"),u()()(),l(39,"div",22)(40,"div",20)(41,"a",23),f(42,"T\xF4i \u0111\xE3 c\xF3 t\xE0i kho\u1EA3n"),u()()()()()()()(),l(43,"div",24)(44,"div",12)(45,"div",13)(46,"div",25)(47,"h1",17),f(48,"T\u1EA0O B\xC0I THI TR\u1EAEC NGHI\u1EC6M ONLINE MI\u1EC4N PH\xCD V\xC0 D\u1EC4 S\u1EEC D\u1EE4NG"),u(),l(49,"div",26)(50,"p"),N(51,"i",27),f(52,"D\u1EC5 d\xE0ng t\u1EA1o ho\u1EB7c upload file c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m"),u(),l(53,"p"),N(54,"i",27),f(55,"Nhi\u1EC1u t\xF9y ch\u1ECDn tr\u1ED9n c\xE2u h\u1ECFi v\xE0 t\u1EF1 \u0111\u1ED9ng ch\u1EA5m b\xE0i l\xE0m"),u(),l(56,"p"),N(57,"i",27),f(58,"T\u1EA1o b\xE0i thi l\u1EA5y ng\u1EABu nhi\xEAn t\u1EEB ng\xE2n h\xE0ng c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m c\u1EE7a b\u1EA1n"),u(),l(59,"p"),N(60,"i",27),f(61,"T\xEDch h\u1EE3p Chat GPT gi\xFAp b\u1EA1n t\u1EF1 \u0111\u1ED9ng t\u1EA1o c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m"),u(),l(62,"p"),N(63,"i",27),f(64,"Tri\u1EC3n khai thi online ho\u1EB7c l\xE0m b\xE0i thi online kh\xF4ng c\u1EA7n c\xE0i \u0111\u1EB7t \u1EE9ng d\u1EE5ng"),u()()(),l(65,"div",14),N(66,"img",28),u()()()(),l(67,"div",29)(68,"div",12)(69,"div",13)(70,"div",14),N(71,"img",30),u(),l(72,"div",25)(73,"h1",17),f(74,"TH\xCAM C\xC2U H\u1ECEI V\xC0 B\xC0I THI \u0110\u01A0N GI\u1EA2N H\u01A0N BAO GI\u1EDC H\u1EBET!"),u(),l(75,"div",26)(76,"p"),N(77,"i",27),f(78," Th\xEAm c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m b\u1EB1ng tay v\u1EDBi nhi\u1EC1u d\u1EA1ng c\xE2u h\u1ECFi nh\u01B0: c\xE2u h\u1ECFi l\u1EF1a ch\u1ECDn m\u1ED9t \u0111\xE1p \xE1n, c\xE2u h\u1ECFi l\u1EF1a ch\u1ECDn nhi\u1EC1u \u0111\xE1p \xE1n, c\xE2u h\u1ECFi upload file..."),u(),l(79,"p"),N(80,"i",27),f(81," Th\xEAm c\xE2u h\u1ECFi t\u1EEB Ng\xE2n H\xE0ng c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m, b\u1EA1n c\xF3 th\u1EC3 l\u1EA5y c\xE2u h\u1ECFi ch\u1EC9 \u0111\u1ECBnh t\u1EEB ng\xE2n h\xE0ng c\xE2u h\u1ECFi ho\u1EB7c c\xE0i \u0111\u1EB7t b\xE0i thi online l\u1EA5y s\u1ED1 l\u01B0\u1EE3ng c\xE2u h\u1ECFi ng\u1EABu nhi\xEAn t\u1EEB th\u01B0 vi\u1EC7n c\xE2u h\u1ECFi cho m\u1ED7i b\xE0i l\xE0m kh\xE1c nhau."),u(),l(82,"p"),N(83,"i",27),f(84," T\u1EA3i file danh s\xE1ch c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m c\xF3 s\u1EB5n l\xEAn, Ninequiz h\u1ED7 tr\u1EE3 c\xE1c file word, excel, pdf."),u(),l(85,"p"),N(86,"i",27),f(87," S\u1EED d\u1EE5ng AI t\u1EA1o c\xE2u h\u1ECFi theo ch\u1EE7 \u0111\u1EC1 c\u1EE7a b\u1EA1n"),u(),l(88,"p"),N(89,"i",27),f(90," T\u1EA1o c\xE2u h\u1ECFi t\u1EEB n\u1ED9i dung c\u1EE7a b\u1EA1n b\u1EB1ng AI, sau khi b\u1EA1n cung c\u1EA5p n\u1ED9i dung cho AI, h\u1EC7 th\u1ED1ng s\u1EBD t\u1EF1 \u0111\u1ED9ng t\u1EA1o c\xE2u h\u1ECFi tr\u1EAFc nghi\u1EC7m t\u1EEB n\u1ED9i dung t\xE0i li\u1EC7u c\u1EE7a b\u1EA1n."),u()()()()()(),l(91,"div",29)(92,"div",12)(93,"div",13)(94,"div",25)(95,"h1",17),f(96,"L\xCAN TR\u01AF\u1EDAC L\u1ECACH THI ONLINE HO\u1EB6C GI\u1EDAI H\u1EA0N TH\u1EDCI GIAN L\xC0M B\xC0I THI"),u(),l(97,"div",26)(98,"p"),N(99,"i",27),f(100," B\u1EA1n c\xF3 th\u1EC3 c\xE0i \u0111\u1EB7t th\u1EDDi gian \u0111\u1EC3 h\u1ECDc sinh ch\u1EC9 l\xE0m b\xE0i thi online trong khung th\u1EDDi gian qui \u0111\u1ECBnh: "),u(),l(101,"ul")(102,"li"),f(103," Qui \u0111\u1ECBnh th\u1EDDi gian cho b\xE0i l\xE0m (10\u2019, 15\u2019, 45\u2019...) "),u(),l(104,"li"),f(105," Qui \u0111\u1ECBnh th\u1EDDi gian c\xF3 th\u1EC3 b\u1EAFt \u0111\u1EA7u l\xE0m b\xE0i "),u(),l(106,"li"),f(107," Qui \u0111\u1ECBnh th\u1EDDi gian k\u1EBFt th\xFAc hi\u1EC7u l\u1EF1c l\xE0m b\xE0i "),u()(),l(108,"p"),N(109,"i",27),f(110," Ho\u1EB7c b\u1ECF c\xE0i \u0111\u1EB7t th\u1EDDi gian \u0111\u1EC3 h\u1ECDc sinh c\xF3 th\u1EC3 l\xE0m b\xE0i b\u1EA5t k\u1EF3 l\xFAc n\xE0o cho \u0111\u1EBFn khi n\u1ED9p b\xE0i th\xE0nh c\xF4ng. "),u()()(),l(111,"div",14),N(112,"img",31),u()()()(),l(113,"div",29)(114,"div",12)(115,"div",13)(116,"div",14),N(117,"img",32),u(),l(118,"div",25)(119,"h1",17),f(120,"CHIA S\u1EBA B\xC0I THI V\xC0 QU\u1EA2N L\xCD USER C\xD3 TH\u1EC2 L\xC0M B\xC0I THI"),u(),l(121,"div",26)(122,"p"),N(123,"i",27),f(124," Chia s\u1EBB public: B\u1EA1n ch\u1EC9 vi\u1EC7c sao ch\xE9p \u0111\u01B0\u1EDDng d\u1EABn chia s\u1EBB v\xE0 g\u1EEDi cho \u0111\u1ED1i t\u01B0\u1EE3ng c\u1EA7n l\xE0m b\xE0i thi ho\u1EB7c t\u1EA3i v\xE0 chia s\u1EBB qr code cho h\u1ECDc sinh qu\xE9t qr code truy c\u1EADp tr\u1EF1c ti\u1EBFp v\xE0o b\xE0i thi"),u(),l(125,"p"),N(126,"i",27),f(127," B\u1EA1n c\xF3 th\u1EC3 qu\u1EA3n l\xFD b\xE0i ki\u1EC3m tra v\u1EDBi t\u1EEBng nh\xF3m ho\u1EB7c l\u1EDBp b\u1EB1ng c\xE1ch t\u1EA1o l\u1EDBp v\xE0 th\xEAm h\u1ECDc sinh v\xE0o l\u1EDBp"),u(),l(128,"ul")(129,"li"),f(130," Qu\u1EA3n l\xFD nh\xF3m v\xE0 l\xEAn l\u1ECBch thi ri\xEAng cho t\u1EEBng nh\xF3m, user ngo\xE0i danh s\xE1ch ch\u1EC9 \u0111\u1ECBnh s\u1EBD kh\xF4ng truy c\u1EADp b\xE0i thi \u0111\u01B0\u1EE3c "),u(),l(131,"li"),f(132," Khi tri\u1EC3n khai b\xE0i thi ch\u1EC9 \u0111\u1ECBnh user th\xEC c\xE1c user s\u1EBD nh\u1EADn \u0111\u01B0\u1EE3c th\xF4ng b\xE1o v\u1EC1 b\xE0i thi "),u()()()()()()(),l(133,"div",29)(134,"div",12)(135,"div",13)(136,"div",25)(137,"h1",17),f(138,"H\u1ECCC SINH L\xC0M B\xC0I KH\xD4NG C\u1EA6N C\xC0I \u0110\u1EB6T TH\xCAM \u1EE8NG D\u1EE4NG"),u(),l(139,"div",26)(140,"p"),N(141,"i",27),f(142," H\u1ECDc sinh d\u1EC3 d\xE0ng truy c\u1EADp v\xE0 l\xE0m b\xE0i thi tr\u1EAFc nghi\u1EC7m online m\xE0 kh\xF4ng c\u1EA7n c\xE0i \u0111\u1EB7t th\xEAm \u1EE9ng d\u1EE5ng"),u(),l(143,"p"),N(144,"i",27),f(145," Giao di\u1EC7n l\xE0m b\xE0i tr\u1EAFc nghi\u1EC7m online tr\u1EF1c quan v\xE0 d\u1EC3 t\u01B0\u01A1ng t\xE1c"),u(),l(146,"p"),N(147,"i",27),f(148," Giao di\u1EC7n tu\u1EF3 bi\u1EBFn theo k\xEDch th\u01B0\u1EDBc m\xE0n h\xECnh m\xE0 kh\xF4ng l\xE0m thay \u0111\u1ED5i ch\u1EA5t l\u01B0\u1EE3ng h\xECnh \u1EA3nh"),u(),l(149,"p"),N(150,"i",27),f(151," Ch\u1EC9 c\u1EA7n scan qr code b\xE0i thi tr\u1EAFc nghi\u1EC7m online ho\u1EB7c truy c\u1EADp link b\xE0i thi v\xE0 l\xE0m b\xE0i m\xE0 kh\xF4ng c\u1EA7n c\xE0i \u0111\u1EB7t \u1EE9ng d\u1EE5ng"),u(),l(152,"p"),N(153,"i",27),f(154," Tr\u1EA3 l\u1EDDi b\xE0i thi t\u1EF1 lu\u1EADn b\u1EB1ng c\xE1ch ch\u1EE5p \u1EA3nh b\xE0i l\xE0m ho\u1EB7c upload file word"),u()()(),l(155,"div",14),N(156,"img",33),u()()()(),l(157,"div",34)(158,"div",12)(159,"div",13)(160,"div",25)(161,"h1",17),f(162,"Th\xF4ng tin li\xEAn h\u1EC7"),u(),l(163,"div",26)(164,"p"),N(165,"i",35),f(166," 0123456789"),u(),l(167,"p"),N(168,"i",36),f(169),u(),l(170,"p"),N(171,"i",37),f(172," 179 \u0110\u1EB7ng Th\xF9y Tr\xE2m, ph\u01B0\u1EDDng 13, qu\u1EADn B\xECnh Th\u1EA1nh, tp HCM"),u()()(),l(173,"div",14)(174,"h1",17),f(175,"\u0110i\u1EC1u kho\u1EA3n v\xE0 h\u01B0\u1EDBng d\u1EABn"),u(),l(176,"div",26)(177,"p")(178,"a",38),f(179,"\u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng"),u(),l(180,"a",39),f(181,"/ b\u1EA3o m\u1EADt th\xF4ng tin"),u()(),l(182,"p")(183,"a",40),f(184,"H\u01B0\u1EDBng d\u1EABn"),u()(),l(185,"p")(186,"a",41),f(187,"Li\xEAn h\u1EC7 h\u1ED7 tr\u1EE3"),u()()()()(),N(188,"hr",42),l(189,"footer",43)(190,"div",12)(191,"p"),f(192,"\xA9 2024 Group 77 | All Rights Reserved"),u(),l(193,"a",44),f(194,"Privacy Policy"),u(),f(195," | "),l(196,"a",44),f(197,"Terms of Service"),u()()()()()()),t&2&&(m(169),te(" ",r.email,""))}})};var vd=class e{email="support@example.com";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Se({type:e,selectors:[["app-terms"]],standalone:!0,features:[Me],decls:142,vars:1,consts:[[1,"navbar","navbar-expand-lg","navbar-light"],[1,"container-fluid"],["id","navbarTogglerDemo03",1,"collapse","navbar-collapse"],[1,"fa-solid","fa-chevron-left"],[1,"navbar-nav","me-auto","mb-4","mb-lg-0"],[1,"nav-item","ms-4"],["aria-current","page","href","/home",1,"nav-link","active"],[1,"container","mt-5"],[1,"text-center"],["id","contact",2,"padding-top","20px","padding-bottom","100px"],[1,"container"],[1,"row","align-items-center"],[1,"col-md-6","text-start"],[1,"my-4"],[1,"text-start"],[1,"fa-solid","fa-phone",2,"margin-right","5px"],[1,"fa-solid","fa-envelope",2,"margin-right","5px"],[1,"fa-solid","fa-location-dot",2,"margin-right","5px"],[1,"col-md-6"],["href","/terms"],["href","/privacy"],["href","/guide"],["href","/contact"],[2,"border","1px solid #000","margin","0"],[1,"text-black","text-center","py-3","footer"],["href","#"]],template:function(t,r){t&1&&(l(0,"nav",0)(1,"div",1)(2,"div",2),N(3,"i",3),l(4,"ul",4)(5,"li",5)(6,"a",6),f(7,"TRANG CH\u1EE6"),u()()()()()(),l(8,"div",7)(9,"h1",8),f(10,"\u0110i\u1EC1u Kho\u1EA3n S\u1EED D\u1EE5ng"),u(),l(11,"h5"),f(12,"TH\u1ECEA THU\u1EACN \u0110I\u1EC0U KHO\u1EA2N S\u1EEC D\u1EE4NG D\u1ECACH V\u1EE4:"),u(),l(13,"p"),f(14,"Th\u1ECFa thu\u1EADn D\u1ECBch v\u1EE5 n\xE0y (\u201CTh\u1ECFa thu\u1EADn\u201D) quy \u0111\u1ECBnh c\xE1c \u0111i\u1EC1u kho\u1EA3n, \u0111i\u1EC1u ki\u1EC7n v\xE0 c\xE1c quy \u0111\u1ECBnh khi s\u1EED d\u1EE5ng c\xE1c d\u1ECBch v\u1EE5 \u0111\u01B0\u1EE3c cung c\u1EA5p b\u1EDFi C\xF4ng ty C\u1ED5 ph\u1EA7n Ninecode v\xE0 Kh\xE1ch h\xE0ng ho\u1EB7c Ph\xE1p nh\xE2n, t\u1ED5 ch\u1EE9c ho\u1EB7c doanh nghi\u1EC7p m\xE0 h\u1ECD \u0111\u1EA1i \u0111i\u1EC7n"),u(),l(15,"p"),f(16,"B\u1EB1ng vi\u1EC7c \u0111\u0103ng k\xFD d\u1ECBch v\u1EE5 c\u1EE7a Ninequiz (t\u1EA1m g\u1ECDi t\u1EAFt l\xE0 \u201CD\u1ECBch v\u1EE5\u201D ho\u1EB7c \u201CNinequiz\u201D), kh\xE1ch h\xE0ng \u0111\u1ED3ng \xFD cam k\u1EBFt v\u1EDBi t\u1EA5t c\u1EA3 c\xE1c \u0111i\u1EC1u kho\u1EA3n v\xE0 \u0111i\u1EC1u ki\u1EC7n sau \u0111\xE2y (g\u1ECDi chung l\xE0 \u201C\u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng\u201D). Trong tr\u01B0\u1EDDng h\u1EE3p kh\xE1ch h\xE0ng kh\xF4ng \u0111\u1ED3ng \xFD v\u1EDBi b\u1EA5t k\u1EF3 \u0111i\u1EC1u kho\u1EA3n c\u1EE7a Th\u1ECFa thu\u1EADn, Kh\xE1ch h\xE0ng c\u1EA7n ph\u1EA3i ch\u1EA5m d\u1EE9t ngay l\u1EADp t\u1EE9c vi\u1EC7c s\u1EED d\u1EE5ng c\xE1c d\u1ECBch v\u1EE5 c\u1EE7a Ninequiz, x\xF3a t\u1EA5t c\u1EA3 c\xE1c ch\u01B0\u01A1ng tr\xECnh v\xE0 d\u1EEF li\u1EC7u tr\xEAn h\u1EC7 th\u1ED1ng c\u1EE7a b\u1EA1n."),u(),l(17,"p"),f(18,"Ninequiz b\u1EA3o l\u01B0u quy\u1EC1n ch\u1EC9nh s\u1EEDa, c\u1EADp nh\u1EADt v\xE0 b\u1ED5 sung m\u1ED9t ph\u1EA7n ho\u1EB7c to\xE0n b\u1ED9 c\xE1c quy \u0111\u1ECBnh n\xE0y b\u1EA5t c\u1EE9 l\xFAc n\xE0o m\xE0 kh\xF4ng c\u1EA7n b\xE1o tr\u01B0\u1EDBc ho\u1EB7c c\xF3 s\u1EF1 \u0111\u1ED3ng \xFD tr\u01B0\u1EDBc. Vi\u1EC7c ch\u1EC9nh s\u1EEDa n\xE0y s\u1EBD c\xF3 hi\u1EC7u l\u1EF1c ngay khi \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt tr\xEAn website c\u1EE7a Ninequiz.com. Ninequiz s\u1EBD ti\u1EBFn h\xE0nh g\u1EEDi th\xF4ng b\xE1o tr\xEAn website v\xE0 g\u1EEDi v\u1EC1 email c\u1EE7a Kh\xE1ch h\xE0ng khi c\xF3 c\u1EADp nh\u1EADt, Kh\xE1ch h\xE0ng th\u01B0\u1EDDng xuy\xEAn ki\u1EC3m tra t\u1EA1i \u0111\xE2y \u0111\u1EA3m b\u1EA3o quy\u1EC1n l\u1EE3i c\u1EE7a m\xECnh m\u1ED9t c\xE1ch \u0111\u1EA7y \u0111\u1EE7 nh\u1EA5t."),u(),l(19,"h5"),f(20,"\u0110i\u1EC1u 1. M\xD4 T\u1EA2 D\u1ECACH V\u1EE4"),u(),l(21,"p"),f(22,"D\u1ECBch v\u1EE5 bao g\u1ED3m m\u1ED9t d\u1ECBch v\u1EE5 tr\xEAn web, ho\u1EB7c \u1EE9ng d\u1EE5ng di \u0111\u1ED9ng cho ph\xE9p b\u1EA1n truy c\u1EADp v\xE0 s\u1EED d\u1EE5ng m\u1ED9t t\xE0i kho\u1EA3n Ninequiz duy nh\u1EA5t. \u201CNinequiz\u201D \u1EDF \u0111\xE2y l\xE0 m\u1ED9t c\xF4ng c\u1EE5 t\u1EA1o v\xE0 qu\u1EA3n l\xFD b\xE0i ki\u1EC3m tra. Ninequiz c\xF3 th\u1EC3 l\u01B0u tr\u1EEF th\xF4ng tin, d\u1EEF li\u1EC7u, v\u0103n b\u1EA3n, h\xECnh \u1EA3nh, video, clip \xE2m thanh\u2026 \u0111\u01B0\u1EE3c t\u1EA1o ra th\xF4ng qua c\xE1c t\u01B0\u01A1ng t\xE1c trong qu\xE1 tr\xECnh s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5 (g\u1ECDi chung l\xE0 \u201CN\u1ED9i dung\u201D)."),u(),l(23,"p"),f(24,"\u0110i\u1EC1u ki\u1EC7n s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5:"),u(),l(25,"ol")(26,"li"),f(27,"\u0110\u1EC3 c\xF3 th\u1EC3 s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5, Kh\xE1ch h\xE0ng ph\u1EA3i t\u1EEB 13 tu\u1ED5i tr\u1EDF l\xEAn."),u(),l(28,"li"),f(29,"Cung c\u1EA5p \u0111\u1ECBa ch\u1EC9 email h\u1EE3p l\u1EC7 v\xE0 c\xE1c th\xF4ng tin kh\xE1c theo y\xEAu c\u1EA7u \u0111\u1EC3 ho\xE0n th\xE0nh qu\xE1 tr\xECnh \u0111\u0103ng k\xFD."),u(),l(30,"li"),f(31,"C\xF3 tr\xE1ch nhi\u1EC7m gi\u1EEF t\xE0i kho\u1EA3n v\xE0 m\u1EADt kh\u1EA9u c\u1EE7a m\xECnh an to\xE0n. Ninequiz kh\xF4ng th\u1EC3 v\xE0 s\u1EBD kh\xF4ng ch\u1ECBu tr\xE1ch nhi\u1EC7m cho b\u1EA5t k\u1EF3 t\u1ED5n th\u1EA5t ho\u1EB7c thi\u1EC7t h\u1EA1i n\xE0o t\u1EEB s\u1EF1 thi\u1EBFu c\u1EA9n tr\u1ECDng c\u1EE7a b\u1EA1n trong vi\u1EC7c b\u1EA3o m\u1EADt th\xF4ng tin t\xE0i kho\u1EA3n. "),u(),l(32,"li"),f(33,"Trong tr\u01B0\u1EDDng h\u1EE3p b\u1EA1n vi ph\u1EA1m quy \u0111\u1ECBnh v\u1EC1 d\u1ECBch v\u1EE5 c\u0169ng nh\u01B0 h\u1EC7 th\u1ED1ng h\u1ED7 tr\u1EE3 d\u1ECBch v\u1EE5, ch\xFAng t\xF4i c\xF3 quy\u1EC1n h\u1EA1n ch\u1EBF ho\u1EB7c v\xF4 hi\u1EC7u h\xF3a quy\u1EC1n truy c\u1EADp, s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5 c\u1EE7a b\u1EA1n m\xE0 kh\xF4ng c\u1EA7n th\xF4ng b\xE1o."),u(),l(34,"li"),f(35,"Vi ph\u1EA1m b\u1EA5t k\u1EF3 \u0111i\u1EC1u n\xE0o trong \u0111i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng t\xE0i kho\u1EA3n, Ninequiz s\u1EBD d\u1EEBng ngay l\u1EADp t\u1EE9c c\xE1c d\u1ECBch v\u1EE5 c\u1EE7a b\u1EA1n."),u()(),l(36,"h5"),f(37,"\u0110i\u1EC1u 2. HO\xC1 \u0110\u01A0N / THANH TO\xC1N"),u(),l(38,"p"),f(39,"C\xE1c g\xF3i s\u1EED d\u1EE5ng c\xF3 th\u1EC3 \u0111\u01B0\u1EE3c th\xEAm v\xE0o d\u1ECBch v\u1EE5 v\xE0 cung c\u1EA5p cho Kh\xE1ch h\xE0ng nh\u01B0 m\u1ED9t b\u1EA3n n\xE2ng c\u1EA5p tr\u1EA3 ti\u1EC1n. Ninequiz s\u1EBD thu ph\xED khi Kh\xE1ch h\xE0ng l\u1EF1a ch\u1ECDn g\xF3i n\xE2ng cao. Khi l\u1EF1a ch\u1ECDn tr\u1EA3 ph\xED, Kh\xE1ch h\xE0ng \u0111\u1ED3ng \xFD cung c\u1EA5p cho Ninequiz c\xE1c th\xF4ng tin thanh to\xE1n c\u1EA7n thi\u1EBFt (\u201CD\u1EEF li\u1EC7u thanh to\xE1n\u201D). Kh\xE1ch h\xE0ng c\xF3 th\u1EC3 l\u1EF1a ch\u1ECDn tr\u1EA3 ph\xED g\xF3i d\u1ECBch v\u1EE5 theo s\u1ED1 l\u01B0\u1EE3ng b\xE0i ki\u1EC3m tra m\xE0 b\u1EA1n s\u1EED d\u1EE5ng h\xE0ng th\xE1ng (t\xEDnh ph\xED d\u1EF1a tr\xEAn s\u1ED1 l\u01B0\u1EE3ng \u0111\xE3 d\xF9ng)."),u(),l(40,"p"),f(41,"Ninequiz l\xE0 m\u1ED9t s\u1EA3n ph\u1EA9m thu\u1ED9c quy\u1EC1n s\u1EDF h\u1EEFu c\u1EE7a C\xF4ng ty c\u1ED5 ph\u1EA7n Ninecode v\xEC v\u1EADy m\u1ECDi giao d\u1ECBch v\xE0 th\xF4ng tin xu\u1EA5t ho\xE1 \u0111\u01A1n thu\u1EBF gi\xE1 tr\u1ECB gia t\u0103ng s\u1EBD do C\xF4ng ty c\u1ED5 ph\u1EA7n Ninecode th\u1EF1c hi\u1EC7n giao d\u1ECBch v\xE0 xu\u1EA5t ho\xE1 \u0111\u01A1n cho Kh\xE1ch h\xE0ng. "),u(),l(42,"h5"),f(43,"\u0110i\u1EC1u 3. QUY\u1EC0N S\u1EDE H\u1EEEU / S\u1EDE H\u1EEEU TR\xCD TU\u1EC6"),u(),l(44,"p"),f(45,"C\xF4ng ty c\u1ED5 ph\u1EA7n Ninecode s\u1EDF h\u1EEFu t\u1EA5t c\u1EA3 n\u1ED9i dung c\u1EE7a Ninequiz nh\u01B0 giao di\u1EC7n, thi\u1EBFt k\u1EBF \u0111\u1ED3 h\u1ECDa, th\u01B0\u01A1ng hi\u1EC7u, nh\xE3n hi\u1EC7u d\u1ECBch v\u1EE5, t\xEAn th\u01B0\u01A1ng hi\u1EC7u, logo v\xE0 t\xE0i s\u1EA3n tr\xED tu\u1EC7 kh\xE1c trong d\u1ECBch v\u1EE5 c\u1EE7a Ninequiz. B\u1EA5t k\u1EF3 ai truy c\u1EADp v\xE0o Ninequiz \u0111\u1EC1u kh\xF4ng c\xF3 quy\u1EC1n s\u1EED d\u1EE5ng ho\u1EB7c sao ch\xE9p b\u1EA5t k\u1EF3 n\u1ED9i dung, th\u01B0\u01A1ng hi\u1EC7u, nh\xE3n hi\u1EC7u d\u1ECBch v\u1EE5, t\xEAn th\u01B0\u01A1ng hi\u1EC7u, logo hay b\u1EA5t k\u1EF3 t\xE0i s\u1EA3n tr\xED tu\u1EC7 n\xE0o kh\xE1c."),u(),l(46,"p"),f(47,"B\u1EB1ng vi\u1EC7c s\u1EED d\u1EE5ng ho\u1EB7c truy c\u1EADp d\u1ECBch v\u1EE5, b\u1EA1n \u0111\u1ED3ng \xFD tu\xE2n th\u1EE7 c\xE1c quy \u0111\u1ECBnh ph\xE1p lu\u1EADt v\u1EC1 s\u1EDF h\u1EEFu tr\xED tu\u1EC7 hi\u1EC7n h\xE0nh \u0111\u1ED1i v\u1EDBi v\u1EA5n \u0111\u1EC1 b\u1EA3o h\u1ED9 b\u1EA3n quy\u1EC1n, th\u01B0\u01A1ng hi\u1EC7u, nh\xE3n hi\u1EC7u d\u1ECBch v\u1EE5, c\xE1c d\u1ECBch v\u1EE5, trang web v\xE0 n\u1ED9i dung c\u1EE7a ch\xFAng t\xF4i."),u(),l(48,"h5"),f(49,"\u0110i\u1EC1u 4. H\u1EA0N CH\u1EBE V\u1EC0 M\u1EB6T N\u1ED8I DUNG"),u(),l(50,"p"),f(51,"B\u1EA1n hi\u1EC3u r\u1EB1ng ng\u01B0\u1EDDi t\u1EA1o ra n\u1ED9i dung ch\u1ECBu ho\xE0n to\xE0n tr\xE1ch nhi\u1EC7m v\u1EC1 th\xF4ng tin. \u0110i\u1EC1u n\xE0y c\xF3 ngh\u0129a r\u1EB1ng b\u1EA1n, kh\xF4ng ph\u1EA3i l\xE0 Ninequiz, ho\xE0n to\xE0n ch\u1ECBu tr\xE1ch nhi\u1EC7m v\u1EC1 t\u1EA5t c\u1EA3 c\xE1c n\u1ED9i dung m\xE0 b\u1EA1n t\u1EA3i l\xEAn, \u0111\u0103ng tin, truy\u1EC1n t\u1EA3i ho\u1EB7c cung c\u1EA5p th\xF4ng qua t\xE0i kho\u1EA3n c\u1EE7a b\u1EA1n. Ninequiz kh\xF4ng ki\u1EC3m so\xE1t n\u1ED9i dung ng\u01B0\u1EDDi d\xF9ng \u0111\u0103ng t\u1EA3i qua d\u1ECBch v\u1EE5 v\xEC v\u1EADy kh\xF4ng b\u1EA3o \u0111\u1EA3m t\xEDnh ch\xEDnh x\xE1c, nguy\xEAn v\u1EB9n ho\u1EB7c ch\u1EA5t l\u01B0\u1EE3ng c\u1EE7a n\u1ED9i dung."),u(),l(52,"p"),f(53,"B\u1EA1n \u0111\u1ED3ng \xFD r\u1EB1ng kh\xF4ng:"),u(),l(54,"ol")(55,"li"),f(56,"(A) Ch\u1ED1ng ph\xE1 Nh\xE0 n\u01B0\u1EDBc C\u1ED9ng h\xF2a X\xE3 h\u1ED9i Ch\u1EE7 ngh\u0129a Vi\u1EC7t Nam, g\xE2y h\u1EA1i cho an ninh qu\u1ED1c gia v\xE0 tr\u1EADt t\u1EF1 an to\xE0n x\xE3 h\u1ED9i; tuy\xEAn truy\u1EC1n chi\u1EBFn tranh, kh\u1EE7ng b\u1ED1; g\xE2y th\xF9 h\u1EADn v\xE0 xung \u0111\u1ED9t gi\u1EEFa c\xE1c qu\u1ED1c gia, d\xE2n t\u1ED9c v\xE0 t\xF4n gi\xE1o; "),u(),l(57,"li"),f(58,"(B) T\u1EA3i l\xEAn, \u0111\u0103ng tin, g\u1EEDi ho\u1EB7c cung c\u1EA5p n\u1ED9i dung \u0111\u01B0\u1EE3c cho l\xE0 b\u1EA5t h\u1EE3p ph\xE1p, tr\xE1i thu\u1EA7n phong m\u1EF9 t\u1EE5c c\u1EE7a ng\u01B0\u1EDDi Vi\u1EC7t Nam c\xF3 h\u1EA1i, \u0111e d\u1ECDa, x\xFAc ph\u1EA1m, qu\u1EA5y r\u1ED1i, nh\u1EE5c m\u1EA1, ph\u1EA3n c\u1EA3m, x\xE2m ph\u1EA1m quy\u1EC1n ri\xEAng t\u01B0 c\u1EE7a ng\u01B0\u1EDDi kh\xE1c, ho\u1EB7c ph\xE2n bi\u1EC7t ch\u1EE7ng t\u1ED9c, s\u1EAFc t\u1ED9c ho\u1EB7c c\xE1c h\xE0nh \u0111\u1ED9ng \u0111\xE1ng l\xEAn \xE1n kh\xE1c. Ti\u1EBFt l\u1ED9 b\xED m\u1EADt nh\xE0 n\u01B0\u1EDBc, qu\xE2n s\u1EF1, an ninh, kinh t\u1EBF, \u0111\u1ED1i ngo\u1EA1i v\xE0 c\xE1c b\xED m\u1EADt kh\xE1c theo quy \u0111\u1ECBnh c\u1EE7a ph\xE1p lu\u1EADt;"),u(),l(59,"li"),f(60,"(C) L\u1EE3i d\u1EE5ng d\u1ECBch v\u1EE5 \u0111\u1EC3 g\xE2y h\u1EA1i cho tr\u1EBB v\u1ECB th\xE0nh ni\xEAn;"),u(),l(61,"li"),f(62,"(D) M\u1EA1o danh b\u1EA5t k\u1EF3 c\xE1 nh\xE2n hay t\u1ED5 ch\u1EE9c n\xE0o;"),u(),l(63,"li"),f(64,"(E) Gi\u1EA3 m\u1EA1o ti\xEAu \u0111\u1EC1 ho\u1EB7c s\u1EEDa \u0111\u1ED5i \u0111\u1ECBnh d\u1EA1ng nh\u1EB1m che gi\u1EA5u ngu\u1ED3n g\u1ED1c c\u1EE7a n\u1ED9i dung;"),u(),l(65,"li"),f(66,"(F) T\u1EA3i l\xEAn, \u0111\u0103ng tin ho\u1EB7c chuy\u1EC3n b\u1EA5t k\u1EF3 n\u1ED9i dung n\xE0o m\xE0 b\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n \u0111\u01B0\u1EE3c truy\u1EC1n \u0111i; \u0110\u0103ng t\u1EA3i ho\u1EB7c truy\u1EC1n n\u1ED9i dung vi ph\u1EA1m c\xE1c b\u1EB1ng s\xE1ng ch\u1EBF, th\u01B0\u01A1ng hi\u1EC7u, b\xED m\u1EADt th\u01B0\u01A1ng m\u1EA1i, b\u1EA3n quy\u1EC1n, quy\u1EC1n ri\xEAng t\u01B0 ho\u1EB7c c\xF4ng khai, ho\u1EB7c quy\u1EC1n s\u1EDF h\u1EEFu kh\xE1c c\u1EE7a b\u1EA5t k\u1EF3 b\xEAn n\xE0o;"),u(),l(67,"li"),f(68,"(G) T\u1EA3i l\xEAn, \u0111\u0103ng, g\u1EEDi email, ho\u1EB7c c\xE1c h\xECnh th\u1EE9c kh\xE1c cung c\u1EA5p t\xE0i li\u1EC7u qu\u1EA3ng c\xE1o, qu\u1EA3ng b\xE1 tr\xE1i ph\xE9p hay th\u01B0 r\xE1c;"),u(),l(69,"li"),f(70,"(H) Truy\u1EC1n t\u1EA3i b\u1EA5t k\u1EF3 lo\u1EA1i virus ho\u1EB7c m\xE3 \u0111\u1ED9c n\xE0o c\xF3 t\xEDnh ch\u1EA5t ph\xE1 ho\u1EA1i;"),u(),l(71,"li"),f(72,"(I) G\xE2y c\u1EA3n tr\u1EDF ho\u1EB7c l\xE0m r\u1ED1i lo\u1EA1n d\u1ECBch v\u1EE5, c\xE1c m\xE1y ch\u1EE7 ho\u1EB7c m\u1EA1ng k\u1EBFt n\u1ED1i v\u1EDBi d\u1ECBch v\u1EE5, ho\u1EB7c kh\xF4ng tu\xE2n theo b\u1EA5t k\u1EF3 y\xEAu c\u1EA7u, th\u1EE7 t\u1EE5c, ch\xEDnh s\xE1ch ho\u1EB7c quy \u0111\u1ECBnh c\u1EE7a m\u1EA1ng k\u1EBFt n\u1ED1i v\u1EDBi d\u1ECBch v\u1EE5;"),u(),l(73,"li"),f(74,"(J) C\u1ED1 t\xECnh hay v\xF4 t\xECnh vi ph\u1EA1m b\u1EA5t k\u1EF3 \u0111i\u1EC1u lu\u1EADt, ch\xEDnh s\xE1ch hay quy \u0111\u1ECBnh hi\u1EC7n h\xE0nh n\xE0o c\u1EE7a \u0111\u1ECBa ph\u01B0\u01A1ng, qu\u1ED1c gia ho\u1EB7c qu\u1ED1c t\u1EBF;"),u(),l(75,"li"),f(76,"(K) Theo d\xF5i ho\u1EB7c qu\u1EA5y r\u1ED1i ng\u01B0\u1EDDi kh\xE1c;"),u(),l(77,"li"),f(78,"(L) Tuy\xEAn truy\u1EC1n ho\u1EB7c cung c\u1EA5p th\xF4ng tin v\u1EC1 c\xE1c ho\u1EA1t \u0111\u1ED9ng b\u1EA5t h\u1EE3p ph\xE1p, g\xE2y h\u1EA1i cho c\xE1c c\xE1 nh\xE2n hay t\u1ED5 ch\u1EE9c; "),u(),l(79,"li"),f(80,"(M) Ch\xE0o b\xE1n b\u1EA5t k\u1EF3 s\u1EA3n ph\u1EA9m hay d\u1ECBch v\u1EE5 (i) Vi ph\u1EA1m ph\xE1p lu\u1EADt qu\u1ED1c gia, (ii) B\u1EA1n kh\xF4ng c\xF3 \u0111\u1EE7 th\u1EA9m quy\u1EC1n \u0111\u1EC3 ch\xE0o b\xE1n, ho\u1EB7c (iii) Ninequiz x\xE1c \u0111\u1ECBnh l\xE0 kh\xF4ng ph\xF9 h\u1EE3p \u0111\u1EC3 b\xE1n th\xF4ng qua c\xE1c d\u1ECBch v\u1EE5 \u0111\u01B0\u1EE3c cung c\u1EA5p b\u1EDFi Ninequiz;"),u(),l(81,"li"),f(82,"(N) Ti\u1EBFt l\u1ED9 ho\u1EB7c \u0111\xE1nh c\u1EAFp th\xF4ng tin \u0111\u0103ng nh\u1EADp c\xE1 nh\xE2n m\xE0 kh\xF4ng c\xF3 s\u1EF1 cho ph\xE9p c\u1EE7a c\xE1 nh\xE2n ho\u1EB7c t\u1ED5 ch\u1EE9c \u0111\xE3 cung c\u1EA5p n\xF3 cho b\u1EA1n. N\u1EBFu b\u1EA5t k\u1EF3 ng\u01B0\u1EDDi s\u1EED d\u1EE5ng n\xE0o \u0111\u01B0\u1EE3c b\xE1o c\xE1o l\xE0 vi ph\u1EA1m quy \u0111\u1ECBnh, Ninequiz c\xF3 quy\u1EC1n \u0111\xF3ng t\xE0i kho\u1EA3n n\xE0y b\u1EA5t c\u1EE9 l\xFAc n\xE0o m\xE0 kh\xF4ng c\u1EA7n c\u1EA3nh b\xE1o th\xEAm."),u()(),l(83,"h5"),f(84,"\u0110i\u1EC1u 5. B\u1EA2O M\u1EACT TH\xD4NG TIN"),u(),l(85,"ol")(86,"li"),f(87,"Theo m\u1EE5c \u0111\xEDch c\u1EE7a Th\u1ECFa thu\u1EADn n\xE0y, \u201CTh\xF4ng tin B\u1EA3o m\u1EADt\u201D ngh\u0129a l\xE0 th\xF4ng tin, t\xE0i li\u1EC7u v\xE0 d\u1EEF li\u1EC7u \u0111\u01B0\u1EE3c t\u1EA1o, ph\xE1t tri\u1EC3n ra b\u1EDFi qu\xE1 tr\xECnh th\u1EF1c hi\u1EC7n Th\u1ECFa thu\u1EADn n\xE0y, bao g\u1ED3m nh\u01B0ng kh\xF4ng gi\u1EDBi h\u1EA1n th\xF4ng tin \u0111\u01B0\u1EE3c cung c\u1EA5p b\u1EDFi m\u1ED9t b\xEAn cho B\xEAn c\xF2n l\u1EA1i d\u01B0\u1EDBi d\u1EA1ng v\u0103n b\u1EA3n, tin nh\u1EAFn d\u1EEF li\u1EC7u \u0111i\u1EC7n t\u1EED ho\u1EB7c c\xE1c h\xECnh th\u1EE9c kh\xE1c ph\xF9 h\u1EE3p v\u1EDBi quy \u0111\u1ECBnh ph\xE1p lu\u1EADt v\xE0 th\u1ECFa thu\u1EADn c\u1EE7a c\u1EA3 hai b\xEAn."),u(),l(88,"li"),f(89,"Ng\u01B0\u1EDDi Nh\u1EADn Th\xF4ng tin B\u1EA3o m\u1EADt (\u201CNg\u01B0\u1EDDi nh\u1EADn\u201D) s\u1EBD kh\xF4ng s\u1EED d\u1EE5ng Th\xF4ng tin B\u1EA3o m\u1EADt c\u1EE7a B\xEAn Cung c\u1EA5p (\u201CB\xEAn cung c\u1EA5p\u201D) cho c\xE1c m\u1EE5c \u0111\xEDch kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1EC1 c\u1EADp tr\u01B0\u1EDBc t\u1EA1i Th\u1ECFa thu\u1EADn n\xE0y, n\u1EBFu Th\u1ECFa thu\u1EADn n\xE0y kh\xF4ng cho ph\xE9p ti\u1EBFt l\u1ED9 Th\xF4ng tin B\u1EA3o m\u1EADt cho nh\xE2n vi\xEAn c\u1EE7a Ng\u01B0\u1EDDi nh\u1EADn, nh\xE0 th\u1EA7u ho\u1EB7c nh\xE2n vi\xEAn c\xF4ng ty ng\u01B0\u1EDDi c\u1EA7n \u0111\u01B0\u1EE3c bi\u1EBFt Th\xF4ng tin B\u1EA3o m\u1EADt v\u1EDBi m\u1EE5c \u0111\xEDch th\u1EF1c hi\u1EC7n th\u1ECFa thu\u1EADn n\xE0y; Ng\u01B0\u1EDDi nh\u1EADn c\xE1c th\xF4ng tin sau c\u0169ng c\xF3 ngh\u0129a v\u1EE5 b\u1EA3o m\u1EADt Th\xF4ng tin B\u1EA3o m\u1EADt t\u01B0\u01A1ng t\u1EF1 ngh\u0129a v\u1EE5 c\u1EE7a Ng\u01B0\u1EDDi nh\u1EADn. Ng\u01B0\u1EDDi nh\u1EADn cam k\u1EBFt s\u1EED d\u1EE5ng n\u1ED7 l\u1EF1c t\u1ED1t nh\u1EA5t \u0111\u1EC3 b\u1EA3o v\u1EC7 Th\xF4ng tin B\u1EA3o m\u1EADt t\u01B0\u01A1ng t\u1EF1 l\xE0 c\u1EE7a ch\xEDnh Ng\u01B0\u1EDDi nh\u1EADn."),u()(),l(90,"h5"),f(91,"\u0110i\u1EC1u 6. X\u1EEC L\xDD D\u1EEE LI\u1EC6U KHI CH\u1EA4M D\u1EE8T D\u1ECACH V\u1EE4"),u(),l(92,"ol")(93,"li"),f(94,"Kh\xE1ch h\xE0ng \u0111\u1ED3ng \xFD r\u1EB1ng khi Kh\xE1ch h\xE0ng x\xF3a t\xE0i kho\u1EA3n c\u1EE7a m\xECnh ho\u1EB7c khi Ninequiz ch\u1EA5m d\u1EE9t d\u1ECBch v\u1EE5 v\u1EDBi Kh\xE1ch h\xE0ng th\xEC t\u1EA5t c\u1EA3 th\xF4ng tin, d\u1EEF li\u1EC7u c\u1EE7a Kh\xE1ch h\xE0ng (bao g\u1ED3m nh\u01B0ng kh\xF4ng gi\u1EDBi h\u1EA1n c\xE1c th\xF4ng tin, d\u1EEF li\u1EC7u m\xE0 Kh\xE1ch h\xE0ng \u0111\xE3 g\u1EEDi ho\u1EB7c \u0111\xE3 nh\u1EADn) s\u1EBD b\u1ECB x\xF3a ngay l\u1EADp t\u1EE9c. Kh\xE1ch h\xE0ng ho\xE0n to\xE0n c\xF3 tr\xE1ch nhi\u1EC7m \u0111\u1ED1i v\u1EDBi c\xE1c th\xF4ng tin d\u1EEF li\u1EC7u tr\u01B0\u1EDBc khi x\xF3a t\xE0i kho\u1EA3n c\u1EE7a m\xECnh."),u(),l(95,"li"),f(96,"Ninequiz c\xF3 th\u1EC3 l\u01B0u tr\u1EEF n\u1ED9i dung c\u1EE7a Kh\xE1ch h\xE0ng t\u1ED1i \u0111a 90 ng\xE0y k\u1EC3 t\u1EEB ng\xE0y Kh\xE1ch h\xE0ng x\xF3a t\xE0i kho\u1EA3n c\u1EE7a m\xECnh v\xE0 kh\xF4ng ch\u1ECBu tr\xE1ch nhi\u1EC7m cho c\xE1c th\xF4ng tin d\u1EEF li\u1EC7u m\xE0 Kh\xE1ch h\xE0ng \u0111\xE3 g\u1EEDi ho\u1EB7c \u0111\xE3 nh\u1EADn."),u()(),l(97,"h5"),f(98,"\u0110i\u1EC1u 7. C\xC1C QUY \u0110\u1ECANH KH\xC1C"),u(),l(99,"p"),f(100,"Th\u1ECFa thu\u1EADn n\xE0y \u0111\u01B0\u1EE3c \u0111i\u1EC1u ch\u1EC9nh b\u1EDFi ph\xE1p lu\u1EADt Vi\u1EC7t Nam. M\u1ECDi tranh ch\u1EA5p ph\xE1t sinh t\u1EEB Th\u1ECFa thu\u1EADn n\xE0y s\u1EBD \u0111\u01B0\u1EE3c gi\u1EA3i quy\u1EBFt t\u1EA1i t\xF2a \xE1n c\xF3 th\u1EA9m quy\u1EC1n t\u1EA1i Vi\u1EC7t Nam."),u()(),N(101,"div",9),l(102,"div",10)(103,"div",11)(104,"div",12)(105,"h1",13),f(106,"Th\xF4ng tin li\xEAn h\u1EC7"),u(),l(107,"div",14)(108,"p"),N(109,"i",15),f(110," 0123456789"),u(),l(111,"p"),N(112,"i",16),f(113),u(),l(114,"p"),N(115,"i",17),f(116," 179 \u0110\u1EB7ng Th\xF9y Tr\xE2m, ph\u01B0\u1EDDng 13, qu\u1EADn B\xECnh Th\u1EA1nh, tp HCM"),u()()(),l(117,"div",18)(118,"h1",13),f(119,"\u0110i\u1EC1u kho\u1EA3n v\xE0 h\u01B0\u1EDBng d\u1EABn"),u(),l(120,"div",14)(121,"p")(122,"a",19),f(123,"\u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng"),u(),l(124,"a",20),f(125,"/ b\u1EA3o m\u1EADt th\xF4ng tin"),u()(),l(126,"p")(127,"a",21),f(128,"H\u01B0\u1EDBng d\u1EABn"),u()(),l(129,"p")(130,"a",22),f(131,"Li\xEAn h\u1EC7 h\u1ED7 tr\u1EE3"),u()()()()(),N(132,"hr",23),l(133,"footer",24)(134,"div",10)(135,"p"),f(136,"\xA9 2024 Group 77 | All Rights Reserved"),u(),l(137,"a",25),f(138,"Privacy Policy"),u(),f(139," | "),l(140,"a",25),f(141,"Terms of Service"),u()()()()),t&2&&(m(113),te(" ",r.email,""))},styles:["h5[_ngcontent-%COMP%]{color:#6495ed}"]})};var _d=class e{email="support@example.com";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Se({type:e,selectors:[["app-privacy"]],standalone:!0,features:[Me],decls:150,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-light"],[1,"container-fluid"],["id","navbarTogglerDemo03",1,"collapse","navbar-collapse"],[1,"fa-solid","fa-chevron-left"],[1,"navbar-nav","me-auto","mb-4","mb-lg-0"],[1,"nav-item","ms-4"],["aria-current","page","href","/home",1,"nav-link","active"],[1,"container","mt-5"],[1,"text-center","text-primary"],[1,"row","align-items-center"],[1,"col-md-6","text-start"],[1,"my-4"],[1,"text-start"],[1,"fa-solid","fa-phone",2,"margin-right","5px"],[1,"fa-solid","fa-envelope",2,"margin-right","5px"],[1,"fa-solid","fa-location-dot",2,"margin-right","5px"],[1,"col-md-6"],["href","/terms"],["href","/privacy"],["href","/guide"],["href","/contact"],[2,"border","1px solid #000","margin","0"],[1,"text-black","text-center","py-3","footer"],[1,"container"],["href","#"]],template:function(t,r){t&1&&(l(0,"nav",0)(1,"div",1)(2,"div",2),N(3,"i",3),l(4,"ul",4)(5,"li",5)(6,"a",6),f(7,"TRANG CH\u1EE6"),u()()()()()(),l(8,"div",7)(9,"h1",8),f(10,"CH\xCDNH S\xC1CH B\u1EA2O M\u1EACT "),u(),l(11,"p")(12,"strong"),f(13,"C\xF3 hi\u1EC7u l\u1EF1c t\u1EEB ng\xE0y 1 th\xE1ng 1 n\u0103m 2021"),u()(),l(14,"p"),f(15,"Ch\xFAng t\xF4i nh\u1EADn ra t\u1EA7m quan tr\u1ECDng c\u1EE7a quy\u1EC1n ri\xEAng t\u01B0. Ch\xFAng t\xF4i mu\u1ED1n b\u1EA1n c\u1EA3m th\u1EA5y t\u1EF1 tin khi s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5 c\u1EE7a ch\xFAng t\xF4i v\xE0 th\xF4ng b\xE1o v\u1EC1 quy\u1EC1n ri\xEAng t\u01B0 n\xE0y (\u201CTh\xF4ng b\xE1o v\u1EC1 quy\u1EC1n ri\xEAng t\u01B0\u201D ho\u1EB7c \u201CTh\xF4ng b\xE1o\u201D) l\xE0 \u0111\u1EC3 gi\xFAp b\u1EA1n hi\u1EC3u v\xE0 m\xF4 t\u1EA3 c\xE1ch ch\xFAng t\xF4i thu th\u1EADp, s\u1EED d\u1EE5ng v\xE0 ti\u1EBFt l\u1ED9 th\xF4ng tin c\u1EE7a b\u1EA1n."),u(),l(16,"ul")(17,"li"),f(18,"Ch\xFAng t\xF4i thu th\u1EADp th\xF4ng tin g\xEC v\xE0 thu th\u1EADp th\xF4ng tin \u0111\xF3 nh\u01B0 th\u1EBF n\xE0o"),u(),l(19,"li"),f(20,"Ch\xFAng t\xF4i c\xF3 th\u1EC3 chia s\u1EBB th\xF4ng tin v\u1EDBi ai"),u(),l(21,"li"),f(22,"C\u01A1 s\u1EDF ph\xE1p l\xFD \u0111\u1EC3 x\u1EED l\xFD th\xF4ng tin"),u(),l(23,"li"),f(24,"Quy\u1EC1n v\xE0 l\u1EF1a ch\u1ECDn c\u1EE7a b\u1EA1n"),u(),l(25,"li"),f(26,"B\u1EA3o m\u1EADt v\xE0 l\u01B0u tr\u1EEF th\xF4ng tin"),u(),l(27,"li"),f(28,"Trang web c\u1EE7a b\xEAn th\u1EE9 ba"),u(),l(29,"li"),f(30,"Tu\xE2n th\u1EE7 c\xE1c quy \u0111\u1ECBnh b\u1EA3o m\u1EADt th\xF4ng tin c\u1EE7a Vi\u1EC7t Nam"),u(),l(31,"li"),f(32,"Th\xF4ng b\xE1o v\u1EC1 c\xE1c thay \u0111\u1ED5i"),u(),l(33,"li"),f(34,"Li\xEAn h\u1EC7 v\u1EDBi web"),u()(),l(35,"p"),f(36,"Trong to\xE0n b\u1ED9 t\xE0i li\u1EC7u n\xE0y, ch\xFAng t\xF4i s\u1EBD s\u1EED d\u1EE5ng m\u1ED9t s\u1ED1 thu\u1EADt ng\u1EEF \u0111\u1EC3 m\xF4 t\u1EA3 c\xE1c s\u1EA3n ph\u1EA9m v\xE0 vai tr\xF2 kh\xE1c nhau. T\u1EA5t c\u1EA3 v\u0103n b\u1EA3n, d\u1EEF li\u1EC7u, th\xF4ng tin, ph\u1EA7n m\u1EC1m, \u0111\u1ED3 h\u1ECDa, \u1EA3nh, v.v. m\xE0 ch\xFAng t\xF4i v\xE0 c\xE1c chi nh\xE1nh c\u1EE7a ch\xFAng t\xF4i c\xF3 th\u1EC3 cung c\u1EA5p cho b\u1EA1n, c\u1ED9ng v\u1EDBi c\xE1c trang web c\u1EE7a ch\xFAng t\xF4i v\xE0 b\u1EA5t k\u1EF3 d\u1ECBch v\u1EE5, plugin, ph\u1EA7n m\u1EC1m ho\u1EB7c \u1EE9ng d\u1EE5ng n\xE0o m\xE0 ch\xFAng t\xF4i c\xF3 th\u1EC3 cung c\u1EA5p t\u1EA5t c\u1EA3 c\xF9ng nhau t\u1EA1o th\xE0nh \u201CTrang web\u201D c\u1EE7a web. \u201CNg\u01B0\u1EDDi d\xF9ng\u201D c\u1EE7a web l\xE0 nh\u1EEFng ng\u01B0\u1EDDi \u0111\xE3 t\u1EA1o t\xE0i kho\u1EA3n web v\xE0 \u201CNg\u01B0\u1EDDi \u0111\u01B0\u1EE3c m\u1EDDi c\u1EE7a web\u201D l\xE0 nh\u1EEFng ng\u01B0\u1EDDi \u0111\xE3 l\xEAn l\u1ECBch g\u1EB7p Ng\u01B0\u1EDDi d\xF9ng web nh\u01B0ng c\xF3 th\u1EC3 \u0111\xE3 \u0111\u0103ng k\xFD ho\u1EB7c ch\u01B0a \u0111\u0103ng k\xFD v\u1EDBi web. \u201CNg\u01B0\u1EDDi xem\u201D web l\xE0 ng\u01B0\u1EDDi truy c\u1EADp Trang web web nh\u01B0ng c\xF3 th\u1EC3 ho\u1EB7c kh\xF4ng ph\u1EA3i l\xE0 Ng\u01B0\u1EDDi d\xF9ng web ho\u1EB7c Ng\u01B0\u1EDDi \u0111\u01B0\u1EE3c web m\u1EDDi."),u(),l(37,"p"),f(38,"B\u1EA5t k\u1EF3 \u0111i\u1EC1u kho\u1EA3n n\xE0o \u0111\u01B0\u1EE3c x\xE1c \u0111\u1ECBnh trong \u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng, th\u1ECFa thu\u1EADn c\u1EA5p ph\xE9p ng\u01B0\u1EDDi d\xF9ng cu\u1ED1i v\xE0 ph\u1EE5 l\u1EE5c v\u1EC1 x\u1EED l\xFD d\u1EEF li\u1EC7u v\xE0 kh\xF4ng \u0111\u01B0\u1EE3c \u0111\u1ECBnh ngh\u0129a kh\xE1c trong Th\xF4ng b\xE1o v\u1EC1 quy\u1EC1n ri\xEAng t\u01B0 n\xE0y \u0111\u1EC1u \u0111\u01B0\u1EE3c th\xF4ng qua b\u1EB1ng c\xE1ch tham chi\u1EBFu trong th\xF4ng b\xE1o v\u1EC1 quy\u1EC1n ri\xEAng t\u01B0 n\xE0y."),u(),l(39,"h5"),f(40,"TH\xD4NG TIN CH\xDANG T\xD4I THU TH\u1EACP"),u(),l(41,"p"),f(42,"Ch\xFAng t\xF4i thu th\u1EADp th\xF4ng tin v\u1EC1 b\u1EA1n tr\u1EF1c ti\u1EBFp t\u1EEB b\u1EA1n v\xE0 t\u1EF1 \u0111\u1ED9ng th\xF4ng qua vi\u1EC7c b\u1EA1n s\u1EED d\u1EE5ng trang web c\u1EE7a ch\xFAng t\xF4i. Ch\xFAng t\xF4i c\xF3 th\u1EC3 k\u1EBFt h\u1EE3p th\xF4ng tin \u0111\u01B0\u1EE3c thu th\u1EADp t\u1EF1 \u0111\u1ED9ng v\u1EDBi th\xF4ng tin kh\xE1c m\xE0 ch\xFAng t\xF4i \u0111\xE3 thu th\u1EADp v\u1EC1 b\u1EA1n bao g\u1ED3m t\u1EEB c\xE1c ngu\u1ED3n c\xF3 s\u1EB5n c\xF4ng khai."),u(),l(43,"p"),f(44,"\u0110\u1EC3 gi\xFAp b\u1EA1n b\u1EA3o v\u1EC7 b\u1EA3n th\xE2n v\xE0 th\xF4ng tin c\u1EE7a m\xECnh, ch\xFAng t\xF4i khuy\u1EBFn kh\xEDch b\u1EA1n ch\u1EC9 cung c\u1EA5p th\xF4ng tin c\u1EA7n thi\u1EBFt cho vi\u1EC7c s\u1EED d\u1EE5ng trang web c\u1EE7a ch\xFAng t\xF4i. V\xED d\u1EE5: \u0111\u1EC3 l\xEAn l\u1ECBch m\u1ED9t l\u1EDBp h\u1ECDc online, b\u1EA1n c\xF3 th\u1EC3 ch\u1EC9 c\u1EA7n cung c\u1EA5p cho ch\xFAng t\xF4i t\xEAn, \u0111\u1ECBa ch\u1EC9 email, ng\xE0y v\xE0 gi\u1EDD."),u(),l(45,"h5"),f(46,"TH\xD4NG TIN B\u1EA0N T\u1EF0 NGUY\u1EC6N CUNG C\u1EA4P"),u(),l(47,"p"),f(48,"Ch\xFAng t\xF4i thu th\u1EADp th\xF4ng tin sau, tr\u1EF1c ti\u1EBFp t\u1EEB Ng\u01B0\u1EDDi d\xF9ng, Ng\u01B0\u1EDDi \u0111\u01B0\u1EE3c m\u1EDDi ho\u1EB7c Ng\u01B0\u1EDDi xem c\u1EE7a web ho\u1EB7c th\xF4ng qua c\xE1c b\xEAn th\u1EE9 ba li\xEAn quan \u0111\u1EBFn Ng\u01B0\u1EDDi d\xF9ng, Ng\u01B0\u1EDDi \u0111\u01B0\u1EE3c m\u1EDDi ho\u1EB7c Ng\u01B0\u1EDDi xem."),u(),l(49,"ol")(50,"li")(51,"strong"),f(52," Th\xF4ng tin cu\u1ED9c h\u1EB9n."),u(),l(53,"p"),f(54,"Ng\u01B0\u1EDDi d\xF9ng web, Ng\u01B0\u1EDDi \u0111\u01B0\u1EE3c m\u1EDDi ho\u1EB7c b\xEAn th\u1EE9 ba c\xF3 th\u1EC3 t\u1EF1 nguy\u1EC7n cung c\u1EA5p cho ch\xFAng t\xF4i m\u1ED9t s\u1ED1 th\xF4ng tin nh\u1EA5t \u0111\u1ECBnh. \u0110i\u1EC1u n\xE0y c\xF3 th\u1EC3 bao g\u1ED3m t\xEAn, \u0111\u1ECBa ch\u1EC9 email v\xE0 s\u1ED1 \u0111i\u1EC7n tho\u1EA1i; \u0111\u1ECBa ch\u1EC9 email c\u1EE7a ng\u01B0\u1EDDi kh\xE1c; ch\u1EE7 \u0111\u1EC1 c\u1EE7a l\u1EDBp h\u1ECDc; v\xE0 b\u1EA5t k\u1EF3 th\xF4ng tin n\xE0o kh\xE1c \u0111\u01B0\u1EE3c cung c\u1EA5p cho ch\xFAng t\xF4i ho\u1EB7c theo y\xEAu c\u1EA7u c\u1EE7a Ng\u01B0\u1EDDi d\xF9ng web khi l\xEAn l\u1ECBch, theo \u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng c\u1EE7a web. N\u1EBFu b\u1EA1n nh\u1EADn \u0111\u01B0\u1EE3c l\u1EDDi m\u1EDDi t\u1EEB Ng\u01B0\u1EDDi d\xF9ng web nh\u01B0ng kh\xF4ng mu\u1ED1n tr\u1EDF th\xE0nh Ng\u01B0\u1EDDi d\xF9ng web, vui l\xF2ng li\xEAn h\u1EC7 v\u1EDBi Ng\u01B0\u1EDDi d\xF9ng web \u0111\xE3 g\u1EEDi l\u1EDDi m\u1EDDi th\xF4ng qua c\xE1c ph\u01B0\u01A1ng ti\u1EC7n kh\xE1c \u0111\u1EC3 thi\u1EBFt l\u1EADp cu\u1ED9c h\u1ECDp c\u1EE7a b\u1EA1n."),u()(),l(55,"li")(56,"strong"),f(57," Th\xF4ng b\xE1o l\u1EDBp h\u1ECDc tr\u1EF1c tuy\u1EBFn."),u(),l(58,"p"),f(59,"Ng\u01B0\u1EDDi d\xF9ng web c\xF3 th\u1EC3 k\u1EBFt n\u1ED1i l\u1ECBch c\u1EE7a h\u1ECD v\u1EDBi web. T\xEDch h\u1EE3p l\u1ECBch c\u1EE7a ch\xFAng t\xF4i ch\u1EC9 ki\u1EC3m tra th\u1EDDi l\u01B0\u1EE3ng v\xE0 tr\u1EA1ng th\xE1i r\u1EA3nh/b\u1EADn c\u1EE7a c\xE1c s\u1EF1 ki\u1EC7n trong l\u1ECBch c\u1EE7a b\u1EA1n \u0111\u1EC3 ch\xFAng t\xF4i kh\xF4ng \u0111\u1EB7t l\u1ECBch cho b\u1EA1n khi b\u1EA1n b\u1EADn. Ch\xFAng t\xF4i kh\xF4ng bao gi\u1EDD l\u01B0u tr\u1EEF ng\u01B0\u1EDDi b\u1EA1n \u0111ang g\u1EB7p, \u0111\u1ECBa ch\u1EC9 email c\u1EE7a h\u1ECD, ti\xEAu \u0111\u1EC1 cu\u1ED9c h\u1ECDp ho\u1EB7c b\u1EA5t k\u1EF3 chi ti\u1EBFt n\xE0o kh\xE1c v\u1EC1 c\xE1c cu\u1ED9c h\u1EB9n trong l\u1ECBch \u0111\u01B0\u1EE3c k\u1EBFt n\u1ED1i c\u1EE7a b\u1EA1n."),u()(),l(60,"li")(61,"strong"),f(62," Th\xF4ng tin thanh to\xE1n."),u(),l(63,"p"),f(64,"N\u1EBFu b\u1EA1n mua phi\xEAn b\u1EA3n cao c\u1EA5p c\u1EE7a web, b\u1ED9 x\u1EED l\xFD thanh to\xE1n b\xEAn th\u1EE9 ba c\u1EE7a ch\xFAng t\xF4i s\u1EBD thu th\u1EADp v\xE0 l\u01B0u tr\u1EEF \u0111\u1ECBa ch\u1EC9 thanh to\xE1n v\xE0 th\xF4ng tin th\u1EBB t\xEDn d\u1EE5ng c\u1EE7a b\u1EA1n. Ch\xFAng t\xF4i l\u01B0u tr\u1EEF b\u1ED1n ch\u1EEF s\u1ED1 cu\u1ED1i c\u1EE7a s\u1ED1 th\u1EBB t\xEDn d\u1EE5ng, lo\u1EA1i th\u1EBB v\xE0 ng\xE0y h\u1EBFt h\u1EA1n c\u1EE7a b\u1EA1n."),u()()(),l(65,"h5"),f(66,"TH\xD4NG TIN \u0110\u01AF\u1EE2C THU TH\u1EACP T\u1EF0 \u0110\u1ED8NG"),u(),l(67,"p"),f(68,"Ch\xFAng t\xF4i v\xE0 Nh\xE0 cung c\u1EA5p d\u1ECBch v\u1EE5 c\u1EE7a ch\xFAng t\xF4i s\u1EED d\u1EE5ng Cookie, \u0111\xE8n hi\u1EC7u web v\xE0 c\xE1c c\xF4ng ngh\u1EC7 kh\xE1c \u0111\u1EC3 nh\u1EADn v\xE0 l\u01B0u tr\u1EEF m\u1ED9t s\u1ED1 lo\u1EA1i th\xF4ng tin nh\u1EA5t \u0111\u1ECBnh khi b\u1EA1n t\u01B0\u01A1ng t\xE1c v\u1EDBi ch\xFAng t\xF4i th\xF4ng qua m\xE1y t\xEDnh ho\u1EB7c thi\u1EBFt b\u1ECB di \u0111\u1ED9ng t\xF9y thu\u1ED9c v\xE0o t\xF9y ch\u1ECDn kh\xF4ng tham gia c\u1EE7a b\u1EA1n (xem Quy\u1EC1n v\xE0 l\u1EF1a ch\u1ECDn c\u1EE7a b\u1EA1n ph\u1EA7n b\xEAn d\u01B0\u1EDBi). Vi\u1EC7c s\u1EED d\u1EE5ng c\xE1c c\xF4ng ngh\u1EC7 n\xE0y gi\xFAp ch\xFAng t\xF4i t\xF9y ch\u1EC9nh tr\u1EA3i nghi\u1EC7m c\u1EE7a b\u1EA1n v\u1EDBi trang web c\u1EE7a ch\xFAng t\xF4i, c\u1EA3i thi\u1EC7n tr\u1EA3i nghi\u1EC7m c\u1EE7a b\u1EA1n v\xE0 \u0111i\u1EC1u ch\u1EC9nh c\xE1c th\xF4ng \u0111i\u1EC7p ti\u1EBFp th\u1ECB. D\u01B0\u1EDBi \u0111\xE2y l\xE0 m\u1ED9t s\u1ED1 lo\u1EA1i th\xF4ng tin ch\xFAng t\xF4i thu th\u1EADp:"),u(),l(69,"ol")(70,"li")(71,"strong"),f(72," Nh\u1EADt k\xFD v\xE0 d\u1EEF li\u1EC7u thi\u1EBFt b\u1ECB."),u(),l(73,"p"),f(74,"Khi b\u1EA1n s\u1EED d\u1EE5ng web, m\xE1y ch\u1EE7 c\u1EE7a ch\xFAng t\xF4i s\u1EBD t\u1EF1 \u0111\u1ED9ng ghi l\u1EA1i th\xF4ng tin (\u201Cd\u1EEF li\u1EC7u nh\u1EADt k\xFD\u201D), bao g\u1ED3m th\xF4ng tin m\xE0 tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n g\u1EEDi b\u1EA5t c\u1EE9 khi n\xE0o b\u1EA1n truy c\u1EADp trang web c\u1EE7a ch\xFAng t\xF4i. D\u1EEF li\u1EC7u nh\u1EADt k\xFD n\xE0y c\xF3 th\u1EC3 bao g\u1ED3m \u0111\u1ECBa ch\u1EC9 web b\u1EA1n \u0111\xE3 truy c\u1EADp c\u1EE7a ch\xFAng t\xF4i, ki\u1EC3u thi\u1EBFt b\u1ECB, h\u1EC7 \u0111i\u1EC1u h\xE0nh, lo\u1EA1i tr\xECnh duy\u1EC7t, m\xE3 \u0111\u1ECBnh danh thi\u1EBFt b\u1ECB duy nh\u1EA5t, \u0111\u1ECBa ch\u1EC9 IP, nh\xE0 cung c\u1EA5p m\u1EA1ng di \u0111\u1ED9ng v\xE0 m\xFAi gi\u1EDD ho\u1EB7c v\u1ECB tr\xED. Vi\u1EC7c ch\xFAng t\xF4i thu th\u1EADp m\u1ED9t s\u1ED1 hay t\u1EA5t c\u1EA3 th\xF4ng tin n\xE0y th\u01B0\u1EDDng ph\u1EE5 thu\u1ED9c v\xE0o lo\u1EA1i thi\u1EBFt b\u1ECB b\u1EA1n \u0111ang s\u1EED d\u1EE5ng v\xE0 c\xE0i \u0111\u1EB7t c\u1EE7a n\xF3. V\xED d\u1EE5, nhi\u1EC1u lo\u1EA1i th\xF4ng tin kh\xE1c nhau c\xF3 s\u1EB5n t\xF9y thu\u1ED9c v\xE0o vi\u1EC7c b\u1EA1n \u0111ang s\u1EED d\u1EE5ng m\xE1y Mac hay PC, iPhone hay \u0111i\u1EC7n tho\u1EA1i Android. \u0110\u1EC3 t\xECm hi\u1EC3u th\xEAm v\u1EC1 nh\u1EEFng th\xF4ng tin m\xE0 thi\u1EBFt b\u1ECB c\u1EE7a b\u1EA1n cung c\u1EA5p cho ch\xFAng t\xF4i, vui l\xF2ng ki\u1EC3m tra ch\xEDnh s\xE1ch c\u1EE7a nh\xE0 s\u1EA3n xu\u1EA5t thi\u1EBFt b\u1ECB ho\u1EB7c nh\xE0 cung c\u1EA5p ph\u1EA7n m\u1EC1m c\u1EE7a b\u1EA1n."),u()(),l(75,"li")(76,"strong"),f(77," D\u1EEF li\u1EC7u cookie."),u(),l(78,"p"),f(79,"T\xF9y thu\u1ED9c v\xE0o c\xE1ch b\u1EA1n \u0111ang truy c\u1EADp c\xE1c d\u1ECBch v\u1EE5 c\u1EE7a ch\xFAng t\xF4i v\xE0 t\xF9y thu\u1ED9c v\xE0o t\xF9y ch\u1ECDn kh\xF4ng tham gia c\u1EE7a b\u1EA1n, ch\xFAng t\xF4i c\xF3 th\u1EC3 s\u1EED d\u1EE5ng \u201CCookie\u201D (m\u1ED9t t\u1EC7p v\u0103n b\u1EA3n nh\u1ECF do m\xE1y t\xEDnh c\u1EE7a b\u1EA1n g\u1EEDi m\u1ED7i khi b\u1EA1n truy c\u1EADp trang web c\u1EE7a ch\xFAng t\xF4i, duy nh\u1EA5t cho t\xE0i kho\u1EA3n web ho\u1EB7c tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n) ho\u1EB7c c\xE1c c\xF4ng ngh\u1EC7 t\u01B0\u01A1ng t\u1EF1 \u0111\u1EC3 ghi l\u1EA1i d\u1EEF li\u1EC7u nh\u1EADt k\xFD. Khi ch\xFAng t\xF4i s\u1EED d\u1EE5ng Cookie, ch\xFAng t\xF4i c\xF3 th\u1EC3 s\u1EED d\u1EE5ng Cookie \u2018phi\xEAn\u2019 (k\xE9o d\xE0i cho \u0111\u1EBFn khi b\u1EA1n \u0111\xF3ng tr\xECnh duy\u1EC7t c\u1EE7a m\xECnh) ho\u1EB7c Cookie \u2018li\xEAn t\u1EE5c\u2019 (k\xE9o d\xE0i cho \u0111\u1EBFn khi b\u1EA1n ho\u1EB7c tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n x\xF3a ch\xFAng). V\xED d\u1EE5: ch\xFAng t\xF4i c\xF3 th\u1EC3 s\u1EED d\u1EE5ng Cookie \u0111\u1EC3 gi\xFAp b\u1EA1n lu\xF4n \u0111\u0103ng nh\u1EADp v\xE0o web. M\u1ED9t s\u1ED1 Cookie l\xE0 c\u1EA7n thi\u1EBFt \u0111\u1EC3 trang web ho\u1EA1t \u0111\u1ED9ng, trong khi nh\u1EEFng c\xE1i kh\xE1c c\xF3 th\u1EC3 \u0111\u01B0\u1EE3c s\u1EED d\u1EE5ng \u0111\u1EC3 cung c\u1EA5p cho b\u1EA1n c\xE1c t\xEDnh n\u0103ng ho\u1EB7c ch\u1EE9c n\u0103ng b\u1ED5 sung ho\u1EB7c \u0111\u1EC3 ph\xE2n t\xEDch c\xE1ch b\u1EA1n s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5 c\u1EE7a ch\xFAng t\xF4i. B\u1EA1n c\xF3 th\u1EC3 \u0111i\u1EC1u ch\u1EC9nh c\xE0i \u0111\u1EB7t c\u1EE7a tr\xECnh duy\u1EC7t c\u1EE7a m\xECnh \u0111\u1EC3 t\u1EEB ch\u1ED1i Cookie, nh\u01B0ng \u0111i\u1EC1u \u0111\xF3 c\xF3 th\u1EC3 \u1EA3nh h\u01B0\u1EDFng \u0111\u1EBFn kh\u1EA3 n\u0103ng s\u1EED d\u1EE5ng trang web c\u1EE7a ch\xFAng t\xF4i."),u()(),l(80,"li")(81,"strong"),f(82," D\u1EEF li\u1EC7u ph\xE2n t\xEDch."),u(),l(83,"p"),f(84,"Ch\xFAng t\xF4i c\xF3 th\u1EC3 s\u1EED d\u1EE5ng c\xE1c d\u1ECBch v\u1EE5 ph\xE2n t\xEDch c\u1EE7a b\xEAn th\u1EE9 ba \u0111\u1EC3 theo d\xF5i c\xE1ch b\u1EA1n t\u01B0\u01A1ng t\xE1c v\u1EDBi d\u1ECBch v\u1EE5 c\u1EE7a ch\xFAng t\xF4i v\xE0 th\xF4ng b\xE1o cho ch\xFAng t\xF4i v\u1EC1 c\xE1ch c\u1EA3i thi\u1EC7n trang web c\u1EE7a m\xECnh. C\xE1c d\u1ECBch v\u1EE5 n\xE0y c\xF3 th\u1EC3 thu th\u1EADp th\xF4ng tin v\u1EC1 b\u1EA1n, bao g\u1ED3m \u0111\u1ECBa ch\u1EC9 IP, tr\xECnh duy\u1EC7t v\xE0 h\u1EC7 \u0111i\u1EC1u h\xE0nh, th\u1EDDi gian v\xE0 ng\xE0y, v\xE0 h\xE0nh \u0111\u1ED9ng c\u1EE7a b\u1EA1n tr\xEAn trang web c\u1EE7a ch\xFAng t\xF4i."),u()()(),l(85,"h5"),f(86,"CHIA S\u1EBA TH\xD4NG TIN"),u(),l(87,"p"),f(88,"Ch\xFAng t\xF4i c\xF3 th\u1EC3 chia s\u1EBB th\xF4ng tin c\u1EE7a b\u1EA1n v\u1EDBi nh\u1EEFng ng\u01B0\u1EDDi kh\xE1c trong m\u1ED9t s\u1ED1 t\xECnh hu\u1ED1ng nh\u1EA5t \u0111\u1ECBnh, bao g\u1ED3m:"),u(),l(89,"ol")(90,"li")(91,"strong"),f(92," Nh\xE0 cung c\u1EA5p d\u1ECBch v\u1EE5."),u(),f(93," Ch\xFAng t\xF4i c\xF3 th\u1EC3 chia s\u1EBB th\xF4ng tin v\u1EDBi c\xE1c nh\xE0 cung c\u1EA5p d\u1ECBch v\u1EE5 m\xE0 ch\xFAng t\xF4i s\u1EED d\u1EE5ng \u0111\u1EC3 th\u1EF1c hi\u1EC7n d\u1ECBch v\u1EE5 c\u1EE7a m\xECnh, ch\u1EB3ng h\u1EA1n nh\u01B0 b\u1ED9 x\u1EED l\xFD thanh to\xE1n ho\u1EB7c d\u1ECBch v\u1EE5 l\u01B0u tr\u1EEF d\u1EEF li\u1EC7u."),u(),l(94,"li")(95,"strong"),f(96," C\u01A1 quan nh\xE0 n\u01B0\u1EDBc."),u(),f(97," Ch\xFAng t\xF4i c\xF3 th\u1EC3 ti\u1EBFt l\u1ED9 th\xF4ng tin n\u1EBFu ch\xFAng t\xF4i tin r\u1EB1ng h\xE0nh \u0111\u1ED9ng \u0111\xF3 l\xE0 c\u1EA7n thi\u1EBFt \u0111\u1EC3 tu\xE2n th\u1EE7 lu\u1EADt ph\xE1p, b\u1EA3o v\u1EC7 quy\u1EC1n v\xE0 t\xE0i s\u1EA3n c\u1EE7a ch\xFAng t\xF4i, ho\u1EB7c \u0111\u1EA3m b\u1EA3o an to\xE0n cho ng\u01B0\u1EDDi kh\xE1c."),u(),l(98,"li")(99,"strong"),f(100," Trong tr\u01B0\u1EDDng h\u1EE3p chuy\u1EC3n nh\u01B0\u1EE3ng."),u(),f(101," N\u1EBFu web tham gia v\xE0o m\u1ED9t th\u01B0\u01A1ng v\u1EE5, ch\u1EB3ng h\u1EA1n nh\u01B0 s\xE1p nh\u1EADp, mua l\u1EA1i ho\u1EB7c b\xE1n t\xE0i s\u1EA3n, th\xF4ng tin c\u1EE7a b\u1EA1n c\xF3 th\u1EC3 \u0111\u01B0\u1EE3c chuy\u1EC3n giao nh\u01B0 m\u1ED9t ph\u1EA7n c\u1EE7a th\u01B0\u01A1ng v\u1EE5 \u0111\xF3. "),u()(),l(102,"h5"),f(103,"B\u1EA2O M\u1EACT TH\xD4NG TIN"),u(),l(104,"p"),f(105,"Ch\xFAng t\xF4i s\u1EED d\u1EE5ng c\xE1c bi\u1EC7n ph\xE1p b\u1EA3o m\u1EADt h\u1EE3p l\xFD \u0111\u1EC3 b\u1EA3o v\u1EC7 th\xF4ng tin c\u1EE7a b\u1EA1n kh\u1ECFi vi\u1EC7c truy c\u1EADp, s\u1EED d\u1EE5ng ho\u1EB7c ti\u1EBFt l\u1ED9 tr\xE1i ph\xE9p. Tuy nhi\xEAn, kh\xF4ng c\xF3 ph\u01B0\u01A1ng th\u1EE9c truy\u1EC1n t\u1EA3i qua Internet ho\u1EB7c ph\u01B0\u01A1ng th\u1EE9c l\u01B0u tr\u1EEF \u0111i\u1EC7n t\u1EED n\xE0o l\xE0 ho\xE0n to\xE0n an to\xE0n. Do \u0111\xF3, m\u1EB7c d\xF9 ch\xFAng t\xF4i c\u1ED1 g\u1EAFng b\u1EA3o v\u1EC7 th\xF4ng tin c\u1EE7a b\u1EA1n, ch\xFAng t\xF4i kh\xF4ng th\u1EC3 \u0111\u1EA3m b\u1EA3o t\xEDnh b\u1EA3o m\u1EADt tuy\u1EC7t \u0111\u1ED1i."),u(),l(106,"h5"),f(107,"LI\xCAN H\u1EC6 V\u1EDAI CH\xDANG T\xD4I"),u(),l(108,"p"),f(109),u()(),l(110,"div",7)(111,"div",9)(112,"div",10)(113,"h1",11),f(114,"Th\xF4ng tin li\xEAn h\u1EC7"),u(),l(115,"div",12)(116,"p"),N(117,"i",13),f(118," 0123456789"),u(),l(119,"p"),N(120,"i",14),f(121),u(),l(122,"p"),N(123,"i",15),f(124," 179 \u0110\u1EB7ng Th\xF9y Tr\xE2m, ph\u01B0\u1EDDng 13, qu\u1EADn B\xECnh Th\u1EA1nh, tp HCM"),u()()(),l(125,"div",16)(126,"h1",11),f(127,"\u0110i\u1EC1u kho\u1EA3n v\xE0 h\u01B0\u1EDBng d\u1EABn"),u(),l(128,"div",12)(129,"p")(130,"a",17),f(131,"\u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng"),u(),l(132,"a",18),f(133,"/ b\u1EA3o m\u1EADt th\xF4ng tin"),u()(),l(134,"p")(135,"a",19),f(136,"H\u01B0\u1EDBng d\u1EABn"),u()(),l(137,"p")(138,"a",20),f(139,"Li\xEAn h\u1EC7 h\u1ED7 tr\u1EE3"),u()()()()(),N(140,"hr",21),l(141,"footer",22)(142,"div",23)(143,"p"),f(144,"\xA9 2024 Group 77 | All Rights Reserved"),u(),l(145,"a",24),f(146,"Privacy Policy"),u(),f(147," | "),l(148,"a",24),f(149,"Terms of Service"),u()()()()),t&2&&(m(109),te("N\u1EBFu b\u1EA1n c\xF3 b\u1EA5t k\u1EF3 c\xE2u h\u1ECFi n\xE0o v\u1EC1 Th\xF4ng b\xE1o v\u1EC1 quy\u1EC1n ri\xEAng t\u01B0 n\xE0y ho\u1EB7c mu\u1ED1n th\u1EF1c hi\u1EC7n b\u1EA5t k\u1EF3 quy\u1EC1n n\xE0o m\xE0 b\u1EA1n c\xF3, vui l\xF2ng li\xEAn h\u1EC7 v\u1EDBi ch\xFAng t\xF4i qua email: ",r.email,""),m(12),te(" ",r.email,""))},styles:["h5[_ngcontent-%COMP%]{color:#6495ed}"]})};var Cd=class e{static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Se({type:e,selectors:[["app-guide"]],standalone:!0,features:[Me],decls:25,vars:0,consts:[[1,"container","mt-5"],[1,"text-center"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"h1",1),f(2,"H\u01B0\u1EDBng D\u1EABn S\u1EED D\u1EE5ng"),u(),l(3,"p"),f(4,"\u0110\u1EC3 s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5 tr\u1EAFc nghi\u1EC7m online c\u1EE7a ch\xFAng t\xF4i, vui l\xF2ng l\xE0m theo c\xE1c b\u01B0\u1EDBc sau:"),u(),l(5,"h2"),f(6,"1. \u0110\u0103ng K\xFD T\xE0i Kho\u1EA3n"),u(),l(7,"p"),f(8,"Truy c\u1EADp trang \u0111\u0103ng k\xFD v\xE0 \u0111i\u1EC1n th\xF4ng tin c\u1EA7n thi\u1EBFt \u0111\u1EC3 t\u1EA1o t\xE0i kho\u1EA3n."),u(),l(9,"h2"),f(10,"2. \u0110\u0103ng Nh\u1EADp"),u(),l(11,"p"),f(12,"S\u1EED d\u1EE5ng t\xEAn \u0111\u0103ng nh\u1EADp v\xE0 m\u1EADt kh\u1EA9u \u0111\u1EC3 \u0111\u0103ng nh\u1EADp v\xE0o t\xE0i kho\u1EA3n c\u1EE7a b\u1EA1n."),u(),l(13,"h2"),f(14,"3. T\u1EA1o B\xE0i Thi"),u(),l(15,"p"),f(16,"Ch\u1ECDn t\xF9y ch\u1ECDn t\u1EA1o b\xE0i thi v\xE0 l\xE0m theo h\u01B0\u1EDBng d\u1EABn \u0111\u1EC3 th\xEAm c\xE2u h\u1ECFi v\xE0 c\xE0i \u0111\u1EB7t b\xE0i thi."),u(),l(17,"h2"),f(18,"4. Tham Gia Thi"),u(),l(19,"p"),f(20,"Ch\u1ECDn b\xE0i thi b\u1EA1n mu\u1ED1n tham gia v\xE0 l\xE0m theo h\u01B0\u1EDBng d\u1EABn \u0111\u1EC3 ho\xE0n th\xE0nh b\xE0i thi."),u(),l(21,"h2"),f(22,"5. H\u1ED7 Tr\u1EE3"),u(),l(23,"p"),f(24,"N\u1EBFu b\u1EA1n g\u1EB7p kh\xF3 kh\u0103n trong qu\xE1 tr\xECnh s\u1EED d\u1EE5ng d\u1ECBch v\u1EE5, vui l\xF2ng li\xEAn h\u1EC7 v\u1EDBi ch\xFAng t\xF4i \u0111\u1EC3 \u0111\u01B0\u1EE3c h\u1ED7 tr\u1EE3."),u()())}})};var yd=class e{email="support@example.com";static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Se({type:e,selectors:[["app-contact"]],standalone:!0,features:[Me],decls:73,vars:2,consts:[[1,"navbar","navbar-expand-lg","navbar-light"],[1,"container-fluid"],["id","navbarTogglerDemo03",1,"collapse","navbar-collapse"],[1,"fa-solid","fa-chevron-left"],[1,"navbar-nav","me-auto","mb-4","mb-lg-0"],[1,"nav-item","ms-4"],["aria-current","page","href","/home",1,"nav-link","active"],[1,"container","mt-5"],[1,"text-center"],[1,"row","align-items-center"],[1,"col-md-6","text-start"],[1,"my-4"],[1,"text-start"],[1,"fa-solid","fa-phone",2,"margin-right","5px"],[1,"fa-solid","fa-envelope",2,"margin-right","5px"],[1,"fa-solid","fa-location-dot",2,"margin-right","5px"],[1,"col-md-6"],["href","/terms"],["href","/privacy"],["href","/guide"],["href","/contact"],[2,"border","1px solid #000","margin","0"],[1,"text-black","text-center","py-3","footer"],[1,"container"],["href","#"]],template:function(t,r){t&1&&(l(0,"nav",0)(1,"div",1)(2,"div",2),N(3,"i",3),l(4,"ul",4)(5,"li",5)(6,"a",6),f(7,"TRANG CH\u1EE6"),u()()()()()(),l(8,"div",7)(9,"h1",8),f(10,"Li\xEAn H\u1EC7 H\u1ED7 Tr\u1EE3"),u(),l(11,"p"),f(12,"N\u1EBFu b\u1EA1n c\u1EA7n h\u1ED7 tr\u1EE3 ho\u1EB7c c\xF3 b\u1EA5t k\u1EF3 c\xE2u h\u1ECFi n\xE0o, vui l\xF2ng li\xEAn h\u1EC7 v\u1EDBi ch\xFAng t\xF4i qua c\xE1c ph\u01B0\u01A1ng th\u1EE9c d\u01B0\u1EDBi \u0111\xE2y:"),u(),l(13,"h2"),f(14,"Th\xF4ng Tin Li\xEAn H\u1EC7"),u(),l(15,"p")(16,"strong"),f(17,"\u0110i\u1EC7n Tho\u1EA1i:"),u(),f(18," 0123456789"),u(),l(19,"p")(20,"strong"),f(21,"Email:"),u(),f(22),u(),l(23,"p")(24,"strong"),f(25,"\u0110\u1ECBa Ch\u1EC9:"),u(),f(26," 179 \u0110\u1EB7ng Th\xF9y Tr\xE2m, ph\u01B0\u1EDDng 13, qu\u1EADn B\xECnh Th\u1EA1nh, tp HCM"),u(),l(27,"h2"),f(28,"Gi\u1EDD L\xE0m Vi\u1EC7c"),u(),l(29,"p"),f(30,"Th\u1EE9 Hai - Th\u1EE9 S\xE1u: 9:00 - 18:00"),u(),l(31,"p"),f(32,"Th\u1EE9 B\u1EA3y - Ch\u1EE7 Nh\u1EADt: \u0110\xF3ng c\u1EEDa"),u()(),l(33,"div",7)(34,"div",9)(35,"div",10)(36,"h1",11),f(37,"Th\xF4ng tin li\xEAn h\u1EC7"),u(),l(38,"div",12)(39,"p"),N(40,"i",13),f(41," 0123456789"),u(),l(42,"p"),N(43,"i",14),f(44),u(),l(45,"p"),N(46,"i",15),f(47," 179 \u0110\u1EB7ng Th\xF9y Tr\xE2m, ph\u01B0\u1EDDng 13, qu\u1EADn B\xECnh Th\u1EA1nh, tp HCM"),u()()(),l(48,"div",16)(49,"h1",11),f(50,"\u0110i\u1EC1u kho\u1EA3n v\xE0 h\u01B0\u1EDBng d\u1EABn"),u(),l(51,"div",12)(52,"p")(53,"a",17),f(54,"\u0110i\u1EC1u kho\u1EA3n s\u1EED d\u1EE5ng"),u(),l(55,"a",18),f(56,"/ b\u1EA3o m\u1EADt th\xF4ng tin"),u()(),l(57,"p")(58,"a",19),f(59,"H\u01B0\u1EDBng d\u1EABn"),u()(),l(60,"p")(61,"a",20),f(62,"Li\xEAn h\u1EC7 h\u1ED7 tr\u1EE3"),u()()()()(),N(63,"hr",21),l(64,"footer",22)(65,"div",23)(66,"p"),f(67,"\xA9 2024 Group 77 | All Rights Reserved"),u(),l(68,"a",24),f(69,"Privacy Policy"),u(),f(70," | "),l(71,"a",24),f(72,"Terms of Service"),u()()()()),t&2&&(m(22),te(" ",r.email,""),m(22),te(" ",r.email,""))}})};function NP(e,n){e&1&&(l(0,"div",12),f(1," \u0110ang x\u1EED l\xFD... "),N(2,"i",13),u())}var wd=class e{constructor(n,t){this.router=n;this.authService=t}selectedRole=null;isLoading=!1;errorMessage=null;ngOnInit(){let n=this.authService.getCurrentUser();if(!n){this.router.navigate(["/register"]);return}n.role==="admin"&&(alert("B\u1EA1n l\xE0 admin. Chuy\u1EC3n h\u01B0\u1EDBng \u0111\u1EBFn Admin Dashboard."),this.router.navigate(["/admin-dashboard"]))}handleOptionClick(n){this.errorMessage=null,this.selectedRole=n,this.isLoading=!0;let t=this.authService.getCurrentUser();if(!t?._id){this.setErrorMessage("Kh\xF4ng t\xECm th\u1EA5y th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng. Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i.");return}if(t.role==="admin"){this.setErrorMessage("Admin kh\xF4ng th\u1EC3 thay \u0111\u1ED5i vai tr\xF2.");return}this.authService.updateUserRole(t._id,n).subscribe({next:r=>{console.log("Vai tr\xF2 \u0111\xE3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt th\xE0nh c\xF4ng:",r),localStorage.setItem("user",JSON.stringify(r.user)),this.isLoading=!1,this.navigateToDashboard(n)},error:r=>{console.error("C\u1EADp nh\u1EADt vai tr\xF2 th\u1EA5t b\u1EA1i:",r),this.setErrorMessage(r.message||"C\u1EADp nh\u1EADt vai tr\xF2 th\u1EA5t b\u1EA1i. Vui l\xF2ng th\u1EED l\u1EA1i.")}})}navigateToDashboard(n){n==="student"?this.router.navigate(["/student-dashboard"]):this.router.navigate(["/teacher-dashboard"])}setErrorMessage(n){this.errorMessage=n,this.isLoading=!1,this.selectedRole=null}static \u0275fac=function(t){return new(t||e)(Q(Re),Q(ze))};static \u0275cmp=Se({type:e,selectors:[["app-role"]],standalone:!0,features:[Me],decls:20,vars:5,consts:[[1,"container"],[1,"logo"],["alt","Quizz App","height","150","src","../../../assets/img/logo2.png","width","150"],[1,"title"],["href","#"],[1,"options"],[1,"option",3,"click"],["alt","Student participating in quiz","height","100","src","../../../assets/img/pic2.png","width","100"],["alt","Teacher creating quiz","height","100","src","../../../assets/img/pic3.png","width","100"],[1,"footer"],["alt","Rocket and gears illustration","height","200","src","../../../assets/img/footer.png","width","200"],["class","loading-indicator",4,"ngIf"],[1,"loading-indicator"],[1,"fa","fa-spinner","fa-spin"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1),N(2,"img",2),u(),l(3,"div",3),f(4," B\u1EA1n tham gia "),l(5,"a",4),f(6,"QUIZ"),u(),f(7," v\u1EDBi h\xECnh th\u1EE9c n\xE0o? "),u(),l(8,"div",5)(9,"div",6),H("click",function(){return r.handleOptionClick("student")}),N(10,"img",7),l(11,"p"),f(12,"H\u1ECDc vi\xEAn tham gia l\xE0m b\xE0i tr\u1EAFc nghi\u1EC7m"),u()(),l(13,"div",6),H("click",function(){return r.handleOptionClick("teacher")}),N(14,"img",8),l(15,"p"),f(16,"Gi\xE1o vi\xEAn t\u1EA1o v\xE0 qu\u1EA3n l\xFD b\xE0i tr\u1EAFc nghi\u1EC7m Online"),u()()()(),l(17,"div",9),N(18,"img",10),u(),G(19,NP,3,0,"div",11)),t&2&&(m(9),xt("selected",r.selectedRole==="student"),m(4),xt("selected",r.selectedRole==="teacher"),m(6),O("ngIf",r.isLoading))},dependencies:[Ue,We],styles:["body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;text-align:center;background-color:#fff;margin:0;padding:0}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100vh}.logo[_ngcontent-%COMP%]{margin-bottom:20px}.logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:200px;height:200px}.title[_ngcontent-%COMP%]{font-size:24px;color:#333;margin-bottom:40px}.title[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#007bff;text-decoration:none}.options[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px}.option[_ngcontent-%COMP%]{border:1px solid #e0e0e0;border-radius:8px;padding:20px;width:300px;text-align:center;transition:box-shadow .3s;cursor:pointer;background-color:transparent}.option[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #0000001a}.option.selected[_ngcontent-%COMP%]{border:2px solid #007bff;background-color:#e7f0ff;box-shadow:0 4px 12px #0003}.footer[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0}.footer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:300px}.loading-indicator[_ngcontent-%COMP%]{text-align:center;font-size:1.2em;color:#333;margin-top:20px}"]})};var It=class e{constructor(n,t){this.http=n;this.authService=t}apiUrl="http://localhost:3000/exams";getAuthHeaders(){let n=this.authService.getToken();return new Bt().set("Authorization",`Bearer ${n}`)}handleError(n){console.error("API Error:",n);let t;return n.status===0?t="Kh\xF4ng th\u1EC3 k\u1EBFt n\u1ED1i \u0111\u1EBFn server. Vui l\xF2ng ki\u1EC3m tra k\u1EBFt n\u1ED1i m\u1EA1ng.":n.status===401?(t="Phi\xEAn \u0111\u0103ng nh\u1EADp h\u1EBFt h\u1EA1n. Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i.",this.authService.logout()):n.status===403?t="B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp t\xE0i nguy\xEAn n\xE0y.":n.status===404?t="Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u y\xEAu c\u1EA7u.":n.status===500?t="L\u1ED7i server. Vui l\xF2ng th\u1EED l\u1EA1i sau.":t=n.error?.message||"\u0110\xE3 x\u1EA3y ra l\u1ED7i kh\xF4ng x\xE1c \u0111\u1ECBnh.",vn(()=>new Error(t))}createExam(n){console.log("Exam data being sent:",n);let t=this.getAuthHeaders();return this.http.post(this.apiUrl,n,{headers:t})}getExams(){let n=this.getAuthHeaders();return this.http.get(this.apiUrl,{headers:n})}getPublishedExams(){let n=`${this.apiUrl}?status=published`;return this.http.get(n)}getExamQuestionById(n){return this.http.get(`${this.apiUrl}/questions/${n}`)}getExamById(n){console.log("Fetching exam by ID:",n);let t=this.getAuthHeaders();return this.http.get(`${this.apiUrl}/${n}`,{headers:t}).pipe(Ft(r=>console.log("Fetched exam from API:",r)),Et(r=>(console.error("Error fetching exam:",r),vn(r))))}updateExam(n,t){let r=this.getAuthHeaders();return this.http.put(`${this.apiUrl}/${n}`,t,{headers:r})}deleteExam(n){let t=this.getAuthHeaders();return this.http.delete(`${this.apiUrl}/${n}`,{headers:t})}getExam(n){return this.http.get(`${this.apiUrl}/${n}`)}submitExam(n,t){let r=this.getAuthHeaders(),i={answers:t.answers,startTime:t.startTime,endTime:t.endTime};return this.http.post(`${this.apiUrl}/${n}/submit`,i,{headers:r}).pipe(Ft(o=>console.log("Exam submitted:",o)),Et(o=>(console.error("Submit error:",o),vn(()=>o))))}getResult(n){return this.http.get(`${this.apiUrl}/${n}/results`)}getExamHistory(n){let t=this.getAuthHeaders();return this.http.get(`${this.apiUrl}/user/${n}/results`,{headers:t})}getExamResult(n){let t=this.getAuthHeaders();return this.http.get(`${this.apiUrl}/results/${n}`,{headers:t})}getExamDetails(n){let t=`${this.apiUrl}/${n}`;return console.log("Fetching exam details from URL:",t),this.http.get(t)}getExamStatistics(n){let t=`${this.apiUrl}/${n}/statistics`;return console.log("Fetching exam statistics from URL:",t),this.http.get(t)}getStudentExamDetails(n,t){let r=`http://localhost:3000/exams/${n}/results/${t}`;return this.http.get(r).pipe(Et(i=>(console.error("Error fetching student exam details:",i),i.status===404?vn({error:"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u chi ti\u1EBFt b\xE0i ki\u1EC3m tra cho User ID n\xE0y!"}):this.handleError(i))))}getStudentExamDetail(n,t){let r=`http://localhost:3000/exams/${n}/results/${t}`;return this.http.get(r)}static \u0275fac=function(t){return new(t||e)(ke(Ki),ke(ze))};static \u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})};function RP(e,n){if(e&1){let t=ve();l(0,"div",34)(1,"h3"),f(2),u(),l(3,"p"),f(4),u(),l(5,"p"),f(6),zt(7,"date"),zt(8,"date"),u(),l(9,"p"),f(10),u(),l(11,"p"),f(12),u(),l(13,"div",35)(14,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.viewExamDetails(i))}),f(15,"Xem chi ti\u1EBFt"),u(),l(16,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.editExam(i))}),f(17,"Ch\u1EC9nh s\u1EEDa"),u(),l(18,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.deleteExam(i))}),f(19,"X\xF3a"),u(),l(20,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.updateExamStatus(i))}),f(21,"T\u1EA1o k\xEC thi"),u()()()}if(e&2){let t=n.$implicit;m(2),ae(t.name),m(2),ae(t.description),m(2),Wt("Th\u1EDDi gian: ",tr(7,6,t.startDate)," - ",tr(8,8,t.endDate),""),m(4),te("Th\u1EDDi l\u01B0\u1EE3ng: ",t.duration," ph\xFAt"),m(2),te("\u0110i\u1EC3m t\u1ED1i \u0111a: ",t.maxScore,"")}}function BP(e,n){if(e&1&&(l(0,"div"),G(1,RP,22,10,"div",33),u()),e&2){let t=D();m(),O("ngForOf",t.activeExams)}}function LP(e,n){e&1&&(l(0,"div",37),N(1,"img",38),l(2,"div"),f(3,"Hi\u1EC7n t\u1EA1i kh\xF4ng c\xF3 b\xE0i thi n\xE0o \u0111ang di\u1EC5n ra"),u()())}function VP(e,n){if(e&1){let t=ve();l(0,"div",34)(1,"h3"),f(2),u(),l(3,"p"),f(4),u(),l(5,"p"),f(6),zt(7,"date"),u(),l(8,"p"),f(9),u(),l(10,"p"),f(11),u(),l(12,"div",35)(13,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.viewExamDetails(i))}),f(14,"Xem chi ti\u1EBFt"),u(),l(15,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.editExam(i))}),f(16,"Ch\u1EC9nh s\u1EEDa"),u(),l(17,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.deleteExam(i))}),f(18,"X\xF3a"),u(),l(19,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.updateExamStatus(i))}),f(20,"T\u1EA1o k\xEC thi"),u()()()}if(e&2){let t=n.$implicit;m(2),ae(t.name),m(2),ae(t.description),m(2),te("D\u1EF1 ki\u1EBFn b\u1EAFt \u0111\u1EA7u: ",tr(7,5,t.startDate),""),m(3),te("Th\u1EDDi l\u01B0\u1EE3ng: ",t.duration," ph\xFAt"),m(2),te("\u0110i\u1EC3m t\u1ED1i \u0111a: ",t.maxScore,"")}}function UP(e,n){if(e&1&&(l(0,"div"),G(1,VP,21,7,"div",33),u()),e&2){let t=D();m(),O("ngForOf",t.draftExams)}}function jP(e,n){e&1&&(l(0,"div",37),N(1,"img",39),l(2,"div"),f(3,"Hi\u1EC7n t\u1EA1i kh\xF4ng c\xF3 b\xE0i thi n\xE0o \u0111ang so\u1EA1n"),u()())}function HP(e,n){if(e&1){let t=ve();l(0,"div",34)(1,"h3"),f(2),u(),l(3,"p"),f(4),u(),l(5,"p"),f(6),zt(7,"date"),zt(8,"date"),u(),l(9,"p"),f(10),u(),l(11,"p"),f(12),u(),l(13,"div",35)(14,"button",36),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.viewExamDetails(i))}),f(15,"Xem chi ti\u1EBFt"),u()()()}if(e&2){let t=n.$implicit;m(2),ae(t.name),m(2),ae(t.description),m(2),Wt("Th\u1EDDi gian: ",tr(7,6,t.startDate)," - ",tr(8,8,t.endDate),""),m(4),te("Th\u1EDDi l\u01B0\u1EE3ng: ",t.duration," ph\xFAt"),m(2),te("\u0110i\u1EC3m t\u1ED1i \u0111a: ",t.maxScore,"")}}function $P(e,n){if(e&1&&(l(0,"div"),G(1,HP,16,10,"div",33),u()),e&2){let t=D();m(),O("ngForOf",t.publishedExams)}}function qP(e,n){e&1&&(l(0,"div",37),N(1,"img",40),l(2,"div"),f(3,"Hi\u1EC7n t\u1EA1i kh\xF4ng c\xF3 b\xE0i thi n\xE0o \u0111\xE3 \u0111\u0103ng"),u()())}var bd=class e{constructor(n,t,r){this.authService=n;this.router=t;this.examService=r}user=null;isDropdownActive=!1;activeExams=[];draftExams=[];publishedExams=[];ngOnInit(){this.user=this.authService.getCurrentUser(),this.loadExams()}loadExams(){this.examService.getExams().subscribe({next:n=>{let t=new Date;this.activeExams=n.filter(r=>new Date(r.startDate)<=t&&new Date(r.endDate)>=t&&r.status!=="published"),this.draftExams=n.filter(r=>new Date(r.startDate)>t&&r.status!=="published"),this.publishedExams=n.filter(r=>r.status==="published")},error:n=>{console.error("Error loading exams:",n)}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}logout(){this.authService.logout().subscribe({next:()=>{this.router.navigate(["/login"])},error:n=>{console.error("Logout error:",n)}})}navigateToCreateExam(){this.router.navigate(["/exam-create"])}viewExamDetails(n){this.router.navigate(["/exam-details",n._id])}editExam(n){this.router.navigate(["/exam-edit",n._id])}deleteExam(n){confirm(`Are you sure you want to delete the exam "${n.name}"?`)&&this.examService.deleteExam(n._id).subscribe({next:()=>{this.loadExams(),alert("Exam deleted successfully")},error:t=>{console.error("Error deleting exam:",t)}})}updateExamStatus(n){n.status="published",this.examService.updateExam(n._id,n).subscribe({next:()=>{this.loadExams(),alert("Exam status updated successfully")},error:t=>{console.error("Error updating exam status:",t)}})}navigateToStatistics(n){this.router.navigate(["/teacher-statistics",n])}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(Re),Q(It))};static \u0275cmp=Se({type:e,selectors:[["app-teacher-dashboard"]],standalone:!0,features:[Me],decls:57,vars:10,consts:[["noActiveExams",""],["noDraftExams",""],["noPublishedExams",""],[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["href","/teacher-dashboard",1,"active"],["href","/teacher-history"],["href","/teacher-library"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","/settings"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"content"],[2,"display","flex","justify-content","flex-end"],[1,"create-button",3,"click"],[1,"fas","fa-plus"],[1,"section"],[4,"ngIf","ngIfElse"],["class","exam-item",4,"ngFor","ngForOf"],[1,"exam-item"],[1,"exam-actions"],[3,"click"],[1,"empty-state"],["src","../../assets/img/pic01.png","alt","No Active Exams","height","100","width","100"],["src","../../assets/img/pic02.png","alt","No Draft Exams","height","100","width","100"],["src","../../assets/img/pic03.png","alt","No Published Exams","height","100","width","100"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",3)(1,"div",4),N(2,"img",5),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",6)(6,"a",7),f(7,"B\xE0i ki\u1EC3m tra"),u(),l(8,"a",8),f(9,"L\u1ECBch s\u1EED b\xE0i ki\u1EC3m tra"),u(),l(10,"a",9),f(11,"Th\u01B0 vi\u1EC7n c\xE2u h\u1ECFi"),u()(),l(12,"div",10),N(13,"i",11)(14,"i",12),l(15,"img",13),H("click",function(){return U(i),j(r.toggleDropdown())}),u(),l(16,"div",14)(17,"div",15),N(18,"img",16),l(19,"div",17)(20,"div",18),f(21),u(),l(22,"div",19),f(23),u()()(),l(24,"div",20)(25,"a",21),N(26,"i",22),f(27," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(28,"a",23),N(29,"i",24),f(30," C\xE0i \u0111\u1EB7t chung"),u(),l(31,"a",25),H("click",function(){return U(i),j(r.logout())}),N(32,"i",26),f(33," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(34,"div",27)(35,"div",28)(36,"button",29),H("click",function(){return U(i),j(r.navigateToCreateExam())}),f(37,"T\u1EA1o b\xE0i thi m\u1EDBi "),N(38,"i",30),u()(),l(39,"div",31)(40,"h2"),f(41,"\u0110ang di\u1EC5n ra"),u(),G(42,BP,2,1,"div",32)(43,LP,4,0,"ng-template",null,0,nr),u(),l(45,"div",31)(46,"h2"),f(47,"\u0110ang so\u1EA1n"),u(),G(48,UP,2,1,"div",32)(49,jP,4,0,"ng-template",null,1,nr),u(),l(51,"div",31)(52,"h2"),f(53,"C\xE1c b\xE0i ki\u1EC3m tra \u0111\xE3 \u0111\u0103ng"),u(),G(54,$P,2,1,"div",32)(55,qP,4,0,"ng-template",null,2,nr),u()()}if(t&2){let i=Nt(44),o=Nt(50),s=Nt(56);m(16),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(19),O("ngIf",r.activeExams.length>0)("ngIfElse",i),m(6),O("ngIf",r.draftExams.length>0)("ngIfElse",o),m(6),O("ngIf",r.publishedExams.length>0)("ngIfElse",s)}},dependencies:[Ue,lt,We,pr,He],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5}.nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500;transition:color .4s ease,transform .3s ease}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff;transform:scale(1.1)}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 4px 10px #0003}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000;animation:_ngcontent-%COMP%_slideDown .4s ease-out}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:12px;color:#666}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .view-profile[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:5px 10px;border-radius:5px;text-align:center;text-decoration:none;font-size:12px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:10px 15px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px;transition:color .4s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{background-color:#fff;padding:20px;margin-bottom:20px;border-radius:5px;box-shadow:0 2px 5px #0000001a;transition:transform .3s ease,box-shadow .4s ease}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 4px 12px #0003}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;font-size:18px;font-weight:500}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;color:#666;animation:_ngcontent-%COMP%_fadeIn .6s ease-in-out}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;margin-bottom:10px}.notification-badge[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;background-color:#f44;color:#fff;border-radius:50%;padding:5px;font-size:14px;font-weight:700;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:.9}50%{transform:scale(1.2);opacity:1}to{transform:scale(1);opacity:.9}}.exam-item[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e0e0e0;border-radius:6px;padding:15px;margin-bottom:15px;transition:transform .2s ease,box-shadow .3s ease}.exam-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.exam-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333}.exam-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#666}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 15px;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .2s ease,transform .2s ease}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.1)}.create-button[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:16px;display:flex;align-items:center;margin-left:20px;margin-bottom:20px;transition:background-color .3s ease,transform .2s ease}.create-button[_ngcontent-%COMP%]:hover{background-color:#283593;transform:scale(1.1)}.create-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;padding:10px}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{margin:10px 0;width:100%;justify-content:space-around}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 5px;font-size:14px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.content[_ngcontent-%COMP%]{padding:10px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:15px}}button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;background-color:#007bff;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 6px #0000001a;font-weight:600}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px);box-shadow:0 6px 12px #0003}button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 2px 5px #0003}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px;font-size:18px}button[_ngcontent-%COMP%]:focus{outline:none}button.secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}button.secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}button.success[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}button.success[_ngcontent-%COMP%]:hover{background-color:#218838}button.danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}button.danger[_ngcontent-%COMP%]:hover{background-color:#c82333}button.info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}button.info[_ngcontent-%COMP%]:hover{background-color:#138496}']})};var vr=class e{constructor(n,t){this.http=n;this.authService=t}apiUrl="http://localhost:3000/questions";handleError(n){return console.error("Server Error:",n),vn(()=>new Error("Something went wrong with the API"))}getAuthHeaders(){let n=this.authService.getToken(),t=new Bt;return n&&(t=t.set("Authorization",`Bearer ${n}`)),t}getQuestions(){let n=this.getAuthHeaders();return this.http.get(this.apiUrl,{headers:n}).pipe(Et(this.handleError))}getQuestionById(n){let t=this.getAuthHeaders();return this.http.get(`${this.apiUrl}/${n}`,{headers:t}).pipe(Et(this.handleError))}addQuestion(n){let t=this.getAuthHeaders();return this.http.post(this.apiUrl,n,{headers:t}).pipe(Et(this.handleError))}updateQuestion(n){let t=this.getAuthHeaders();return this.http.put(`${this.apiUrl}/${n._id}`,n,{headers:t}).pipe(Et(this.handleError))}deleteQuestion(n){let t=this.getAuthHeaders();return this.http.delete(`${this.apiUrl}/${n}`,{headers:t}).pipe(Et(this.handleError))}updateQuestionStatus(n,t){let r=this.getAuthHeaders();return this.http.patch(`${this.apiUrl}/${n}`,{status:t},{headers:r}).pipe(Et(this.handleError))}bulkAddQuestions(n){return this.http.post("http://localhost:3000/questions/bulk-upload",n)}checkIfQuestionExists(n){let t=this.getAuthHeaders();return this.http.post(`${this.apiUrl}/check-existence`,n,{headers:t}).pipe(Et(this.handleError))}uploadAudioFile(n){let t=this.getAuthHeaders();return this.http.post("http://localhost:3000/upload-audio",n,{headers:t}).pipe(Et(this.handleError))}static \u0275fac=function(t){return new(t||e)(ke(Ki),ke(ze))};static \u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})};function WP(e,n){if(e&1){let t=ve();l(0,"div",13)(1,"div",14)(2,"label",15),f(3,"T\xEAn b\xE0i thi"),u(),l(4,"input",16),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.name,i)||(o.exam.name=i),j(i)}),u()(),l(5,"div",14)(6,"label",17),f(7,"M\xF4 t\u1EA3"),u(),l(8,"textarea",18),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.description,i)||(o.exam.description=i),j(i)}),u()(),l(9,"div",14)(10,"label",19),f(11,"Ng\xE0y b\u1EAFt \u0111\u1EA7u"),u(),l(12,"input",20),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.startDate,i)||(o.exam.startDate=i),j(i)}),u()(),l(13,"div",14)(14,"label",21),f(15,"Ng\xE0y k\u1EBFt th\xFAc"),u(),l(16,"input",22),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.endDate,i)||(o.exam.endDate=i),j(i)}),u()(),l(17,"div",14)(18,"label",23),f(19,"S\u1ED1 l\u1EA7n thi t\u1ED1i \u0111a"),u(),l(20,"input",24),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.maxAttempts,i)||(o.exam.maxAttempts=i),j(i)}),u()(),l(21,"div",14)(22,"label",25),f(23,"Th\u1EDDi gian l\xE0m b\xE0i (ph\xFAt)"),u(),l(24,"input",26),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.duration,i)||(o.exam.duration=i),j(i)}),u()()()}if(e&2){let t=D();m(4),me("ngModel",t.exam.name),m(4),me("ngModel",t.exam.description),m(4),me("ngModel",t.exam.startDate),m(4),me("ngModel",t.exam.endDate),m(4),me("ngModel",t.exam.maxAttempts),m(4),me("ngModel",t.exam.duration)}}function zP(e,n){e&1&&N(0,"div",45)}function GP(e,n){if(e&1){let t=ve();l(0,"div",13)(1,"div",27)(2,"div",14)(3,"label",28),f(4,"\u0110i\u1EC3m t\u1ED1i \u0111a cho b\xE0i ki\u1EC3m tra"),u(),l(5,"input",29),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.maxScore,i)||(o.exam.maxScore=i),j(i)}),u(),G(6,zP,1,0,"div",30),u(),l(7,"div",31)(8,"label")(9,"span",32),f(10,"H\u1EC7 th\u1ED1ng s\u1EBD t\u1EF1 \u0111\u1ED9ng chia \u0111i\u1EC3m b\xE0i thi"),u(),l(11,"input",33),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.autoDistributeScore,i)||(o.exam.autoDistributeScore=i),j(i)}),u()()(),l(12,"div",31)(13,"label")(14,"span",32),f(15,"Cho ph\xE9p hi\u1EC3n th\u1ECB b\xE0i l\xE0m c\u1EE7a h\u1ECDc vi\xEAn"),u(),l(16,"input",34),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.showStudentResult,i)||(o.exam.showStudentResult=i),j(i)}),u()()(),l(17,"div",14)(18,"label",35),f(19,"K\u1EBFt qu\u1EA3 s\u1EBD hi\u1EC3n th\u1ECB"),u(),l(20,"select",36),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.displayResults,i)||(o.exam.displayResults=i),j(i)}),l(21,"option",37),f(22,"Sau khi gi\xE1o vi\xEAn ch\u1EA5m b\xE0i"),u(),l(23,"option",38),f(24,"Sau khi n\u1ED9p b\xE0i"),u()()(),l(25,"div",14)(26,"label",39),f(27,"S\u1ED1 th\u1EE9 t\u1EF1 c\xE2u h\u1ECFi"),u(),l(28,"select",40),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.questionOrder,i)||(o.exam.questionOrder=i),j(i)}),l(29,"option",41),f(30,"A, B, C..."),u(),l(31,"option",42),f(32,"1, 2, 3..."),u()()(),l(33,"div",14)(34,"label",43),f(35,"S\u1ED1 c\xE2u h\u1ECFi tr\xEAn trang l\xE0m b\xE0i"),u(),l(36,"input",44),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.questionsPerPage,i)||(o.exam.questionsPerPage=i),j(i)}),u()()()()}if(e&2){let t=D();m(5),me("ngModel",t.exam.maxScore),m(),O("ngIf",t.isMaxScoreError),m(5),me("ngModel",t.exam.autoDistributeScore),m(5),me("ngModel",t.exam.showStudentResult),m(4),me("ngModel",t.exam.displayResults),m(8),me("ngModel",t.exam.questionOrder),m(8),me("ngModel",t.exam.questionsPerPage)}}function QP(e,n){if(e&1&&(l(0,"option",61),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function XP(e,n){if(e&1&&(l(0,"option",61),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function YP(e,n){if(e&1&&(l(0,"option",61),f(1),u()),e&2){let t=n.$implicit;O("value",t._id),m(),te(" ",t.text," ")}}function KP(e,n){if(e&1&&(l(0,"div")(1,"p"),f(2,"Ch\u1ECDn c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng"),u(),l(3,"audio",72),N(4,"source",73),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(4),O("src",t.text,Qt)}}function ZP(e,n){if(e&1&&(l(0,"div",74),N(1,"input",75),l(2,"span"),f(3),u()()),e&2){let t=n.$implicit;m(),O("checked",t.isCorrect),m(),xt("correct-answer",t.isCorrect),m(),ae(t.text)}}function JP(e,n){if(e&1){let t=ve();l(0,"div",62)(1,"div",63)(2,"h4"),f(3),u(),l(4,"button",64),H("click",function(){let i=U(t).index,o=D(2).index,s=D();return j(s.removeQuestionFromSection(o,i))}),N(5,"i",65),u()(),l(6,"div",66),f(7),u(),G(8,KP,6,1,"div",67),l(9,"div",68),G(10,ZP,4,4,"div",69),u(),l(11,"div",70)(12,"label"),f(13,"\u0110i\u1EC3m:"),u(),l(14,"input",71),ge("ngModelChange",function(i){let o=U(t).$implicit;return xe(o.score,i)||(o.score=i),j(i)}),u()()()}if(e&2){let t=n.$implicit,r=n.index,i=D(2).index;m(3),te("C\xE2u h\u1ECFi ",r+1,""),m(4),ae(t.text),m(),O("ngIf",t.text&&t.text.startsWith("http")),m(2),O("ngForOf",t.answers),m(4),Bp("name","score",i,"",r,""),me("ngModel",t.score)}}function eF(e,n){if(e&1){let t=ve();l(0,"div",13)(1,"input",47),ge("ngModelChange",function(i){U(t);let o=D().$implicit;return xe(o.title,i)||(o.title=i),j(i)}),u(),l(2,"textarea",48),ge("ngModelChange",function(i){U(t);let o=D().$implicit;return xe(o.description,i)||(o.description=i),j(i)}),u(),l(3,"div",49)(4,"label",50),f(5,"Danh m\u1EE5c:"),u(),l(6,"select",51),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.selectedCategory,i)||(o.selectedCategory=i),j(i)}),H("ngModelChange",function(){U(t);let i=D(2);return j(i.onCategoryOrGroupChange())}),l(7,"option",52),f(8,"T\u1EA5t c\u1EA3"),u(),G(9,QP,2,2,"option",53),u(),l(10,"label",54),f(11,"Nh\xF3m:"),u(),l(12,"select",55),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.selectedGroup,i)||(o.selectedGroup=i),j(i)}),H("ngModelChange",function(){U(t);let i=D(2);return j(i.onCategoryOrGroupChange())}),l(13,"option",52),f(14,"T\u1EA5t c\u1EA3"),u(),G(15,XP,2,2,"option",53),u(),l(16,"div",56)(17,"button",57),H("click",function(){U(t);let i=D(2);return j(i.clearFilters())}),f(18,"X\xF3a b\u1ED9 l\u1ECDc"),u(),l(19,"button",57),H("click",function(){U(t);let i=D(2);return j(i.filterQuestions())}),f(20,"\xC1p d\u1EE5ng"),u()()(),l(21,"div",58)(22,"label"),f(23,"Ch\u1ECDn c\xE2u h\u1ECFi:"),u(),l(24,"select",null,0)(26,"option",52),f(27,"Ch\u1ECDn c\xE2u h\u1ECFi"),u(),G(28,YP,2,2,"option",53),u(),l(29,"button",11),H("click",function(){U(t);let i=Nt(25),o=D().index,s=D();return j(s.addQuestionToSection(o,i.value))}),f(30," Th\xEAm c\xE2u h\u1ECFi "),u()(),l(31,"div",59)(32,"p"),f(33),u()(),G(34,JP,15,8,"div",60),u()}if(e&2){let t=D(),r=t.$implicit,i=t.index,o=D();m(),fs("name","sectionTitle",i,""),me("ngModel",r.title),m(),fs("name","sectionDescription",i,""),me("ngModel",r.description),m(4),me("ngModel",o.selectedCategory),m(3),O("ngForOf",o.uniqueCategories),m(3),me("ngModel",o.selectedGroup),m(3),O("ngForOf",o.uniqueGroups),m(13),O("ngForOf",o.filteredQuestions),m(5),te("S\u1ED1 c\xE2u h\u1ECFi: ",r.questions.length,""),m(),O("ngForOf",r.questions)}}function tF(e,n){if(e&1){let t=ve();l(0,"div",46)(1,"div",6),H("click",function(){let i=U(t).index,o=D();return j(o.toggleSection("section"+i))}),N(2,"i",7),l(3,"h3"),f(4),u()(),G(5,eF,35,13,"div",8),u()}if(e&2){let t=n.index,r=D();m(2),O("ngClass",r.isSectionOpen["section"+t]?"fas fa-chevron-up":"fas fa-chevron-down"),m(2),te("Ph\u1EA7n ",t+1,""),m(),O("ngIf",r.isSectionOpen["section"+t])}}var Dd=class e{constructor(n,t,r,i){this.questionService=n;this.examService=t;this.authService=r;this.router=i}exam={name:"",description:"",startDate:"",endDate:"",maxAttempts:1,duration:30,maxScore:10,autoDistributeScore:!1,showStudentResult:!1,displayResults:"afterGrading",questionOrder:"A, B, C",questionsPerPage:1};sections=[];availableQuestions=[];filteredQuestions=[];teacherId;isMaxScoreError=!1;selectedCategory="";selectedGroup="";uniqueCategories=[];uniqueGroups=[];isSectionOpen={general:!0,advanced:!0};ngOnInit(){let n=this.authService.getCurrentUser();this.teacherId=n?._id,this.questionService.getQuestions().subscribe(t=>{this.availableQuestions=t,this.filteredQuestions=t,this.updateUniqueFilters()})}updateUniqueFilters(){this.uniqueCategories=[...new Set(this.availableQuestions.map(n=>n.category).filter(Boolean))],this.uniqueGroups=[...new Set(this.availableQuestions.map(n=>n.group).filter(Boolean))],console.log("Unique Categories:",this.uniqueCategories),console.log("Unique Groups:",this.uniqueGroups)}onSubmit(){console.log("Exam submitted:",this.exam),console.log("Sections:",this.sections)}addQuestionToSection(n,t){if(!t){alert("Vui l\xF2ng ch\u1ECDn m\u1ED9t c\xE2u h\u1ECFi \u0111\u1EC3 th\xEAm!");return}let r=this.availableQuestions.find(i=>i._id===t);if(r){if(this.sections[n]?.questions.some(s=>s._id===r._id)){alert("C\xE2u h\u1ECFi n\xE0y \u0111\xE3 \u0111\u01B0\u1EE3c th\xEAm v\xE0o ph\u1EA7n n\xE0y!");return}if(this.sections.some(s=>s.questions.some(a=>a._id===r._id))){alert("C\xE2u h\u1ECFi n\xE0y \u0111\xE3 \u0111\u01B0\u1EE3c th\xEAm v\xE0o m\u1ED9t ph\u1EA7n kh\xE1c!");return}this.sections[n]?.questions.push(qe(de({},r),{score:1})),this.filterQuestions()}else alert("Kh\xF4ng t\xECm th\u1EA5y c\xE2u h\u1ECFi!")}checkTotalScore(){let n=this.sections.reduce((t,r)=>{let i=r.questions.reduce((o,s)=>o+(s.score||0),0);return t+i},0);return n!==this.exam.maxScore?(alert(`T\u1ED5ng \u0111i\u1EC3m c\u1EE7a c\xE1c c\xE2u h\u1ECFi (${n}) kh\xF4ng kh\u1EDBp v\u1EDBi \u0111i\u1EC3m t\u1ED1i \u0111a c\u1EE7a b\xE0i thi (${this.exam.maxScore})!`),!1):!0}saveExam(){if(!this.checkTotalScore())return;let n=qe(de({},this.exam),{createdBy:this.teacherId,sections:this.sections.map(t=>qe(de({},t),{questions:t.questions.map(r=>({questionId:r._id,score:r.score}))}))});console.log("Exam data being sent:",n),this.examService.createExam(n).subscribe({next:t=>{console.log("Exam saved successfully:",t),alert("B\xE0i thi \u0111\xE3 \u0111\u01B0\u1EE3c l\u01B0u th\xE0nh c\xF4ng!"),window.history.back()},error:t=>{console.error("Error saving exam:",t),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi l\u01B0u b\xE0i thi. Vui l\xF2ng th\u1EED l\u1EA1i.")}})}toggleSection(n){this.isSectionOpen[n]=!this.isSectionOpen[n]}navigateBack(){window.history.back()}onCategoryOrGroupChange(){console.log("Category selected:",this.selectedCategory),console.log("Group selected:",this.selectedGroup),this.filterQuestions()}addSection(){this.sections.push({title:"",description:"",questions:[]})}removeQuestionFromSection(n,t){confirm("B\u1EA1n c\xF3 ch\u1EAFc mu\u1ED1n x\xF3a c\xE2u h\u1ECFi n\xE0y?")&&this.sections[n].questions.splice(t,1)}filterQuestions(){console.log("Filtered Questions before filtering:",this.filteredQuestions),this.filteredQuestions=this.availableQuestions.filter(n=>{let t=this.selectedCategory?n.category===this.selectedCategory:!0,r=this.selectedGroup?n.group===this.selectedGroup:!0,i=n.status==="approved",o=this.sections.some(s=>s.questions.some(a=>a._id===n._id));return t&&r&&i&&!o}),console.log("Filtered Questions after filtering:",this.filteredQuestions)}clearFilters(){this.selectedCategory="",this.selectedGroup="",this.filteredQuestions=this.availableQuestions}static \u0275fac=function(t){return new(t||e)(Q(vr),Q(It),Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-exam-create"]],standalone:!0,features:[Me],decls:27,vars:5,consts:[["questionSelect",""],[1,"exam-create-container"],[1,"header"],[1,"back-button",3,"click"],[1,"fas","fa-arrow-left"],[3,"ngSubmit"],[1,"section-header",3,"click"],[3,"ngClass"],["class","section-content",4,"ngIf"],["class","section-container",4,"ngFor","ngForOf"],[1,"actions"],["type","button",3,"click"],["type","submit",1,"create-button",3,"click"],[1,"section-content"],[1,"form-group"],["for","examName"],["type","text","id","examName","name","examName","required","",3,"ngModelChange","ngModel"],["for","description"],["id","description","name","description",3,"ngModelChange","ngModel"],["for","startDate"],["type","datetime-local","id","startDate","name","startDate","required","",3,"ngModelChange","ngModel"],["for","endDate"],["type","datetime-local","id","endDate","name","endDate","required","",3,"ngModelChange","ngModel"],["for","maxAttempts"],["type","number","id","maxAttempts","name","maxAttempts","min","1",3,"ngModelChange","ngModel"],["for","duration"],["type","number","id","duration","name","duration","min","1","required","",3,"ngModelChange","ngModel"],[1,"advanced-settings"],["for","maxScore"],["type","number","id","maxScore","name","maxScore","min","0","required","",3,"ngModelChange","ngModel"],["class","error-message",4,"ngIf"],[1,"form-group","checkbox-group"],[1,"checkbox-label"],["type","checkbox","name","autoDistributeScore",3,"ngModelChange","ngModel"],["type","checkbox","name","showStudentResult",3,"ngModelChange","ngModel"],["for","displayResults"],["id","displayResults","name","displayResults",3,"ngModelChange","ngModel"],["value","afterGrading"],["value","afterSubmission"],["for","questionOrder"],["id","questionOrder","name","questionOrder",3,"ngModelChange","ngModel"],["value","A, B, C"],["value","1, 2, 3"],["for","questionsPerPage"],["type","number","id","questionsPerPage","name","questionsPerPage","min","1",3,"ngModelChange","ngModel"],[1,"error-message"],[1,"section-container"],["type","text","placeholder","Nh\u1EADp ti\xEAu \u0111\u1EC1 ph\u1EA7n",3,"ngModelChange","ngModel","name"],["placeholder","Nh\u1EADp m\xF4 t\u1EA3",3,"ngModelChange","ngModel","name"],[1,"filter-controls"],["for","category"],["name","category",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","group"],["name","group",3,"ngModelChange","ngModel"],[1,"filter-actions"],[3,"click"],[1,"question-selection"],[1,"number-of-questions"],["class","question-container",4,"ngFor","ngForOf"],[3,"value"],[1,"question-container"],[1,"question-header"],["type","button",1,"remove-question",3,"click"],[1,"fas","fa-times"],[1,"question-text"],[4,"ngIf"],[1,"answers-list"],["class","answer-item",4,"ngFor","ngForOf"],[1,"score-container"],["type","number","min","1",3,"ngModelChange","ngModel","name"],["controls",""],["type","audio/mpeg",3,"src"],[1,"answer-item"],["type","radio","disabled","",3,"checked"]],template:function(t,r){t&1&&(l(0,"div",1)(1,"div",2)(2,"h1"),f(3,"T\u1EA1o b\xE0i thi m\u1EDBi"),u(),l(4,"button",3),H("click",function(){return r.navigateBack()}),N(5,"i",4),f(6," Quay l\u1EA1i"),u()(),l(7,"form",5),H("ngSubmit",function(){return r.onSubmit()}),l(8,"div",6),H("click",function(){return r.toggleSection("general")}),N(9,"i",7),l(10,"h2"),f(11,"Th\xF4ng tin chung c\u1EE7a b\xE0i thi"),u()(),G(12,WP,25,6,"div",8),l(13,"div",6),H("click",function(){return r.toggleSection("advanced")}),N(14,"i",7),l(15,"h2"),f(16,"C\xE0i \u0111\u1EB7t n\xE2ng cao"),u()(),G(17,GP,37,7,"div",8),l(18,"h2"),f(19,"Th\xEAm c\xE2u h\u1ECFi"),u(),G(20,tF,6,3,"div",9),l(21,"div",10)(22,"button",11),H("click",function(){return r.addSection()}),f(23,"+ Th\xEAm ph\u1EA7n"),u()(),l(24,"div",10)(25,"button",12),H("click",function(){return r.saveExam()}),f(26,"T\u1EA1o b\xE0i thi"),u()()()()),t&2&&(m(9),O("ngClass",r.isSectionOpen.general?"fas fa-chevron-up":"fas fa-chevron-down"),m(3),O("ngIf",r.isSectionOpen.general),m(2),O("ngClass",r.isSectionOpen.advanced?"fas fa-chevron-up":"fas fa-chevron-down"),m(3),O("ngIf",r.isSectionOpen.advanced),m(3),O("ngForOf",r.sections))},dependencies:[Ue,hr,lt,We,He,Mn,gr,xr,jt,Zc,Yc,jn,Ot,Sn,_n,Jc,Vt,Pn],styles:['@charset "UTF-8";.exam-create-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px;background-color:#fff;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 4px 8px #0000001a}.header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px}.back-button[_ngcontent-%COMP%]{background:none;border:none;color:#4a3aff;cursor:pointer;font-size:16px;display:flex;align-items:center;padding:5px}.back-button[_ngcontent-%COMP%]:hover{color:#372f9e}h1[_ngcontent-%COMP%]{font-size:24px;color:#333}.section-header[_ngcontent-%COMP%]{cursor:pointer;display:flex;align-items:center;justify-content:space-between;padding:15px;background-color:#f8f9fa;border:1px solid #e0e0e0;border-radius:6px;margin-top:15px}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px;margin:0}.section-content[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #e0e0e0;border-radius:6px;padding:20px;margin-top:5px}.section-content[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:15px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:500;margin-bottom:8px;color:#333}input[type=text][_ngcontent-%COMP%], input[type=number][_ngcontent-%COMP%], input[type=datetime-local][_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;box-sizing:border-box}textarea[_ngcontent-%COMP%]{min-height:100px;resize:vertical}.checkbox-group[_ngcontent-%COMP%]{display:flex;align-items:right;gap:10px}.checkbox-label[_ngcontent-%COMP%]{font-size:14px;color:#333}.question-selection[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:10px}.question-selection[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:auto;min-width:150px;padding:5px;font-size:14px}button[_ngcontent-%COMP%]{padding:5px 15px;background-color:#4a3aff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px}.number-of-questions[_ngcontent-%COMP%]{margin-top:20px;text-align:center;font-size:16px;white-space:nowrap}.number-of-questions[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .number-of-questions[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.question-add-controls[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:5px}.question-container[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e0e0e0;border-radius:6px;padding:10px;margin:15px 0}.question-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:16px;margin:0;color:#333}.remove-question[_ngcontent-%COMP%]{background:none;border:none;color:#f44;cursor:pointer}.remove-question[_ngcontent-%COMP%]:hover{color:#c00}.answers-list[_ngcontent-%COMP%]{margin-top:10px}.answer-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px;background:#fff;border:1px solid #e0e0e0;border-radius:4px;margin-bottom:5px}.score-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;margin-top:10px}.actions[_ngcontent-%COMP%]{margin-top:20px}.question-selection[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.question-selection[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;color:#333;margin-right:10px}.question-selection[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:430px;padding:5px;font-size:16px;border:1px solid #ddd;border-radius:4px;height:35px}.question-selection[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{position:relative;top:-14px;padding:5px 15px;background-color:#4a3aff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:16px;height:40px}.question-selection[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#372f9e}button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#4a3aff;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:14px;margin:20px 10px 0}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;margin-top:20px}button[_ngcontent-%COMP%]:hover{background-color:#372f9e}.create-button[_ngcontent-%COMP%]{background-color:#28a745}.create-button[_ngcontent-%COMP%]:hover{background-color:#218838}']})};function nF(e,n){e&1&&(l(0,"div")(1,"p"),f(2,"\u0110ang t\u1EA3i th\xF4ng tin b\xE0i thi..."),u()())}function rF(e,n){if(e&1&&(cn(0),l(1,"p"),f(2,"Ch\u1ECDn c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng:"),u(),l(3,"audio",9),N(4,"source",10),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u(),un()),e&2){let t=D().$implicit;m(4),O("src",t.questionId==null?null:t.questionId.text,Qt)}}function iF(e,n){if(e&1&&(cn(0),f(1),un()),e&2){let t=D().$implicit;m(),te(" ",(t.questionId==null?null:t.questionId.text)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u c\xE2u h\u1ECFi"," ")}}function oF(e,n){e&1&&(l(0,"span"),f(1,"(\u0110\xE1p \xE1n \u0111\xFAng)"),u())}function sF(e,n){if(e&1&&(l(0,"li"),f(1),G(2,oF,2,0,"span",2),u()),e&2){let t=n.$implicit;m(),te(" ",t.text," "),m(),O("ngIf",t.isCorrect)}}function aF(e,n){if(e&1&&(l(0,"div")(1,"p")(2,"strong"),f(3,"C\xE1c \u0111\xE1p \xE1n:"),u()(),l(4,"ul"),G(5,sF,3,2,"li",8),u()()),e&2){let t=D().$implicit;m(5),O("ngForOf",t.questionId.answers)}}function cF(e,n){if(e&1&&(l(0,"li")(1,"p")(2,"strong"),f(3),u(),G(4,rF,6,1,"ng-container",2)(5,iF,2,1,"ng-container",2),u(),l(6,"p")(7,"strong"),f(8,"\u0110i\u1EC3m cho c\xE2u h\u1ECFi:"),u(),f(9),u(),G(10,aF,6,1,"div",2),u()),e&2){let t=n.$implicit,r=n.index;m(3),te("C\xE2u h\u1ECFi ",r+1,":"),m(),O("ngIf",t.questionId==null||t.questionId.text==null?null:t.questionId.text.includes("http")),m(),O("ngIf",!(!(t.questionId==null||t.questionId.text==null)&&t.questionId.text.includes("http"))),m(4),te(" ",t.score," \u0111i\u1EC3m"),m(),O("ngIf",t.questionId==null?null:t.questionId.answers)}}function uF(e,n){if(e&1&&(l(0,"div")(1,"ul"),G(2,cF,11,5,"li",8),u()()),e&2){let t=D().$implicit;m(2),O("ngForOf",t.questions)}}function lF(e,n){if(e&1&&(l(0,"div",7)(1,"h4"),f(2),u(),G(3,uF,3,1,"div",2),u()),e&2){let t=n.$implicit,r=n.index;m(2),Wt("Ph\u1EA7n ",r+1,": ",t.title,""),m(),O("ngIf",t.questions&&t.questions.length>0)}}function dF(e,n){if(e&1&&(l(0,"div")(1,"h3"),f(2,"C\xE1c ph\u1EA7n thi:"),u(),G(3,lF,4,3,"div",6),u()),e&2){let t=D(2);m(3),O("ngForOf",t.exam.sections)}}function fF(e,n){e&1&&(l(0,"div")(1,"p"),f(2,"Kh\xF4ng c\xF3 ph\u1EA7n thi n\xE0o trong b\xE0i thi n\xE0y."),u()())}function hF(e,n){if(e&1){let t=ve();l(0,"div",4)(1,"h2"),f(2),u(),l(3,"p")(4,"strong"),f(5,"M\xF4 t\u1EA3:"),u(),f(6),u(),l(7,"p")(8,"strong"),f(9,"Th\u1EDDi gian b\u1EAFt \u0111\u1EA7u:"),u(),f(10),zt(11,"date"),u(),l(12,"p")(13,"strong"),f(14,"Th\u1EDDi gian k\u1EBFt th\xFAc:"),u(),f(15),zt(16,"date"),u(),l(17,"p")(18,"strong"),f(19,"Th\u1EDDi l\u01B0\u1EE3ng:"),u(),f(20),u(),l(21,"p")(22,"strong"),f(23,"\u0110i\u1EC3m t\u1ED1i \u0111a:"),u(),f(24),u(),l(25,"p")(26,"strong"),f(27,"S\u1ED1 l\u1EA7n l\xE0m b\xE0i t\u1ED1i \u0111a:"),u(),f(28),u(),l(29,"p")(30,"strong"),f(31,"T\u1EF1 \u0111\u1ED9ng ph\xE2n ph\u1ED1i \u0111i\u1EC3m:"),u(),f(32),u(),l(33,"p")(34,"strong"),f(35,"Hi\u1EC3n th\u1ECB k\u1EBFt qu\u1EA3 cho h\u1ECDc sinh:"),u(),f(36),u(),l(37,"p")(38,"strong"),f(39,"Ch\u1EBF \u0111\u1ED9 hi\u1EC3n th\u1ECB k\u1EBFt qu\u1EA3:"),u(),f(40),u(),l(41,"p")(42,"strong"),f(43,"Th\u1EE9 t\u1EF1 c\xE2u h\u1ECFi:"),u(),f(44),u(),l(45,"p")(46,"strong"),f(47,"S\u1ED1 c\xE2u h\u1ECFi tr\xEAn m\u1ED7i trang:"),u(),f(48),u(),G(49,dF,4,1,"div",2)(50,fF,3,0,"div",2),l(51,"button",5),H("click",function(){U(t);let i=D();return j(i.goBack())}),f(52,"Quay l\u1EA1i"),u()()}if(e&2){let t=D();m(2),te("Chi ti\u1EBFt b\xE0i thi: ",t.exam.name,""),m(4),te(" ",t.exam.description,""),m(4),te(" ",tr(11,14,t.exam.startDate),""),m(5),te(" ",tr(16,16,t.exam.endDate),""),m(5),te(" ",t.exam.duration," ph\xFAt"),m(4),te(" ",t.exam.maxScore,""),m(4),te(" ",t.exam.maxAttempts,""),m(4),te(" ",t.exam.autoDistributeScore?"C\xF3":"Kh\xF4ng",""),m(4),te(" ",t.exam.showStudentResult?"C\xF3":"Kh\xF4ng",""),m(4),te(" ",t.exam.displayResults,""),m(4),te(" ",t.exam.questionOrder,""),m(4),te(" ",t.exam.questionsPerPage,""),m(),O("ngIf",t.exam.sections&&t.exam.sections.length>0),m(),O("ngIf",!t.exam.sections||t.exam.sections.length===0)}}function pF(e,n){e&1&&(l(0,"p"),f(1,"B\xE0i thi kh\xF4ng t\u1ED3n t\u1EA1i ho\u1EB7c kh\xF4ng th\u1EC3 t\xECm th\u1EA5y th\xF4ng tin chi ti\u1EBFt."),u())}var Sd=class e{constructor(n,t,r){this.route=n;this.examService=t;this.questionService=r}examId=null;exam=null;sections=[];isLoading=!0;ngOnInit(){this.route.paramMap.subscribe(n=>{this.examId=n.get("id"),this.examId&&this.loadExamDetails(this.examId)})}loadExamDetails(n){this.examService.getExamById(n).subscribe({next:t=>{console.log("Loaded exam in component:",t),this.exam=t,this.sections=t.sections,this.isLoading=!1},error:t=>{console.error("Error fetching exam details:",t),this.isLoading=!1}})}loadQuestionsForSections(n){let t=[],r=new Map;n.forEach((i,o)=>{i.questions.forEach((s,a)=>{let c=s.questionId;c&&(t.push(this.questionService.getQuestionById(c.trim())),r.set(c,{sectionIndex:o,questionIndex:a}))})}),Ja(t).subscribe({next:i=>{console.log("Loaded questions:",i),this.sections=n.map(o=>qe(de({},o),{questions:o.questions.map(s=>qe(de({},s),{questionData:void 0}))})),i.forEach(o=>{let s=o._id;if(s&&r.has(s)){let a=r.get(s);a&&(this.sections[a.sectionIndex].questions[a.questionIndex].questionData=o)}}),console.log("Processed sections with questions:",this.sections),this.isLoading=!1},error:i=>{console.error("Error fetching questions:",i.message),console.error("Error status code:",i.status),console.error("Full error details:",i),this.isLoading=!1}})}goBack(){window.history.back()}static \u0275fac=function(t){return new(t||e)(Q(dn),Q(It),Q(vr))};static \u0275cmp=Se({type:e,selectors:[["app-exam-details"]],standalone:!0,features:[Me],decls:5,vars:3,consts:[["noExamFound",""],[1,"centered-container"],[4,"ngIf"],["class","centered-content",4,"ngIf","ngIfElse"],[1,"centered-content"],[3,"click"],["class","section-item",4,"ngFor","ngForOf"],[1,"section-item"],[4,"ngFor","ngForOf"],["controls",""],["type","audio/mpeg",3,"src"]],template:function(t,r){if(t&1&&(l(0,"div",1),G(1,nF,3,0,"div",2)(2,hF,53,18,"div",3)(3,pF,2,0,"ng-template",null,0,nr),u()),t&2){let i=Nt(4);m(),O("ngIf",r.isLoading),m(),O("ngIf",!r.isLoading&&r.exam)("ngIfElse",i)}},dependencies:[Ue,lt,We,pr],styles:[".centered-container[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;padding:20px;display:flex;flex-direction:column;align-items:center}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;width:100%}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8em;font-weight:700;color:#333}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{padding:8px 16px;background-color:#6c757d;color:#fff;border:none;border-radius:4px;font-size:1em;cursor:pointer;transition:background-color .3s ease}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}.header[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background-color:#5a6268}.section-item[_ngcontent-%COMP%]{border:1px solid #e0e0e0;padding:20px;margin:15px 0;border-radius:8px;background-color:#fff;box-shadow:0 4px 8px #0000001a;transition:all .3s ease;width:100%;text-align:left}.section-item[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 8px 16px #00000026}.question-details[_ngcontent-%COMP%]{margin:15px 0;padding:15px;background-color:#f8f9fa;border:1px solid #e9ecef;border-radius:6px;box-shadow:0 2px 4px #0000000d}.question-content[_ngcontent-%COMP%]{margin-top:10px;font-size:1em;color:#333}.answers-list[_ngcontent-%COMP%]{margin-top:10px;padding-left:20px}.correct-answer[_ngcontent-%COMP%]{color:#218838;font-weight:700}.correct-badge[_ngcontent-%COMP%]{background-color:#28a745;color:#fff;padding:3px 7px;border-radius:4px;font-size:.85em;margin-left:8px}button[_ngcontent-%COMP%]{margin-top:20px;padding:10px 20px;background-color:#007bff;color:#fff;border:none;border-radius:4px;font-weight:500;font-size:1em;cursor:pointer;transition:background-color .3s ease;box-shadow:0 4px 8px #007bff26}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;box-shadow:0 6px 12px #007bff33}.centered-content[_ngcontent-%COMP%]{width:100%;text-align:left}"]})};function mF(e,n){e&1&&(l(0,"div")(1,"p"),f(2,"\u0110ang t\u1EA3i th\xF4ng tin b\xE0i thi..."),u()())}function gF(e,n){if(e&1&&(l(0,"option",51),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function xF(e,n){if(e&1&&(l(0,"option",51),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function EF(e,n){if(e&1&&(l(0,"option",51),f(1),u()),e&2){let t=n.$implicit;O("value",t._id),m(),te(" ",t.text," ")}}function vF(e,n){if(e&1&&(cn(0),l(1,"p"),f(2,"Ch\u1ECDn c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng:"),u(),l(3,"audio",55),N(4,"source",56),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u(),un()),e&2){let t=D().$implicit;m(4),O("src",(t.questionId==null?null:t.questionId.text)||(t.questionData==null?null:t.questionData.text),Qt)}}function _F(e,n){if(e&1&&(cn(0),f(1),un()),e&2){let t=D().$implicit;m(),te(" ",(t.questionId==null?null:t.questionId.text)||(t.questionData==null?null:t.questionData.text)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u c\xE2u h\u1ECFi"," ")}}function CF(e,n){e&1&&(l(0,"span"),f(1,"(\u0110\xE1p \xE1n \u0111\xFAng)"),u())}function yF(e,n){if(e&1&&(l(0,"li"),f(1),G(2,CF,2,0,"span",3),u()),e&2){let t=n.$implicit;m(),te(" ",t.text," "),m(),O("ngIf",t.isCorrect)}}function wF(e,n){if(e&1&&(l(0,"div")(1,"p")(2,"strong"),f(3,"C\xE1c \u0111\xE1p \xE1n:"),u()(),l(4,"ul"),G(5,yF,3,2,"li",52),u()()),e&2){let t=D().$implicit;m(5),O("ngForOf",(t.questionId==null?null:t.questionId.answers)||(t.questionData==null?null:t.questionData.answers))}}function bF(e,n){if(e&1){let t=ve();l(0,"li")(1,"p"),G(2,vF,6,1,"ng-container",3)(3,_F,2,1,"ng-container",3),u(),l(4,"p",53)(5,"strong"),f(6,"\u0110i\u1EC3m cho c\xE2u h\u1ECFi:"),u(),l(7,"input",54),ge("ngModelChange",function(i){let o=U(t).$implicit;return xe(o.score,i)||(o.score=i),j(i)}),u()(),G(8,wF,6,1,"div",3),l(9,"button",50),H("click",function(){let i=U(t).index,o=D(2).index,s=D(3);return j(s.removeQuestionFromSection(o,i))}),f(10," X\xF3a c\xE2u h\u1ECFi "),u()()}if(e&2){let t=n.$implicit;m(2),O("ngIf",(t.questionId==null||t.questionId.text==null?null:t.questionId.text.includes("http"))||(t.questionData==null||t.questionData.text==null?null:t.questionData.text.includes("http"))),m(),O("ngIf",!(!(t.questionId==null||t.questionId.text==null)&&t.questionId.text.includes("http")||!(t.questionData==null||t.questionData.text==null)&&t.questionData.text.includes("http"))),m(4),me("ngModel",t.score),m(),O("ngIf",(t.questionId==null?null:t.questionId.answers)||(t.questionData==null?null:t.questionData.answers))}}function DF(e,n){if(e&1&&(l(0,"div")(1,"ul"),G(2,bF,11,4,"li",52),u()()),e&2){let t=D().$implicit;m(2),O("ngForOf",t.questions)}}function SF(e,n){if(e&1){let t=ve();l(0,"div",39)(1,"h4"),f(2),u(),l(3,"div")(4,"div",40)(5,"div",41)(6,"label",42),f(7,"Danh m\u1EE5c:"),u(),l(8,"select",43),ge("ngModelChange",function(i){U(t);let o=D(3);return xe(o.selectedCategory,i)||(o.selectedCategory=i),j(i)}),H("ngModelChange",function(){U(t);let i=D(3);return j(i.onCategoryOrGroupChange())}),l(9,"option",44),f(10,"T\u1EA5t c\u1EA3"),u(),G(11,gF,2,2,"option",45),u(),l(12,"label",46),f(13,"Nh\xF3m:"),u(),l(14,"select",47),ge("ngModelChange",function(i){U(t);let o=D(3);return xe(o.selectedGroup,i)||(o.selectedGroup=i),j(i)}),H("ngModelChange",function(){U(t);let i=D(3);return j(i.onCategoryOrGroupChange())}),l(15,"option",44),f(16,"T\u1EA5t c\u1EA3"),u(),G(17,xF,2,2,"option",45),u(),l(18,"div",48)(19,"button",37),H("click",function(){U(t);let i=D(3);return j(i.clearFilters())}),f(20,"X\xF3a b\u1ED9 l\u1ECDc"),u(),l(21,"button",37),H("click",function(){U(t);let i=D(3);return j(i.filterQuestions())}),f(22,"\xC1p d\u1EE5ng"),u()()(),l(23,"div",49)(24,"label"),f(25,"Ch\u1ECDn c\xE2u h\u1ECFi:"),u(),l(26,"select",null,1)(28,"option",44),f(29,"Ch\u1ECDn c\xE2u h\u1ECFi"),u(),G(30,EF,2,2,"option",45),u(),l(31,"button",50),H("click",function(){U(t);let i=Nt(27),o=D(3);return j(o.addQuestionToSection(0,i.value))}),f(32,"Th\xEAm c\xE2u h\u1ECFi"),u()()()(),G(33,DF,3,1,"div",3),u()}if(e&2){let t=n.$implicit,r=n.index,i=D(3);m(2),Wt("Ph\u1EA7n ",r+1,": ",t.title,""),m(6),me("ngModel",i.selectedCategory),m(3),O("ngForOf",i.uniqueCategories),m(3),me("ngModel",i.selectedGroup),m(3),O("ngForOf",i.uniqueGroups),m(13),O("ngForOf",i.filteredQuestions),m(3),O("ngIf",t.questions&&t.questions.length>0)}}function MF(e,n){if(e&1&&(l(0,"div")(1,"h3"),f(2,"C\xE1c ph\u1EA7n thi:"),u(),G(3,SF,34,8,"div",38),u()),e&2){let t=D(2);m(3),O("ngForOf",t.exam.sections)}}function AF(e,n){e&1&&(l(0,"div")(1,"p"),f(2,"Kh\xF4ng c\xF3 ph\u1EA7n thi n\xE0o trong b\xE0i thi n\xE0y."),u()())}function TF(e,n){if(e&1){let t=ve();l(0,"div",5)(1,"h2"),f(2),u(),l(3,"div",6)(4,"div")(5,"label",7),f(6,"T\xEAn b\xE0i thi:"),u(),l(7,"input",8),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.name,i)||(o.exam.name=i),j(i)}),u()(),l(8,"div")(9,"label",9),f(10,"M\xF4 t\u1EA3:"),u(),l(11,"textarea",10),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.description,i)||(o.exam.description=i),j(i)}),u()(),l(12,"div")(13,"label",11),f(14,"Th\u1EDDi gian b\u1EAFt \u0111\u1EA7u:"),u(),l(15,"input",12),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.startDate,i)||(o.exam.startDate=i),j(i)}),u()(),l(16,"div")(17,"label",13),f(18,"Th\u1EDDi gian k\u1EBFt th\xFAc:"),u(),l(19,"input",14),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.endDate,i)||(o.exam.endDate=i),j(i)}),u()(),l(20,"div")(21,"label",15),f(22,"Th\u1EDDi l\u01B0\u1EE3ng:"),u(),l(23,"input",16),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.duration,i)||(o.exam.duration=i),j(i)}),u()(),l(24,"div")(25,"label",17),f(26,"\u0110i\u1EC3m t\u1ED1i \u0111a:"),u(),l(27,"input",18),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.maxScore,i)||(o.exam.maxScore=i),j(i)}),u()(),l(28,"div")(29,"label",19),f(30,"S\u1ED1 l\u1EA7n l\xE0m b\xE0i t\u1ED1i \u0111a:"),u(),l(31,"input",20),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.maxAttempts,i)||(o.exam.maxAttempts=i),j(i)}),u()(),l(32,"div")(33,"label",21),f(34,"T\u1EF1 \u0111\u1ED9ng ph\xE2n ph\u1ED1i \u0111i\u1EC3m:"),u(),l(35,"input",22),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.autoDistributeScore,i)||(o.exam.autoDistributeScore=i),j(i)}),u()(),l(36,"div")(37,"label",23),f(38,"Hi\u1EC3n th\u1ECB k\u1EBFt qu\u1EA3 cho h\u1ECDc sinh:"),u(),l(39,"input",24),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.showStudentResult,i)||(o.exam.showStudentResult=i),j(i)}),u()(),l(40,"div")(41,"label",25),f(42,"Ch\u1EBF \u0111\u1ED9 hi\u1EC3n th\u1ECB k\u1EBFt qu\u1EA3:"),u(),l(43,"select",26),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.displayResults,i)||(o.exam.displayResults=i),j(i)}),l(44,"option",27),f(45,"Sau khi gi\xE1o vi\xEAn ch\u1EA5m b\xE0i"),u(),l(46,"option",28),f(47,"Sau khi n\u1ED9p b\xE0i"),u()()(),l(48,"div")(49,"label",29),f(50,"Th\u1EE9 t\u1EF1 c\xE2u h\u1ECFi:"),u(),l(51,"select",30),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.questionOrder,i)||(o.exam.questionOrder=i),j(i)}),l(52,"option",31),f(53,"A, B, C..."),u(),l(54,"option",32),f(55,"1, 2, 3..."),u()()(),l(56,"div")(57,"label",33),f(58,"S\u1ED1 c\xE2u h\u1ECFi tr\xEAn m\u1ED7i trang:"),u(),l(59,"input",34),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.exam.questionsPerPage,i)||(o.exam.questionsPerPage=i),j(i)}),u()()(),G(60,MF,4,1,"div",3)(61,AF,3,0,"div",3),l(62,"div",35)(63,"button",36),H("click",function(){U(t);let i=D();return j(i.updateExam())}),f(64,"C\u1EADp nh\u1EADt b\xE0i thi"),u()(),l(65,"button",37),H("click",function(){U(t);let i=D();return j(i.goBack())}),f(66,"Quay l\u1EA1i"),u()()}if(e&2){let t=D();m(2),te("Chi ti\u1EBFt b\xE0i thi: ",t.exam.name,""),m(5),me("ngModel",t.exam.name),m(4),me("ngModel",t.exam.description),m(4),me("ngModel",t.exam.startDate),m(4),me("ngModel",t.exam.endDate),m(4),me("ngModel",t.exam.duration),m(4),me("ngModel",t.exam.maxScore),m(4),me("ngModel",t.exam.maxAttempts),m(4),me("ngModel",t.exam.autoDistributeScore),m(4),me("ngModel",t.exam.showStudentResult),m(4),me("ngModel",t.exam.displayResults),m(8),me("ngModel",t.exam.questionOrder),m(8),me("ngModel",t.exam.questionsPerPage),m(),O("ngIf",t.exam.sections&&t.exam.sections.length>0),m(),O("ngIf",!t.exam.sections||t.exam.sections.length===0)}}function OF(e,n){e&1&&(l(0,"p"),f(1,"B\xE0i thi kh\xF4ng t\u1ED3n t\u1EA1i ho\u1EB7c kh\xF4ng th\u1EC3 t\xECm th\u1EA5y th\xF4ng tin chi ti\u1EBFt."),u())}var Md=class e{constructor(n,t,r,i){this.route=n;this.examService=t;this.questionService=r;this.router=i}examId=null;exam=null;isLoading=!0;availableQuestions=[];filteredQuestions=[];teacherId;selectedCategory="";selectedGroup="";uniqueCategories=[];uniqueGroups=[];isSectionOpen={general:!0,advanced:!0};ngOnInit(){this.route.paramMap.subscribe(n=>{this.examId=n.get("id"),this.examId&&this.loadExamDetails(this.examId)}),this.loadAvailableQuestions()}loadAvailableQuestions(){this.questionService.getQuestions().subscribe({next:n=>{this.availableQuestions=n,this.updateUniqueFilters()},error:n=>{console.error("Error fetching available questions:",n)}})}updateUniqueFilters(){this.uniqueCategories=[...new Set(this.availableQuestions.map(n=>n.category).filter(Boolean))],this.uniqueGroups=[...new Set(this.availableQuestions.map(n=>n.group).filter(Boolean))],console.log("Unique Categories:",this.uniqueCategories),console.log("Unique Groups:",this.uniqueGroups)}onCategoryOrGroupChange(){console.log("Category selected:",this.selectedCategory),console.log("Group selected:",this.selectedGroup),this.filterQuestions()}filterQuestions(){console.log("Filtered Questions before filtering:",this.filteredQuestions),this.filteredQuestions=this.availableQuestions.filter(n=>{let t=this.selectedCategory?n.category===this.selectedCategory:!0,r=this.selectedGroup?n.group===this.selectedGroup:!0;return t&&r}),console.log("Filtered Questions after filtering:",this.filteredQuestions)}clearFilters(){this.selectedCategory="",this.selectedGroup="",this.filteredQuestions=this.availableQuestions}loadExamDetails(n){this.examService.getExamById(n).subscribe({next:t=>{this.exam=t,this.isLoading=!1,this.exam.sections.forEach((r,i)=>{this.isSectionOpen["section"+i]=!1})},error:t=>{console.error("Error fetching exam details:",t),this.isLoading=!1}})}updateExam(){this.exam&&this.examId?this.examService.updateExam(this.examId,this.exam).subscribe({next:n=>{console.log("Exam updated successfully:",n),alert("B\xE0i thi \u0111\xE3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt th\xE0nh c\xF4ng"),this.router.navigate(["/teacher-dashboard"])},error:n=>{console.error("Error updating exam:",n.message)}}):console.error("Exam or examId is not defined. Cannot update exam.")}removeQuestionFromSection(n,t){this.exam&&this.exam.sections[n]&&this.exam.sections[n].questions.splice(t,1)}addQuestionToSection(n,t){if(!t)return;let r=this.availableQuestions.find(i=>i._id===t);r&&(this.exam?.sections[n].questions.some(o=>o.questionId===r._id)?alert("C\xE2u h\u1ECFi n\xE0y \u0111\xE3 \u0111\u01B0\u1EE3c th\xEAm v\xE0o ph\u1EA7n n\xE0y!"):this.exam?.sections[n].questions.push({questionId:r._id,score:0,questionData:r}))}toggleSection(n){this.isSectionOpen[n]=!this.isSectionOpen[n]}goBack(){window.history.back()}static \u0275fac=function(t){return new(t||e)(Q(dn),Q(It),Q(vr),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-exam-edit"]],standalone:!0,features:[Me],decls:5,vars:3,consts:[["noExamFound",""],["questionSelect",""],[1,"centered-container"],[4,"ngIf"],["class","centered-content",4,"ngIf","ngIfElse"],[1,"centered-content"],[1,"exam-detail"],["for","examName"],["type","text","id","examName","name","examName","required","",3,"ngModelChange","ngModel"],["for","description"],["id","description","name","description",3,"ngModelChange","ngModel"],["for","startDate"],["type","datetime-local","id","startDate","name","startDate","required","",3,"ngModelChange","ngModel"],["for","endDate"],["type","datetime-local","id","endDate","name","endDate","required","",3,"ngModelChange","ngModel"],["for","duration"],["type","number","id","duration","name","duration","min","1","required","",3,"ngModelChange","ngModel"],["for","maxScore"],["type","number","id","maxScore","name","maxScore","min","0","required","",3,"ngModelChange","ngModel"],["for","maxAttempts"],["type","number","id","maxAttempts","name","maxAttempts","min","1",3,"ngModelChange","ngModel"],["for","autoDistributeScore"],["type","checkbox","name","autoDistributeScore",3,"ngModelChange","ngModel"],["for","showStudentResult"],["type","checkbox","name","showStudentResult",3,"ngModelChange","ngModel"],["for","displayResults"],["id","displayResults","name","displayResults",3,"ngModelChange","ngModel"],["value","afterGrading"],["value","afterSubmission"],["for","questionOrder"],["id","questionOrder","name","questionOrder",3,"ngModelChange","ngModel"],["value","A, B, C"],["value","1, 2, 3"],["for","questionsPerPage"],["type","number","id","questionsPerPage","name","questionsPerPage","min","1",3,"ngModelChange","ngModel"],[1,"actions"],["type","button",1,"update-button",3,"click"],[3,"click"],["class","section-item",4,"ngFor","ngForOf"],[1,"section-item"],[1,"form-group"],[1,"filter-controls"],["for","category"],["name","category",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","group"],["name","group",3,"ngModelChange","ngModel"],[1,"filter-actions"],[1,"question-selection"],["type","button",3,"click"],[3,"value"],[4,"ngFor","ngForOf"],[1,"score-input"],["type","number","min","0",3,"ngModelChange","ngModel"],["controls",""],["type","audio/mpeg",3,"src"]],template:function(t,r){if(t&1&&(l(0,"div",2),G(1,mF,3,0,"div",3)(2,TF,67,15,"div",4)(3,OF,2,0,"ng-template",null,0,nr),u()),t&2){let i=Nt(4);m(),O("ngIf",r.isLoading),m(),O("ngIf",!r.isLoading&&r.exam)("ngIfElse",i)}},dependencies:[Ue,lt,We,He,gr,xr,jt,Zc,Yc,jn,Ot,_n,Jc,Vt],styles:['@charset "UTF-8";.centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:5px;font-weight:700}.centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%], .centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%], .centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   input[type=datetime-local][_ngcontent-%COMP%], .centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:8px;margin-bottom:15px;border:1px solid #ccc;border-radius:4px}.centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:100px}.centered-container[_ngcontent-%COMP%]   .section-item[_ngcontent-%COMP%]{border:1px solid #ccc;padding:10px;margin-bottom:15px;border-radius:4px}.centered-container[_ngcontent-%COMP%]   .section-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#008cba;color:#fff;border:none;padding:10px 15px;text-align:center;text-decoration:none;display:inline-block;font-size:14px;margin:5px 2px;cursor:pointer;border-radius:4px;transition:background-color .3s}.centered-container[_ngcontent-%COMP%]   .section-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#007b9e}.centered-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.centered-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .update-button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:10px 15px;text-align:center;text-decoration:none;font-size:14px;cursor:pointer;border-radius:4px;transition:background-color .3s}.centered-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .update-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.centered-container[_ngcontent-%COMP%]{padding:20px}.centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]{margin-bottom:20px}.centered-container[_ngcontent-%COMP%]   .exam-detail[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{margin-bottom:15px}.centered-container[_ngcontent-%COMP%]   .section-item[_ngcontent-%COMP%]{border:1px solid #ccc;border-radius:5px;padding:15px;margin-bottom:20px;background-color:#f9f9f9}.centered-container[_ngcontent-%COMP%]   .section-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px}.centered-container[_ngcontent-%COMP%]   .section-item[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.centered-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#008cba;color:#fff;border:none;padding:10px 15px;text-align:center;text-decoration:none;display:inline-block;font-size:16px;margin:10px 2px;cursor:pointer;border-radius:5px;transition:background-color .3s}.centered-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#007b9e}.centered-container[_ngcontent-%COMP%]   button.update-button[_ngcontent-%COMP%]{background-color:#4caf50}.centered-container[_ngcontent-%COMP%]   button.remove-question[_ngcontent-%COMP%]{background-color:#f44336}.centered-container[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.centered-container[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px;border-radius:5px;border:1px solid #ccc;margin-right:10px}.centered-container[_ngcontent-%COMP%]   .score-input[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1rem}.centered-container[_ngcontent-%COMP%]   .score-input[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{margin-right:1rem;font-size:1rem;color:#333}.centered-container[_ngcontent-%COMP%]   .score-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]{width:80px;padding:5px;font-size:1rem;border:1px solid #ccc;border-radius:4px;box-shadow:inset 0 1px 3px #0000001a}.centered-container[_ngcontent-%COMP%]   .score-input[_ngcontent-%COMP%]   input[type=number][_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none;box-shadow:0 0 5px #007bff80}']})};var _y=(e,n)=>({"correct-answer":e,"incorrect-answer":n});function IF(e,n){if(e&1&&(l(0,"option",49),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function kF(e,n){if(e&1&&(l(0,"option",49),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function PF(e,n){if(e&1){let t=ve();l(0,"div",43)(1,"div",44)(2,"label"),f(3,"Danh m\u1EE5c:"),u(),l(4,"select",45),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.selectedCategory,i)||(o.selectedCategory=i),j(i)}),l(5,"option",46),f(6,"T\u1EA5t c\u1EA3"),u(),G(7,IF,2,2,"option",47),u()(),l(8,"div",44)(9,"label"),f(10,"Nh\xF3m:"),u(),l(11,"select",45),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.selectedGroup,i)||(o.selectedGroup=i),j(i)}),l(12,"option",46),f(13,"T\u1EA5t c\u1EA3"),u(),G(14,kF,2,2,"option",47),u()(),l(15,"div",48)(16,"button",38),H("click",function(){U(t);let i=D();return j(i.clearFilters())}),f(17,"X\xF3a b\u1ED9 l\u1ECDc"),u(),l(18,"button",38),H("click",function(){U(t);let i=D();return j(i.filterQuestions())}),f(19,"\xC1p d\u1EE5ng"),u()()()}if(e&2){let t=D();m(4),me("ngModel",t.selectedCategory),m(3),O("ngForOf",t.uniqueCategories),m(4),me("ngModel",t.selectedGroup),m(3),O("ngForOf",t.uniqueGroups)}}function FF(e,n){if(e&1&&(l(0,"p"),f(1),u()),e&2){let t=D().$implicit;m(),ae(t.text)}}function NF(e,n){if(e&1&&(l(0,"div")(1,"p"),f(2,"Listen and choose the correct answer:"),u(),l(3,"audio",66),N(4,"source",67),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(4),O("src",t.text,Qt)}}function RF(e,n){if(e&1&&(l(0,"li")(1,"span",70),f(2),u()()),e&2){let t=n.$implicit;m(),O("ngClass",Do(2,_y,t.isCorrect,!t.isCorrect)),m(),te(" ",t.text," ")}}function BF(e,n){if(e&1&&(l(0,"div",68)(1,"p")(2,"strong"),f(3,"C\xE2u tr\u1EA3 l\u1EDDi:"),u()(),l(4,"ul"),G(5,RF,3,5,"li",69),u()()),e&2){let t=D().$implicit;m(5),O("ngForOf",t.answers)}}function LF(e,n){if(e&1&&(l(0,"span",71),N(1,"i",72),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.category," ")}}function VF(e,n){if(e&1&&(l(0,"span",73),N(1,"i",74),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.group," ")}}function UF(e,n){if(e&1){let t=ve();l(0,"div",52)(1,"div",53)(2,"p")(3,"strong"),f(4),u()(),G(5,FF,2,1,"p",54)(6,NF,6,1,"div",54)(7,BF,6,1,"div",55),l(8,"div",56),G(9,LF,3,1,"span",57)(10,VF,3,1,"span",58),l(11,"span",59),N(12,"i",60),f(13),u()()(),l(14,"div",61)(15,"button",62),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.editQuestion(i))}),N(16,"i",63),f(17," S\u1EEDa "),u(),l(18,"button",64),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.deleteQuestion(i))}),N(19,"i",65),f(20," X\xF3a "),u()()()}if(e&2){let t=n.$implicit,r=n.index,i=D(2);m(4),te("C\xE2u h\u1ECFi s\u1ED1 ",r+1,":"),m(),O("ngIf",!t.audioFile&&!t.text.startsWith("http")),m(),O("ngIf",t.text&&t.text.startsWith("http")),m(),O("ngIf",t.answers&&t.answers.length>0),m(2),O("ngIf",t.category),m(),O("ngIf",t.group),m(3),Wt(" ",i.countCorrectAnswers(t),"/",i.getTotalAnswers(t)," c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng ")}}function jF(e,n){if(e&1&&(l(0,"div",50),G(1,UF,21,8,"div",51),u()),e&2){let t=D();m(),O("ngForOf",t.unapprovedQuestions)}}function HF(e,n){e&1&&(l(0,"div",75)(1,"p"),f(2,"Kh\xF4ng c\xF3 c\xE2u h\u1ECFi ch\u01B0a duy\u1EC7t."),u()())}function $F(e,n){if(e&1&&(l(0,"p"),f(1),u()),e&2){let t=D().$implicit;m(),ae(t.text)}}function qF(e,n){if(e&1&&(l(0,"div")(1,"p"),f(2,"Listen and choose the correct answer: "),u(),l(3,"audio",66),N(4,"source",67),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(4),O("src",t.text,Qt)}}function WF(e,n){if(e&1&&(l(0,"li")(1,"span",70),f(2),u()()),e&2){let t=n.$implicit;m(),O("ngClass",Do(2,_y,t.isCorrect,!t.isCorrect)),m(),te(" ",t.text," ")}}function zF(e,n){if(e&1&&(l(0,"div",68)(1,"p")(2,"strong"),f(3,"C\xE2u tr\u1EA3 l\u1EDDi:"),u()(),l(4,"ul"),G(5,WF,3,5,"li",69),u()()),e&2){let t=D().$implicit;m(5),O("ngForOf",t.answers)}}function GF(e,n){if(e&1&&(l(0,"span",71),N(1,"i",72),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.category," ")}}function QF(e,n){if(e&1&&(l(0,"span",73),N(1,"i",74),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.group," ")}}function XF(e,n){if(e&1&&(l(0,"div",52)(1,"div",53)(2,"p")(3,"strong"),f(4),u()(),G(5,$F,2,1,"p",54)(6,qF,6,1,"div",54)(7,zF,6,1,"div",55),l(8,"div",56),G(9,GF,3,1,"span",57)(10,QF,3,1,"span",58),l(11,"span",59),N(12,"i",60),f(13),u()()()()),e&2){let t=n.$implicit,r=n.index,i=D(2);m(4),te("C\xE2u h\u1ECFi s\u1ED1 ",r+1,":"),m(),O("ngIf",!t.audioFile&&!t.text.startsWith("http")),m(),O("ngIf",t.text&&t.text.startsWith("http")),m(),O("ngIf",t.answers&&t.answers.length>0),m(2),O("ngIf",t.category),m(),O("ngIf",t.group),m(3),Wt(" ",i.countCorrectAnswers(t),"/",i.getTotalAnswers(t)," c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng ")}}function YF(e,n){if(e&1&&(l(0,"div",50),G(1,XF,14,8,"div",51),u()),e&2){let t=D();m(),O("ngForOf",t.approvedQuestions)}}function KF(e,n){e&1&&(l(0,"div",75)(1,"p"),f(2,"Kh\xF4ng c\xF3 c\xE2u h\u1ECFi \u0111\xE3 duy\u1EC7t."),u()())}var Ad=class e{constructor(n,t,r){this.authService=n;this.questionService=t;this.router=r}user=null;isDropdownActive=!1;questions=[];filteredQuestions=[];selectedCategory="";selectedGroup="";uniqueCategories=[];uniqueGroups=[];isFilterDropdownVisible=!1;approvedQuestions=[];unapprovedQuestions=[];isApprovedOpen=!0;isUnapprovedOpen=!1;ngOnInit(){this.user=this.authService.getCurrentUser(),this.loadQuestions()}loadQuestions(){this.questionService.getQuestions().subscribe({next:n=>{this.questions=n,this.filteredQuestions=[...this.questions],this.updateUniqueFilters(),this.approvedQuestions=this.questions.filter(t=>t.status==="approved"),this.unapprovedQuestions=this.questions.filter(t=>t.status!=="approved"),console.log("Approved Questions:",this.approvedQuestions),console.log("Unapproved Questions:",this.unapprovedQuestions)},error:n=>{console.error("Error loading questions:",n)}})}updateUniqueFilters(){this.uniqueCategories=[...new Set(this.questions.map(n=>n.category).filter(Boolean))],this.uniqueGroups=[...new Set(this.questions.map(n=>n.group).filter(Boolean))]}toggleFilterDropdown(){this.isFilterDropdownVisible=!this.isFilterDropdownVisible}editQuestion(n){this.router.navigate(["/question"],{state:{question:n}})}deleteQuestion(n){n._id&&confirm("B\u1EA1n c\xF3 ch\u1EAFc mu\u1ED1n x\xF3a c\xE2u h\u1ECFi n\xE0y kh\xF4ng?")&&this.questionService.deleteQuestion(n._id).subscribe({next:()=>{this.questions=this.questions.filter(t=>t._id!==n._id),this.filteredQuestions=this.filteredQuestions.filter(t=>t._id!==n._id),this.updateUniqueFilters(),alert("C\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c x\xF3a"),this.loadQuestions()},error:t=>{console.error("Error deleting question:",t),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi x\xF3a c\xE2u h\u1ECFi")}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}createNewQuestion(){this.router.navigate(["/question"])}logout(){this.authService.logout().subscribe({next:()=>{window.location.href="/login"},error:n=>{console.error("Logout error:",n)}})}getCorrectAnswers(n){return n.answers.filter(r=>r.isCorrect).map(r=>r.text).join(", ")}countCorrectAnswers(n){return n.answers.filter(t=>t.isCorrect).length}getTotalAnswers(n){return n.answers.length}filterQuestions(){this.filteredQuestions=this.questions.filter(n=>{let t=this.selectedCategory?n.category===this.selectedCategory:!0,r=this.selectedGroup?n.group===this.selectedGroup:!0;return t&&r}),this.approvedQuestions=this.filteredQuestions.filter(n=>n.status==="approved"),this.unapprovedQuestions=this.filteredQuestions.filter(n=>n.status!=="approved"),console.log("Approved Questions:",this.approvedQuestions),console.log("Unapproved Questions:",this.unapprovedQuestions),this.isFilterDropdownVisible=!1}clearFilters(){this.selectedCategory="",this.selectedGroup="",this.filteredQuestions=this.questions,this.isFilterDropdownVisible=!1}searchQuestions(n){let t=n.target.value.toLowerCase();t?this.filteredQuestions=this.questions.filter(r=>{let i=r.text.toLowerCase().includes(t),o=r.category?.toLowerCase().includes(t),s=r.group?.toLowerCase().includes(t);return i||o||s}):this.filteredQuestions=this.questions,this.approvedQuestions=this.filteredQuestions.filter(r=>r.status==="approved"),this.unapprovedQuestions=this.filteredQuestions.filter(r=>r.status!=="approved")}toggleApprovedQuestions(){this.isApprovedOpen=!this.isApprovedOpen}toggleUnapprovedQuestions(){this.isUnapprovedOpen=!this.isUnapprovedOpen}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(vr),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-teacher-library"]],standalone:!0,features:[Me],decls:64,vars:12,consts:[[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["href","/teacher-dashboard"],["href","/teacher-history"],["href","/teacher-library",1,"active"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","#"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"content"],[1,"container"],[1,"tab"],[1,"search-bar"],["type","text","placeholder","Nh\u1EADp t\u1EEB kh\xF3a",3,"input"],[1,"fas","fa-search"],[1,"question-count"],[1,"actions"],[1,"filter",3,"click"],[1,"fa-solid","fa-filter"],[1,"create",3,"click"],[1,"fas","fa-plus"],["class","filter-dropdown",4,"ngIf"],[1,"question-section",2,"margin-bottom","60px"],[3,"click"],[1,"fas",3,"ngClass"],["class","questions-list",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"question-section"],[1,"filter-dropdown"],[1,"filter-group"],[3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"filter-actions"],[3,"value"],[1,"questions-list"],["class","question-item",4,"ngFor","ngForOf"],[1,"question-item"],[1,"question-content"],[4,"ngIf"],["class","question-answer",4,"ngIf"],[1,"question-info"],["class","category",4,"ngIf"],["class","group",4,"ngIf"],[1,"answers-count"],[1,"fas","fa-check-circle"],[1,"question-actions"],[1,"edit-btn",3,"click"],[1,"fas","fa-edit"],[1,"delete-btn",3,"click"],[1,"fas","fa-trash"],["controls",""],["type","audio/mpeg",3,"src"],[1,"question-answer"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"category"],[1,"fas","fa-folder"],[1,"group"],[1,"fas","fa-layer-group"],[1,"empty-state"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1),N(2,"img",2),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",3)(6,"a",4),f(7,"B\xE0i ki\u1EC3m tra"),u(),l(8,"a",5),f(9,"L\u1ECBch s\u1EED b\xE0i ki\u1EC3m tra"),u(),l(10,"a",6),f(11,"Th\u01B0 vi\u1EC7n c\xE2u h\u1ECFi"),u()(),l(12,"div",7),N(13,"i",8)(14,"i",9),l(15,"img",10),H("click",function(){return r.toggleDropdown()}),u(),l(16,"div",11)(17,"div",12),N(18,"img",13),l(19,"div",14)(20,"div",15),f(21),u(),l(22,"div",16),f(23),u()()(),l(24,"div",17)(25,"a",18),N(26,"i",19),f(27," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(28,"a",20),N(29,"i",21),f(30," C\xE0i \u0111\u1EB7t chung"),u(),l(31,"a",22),H("click",function(){return r.logout()}),N(32,"i",23),f(33," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(34,"div",24)(35,"div",25)(36,"div",26)(37,"div",27)(38,"input",28),H("input",function(o){return r.searchQuestions(o)}),u(),N(39,"i",29),u(),l(40,"div",30),f(41),u(),l(42,"div",31)(43,"button",32),H("click",function(){return r.toggleFilterDropdown()}),f(44," L\u1ECDc "),N(45,"i",33),u(),l(46,"button",34),H("click",function(){return r.createNewQuestion()}),f(47," Th\xEAm c\xE2u h\u1ECFi "),N(48,"i",35),u()()(),G(49,PF,20,4,"div",36),l(50,"div",37)(51,"h2",38),H("click",function(){return r.toggleUnapprovedQuestions()}),l(52,"span"),f(53,"C\xE2u h\u1ECFi ch\u01B0a duy\u1EC7t"),u(),N(54,"i",39),u(),G(55,jF,2,1,"div",40)(56,HF,3,0,"div",41),u(),l(57,"div",42)(58,"h2",38),H("click",function(){return r.toggleApprovedQuestions()}),l(59,"span"),f(60,"C\xE2u h\u1ECFi \u0111\xE3 duy\u1EC7t"),u(),N(61,"i",39),u(),G(62,YF,2,1,"div",40)(63,KF,3,0,"div",41),u()()()),t&2&&(m(16),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(18),te(" T\u1ED5ng s\u1ED1 c\xE2u h\u1ECFi: ",r.filteredQuestions.length," "),m(8),O("ngIf",r.isFilterDropdownVisible),m(5),O("ngClass",r.isUnapprovedOpen?"fa-chevron-up":"fa-chevron-down"),m(),O("ngIf",r.isUnapprovedOpen&&r.unapprovedQuestions.length>0),m(),O("ngIf",r.unapprovedQuestions.length===0),m(5),O("ngClass",r.isApprovedOpen?"fa-chevron-up":"fa-chevron-down"),m(),O("ngIf",r.isApprovedOpen&&r.approvedQuestions.length>0),m(),O("ngIf",r.approvedQuestions.length===0))},dependencies:[Ue,hr,lt,We,He,gr,xr,jn,Ot,Vt],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0;transition:background-color .3s ease-in-out}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500;transition:color .3s ease}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer;transition:transform .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000;opacity:0;transform:translateY(-20px);transition:opacity .3s ease,transform .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block;opacity:1;transform:translateY(0)}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:12px;color:#666}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:10px 15px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px;transition:color .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.content[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto;padding:20px;background-color:#fff;box-shadow:0 0 10px #0000000d;border-radius:8px;transition:box-shadow .3s ease}.content[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]:hover{box-shadow:0 0 15px #0000001a}.content[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:20px 0;transition:all .3s ease}.content[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;width:30%}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:16px;transition:border .3s ease}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border:1px solid #007bff}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:-30px;color:#aaa}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4a3aff;color:#fff;border:none;padding:10px 20px;border-radius:4px;font-size:16px;cursor:pointer}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{background-color:#ddd;color:#333}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]{position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;padding:15px;z-index:1000}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]{margin-bottom:10px}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#333}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]   .filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ccc;border-radius:4px;font-size:14px}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]   .filter-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:10px}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]   .filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px;border:none;border-radius:4px;cursor:pointer;margin-top:10px}.content[_ngcontent-%COMP%]   .filter-dropdown[_ngcontent-%COMP%]   .filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}.content[_ngcontent-%COMP%]   .questions-list[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px;font-size:16px;color:#444;opacity:0;animation:_ngcontent-%COMP%_fadeIn .5s forwards}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px 0;border-bottom:1px solid #ddd;transition:background-color .3s ease,transform .3s ease}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]:hover{background-color:#f5f5f5;transform:translate(10px)}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-content[_ngcontent-%COMP%]{flex:1;font-size:16px;color:#333}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .correct-answer[_ngcontent-%COMP%]{color:#155724;font-weight:700;display:flex;align-items:center}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{color:#4a3aff;display:flex;align-items:center}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%]   i[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]   .answers-count[_ngcontent-%COMP%]{display:flex;align-items:center;color:#28a745}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-info[_ngcontent-%COMP%]   .answers-count[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:auto}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:8px 12px;font-size:14px;background:none;border:1px solid transparent;border-radius:4px;transition:all .3s ease}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4a3aff;margin-right:5px}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ff4a4a;margin-right:5px}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]:hover{background:#e0e8ff;border-color:#4a3aff}.content[_ngcontent-%COMP%]   .question-item[_ngcontent-%COMP%]   .question-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{background:#ffe0e0;border-color:#ff4a4a}.content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;color:#666;font-size:16px;margin-top:30px}.create-button[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:16px;display:flex;align-items:center;margin-left:20px;margin-bottom:20px;transition:background-color .3s ease}.create-button[_ngcontent-%COMP%]:hover{background-color:#35449b}.create-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}']})};var bw={};bw.version="0.18.5";var Ti=1200,Ba=1252,ZF=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Tg={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Og=function(e){ZF.indexOf(e)!=-1&&(Ba=Tg[0]=e)};function JF(){Og(1252)}var fi=function(e){Ti=e,Og(e)};function Dw(){fi(1200),JF()}function Eg(e){for(var n=[],t=0,r=e.length;t<r;++t)n[t]=e.charCodeAt(t);return n}function e4(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return n.join("")}function Sw(e){for(var n=[],t=0;t<e.length>>1;++t)n[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return n.join("")}var tu=function(e){var n=e.charCodeAt(0),t=e.charCodeAt(1);return n==255&&t==254?e4(e.slice(2)):n==254&&t==255?Sw(e.slice(2)):n==65279?e.slice(1):e},Td=function(n){return String.fromCharCode(n)},Cy=function(n){return String.fromCharCode(n)},wt;var gn=null,eu=!0,Uo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function yy(e){for(var n="",t=0,r=0,i=0,o=0,s=0,a=0,c=0,d=0;d<e.length;)t=e.charCodeAt(d++),o=t>>2,r=e.charCodeAt(d++),s=(t&3)<<4|r>>4,i=e.charCodeAt(d++),a=(r&15)<<2|i>>6,c=i&63,isNaN(r)?a=c=64:isNaN(i)&&(c=64),n+=Uo.charAt(o)+Uo.charAt(s)+Uo.charAt(a)+Uo.charAt(c);return n}function kr(e){var n="",t=0,r=0,i=0,o=0,s=0,a=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)o=Uo.indexOf(e.charAt(d++)),s=Uo.indexOf(e.charAt(d++)),t=o<<2|s>>4,n+=String.fromCharCode(t),a=Uo.indexOf(e.charAt(d++)),r=(s&15)<<4|a>>2,a!==64&&(n+=String.fromCharCode(r)),c=Uo.indexOf(e.charAt(d++)),i=(a&3)<<6|c,c!==64&&(n+=String.fromCharCode(i));return n}var st=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ss=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(n,t){return t?new Buffer(n,t):new Buffer(n)}:Buffer.from.bind(Buffer)}return function(){}}();function $o(e){return st?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function wy(e){return st?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var di=function(n){return st?Ss(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)&255})};function Ms(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var n=[],t=0;t<e.length;++t)n[t]=String.fromCharCode(e[t]);return n.join("")}function Ig(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Ig(new Uint8Array(e));for(var n=new Array(e.length),t=0;t<e.length;++t)n[t]=e[t];return n}var Vo=st?function(e){return Buffer.concat(e.map(function(n){return Buffer.isBuffer(n)?n:Ss(n)}))}:function(e){if(typeof Uint8Array<"u"){var n=0,t=0;for(n=0;n<e.length;++n)t+=e[n].length;var r=new Uint8Array(t),i=0;for(n=0,t=0;n<e.length;t+=i,++n)if(i=e[n].length,e[n]instanceof Uint8Array)r.set(e[n],t);else{if(typeof e[n]=="string")throw"wtf";r.set(new Uint8Array(e[n]),t)}return r}return[].concat.apply([],e.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function t4(e){for(var n=[],t=0,r=e.length+250,i=$o(e.length+255),o=0;o<e.length;++o){var s=e.charCodeAt(o);if(s<128)i[t++]=s;else if(s<2048)i[t++]=192|s>>6&31,i[t++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var a=e.charCodeAt(++o)&1023;i[t++]=240|s>>8&7,i[t++]=128|s>>2&63,i[t++]=128|a>>6&15|(s&3)<<4,i[t++]=128|a&63}else i[t++]=224|s>>12&15,i[t++]=128|s>>6&63,i[t++]=128|s&63;t>r&&(n.push(i.slice(0,t)),t=0,i=$o(65535),r=65530)}return n.push(i.slice(0,t)),Vo(n)}var zn=/\u0000/g,nu=/[\u0001-\u0006]/g;function Fa(e){for(var n="",t=e.length-1;t>=0;)n+=e.charAt(t--);return n}function hi(e,n){var t=""+e;return t.length>=n?t:Xt("0",n-t.length)+t}function kg(e,n){var t=""+e;return t.length>=n?t:Xt(" ",n-t.length)+t}function Ld(e,n){var t=""+e;return t.length>=n?t:t+Xt(" ",n-t.length)}function n4(e,n){var t=""+Math.round(e);return t.length>=n?t:Xt("0",n-t.length)+t}function r4(e,n){var t=""+e;return t.length>=n?t:Xt("0",n-t.length)+t}var by=Math.pow(2,32);function ka(e,n){if(e>by||e<-by)return n4(e,n);var t=Math.round(e);return r4(t,n)}function Vd(e,n){return n=n||0,e.length>=7+n&&(e.charCodeAt(n)|32)===103&&(e.charCodeAt(n+1)|32)===101&&(e.charCodeAt(n+2)|32)===110&&(e.charCodeAt(n+3)|32)===101&&(e.charCodeAt(n+4)|32)===114&&(e.charCodeAt(n+5)|32)===97&&(e.charCodeAt(n+6)|32)===108}var Dy=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],cg=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function i4(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var Ye={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},Sy={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},o4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Ud(e,n,t){for(var r=e<0?-1:1,i=e*r,o=0,s=1,a=0,c=1,d=0,h=0,p=Math.floor(i);d<n&&(p=Math.floor(i),a=p*s+o,h=p*d+c,!(i-p<5e-8));)i=1/(i-p),o=s,s=a,c=d,d=h;if(h>n&&(d>n?(h=c,a=o):(h=d,a=s)),!t)return[0,r*a,h];var g=Math.floor(r*a/h);return[g,r*a-g*h,h]}function _s(e,n,t){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),o=0,s=[],a={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),n&&n.date1904&&(r+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++r,++a.D)),r===60)s=t?[1317,10,29]:[1900,2,29],o=3;else if(r===0)s=t?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var c=new Date(1900,0,1);c.setDate(c.getDate()+r-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],o=c.getDay(),r<60&&(o=(o+6)%7),t&&(o=d4(c,s))}return a.y=s[0],a.m=s[1],a.d=s[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=o,a}var Mw=new Date(1899,11,31,0,0,0),s4=Mw.getTime(),a4=new Date(1900,2,1,0,0,0);function Aw(e,n){var t=e.getTime();return n?t-=1461*24*60*60*1e3:e>=a4&&(t+=24*60*60*1e3),(t-(s4+(e.getTimezoneOffset()-Mw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Pg(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function c4(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function u4(e){var n=e<0?12:11,t=Pg(e.toFixed(12));return t.length<=n||(t=e.toPrecision(10),t.length<=n)?t:e.toExponential(5)}function l4(e){var n=Pg(e.toFixed(11));return n.length>(e<0?12:11)||n==="0"||n==="-0"?e.toPrecision(6):n}function pu(e){var n=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),t;return n>=-4&&n<=-1?t=e.toPrecision(10+n):Math.abs(n)<=9?t=u4(e):n===10?t=e.toFixed(10).substr(0,12):t=l4(e),Pg(c4(t.toUpperCase()))}function ws(e,n){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):pu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Qr(14,Aw(e,n&&n.date1904),n)}throw new Error("unsupported value in General format: "+e)}function d4(e,n){n[0]-=581;var t=e.getDay();return e<60&&(t=(t+6)%7),t}function f4(e,n,t,r){var i="",o=0,s=0,a=t.y,c,d=0;switch(e){case 98:a=t.y+543;case 121:switch(n.length){case 1:case 2:c=a%100,d=2;break;default:c=a%1e4,d=4;break}break;case 109:switch(n.length){case 1:case 2:c=t.m,d=n.length;break;case 3:return cg[t.m-1][1];case 5:return cg[t.m-1][0];default:return cg[t.m-1][2]}break;case 100:switch(n.length){case 1:case 2:c=t.d,d=n.length;break;case 3:return Dy[t.q][0];default:return Dy[t.q][1]}break;case 104:switch(n.length){case 1:case 2:c=1+(t.H+11)%12,d=n.length;break;default:throw"bad hour format: "+n}break;case 72:switch(n.length){case 1:case 2:c=t.H,d=n.length;break;default:throw"bad hour format: "+n}break;case 77:switch(n.length){case 1:case 2:c=t.M,d=n.length;break;default:throw"bad minute format: "+n}break;case 115:if(n!="s"&&n!="ss"&&n!=".0"&&n!=".00"&&n!=".000")throw"bad second format: "+n;return t.u===0&&(n=="s"||n=="ss")?hi(t.S,n.length):(r>=2?s=r===3?1e3:100:s=r===1?10:1,o=Math.round(s*(t.S+t.u)),o>=60*s&&(o=0),n==="s"?o===0?"0":""+o/s:(i=hi(o,2+r),n==="ss"?i.substr(0,2):"."+i.substr(2,n.length-1)));case 90:switch(n){case"[h]":case"[hh]":c=t.D*24+t.H;break;case"[m]":case"[mm]":c=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":c=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+n}d=n.length===3?1:2;break;case 101:c=a,d=1;break}var h=d>0?hi(c,d):"";return h}function jo(e){var n=3;if(e.length<=n)return e;for(var t=e.length%n,r=e.substr(0,t);t!=e.length;t+=n)r+=(r.length>0?",":"")+e.substr(t,n);return r}var Tw=/%/g;function h4(e,n,t){var r=n.replace(Tw,""),i=n.length-r.length;return ro(e,r,t*Math.pow(10,2*i))+Xt("%",i)}function p4(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ro(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function Ow(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Ow(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(n/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),t.indexOf("e")===-1){var s=Math.floor(Math.log(n)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+o):t+="E+"+(s-o);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,i)+"."+t.substr(2+i),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,c,d,h){return c+d+h.substr(0,(i+o)%i)+"."+h.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var Iw=/# (\?+)( ?)\/( ?)(\d+)/;function m4(e,n,t){var r=parseInt(e[4],10),i=Math.round(n*r),o=Math.floor(i/r),s=i-o*r,a=r;return t+(o===0?"":""+o)+" "+(s===0?Xt(" ",e[1].length+1+e[4].length):kg(s,e[1].length)+e[2]+"/"+e[3]+hi(a,e[4].length))}function g4(e,n,t){return t+(n===0?"":""+n)+Xt(" ",e[1].length+2+e[4].length)}var kw=/^#*0*\.([0#]+)/,Pw=/\).*[0#]/,Fw=/\(###\) ###\\?-####/;function ir(e){for(var n="",t,r=0;r!=e.length;++r)switch(t=e.charCodeAt(r)){case 35:break;case 63:n+=" ";break;case 48:n+="0";break;default:n+=String.fromCharCode(t)}return n}function My(e,n){var t=Math.pow(10,n);return""+Math.round(e*t)/t}function Ay(e,n){var t=e-Math.floor(e),r=Math.pow(10,n);return n<(""+Math.round(t*r)).length?0:Math.round(t*r)}function x4(e,n){return n<(""+Math.round((e-Math.floor(e))*Math.pow(10,n))).length?1:0}function E4(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function zr(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Pw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?zr("n",r,t):"("+zr("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return p4(e,n,t);if(n.indexOf("%")!==-1)return h4(e,n,t);if(n.indexOf("E")!==-1)return Ow(n,t);if(n.charCodeAt(0)===36)return"$"+zr(e,n.substr(n.charAt(1)==" "?2:1),t);var i,o,s,a,c=Math.abs(t),d=t<0?"-":"";if(n.match(/^00+$/))return d+ka(c,n.length);if(n.match(/^[#?]+$/))return i=ka(t,0),i==="0"&&(i=""),i.length>n.length?i:ir(n.substr(0,n.length-i.length))+i;if(o=n.match(Iw))return m4(o,c,d);if(n.match(/^#+0+$/))return d+ka(c,n.length-n.indexOf("0"));if(o=n.match(kw))return i=My(t,o[1].length).replace(/^([^\.]+)$/,"$1."+ir(o[1])).replace(/\.$/,"."+ir(o[1])).replace(/\.(\d*)$/,function(v,E){return"."+E+Xt("0",ir(o[1]).length-E.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return d+My(c,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return d+jo(ka(c,0));if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+zr(e,n,-t):jo(""+(Math.floor(t)+x4(t,o[1].length)))+"."+hi(Ay(t,o[1].length),o[1].length);if(o=n.match(/^#,#*,#0/))return zr(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fa(zr(e,n.replace(/[\\-]/g,""),t)),s=0,Fa(Fa(n.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(n.match(Fw))return i=zr(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=Ud(c,Math.pow(10,s)-1,!1),i=""+d,h=ro("n",o[1],a[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+o[2]+"/"+o[3],h=Ld(a[2],s),h.length<o[4].length&&(h=ir(o[4].substr(o[4].length-h.length))+h),i+=h,i;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),a=Ud(c,Math.pow(10,s)-1,!0),d+(a[0]||(a[1]?"":"0"))+" "+(a[1]?kg(a[1],s)+o[2]+"/"+o[3]+Ld(a[2],s):Xt(" ",2*s+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=ka(t,0),n.length<=i.length?i:ir(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0?]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=n.indexOf(".")-s,g=n.length-i.length-p;return ir(n.substr(0,p)+i+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return s=Ay(t,o[1].length),t<0?"-"+zr(e,n,-t):jo(E4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?hi(0,3-v.length):"")+v})+"."+hi(s,o[1].length);switch(n){case"###,##0.00":return zr(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=jo(ka(c,0));return x!=="0"?d+x:"";case"###,###.00":return zr(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return zr(e,"#,##0.00",t).replace(/^0\./,".");default:}throw new Error("unsupported format |"+n+"|")}function v4(e,n,t){for(var r=n.length-1;n.charCodeAt(r-1)===44;)--r;return ro(e,n.substr(0,r),t/Math.pow(10,3*(n.length-r)))}function _4(e,n,t){var r=n.replace(Tw,""),i=n.length-r.length;return ro(e,r,t*Math.pow(10,2*i))+Xt("%",i)}function Nw(e,n){var t,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(n==0)return"0.0E+0";if(n<0)return"-"+Nw(e,-n);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var o=Math.floor(Math.log(n)*Math.LOG10E)%i;if(o<0&&(o+=i),t=(n/Math.pow(10,o)).toPrecision(r+1+(i+o)%i),!t.match(/[Ee]/)){var s=Math.floor(Math.log(n)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(s-t.length+o):t+="E+"+(s-o),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,c,d,h){return c+d+h.substr(0,(i+o)%i)+"."+h.substr(o)+"E"})}else t=n.toExponential(r);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function Ai(e,n,t){if(e.charCodeAt(0)===40&&!n.match(Pw)){var r=n.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Ai("n",r,t):"("+Ai("n",r,-t)+")"}if(n.charCodeAt(n.length-1)===44)return v4(e,n,t);if(n.indexOf("%")!==-1)return _4(e,n,t);if(n.indexOf("E")!==-1)return Nw(n,t);if(n.charCodeAt(0)===36)return"$"+Ai(e,n.substr(n.charAt(1)==" "?2:1),t);var i,o,s,a,c=Math.abs(t),d=t<0?"-":"";if(n.match(/^00+$/))return d+hi(c,n.length);if(n.match(/^[#?]+$/))return i=""+t,t===0&&(i=""),i.length>n.length?i:ir(n.substr(0,n.length-i.length))+i;if(o=n.match(Iw))return g4(o,c,d);if(n.match(/^#+0+$/))return d+hi(c,n.length-n.indexOf("0"));if(o=n.match(kw))return i=(""+t).replace(/^([^\.]+)$/,"$1."+ir(o[1])).replace(/\.$/,"."+ir(o[1])),i=i.replace(/\.(\d*)$/,function(v,E){return"."+E+Xt("0",ir(o[1]).length-E.length)}),n.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(n=n.replace(/^#+([0.])/,"$1"),o=n.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=n.match(/^#{1,3},##0(\.?)$/))return d+jo(""+c);if(o=n.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Ai(e,n,-t):jo(""+t)+"."+Xt("0",o[1].length);if(o=n.match(/^#,#*,#0/))return Ai(e,n.replace(/^#,#*,/,""),t);if(o=n.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Fa(Ai(e,n.replace(/[\\-]/g,""),t)),s=0,Fa(Fa(n.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(n.match(Fw))return i=Ai(e,"##########",t),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var h="";if(o=n.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(o[4].length,7),a=Ud(c,Math.pow(10,s)-1,!1),i=""+d,h=ro("n",o[1],a[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),i+=h+o[2]+"/"+o[3],h=Ld(a[2],s),h.length<o[4].length&&(h=ir(o[4].substr(o[4].length-h.length))+h),i+=h,i;if(o=n.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(o[1].length,o[4].length),7),a=Ud(c,Math.pow(10,s)-1,!0),d+(a[0]||(a[1]?"":"0"))+" "+(a[1]?kg(a[1],s)+o[2]+"/"+o[3]+Ld(a[2],s):Xt(" ",2*s+1+o[2].length+o[3].length));if(o=n.match(/^[#0?]+$/))return i=""+t,n.length<=i.length?i:ir(n.substr(0,n.length-i.length))+i;if(o=n.match(/^([#0]+)\.([#0]+)$/)){i=""+t.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var p=n.indexOf(".")-s,g=n.length-i.length-p;return ir(n.substr(0,p)+i+n.substr(n.length-g))}if(o=n.match(/^00,000\.([#0]*0)$/))return t<0?"-"+Ai(e,n,-t):jo(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?hi(0,3-v.length):"")+v})+"."+hi(0,o[1].length);switch(n){case"###,###":case"##,###":case"#,###":var x=jo(""+c);return x!=="0"?d+x:"";default:if(n.match(/\.[0#?]*$/))return Ai(e,n.slice(0,n.lastIndexOf(".")),t)+ir(n.slice(n.lastIndexOf(".")))}throw new Error("unsupported format |"+n+"|")}function ro(e,n,t){return(t|0)===t?Ai(e,n,t):zr(e,n,t)}function C4(e){for(var n=[],t=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:t=!t;break;case 95:case 42:case 92:++r;break;case 59:n[n.length]=e.substr(i,r-i),i=r+1}if(n[n.length]=e.substr(i),t===!0)throw new Error("Format |"+e+"| unterminated string ");return n}var Rw=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ua(e){for(var n=0,t="",r="";n<e.length;)switch(t=e.charAt(n)){case"G":Vd(e,n)&&(n+=6),n++;break;case'"':for(;e.charCodeAt(++n)!==34&&n<e.length;);++n;break;case"\\":n+=2;break;case"_":n+=2;break;case"@":++n;break;case"B":case"b":if(e.charAt(n+1)==="1"||e.charAt(n+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(n,3).toUpperCase()==="A/P"||e.substr(n,5).toUpperCase()==="AM/PM"||e.substr(n,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++n;break;case"[":for(r=t;e.charAt(n++)!=="]"&&n<e.length;)r+=e.charAt(n);if(r.match(Rw))return!0;break;case".":case"0":case"#":for(;n<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++n))>-1||t=="\\"&&e.charAt(n+1)=="-"&&"0#".indexOf(e.charAt(n+2))>-1););break;case"?":for(;e.charAt(++n)===t;);break;case"*":++n,(e.charAt(n)==" "||e.charAt(n)=="*")&&++n;break;case"(":case")":++n;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;n<e.length&&"0123456789".indexOf(e.charAt(++n))>-1;);break;case" ":++n;break;default:++n;break}return!1}function y4(e,n,t,r){for(var i=[],o="",s=0,a="",c="t",d,h,p,g="H";s<e.length;)switch(a=e.charAt(s)){case"G":if(!Vd(e,s))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(o="";(p=e.charCodeAt(++s))!==34&&s<e.length;)o+=String.fromCharCode(p);i[i.length]={t:"t",v:o},++s;break;case"\\":var x=e.charAt(++s),v=x==="("||x===")"?x:"t";i[i.length]={t:v,v:x},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:n},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(d==null&&(d=_s(n,t,e.charAt(s+1)==="2"),d==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},c=a,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(n<0||d==null&&(d=_s(n,t),d==null))return"";for(o=a;++s<e.length&&e.charAt(s).toLowerCase()===a;)o+=a;a==="m"&&c.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=g),i[i.length]={t:a,v:o},c=a;break;case"A":case"a":case"\u4E0A":var E={t:a,v:a};if(d==null&&(d=_s(n,t)),e.substr(s,3).toUpperCase()==="A/P"?(d!=null&&(E.v=d.H>=12?"P":"A"),E.t="T",g="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(d!=null&&(E.v=d.H>=12?"PM":"AM"),E.t="T",s+=5,g="h"):e.substr(s,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(d!=null&&(E.v=d.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),E.t="T",s+=5,g="h"):(E.t="t",++s),d==null&&E.t==="T")return"";i[i.length]=E,c=a;break;case"[":for(o=a;e.charAt(s++)!=="]"&&s<e.length;)o+=e.charAt(s);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(Rw)){if(d==null&&(d=_s(n,t),d==null))return"";i[i.length]={t:"Z",v:o.toLowerCase()},c=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ua(e)||(i[i.length]={t:"t",v:o}));break;case".":if(d!=null){for(o=a;++s<e.length&&(a=e.charAt(s))==="0";)o+=a;i[i.length]={t:"s",v:o};break}case"0":case"#":for(o=a;++s<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(s))>-1;)o+=a;i[i.length]={t:"n",v:o};break;case"?":for(o=a;e.charAt(++s)===a;)o+=a;i[i.length]={t:a,v:o},c=a;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:r===1?"t":a,v:a},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=a;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)o+=e.charAt(s);i[i.length]={t:"D",v:o};break;case" ":i[i.length]={t:a,v:a},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++s;break}var _=0,M=0,I;for(s=i.length-1,c="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=g,c="h",_<1&&(_=1);break;case"s":(I=i[s].v.match(/\.0+$/))&&(M=Math.max(M,I[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":c=i[s].t;break;case"m":c==="s"&&(i[s].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&i[s].v.match(/[Hh]/)&&(_=1),_<2&&i[s].v.match(/[Mm]/)&&(_=2),_<3&&i[s].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var y="",q;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=f4(i[s].t.charCodeAt(0),i[s].v,d,M),i[s].t="t";break;case"n":case"?":for(q=s+1;i[q]!=null&&((a=i[q].t)==="?"||a==="D"||(a===" "||a==="t")&&i[q+1]!=null&&(i[q+1].t==="?"||i[q+1].t==="t"&&i[q+1].v==="/")||i[s].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[q].v==="/"||i[q].v===" "&&i[q+1]!=null&&i[q+1].t=="?"));)i[s].v+=i[q].v,i[q]={v:"",t:";"},++q;y+=i[s].v,s=q-1;break;case"G":i[s].t="t",i[s].v=ws(n,t);break}var ee="",R,k;if(y.length>0){y.charCodeAt(0)==40?(R=n<0&&y.charCodeAt(0)===45?-n:n,k=ro("n",y,R)):(R=n<0&&r>1?-n:n,k=ro("n",y,R),R<0&&i[0]&&i[0].t=="t"&&(k=k.substr(1),i[0].v="-"+i[0].v)),q=k.length-1;var z=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){z=s;break}var V=i.length;if(z===i.length&&k.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(q>=i[s].v.length-1?(q-=i[s].v.length,i[s].v=k.substr(q+1,i[s].v.length)):q<0?i[s].v="":(i[s].v=k.substr(0,q+1),q=-1),i[s].t="t",V=s);q>=0&&V<i.length&&(i[V].v=k.substr(0,q+1)+i[V].v)}else if(z!==i.length&&k.indexOf("E")===-1){for(q=k.indexOf(".")-1,s=z;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(h=i[s].v.indexOf(".")>-1&&s===z?i[s].v.indexOf(".")-1:i[s].v.length-1,ee=i[s].v.substr(h+1);h>=0;--h)q>=0&&(i[s].v.charAt(h)==="0"||i[s].v.charAt(h)==="#")&&(ee=k.charAt(q--)+ee);i[s].v=ee,i[s].t="t",V=s}for(q>=0&&V<i.length&&(i[V].v=k.substr(0,q+1)+i[V].v),q=k.indexOf(".")+1,s=z;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==z)){for(h=i[s].v.indexOf(".")>-1&&s===z?i[s].v.indexOf(".")+1:0,ee=i[s].v.substr(0,h);h<i[s].v.length;++h)q<k.length&&(ee+=k.charAt(q++));i[s].v=ee,i[s].t="t",V=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(R=r>1&&n<0&&s>0&&i[s-1].v==="-"?-n:n,i[s].v=ro(i[s].t,i[s].v,R),i[s].t="t");var re="";for(s=0;s!==i.length;++s)i[s]!=null&&(re+=i[s].v);return re}var Ty=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Oy(e,n){if(n==null)return!1;var t=parseFloat(n[2]);switch(n[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0;break}return!1}function w4(e,n){var t=C4(e),r=t.length,i=t[r-1].indexOf("@");if(r<4&&i>-1&&--r,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof n!="number")return[4,t.length===4||i>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=i>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=i>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=i>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break;case 4:break}var o=n>0?t[0]:n<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[r,o];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var s=t[0].match(Ty),a=t[1].match(Ty);return Oy(n,s)?[r,t[0]]:Oy(n,a)?[r,t[1]]:[r,t[s!=null&&a!=null?2:1]]}return[r,o]}function Qr(e,n,t){t==null&&(t={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&t.dateNF?r=t.dateNF:r=e;break;case"number":e==14&&t.dateNF?r=t.dateNF:r=(t.table!=null?t.table:Ye)[e],r==null&&(r=t.table&&t.table[Sy[e]]||Ye[Sy[e]]),r==null&&(r=o4[e]||"General");break}if(Vd(r,0))return ws(n,t);n instanceof Date&&(n=Aw(n,t.date1904));var i=w4(r,n);if(Vd(i[1]))return ws(n,t);if(n===!0)n="TRUE";else if(n===!1)n="FALSE";else if(n===""||n==null)return"";return y4(i[1],n,t,i[0])}function Cs(e,n){if(typeof n!="number"){n=+n||-1;for(var t=0;t<392;++t){if(Ye[t]==null){n<0&&(n=t);continue}if(Ye[t]==e){n=t;break}}n<0&&(n=391)}return Ye[n]=e,n}function Bw(){Ye=i4()}var b4={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},Lw=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function D4(e){var n=typeof e=="number"?Ye[e]:e;return n=n.replace(Lw,"(\\d+)"),new RegExp("^"+n+"$")}function S4(e,n,t){var r=-1,i=-1,o=-1,s=-1,a=-1,c=-1;(n.match(Lw)||[]).forEach(function(p,g){var x=parseInt(t[g+1],10);switch(p.toLowerCase().charAt(0)){case"y":r=x;break;case"d":o=x;break;case"h":s=x;break;case"s":c=x;break;case"m":s>=0?a=x:i=x;break}}),c>=0&&a==-1&&i>=0&&(a=i,i=-1);var d=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&a==-1&&c==-1?d:r==-1&&i==-1&&o==-1?h:d+"T"+h}var M4=function(){var e={};e.version="1.2.0";function n(){for(var k=0,z=new Array(256),V=0;V!=256;++V)k=V,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,k=k&1?-306674912^k>>>1:k>>>1,z[V]=k;return typeof Int32Array<"u"?new Int32Array(z):z}var t=n();function r(k){var z=0,V=0,re=0,ne=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(re=0;re!=256;++re)ne[re]=k[re];for(re=0;re!=256;++re)for(V=k[re],z=256+re;z<4096;z+=256)V=ne[z]=V>>>8^k[V&255];var W=[];for(re=1;re!=16;++re)W[re-1]=typeof Int32Array<"u"?ne.subarray(re*256,re*256+256):ne.slice(re*256,re*256+256);return W}var i=r(t),o=i[0],s=i[1],a=i[2],c=i[3],d=i[4],h=i[5],p=i[6],g=i[7],x=i[8],v=i[9],E=i[10],_=i[11],M=i[12],I=i[13],y=i[14];function q(k,z){for(var V=z^-1,re=0,ne=k.length;re<ne;)V=V>>>8^t[(V^k.charCodeAt(re++))&255];return~V}function ee(k,z){for(var V=z^-1,re=k.length-15,ne=0;ne<re;)V=y[k[ne++]^V&255]^I[k[ne++]^V>>8&255]^M[k[ne++]^V>>16&255]^_[k[ne++]^V>>>24]^E[k[ne++]]^v[k[ne++]]^x[k[ne++]]^g[k[ne++]]^p[k[ne++]]^h[k[ne++]]^d[k[ne++]]^c[k[ne++]]^a[k[ne++]]^s[k[ne++]]^o[k[ne++]]^t[k[ne++]];for(re+=15;ne<re;)V=V>>>8^t[(V^k[ne++])&255];return~V}function R(k,z){for(var V=z^-1,re=0,ne=k.length,W=0,fe=0;re<ne;)W=k.charCodeAt(re++),W<128?V=V>>>8^t[(V^W)&255]:W<2048?(V=V>>>8^t[(V^(192|W>>6&31))&255],V=V>>>8^t[(V^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,fe=k.charCodeAt(re++)&1023,V=V>>>8^t[(V^(240|W>>8&7))&255],V=V>>>8^t[(V^(128|W>>2&63))&255],V=V>>>8^t[(V^(128|fe>>6&15|(W&3)<<4))&255],V=V>>>8^t[(V^(128|fe&63))&255]):(V=V>>>8^t[(V^(224|W>>12&15))&255],V=V>>>8^t[(V^(128|W>>6&63))&255],V=V>>>8^t[(V^(128|W&63))&255]);return~V}return e.table=t,e.bstr=q,e.buf=ee,e.str=R,e}(),dt=function(){var n={};n.version="1.2.1";function t(C,S){for(var w=C.split("/"),b=S.split("/"),A=0,T=0,X=Math.min(w.length,b.length);A<X;++A){if(T=w[A].length-b[A].length)return T;if(w[A]!=b[A])return w[A]<b[A]?-1:1}return w.length-b.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var S=C.lastIndexOf("/");return S===-1?C:C.slice(0,S+1)}function i(C){if(C.charAt(C.length-1)=="/")return i(C.slice(0,-1));var S=C.lastIndexOf("/");return S===-1?C:C.slice(S+1)}function o(C,S){typeof S=="string"&&(S=new Date(S));var w=S.getHours();w=w<<6|S.getMinutes(),w=w<<5|S.getSeconds()>>>1,C.write_shift(2,w);var b=S.getFullYear()-1980;b=b<<4|S.getMonth()+1,b=b<<5|S.getDate(),C.write_shift(2,b)}function s(C){var S=C.read_shift(2)&65535,w=C.read_shift(2)&65535,b=new Date,A=w&31;w>>>=5;var T=w&15;w>>>=4,b.setMilliseconds(0),b.setFullYear(w+1980),b.setMonth(T-1),b.setDate(A);var X=S&31;S>>>=5;var ie=S&63;return S>>>=6,b.setHours(S),b.setMinutes(ie),b.setSeconds(X<<1),b}function a(C){Fn(C,0);for(var S={},w=0;C.l<=C.length-4;){var b=C.read_shift(2),A=C.read_shift(2),T=C.l+A,X={};switch(b){case 21589:w=C.read_shift(1),w&1&&(X.mtime=C.read_shift(4)),A>5&&(w&2&&(X.atime=C.read_shift(4)),w&4&&(X.ctime=C.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}C.l=T,S[b]=X}return S}var c;function d(){return c||(c={})}function h(C,S){if(C[0]==80&&C[1]==75)return u1(C,S);if((C[0]|32)==109&&(C[1]|32)==105)return h2(C,S);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var w=3,b=512,A=0,T=0,X=0,ie=0,K=0,Y=[],J=C.slice(0,512);Fn(J,0);var le=p(J);switch(w=le[0],w){case 3:b=512;break;case 4:b=4096;break;case 0:if(le[1]==0)return u1(C,S);default:throw new Error("Major Version: Expected 3 or 4 saw "+w)}b!==512&&(J=C.slice(0,b),Fn(J,28));var he=C.slice(0,b);g(J,w);var Te=J.read_shift(4,"i");if(w===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);J.l+=4,X=J.read_shift(4,"i"),J.l+=4,J.chk("00100000","Mini Stream Cutoff Size: "),ie=J.read_shift(4,"i"),A=J.read_shift(4,"i"),K=J.read_shift(4,"i"),T=J.read_shift(4,"i");for(var pe=-1,_e=0;_e<109&&(pe=J.read_shift(4,"i"),!(pe<0));++_e)Y[_e]=pe;var $e=x(C,b);_(K,T,$e,b,Y);var Pt=I($e,X,Y,b);Pt[X].name="!Directory",A>0&&ie!==fe&&(Pt[ie].name="!MiniFAT"),Pt[Y[0]].name="!FAT",Pt.fat_addrs=Y,Pt.ssz=b;var cr={},nn=[],yr=[],za=[];y(X,Pt,$e,nn,A,cr,yr,ie),v(yr,za,nn),nn.shift();var Ga={FileIndex:yr,FullPaths:za};return S&&S.raw&&(Ga.raw={header:he,sectors:$e}),Ga}function p(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Pe,"Header Signature: "),C.l+=16;var S=C.read_shift(2,"u");return[C.read_shift(2,"u"),S]}function g(C,S){var w=9;switch(C.l+=2,w=C.read_shift(2)){case 9:if(S!=3)throw new Error("Sector Shift: Expected 9 saw "+w);break;case 12:if(S!=4)throw new Error("Sector Shift: Expected 12 saw "+w);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+w)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function x(C,S){for(var w=Math.ceil(C.length/S)-1,b=[],A=1;A<w;++A)b[A-1]=C.slice(A*S,(A+1)*S);return b[w-1]=C.slice(w*S),b}function v(C,S,w){for(var b=0,A=0,T=0,X=0,ie=0,K=w.length,Y=[],J=[];b<K;++b)Y[b]=J[b]=b,S[b]=w[b];for(;ie<J.length;++ie)b=J[ie],A=C[b].L,T=C[b].R,X=C[b].C,Y[b]===b&&(A!==-1&&Y[A]!==A&&(Y[b]=Y[A]),T!==-1&&Y[T]!==T&&(Y[b]=Y[T])),X!==-1&&(Y[X]=b),A!==-1&&b!=Y[b]&&(Y[A]=Y[b],J.lastIndexOf(A)<ie&&J.push(A)),T!==-1&&b!=Y[b]&&(Y[T]=Y[b],J.lastIndexOf(T)<ie&&J.push(T));for(b=1;b<K;++b)Y[b]===b&&(T!==-1&&Y[T]!==T?Y[b]=Y[T]:A!==-1&&Y[A]!==A&&(Y[b]=Y[A]));for(b=1;b<K;++b)if(C[b].type!==0){if(ie=b,ie!=Y[ie])do ie=Y[ie],S[b]=S[ie]+"/"+S[b];while(ie!==0&&Y[ie]!==-1&&ie!=Y[ie]);Y[b]=-1}for(S[0]+="/",b=1;b<K;++b)C[b].type!==2&&(S[b]+="/")}function E(C,S,w){for(var b=C.start,A=C.size,T=[],X=b;w&&A>0&&X>=0;)T.push(S.slice(X*W,X*W+W)),A-=W,X=vs(w,X*4);return T.length===0?mn(0):Vo(T).slice(0,C.size)}function _(C,S,w,b,A){var T=fe;if(C===fe){if(S!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var X=w[C],ie=(b>>>2)-1;if(!X)return;for(var K=0;K<ie&&(T=vs(X,K*4))!==fe;++K)A.push(T);_(vs(X,b-4),S-1,w,b,A)}}function M(C,S,w,b,A){var T=[],X=[];A||(A=[]);var ie=b-1,K=0,Y=0;for(K=S;K>=0;){A[K]=!0,T[T.length]=K,X.push(C[K]);var J=w[Math.floor(K*4/b)];if(Y=K*4&ie,b<4+Y)throw new Error("FAT boundary crossed: "+K+" 4 "+b);if(!C[J])break;K=vs(C[J],Y)}return{nodes:T,data:jy([X])}}function I(C,S,w,b){var A=C.length,T=[],X=[],ie=[],K=[],Y=b-1,J=0,le=0,he=0,Te=0;for(J=0;J<A;++J)if(ie=[],he=J+S,he>=A&&(he-=A),!X[he]){K=[];var pe=[];for(le=he;le>=0;){pe[le]=!0,X[le]=!0,ie[ie.length]=le,K.push(C[le]);var _e=w[Math.floor(le*4/b)];if(Te=le*4&Y,b<4+Te)throw new Error("FAT boundary crossed: "+le+" 4 "+b);if(!C[_e]||(le=vs(C[_e],Te),pe[le]))break}T[he]={nodes:ie,data:jy([K])}}return T}function y(C,S,w,b,A,T,X,ie){for(var K=0,Y=b.length?2:0,J=S[C].data,le=0,he=0,Te;le<J.length;le+=128){var pe=J.slice(le,le+128);Fn(pe,64),he=pe.read_shift(2),Te=Kd(pe,0,he-Y),b.push(Te);var _e={name:Te,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},$e=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);$e!==0&&(_e.ct=q(pe,pe.l-8));var Pt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);Pt!==0&&(_e.mt=q(pe,pe.l-8)),_e.start=pe.read_shift(4,"i"),_e.size=pe.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=fe,_e.name=""),_e.type===5?(K=_e.start,A>0&&K!==fe&&(S[K].name="!StreamData")):_e.size>=4096?(_e.storage="fat",S[_e.start]===void 0&&(S[_e.start]=M(w,_e.start,S.fat_addrs,S.ssz)),S[_e.start].name=_e.name,_e.content=S[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:K!==fe&&_e.start!==fe&&S[K]&&(_e.content=E(_e,S[K].data,(S[ie]||{}).data))),_e.content&&Fn(_e.content,0),T[Te]=_e,X.push(_e)}}function q(C,S){return new Date((Tn(C,S+4)/1e7*Math.pow(2,32)+Tn(C,S)/1e7-11644473600)*1e3)}function ee(C,S){return d(),h(c.readFileSync(C),S)}function R(C,S){var w=S&&S.type;switch(w||st&&Buffer.isBuffer(C)&&(w="buffer"),w||"base64"){case"file":return ee(C,S);case"base64":return h(di(kr(C)),S);case"binary":return h(di(C),S)}return h(C,S)}function k(C,S){var w=S||{},b=w.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=b+"/",C.FileIndex[0]={name:b,type:5}),w.CLSID&&(C.FileIndex[0].clsid=w.CLSID),z(C)}function z(C){var S="Sh33tJ5";if(!dt.find(C,"/"+S)){var w=mn(4);w[0]=55,w[1]=w[3]=50,w[2]=54,C.FileIndex.push({name:S,type:2,content:w,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+S),V(C)}}function V(C,S){k(C);for(var w=!1,b=!1,A=C.FullPaths.length-1;A>=0;--A){var T=C.FileIndex[A];switch(T.type){case 0:b?w=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:b=!0,isNaN(T.R*T.L*T.C)&&(w=!0),T.R>-1&&T.L>-1&&T.R==T.L&&(w=!0);break;default:w=!0;break}}if(!(!w&&!S)){var X=new Date(1987,1,19),ie=0,K=Object.create?Object.create(null):{},Y=[];for(A=0;A<C.FullPaths.length;++A)K[C.FullPaths[A]]=!0,C.FileIndex[A].type!==0&&Y.push([C.FullPaths[A],C.FileIndex[A]]);for(A=0;A<Y.length;++A){var J=r(Y[A][0]);b=K[J],b||(Y.push([J,{name:i(J).replace("/",""),type:1,clsid:Be,ct:X,mt:X,content:null}]),K[J]=!0)}for(Y.sort(function(Te,pe){return t(Te[0],pe[0])}),C.FullPaths=[],C.FileIndex=[],A=0;A<Y.length;++A)C.FullPaths[A]=Y[A][0],C.FileIndex[A]=Y[A][1];for(A=0;A<Y.length;++A){var le=C.FileIndex[A],he=C.FullPaths[A];if(le.name=i(he).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||Be,A===0)le.C=Y.length>1?1:-1,le.size=0,le.type=5;else if(he.slice(-1)=="/"){for(ie=A+1;ie<Y.length&&r(C.FullPaths[ie])!=he;++ie);for(le.C=ie>=Y.length?-1:ie,ie=A+1;ie<Y.length&&r(C.FullPaths[ie])!=r(he);++ie);le.R=ie>=Y.length?-1:ie,le.type=1}else r(C.FullPaths[A+1]||"")==r(he)&&(le.R=A+1),le.type=2}}}function re(C,S){var w=S||{};if(w.fileType=="mad")return p2(C,w);switch(V(C),w.fileType){case"zip":return a2(C,w)}var b=function(Te){for(var pe=0,_e=0,$e=0;$e<Te.FileIndex.length;++$e){var Pt=Te.FileIndex[$e];if(Pt.content){var cr=Pt.content.length;cr>0&&(cr<4096?pe+=cr+63>>6:_e+=cr+511>>9)}}for(var nn=Te.FullPaths.length+3>>2,yr=pe+7>>3,za=pe+127>>7,Ga=yr+_e+nn+za,Go=Ga+127>>7,_f=Go<=109?0:Math.ceil((Go-109)/127);Ga+Go+_f+127>>7>Go;)_f=++Go<=109?0:Math.ceil((Go-109)/127);var Ni=[1,_f,Go,za,nn,_e,pe,0];return Te.FileIndex[0].size=pe<<6,Ni[7]=(Te.FileIndex[0].start=Ni[0]+Ni[1]+Ni[2]+Ni[3]+Ni[4]+Ni[5])+(Ni[6]+7>>3),Ni}(C),A=mn(b[7]<<9),T=0,X=0;{for(T=0;T<8;++T)A.write_shift(1,Ee[T]);for(T=0;T<8;++T)A.write_shift(2,0);for(A.write_shift(2,62),A.write_shift(2,3),A.write_shift(2,65534),A.write_shift(2,9),A.write_shift(2,6),T=0;T<3;++T)A.write_shift(2,0);for(A.write_shift(4,0),A.write_shift(4,b[2]),A.write_shift(4,b[0]+b[1]+b[2]+b[3]-1),A.write_shift(4,0),A.write_shift(4,4096),A.write_shift(4,b[3]?b[0]+b[1]+b[2]-1:fe),A.write_shift(4,b[3]),A.write_shift(-4,b[1]?b[0]-1:fe),A.write_shift(4,b[1]),T=0;T<109;++T)A.write_shift(-4,T<b[2]?b[1]+T:-1)}if(b[1])for(X=0;X<b[1];++X){for(;T<236+X*127;++T)A.write_shift(-4,T<b[2]?b[1]+T:-1);A.write_shift(-4,X===b[1]-1?fe:X+1)}var ie=function(Te){for(X+=Te;T<X-1;++T)A.write_shift(-4,T+1);Te&&(++T,A.write_shift(-4,fe))};for(X=T=0,X+=b[1];T<X;++T)A.write_shift(-4,Oe.DIFSECT);for(X+=b[2];T<X;++T)A.write_shift(-4,Oe.FATSECT);ie(b[3]),ie(b[4]);for(var K=0,Y=0,J=C.FileIndex[0];K<C.FileIndex.length;++K)J=C.FileIndex[K],J.content&&(Y=J.content.length,!(Y<4096)&&(J.start=X,ie(Y+511>>9)));for(ie(b[6]+7>>3);A.l&511;)A.write_shift(-4,Oe.ENDOFCHAIN);for(X=T=0,K=0;K<C.FileIndex.length;++K)J=C.FileIndex[K],J.content&&(Y=J.content.length,!(!Y||Y>=4096)&&(J.start=X,ie(Y+63>>6)));for(;A.l&511;)A.write_shift(-4,Oe.ENDOFCHAIN);for(T=0;T<b[4]<<2;++T){var le=C.FullPaths[T];if(!le||le.length===0){for(K=0;K<17;++K)A.write_shift(4,0);for(K=0;K<3;++K)A.write_shift(4,-1);for(K=0;K<12;++K)A.write_shift(4,0);continue}J=C.FileIndex[T],T===0&&(J.start=J.size?J.start-1:fe);var he=T===0&&w.root||J.name;if(Y=2*(he.length+1),A.write_shift(64,he,"utf16le"),A.write_shift(2,Y),A.write_shift(1,J.type),A.write_shift(1,J.color),A.write_shift(-4,J.L),A.write_shift(-4,J.R),A.write_shift(-4,J.C),J.clsid)A.write_shift(16,J.clsid,"hex");else for(K=0;K<4;++K)A.write_shift(4,0);A.write_shift(4,J.state||0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,0),A.write_shift(4,J.start),A.write_shift(4,J.size),A.write_shift(4,0)}for(T=1;T<C.FileIndex.length;++T)if(J=C.FileIndex[T],J.size>=4096)if(A.l=J.start+1<<9,st&&Buffer.isBuffer(J.content))J.content.copy(A,A.l,0,J.size),A.l+=J.size+511&-512;else{for(K=0;K<J.size;++K)A.write_shift(1,J.content[K]);for(;K&511;++K)A.write_shift(1,0)}for(T=1;T<C.FileIndex.length;++T)if(J=C.FileIndex[T],J.size>0&&J.size<4096)if(st&&Buffer.isBuffer(J.content))J.content.copy(A,A.l,0,J.size),A.l+=J.size+63&-64;else{for(K=0;K<J.size;++K)A.write_shift(1,J.content[K]);for(;K&63;++K)A.write_shift(1,0)}if(st)A.l=A.length;else for(;A.l<A.length;)A.write_shift(1,0);return A}function ne(C,S){var w=C.FullPaths.map(function(K){return K.toUpperCase()}),b=w.map(function(K){var Y=K.split("/");return Y[Y.length-(K.slice(-1)=="/"?2:1)]}),A=!1;S.charCodeAt(0)===47?(A=!0,S=w[0].slice(0,-1)+S):A=S.indexOf("/")!==-1;var T=S.toUpperCase(),X=A===!0?w.indexOf(T):b.indexOf(T);if(X!==-1)return C.FileIndex[X];var ie=!T.match(nu);for(T=T.replace(zn,""),ie&&(T=T.replace(nu,"!")),X=0;X<w.length;++X)if((ie?w[X].replace(nu,"!"):w[X]).replace(zn,"")==T||(ie?b[X].replace(nu,"!"):b[X]).replace(zn,"")==T)return C.FileIndex[X];return null}var W=64,fe=-2,Pe="d0cf11e0a1b11ae1",Ee=[208,207,17,224,161,177,26,225],Be="00000000000000000000000000000000",Oe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:fe,FREESECT:-1,HEADER_SIGNATURE:Pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ht(C,S,w){d();var b=re(C,w);c.writeFileSync(S,b)}function ye(C){for(var S=new Array(C.length),w=0;w<C.length;++w)S[w]=String.fromCharCode(C[w]);return S.join("")}function Fe(C,S){var w=re(C,S);switch(S&&S.type||"buffer"){case"file":return d(),c.writeFileSync(S.filename,w),w;case"binary":return typeof w=="string"?w:ye(w);case"base64":return yy(typeof w=="string"?w:ye(w));case"buffer":if(st)return Buffer.isBuffer(w)?w:Ss(w);case"array":return typeof w=="string"?di(w):w}return w}var oe;function F(C){try{var S=C.InflateRaw,w=new S;if(w._processChunk(new Uint8Array([3,0]),w._finishFlushFlag),w.bytesRead)oe=C;else throw new Error("zlib does not expose bytesRead")}catch(b){console.error("cannot use native zlib: "+(b.message||b))}}function Z(C,S){if(!oe)return a1(C,S);var w=oe.InflateRaw,b=new w,A=b._processChunk(C.slice(C.l),b._finishFlushFlag);return C.l+=b.bytesRead,A}function L(C){return oe?oe.deflateRawSync(C):rt(C)}var B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],De=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(C){var S=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(S>>16|S>>8|S)&255}for(var be=typeof Uint8Array<"u",ce=be?new Uint8Array(256):[],at=0;at<256;++at)ce[at]=Ce(at);function P(C,S){var w=ce[C&255];return S<=8?w>>>8-S:(w=w<<8|ce[C>>8&255],S<=16?w>>>16-S:(w=w<<8|ce[C>>16&255],w>>>24-S))}function $t(C,S){var w=S&7,b=S>>>3;return(C[b]|(w<=6?0:C[b+1]<<8))>>>w&3}function pt(C,S){var w=S&7,b=S>>>3;return(C[b]|(w<=5?0:C[b+1]<<8))>>>w&7}function Dt(C,S){var w=S&7,b=S>>>3;return(C[b]|(w<=4?0:C[b+1]<<8))>>>w&15}function it(C,S){var w=S&7,b=S>>>3;return(C[b]|(w<=3?0:C[b+1]<<8))>>>w&31}function we(C,S){var w=S&7,b=S>>>3;return(C[b]|(w<=1?0:C[b+1]<<8))>>>w&127}function Kt(C,S,w){var b=S&7,A=S>>>3,T=(1<<w)-1,X=C[A]>>>b;return w<8-b||(X|=C[A+1]<<8-b,w<16-b)||(X|=C[A+2]<<16-b,w<24-b)||(X|=C[A+3]<<24-b),X&T}function Pr(C,S,w){var b=S&7,A=S>>>3;return b<=5?C[A]|=(w&7)<<b:(C[A]|=w<<b&255,C[A+1]=(w&7)>>8-b),S+3}function mi(C,S,w){var b=S&7,A=S>>>3;return w=(w&1)<<b,C[A]|=w,S+1}function Pi(C,S,w){var b=S&7,A=S>>>3;return w<<=b,C[A]|=w&255,w>>>=8,C[A+1]=w,S+8}function qa(C,S,w){var b=S&7,A=S>>>3;return w<<=b,C[A]|=w&255,w>>>=8,C[A+1]=w&255,C[A+2]=w>>>8,S+16}function ao(C,S){var w=C.length,b=2*w>S?2*w:S+5,A=0;if(w>=S)return C;if(st){var T=wy(b);if(C.copy)C.copy(T);else for(;A<C.length;++A)T[A]=C[A];return T}else if(be){var X=new Uint8Array(b);if(X.set)X.set(C);else for(;A<w;++A)X[A]=C[A];return X}return C.length=b,C}function Cr(C){for(var S=new Array(C),w=0;w<C;++w)S[w]=0;return S}function Fi(C,S,w){var b=1,A=0,T=0,X=0,ie=0,K=C.length,Y=be?new Uint16Array(32):Cr(32);for(T=0;T<32;++T)Y[T]=0;for(T=K;T<w;++T)C[T]=0;K=C.length;var J=be?new Uint16Array(K):Cr(K);for(T=0;T<K;++T)Y[A=C[T]]++,b<A&&(b=A),J[T]=0;for(Y[0]=0,T=1;T<=b;++T)Y[T+16]=ie=ie+Y[T-1]<<1;for(T=0;T<K;++T)ie=C[T],ie!=0&&(J[T]=Y[ie+16]++);var le=0;for(T=0;T<K;++T)if(le=C[T],le!=0)for(ie=P(J[T],b)>>b-le,X=(1<<b+4-le)-1;X>=0;--X)S[ie|X<<le]=le&15|T<<4;return b}var co=be?new Uint16Array(512):Cr(512),Wa=be?new Uint16Array(32):Cr(32);if(!be){for(var Yn=0;Yn<512;++Yn)co[Yn]=0;for(Yn=0;Yn<32;++Yn)Wa[Yn]=0}(function(){for(var C=[],S=0;S<32;S++)C.push(5);Fi(C,Wa,32);var w=[];for(S=0;S<=143;S++)w.push(8);for(;S<=255;S++)w.push(9);for(;S<=279;S++)w.push(7);for(;S<=287;S++)w.push(8);Fi(w,co,288)})();var gi=function(){for(var S=be?new Uint8Array(32768):[],w=0,b=0;w<De.length-1;++w)for(;b<De[w+1];++b)S[b]=w;for(;b<32768;++b)S[b]=29;var A=be?new Uint8Array(259):[];for(w=0,b=0;w<se.length-1;++w)for(;b<se[w+1];++b)A[b]=w;function T(ie,K){for(var Y=0;Y<ie.length;){var J=Math.min(65535,ie.length-Y),le=Y+J==ie.length;for(K.write_shift(1,+le),K.write_shift(2,J),K.write_shift(2,~J&65535);J-- >0;)K[K.l++]=ie[Y++]}return K.l}function X(ie,K){for(var Y=0,J=0,le=be?new Uint16Array(32768):[];J<ie.length;){var he=Math.min(65535,ie.length-J);if(he<10){for(Y=Pr(K,Y,+(J+he==ie.length)),Y&7&&(Y+=8-(Y&7)),K.l=Y/8|0,K.write_shift(2,he),K.write_shift(2,~he&65535);he-- >0;)K[K.l++]=ie[J++];Y=K.l*8;continue}Y=Pr(K,Y,+(J+he==ie.length)+2);for(var Te=0;he-- >0;){var pe=ie[J];Te=(Te<<5^pe)&32767;var _e=-1,$e=0;if((_e=le[Te])&&(_e|=J&-32768,_e>J&&(_e-=32768),_e<J))for(;ie[_e+$e]==ie[J+$e]&&$e<250;)++$e;if($e>2){pe=A[$e],pe<=22?Y=Pi(K,Y,ce[pe+1]>>1)-1:(Pi(K,Y,3),Y+=5,Pi(K,Y,ce[pe-23]>>5),Y+=3);var Pt=pe<8?0:pe-4>>2;Pt>0&&(qa(K,Y,$e-se[pe]),Y+=Pt),pe=S[J-_e],Y=Pi(K,Y,ce[pe]>>3),Y-=3;var cr=pe<4?0:pe-2>>1;cr>0&&(qa(K,Y,J-_e-De[pe]),Y+=cr);for(var nn=0;nn<$e;++nn)le[Te]=J&32767,Te=(Te<<5^ie[J])&32767,++J;he-=$e-1}else pe<=143?pe=pe+48:Y=mi(K,Y,1),Y=Pi(K,Y,ce[pe]),le[Te]=J&32767,++J}Y=Pi(K,Y,0)-1}return K.l=(Y+7)/8|0,K.l}return function(K,Y){return K.length<8?T(K,Y):X(K,Y)}}();function rt(C){var S=mn(50+Math.floor(C.length*1.1)),w=gi(C,S);return S.slice(0,w)}var Zt=be?new Uint16Array(32768):Cr(32768),Fr=be?new Uint16Array(32768):Cr(32768),xn=be?new Uint16Array(128):Cr(128),zo=1,s1=1;function i2(C,S){var w=it(C,S)+257;S+=5;var b=it(C,S)+1;S+=5;var A=Dt(C,S)+4;S+=4;for(var T=0,X=be?new Uint8Array(19):Cr(19),ie=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],K=1,Y=be?new Uint8Array(8):Cr(8),J=be?new Uint8Array(8):Cr(8),le=X.length,he=0;he<A;++he)X[B[he]]=T=pt(C,S),K<T&&(K=T),Y[T]++,S+=3;var Te=0;for(Y[0]=0,he=1;he<=K;++he)J[he]=Te=Te+Y[he-1]<<1;for(he=0;he<le;++he)(Te=X[he])!=0&&(ie[he]=J[Te]++);var pe=0;for(he=0;he<le;++he)if(pe=X[he],pe!=0){Te=ce[ie[he]]>>8-pe;for(var _e=(1<<7-pe)-1;_e>=0;--_e)xn[Te|_e<<pe]=pe&7|he<<3}var $e=[];for(K=1;$e.length<w+b;)switch(Te=xn[we(C,S)],S+=Te&7,Te>>>=3){case 16:for(T=3+$t(C,S),S+=2,Te=$e[$e.length-1];T-- >0;)$e.push(Te);break;case 17:for(T=3+pt(C,S),S+=3;T-- >0;)$e.push(0);break;case 18:for(T=11+we(C,S),S+=7;T-- >0;)$e.push(0);break;default:$e.push(Te),K<Te&&(K=Te);break}var Pt=$e.slice(0,w),cr=$e.slice(w);for(he=w;he<286;++he)Pt[he]=0;for(he=b;he<30;++he)cr[he]=0;return zo=Fi(Pt,Zt,286),s1=Fi(cr,Fr,30),S}function o2(C,S){if(C[0]==3&&!(C[1]&3))return[$o(S),2];for(var w=0,b=0,A=wy(S||1<<18),T=0,X=A.length>>>0,ie=0,K=0;!(b&1);){if(b=pt(C,w),w+=3,b>>>1)b>>1==1?(ie=9,K=5):(w=i2(C,w),ie=zo,K=s1);else{w&7&&(w+=8-(w&7));var Y=C[w>>>3]|C[(w>>>3)+1]<<8;if(w+=32,Y>0)for(!S&&X<T+Y&&(A=ao(A,T+Y),X=A.length);Y-- >0;)A[T++]=C[w>>>3],w+=8;continue}for(;;){!S&&X<T+32767&&(A=ao(A,T+32767),X=A.length);var J=Kt(C,w,ie),le=b>>>1==1?co[J]:Zt[J];if(w+=le&15,le>>>=4,!(le>>>8&255))A[T++]=le;else{if(le==256)break;le-=257;var he=le<8?0:le-4>>2;he>5&&(he=0);var Te=T+se[le];he>0&&(Te+=Kt(C,w,he),w+=he),J=Kt(C,w,K),le=b>>>1==1?Wa[J]:Fr[J],w+=le&15,le>>>=4;var pe=le<4?0:le-2>>1,_e=De[le];for(pe>0&&(_e+=Kt(C,w,pe),w+=pe),!S&&X<Te&&(A=ao(A,Te+100),X=A.length);T<Te;)A[T]=A[T-_e],++T}}}return S?[A,w+7>>>3]:[A.slice(0,T),w+7>>>3]}function a1(C,S){var w=C.slice(C.l||0),b=o2(w,S);return C.l+=b[1],b[0]}function c1(C,S){if(C)typeof console<"u"&&console.error(S);else throw new Error(S)}function u1(C,S){var w=C;Fn(w,0);var b=[],A=[],T={FileIndex:b,FullPaths:A};k(T,{root:S.root});for(var X=w.length-4;(w[X]!=80||w[X+1]!=75||w[X+2]!=5||w[X+3]!=6)&&X>=0;)--X;w.l=X+4,w.l+=4;var ie=w.read_shift(2);w.l+=6;var K=w.read_shift(4);for(w.l=K,X=0;X<ie;++X){w.l+=20;var Y=w.read_shift(4),J=w.read_shift(4),le=w.read_shift(2),he=w.read_shift(2),Te=w.read_shift(2);w.l+=8;var pe=w.read_shift(4),_e=a(w.slice(w.l+le,w.l+le+he));w.l+=le+he+Te;var $e=w.l;w.l=pe+4,s2(w,Y,J,T,_e),w.l=$e}return T}function s2(C,S,w,b,A){C.l+=2;var T=C.read_shift(2),X=C.read_shift(2),ie=s(C);if(T&8257)throw new Error("Unsupported ZIP encryption");for(var K=C.read_shift(4),Y=C.read_shift(4),J=C.read_shift(4),le=C.read_shift(2),he=C.read_shift(2),Te="",pe=0;pe<le;++pe)Te+=String.fromCharCode(C[C.l++]);if(he){var _e=a(C.slice(C.l,C.l+he));(_e[21589]||{}).mt&&(ie=_e[21589].mt),((A||{})[21589]||{}).mt&&(ie=A[21589].mt)}C.l+=he;var $e=C.slice(C.l,C.l+Y);switch(X){case 8:$e=Z(C,J);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var Pt=!1;T&8&&(K=C.read_shift(4),K==134695760&&(K=C.read_shift(4),Pt=!0),Y=C.read_shift(4),J=C.read_shift(4)),Y!=S&&c1(Pt,"Bad compressed size: "+S+" != "+Y),J!=w&&c1(Pt,"Bad uncompressed size: "+w+" != "+J),vf(b,Te,$e,{unsafe:!0,mt:ie})}function a2(C,S){var w=S||{},b=[],A=[],T=mn(1),X=w.compression?8:0,ie=0,K=!1;K&&(ie|=8);var Y=0,J=0,le=0,he=0,Te=C.FullPaths[0],pe=Te,_e=C.FileIndex[0],$e=[],Pt=0;for(Y=1;Y<C.FullPaths.length;++Y)if(pe=C.FullPaths[Y].slice(Te.length),_e=C.FileIndex[Y],!(!_e.size||!_e.content||pe=="Sh33tJ5")){var cr=le,nn=mn(pe.length);for(J=0;J<pe.length;++J)nn.write_shift(1,pe.charCodeAt(J)&127);nn=nn.slice(0,nn.l),$e[he]=M4.buf(_e.content,0);var yr=_e.content;X==8&&(yr=L(yr)),T=mn(30),T.write_shift(4,67324752),T.write_shift(2,20),T.write_shift(2,ie),T.write_shift(2,X),_e.mt?o(T,_e.mt):T.write_shift(4,0),T.write_shift(-4,ie&8?0:$e[he]),T.write_shift(4,ie&8?0:yr.length),T.write_shift(4,ie&8?0:_e.content.length),T.write_shift(2,nn.length),T.write_shift(2,0),le+=T.length,b.push(T),le+=nn.length,b.push(nn),le+=yr.length,b.push(yr),ie&8&&(T=mn(12),T.write_shift(-4,$e[he]),T.write_shift(4,yr.length),T.write_shift(4,_e.content.length),le+=T.l,b.push(T)),T=mn(46),T.write_shift(4,33639248),T.write_shift(2,0),T.write_shift(2,20),T.write_shift(2,ie),T.write_shift(2,X),T.write_shift(4,0),T.write_shift(-4,$e[he]),T.write_shift(4,yr.length),T.write_shift(4,_e.content.length),T.write_shift(2,nn.length),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(4,0),T.write_shift(4,cr),Pt+=T.l,A.push(T),Pt+=nn.length,A.push(nn),++he}return T=mn(22),T.write_shift(4,101010256),T.write_shift(2,0),T.write_shift(2,0),T.write_shift(2,he),T.write_shift(2,he),T.write_shift(4,Pt),T.write_shift(4,le),T.write_shift(2,0),Vo([Vo(b),Vo(A),T])}var Mu={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function c2(C,S){if(C.ctype)return C.ctype;var w=C.name||"",b=w.match(/\.([^\.]+)$/);return b&&Mu[b[1]]||S&&(b=(w=S).match(/[\.\\]([^\.\\])+$/),b&&Mu[b[1]])?Mu[b[1]]:"application/octet-stream"}function u2(C){for(var S=yy(C),w=[],b=0;b<S.length;b+=76)w.push(S.slice(b,b+76));return w.join(`\r
`)+`\r
`}function l2(C){var S=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Y){var J=Y.charCodeAt(0).toString(16).toUpperCase();return"="+(J.length==1?"0"+J:J)});S=S.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),S.charAt(0)==`
`&&(S="=0D"+S.slice(1)),S=S.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var w=[],b=S.split(`\r
`),A=0;A<b.length;++A){var T=b[A];if(T.length==0){w.push("");continue}for(var X=0;X<T.length;){var ie=76,K=T.slice(X,X+ie);K.charAt(ie-1)=="="?ie--:K.charAt(ie-2)=="="?ie-=2:K.charAt(ie-3)=="="&&(ie-=3),K=T.slice(X,X+ie),X+=ie,X<T.length&&(K+="="),w.push(K)}}return w.join(`\r
`)}function d2(C){for(var S=[],w=0;w<C.length;++w){for(var b=C[w];w<=C.length&&b.charAt(b.length-1)=="=";)b=b.slice(0,b.length-1)+C[++w];S.push(b)}for(var A=0;A<S.length;++A)S[A]=S[A].replace(/[=][0-9A-Fa-f]{2}/g,function(T){return String.fromCharCode(parseInt(T.slice(1),16))});return di(S.join(`\r
`))}function f2(C,S,w){for(var b="",A="",T="",X,ie=0;ie<10;++ie){var K=S[ie];if(!K||K.match(/^\s*$/))break;var Y=K.match(/^(.*?):\s*([^\s].*)$/);if(Y)switch(Y[1].toLowerCase()){case"content-location":b=Y[2].trim();break;case"content-type":T=Y[2].trim();break;case"content-transfer-encoding":A=Y[2].trim();break}}switch(++ie,A.toLowerCase()){case"base64":X=di(kr(S.slice(ie).join("")));break;case"quoted-printable":X=d2(S.slice(ie));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+A)}var J=vf(C,b.slice(w.length),X,{unsafe:!0});T&&(J.ctype=T)}function h2(C,S){if(ye(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var w=S&&S.root||"",b=(st&&Buffer.isBuffer(C)?C.toString("binary"):ye(C)).split(`\r
`),A=0,T="";for(A=0;A<b.length;++A)if(T=b[A],!!/^Content-Location:/i.test(T)&&(T=T.slice(T.indexOf("file")),w||(w=T.slice(0,T.lastIndexOf("/")+1)),T.slice(0,w.length)!=w))for(;w.length>0&&(w=w.slice(0,w.length-1),w=w.slice(0,w.lastIndexOf("/")+1),T.slice(0,w.length)!=w););var X=(b[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var ie="--"+(X[1]||""),K=[],Y=[],J={FileIndex:K,FullPaths:Y};k(J);var le,he=0;for(A=0;A<b.length;++A){var Te=b[A];Te!==ie&&Te!==ie+"--"||(he++&&f2(J,b.slice(le,A),w),le=A)}return J}function p2(C,S){var w=S||{},b=w.boundary||"SheetJS";b="------="+b;for(var A=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+b.slice(2)+'"',"","",""],T=C.FullPaths[0],X=T,ie=C.FileIndex[0],K=1;K<C.FullPaths.length;++K)if(X=C.FullPaths[K].slice(T.length),ie=C.FileIndex[K],!(!ie.size||!ie.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function($e){return"_x"+$e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function($e){return"_u"+$e.charCodeAt(0).toString(16)+"_"});for(var Y=ie.content,J=st&&Buffer.isBuffer(Y)?Y.toString("binary"):ye(Y),le=0,he=Math.min(1024,J.length),Te=0,pe=0;pe<=he;++pe)(Te=J.charCodeAt(pe))>=32&&Te<128&&++le;var _e=le>=he*4/5;A.push(b),A.push("Content-Location: "+(w.root||"file:///C:/SheetJS/")+X),A.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),A.push("Content-Type: "+c2(ie,X)),A.push(""),A.push(_e?l2(J):u2(J))}return A.push(b+`--\r
`),A.join(`\r
`)}function m2(C){var S={};return k(S,C),S}function vf(C,S,w,b){var A=b&&b.unsafe;A||k(C);var T=!A&&dt.find(C,S);if(!T){var X=C.FullPaths[0];S.slice(0,X.length)==X?X=S:(X.slice(-1)!="/"&&(X+="/"),X=(X+S).replace("//","/")),T={name:i(S),type:2},C.FileIndex.push(T),C.FullPaths.push(X),A||dt.utils.cfb_gc(C)}return T.content=w,T.size=w?w.length:0,b&&(b.CLSID&&(T.clsid=b.CLSID),b.mt&&(T.mt=b.mt),b.ct&&(T.ct=b.ct)),T}function g2(C,S){k(C);var w=dt.find(C,S);if(w){for(var b=0;b<C.FileIndex.length;++b)if(C.FileIndex[b]==w)return C.FileIndex.splice(b,1),C.FullPaths.splice(b,1),!0}return!1}function x2(C,S,w){k(C);var b=dt.find(C,S);if(b){for(var A=0;A<C.FileIndex.length;++A)if(C.FileIndex[A]==b)return C.FileIndex[A].name=i(w),C.FullPaths[A]=w,!0}return!1}function E2(C){V(C,!0)}return n.find=ne,n.read=R,n.parse=h,n.write=Fe,n.writeFile=ht,n.utils={cfb_new:m2,cfb_add:vf,cfb_del:g2,cfb_mov:x2,cfb_gc:E2,ReadShift:ou,CheckField:nb,prep_blob:Fn,bconcat:Vo,use_zlib:F,_deflateRaw:rt,_inflateRaw:a1,consts:Oe},n}(),Iy;function A4(e){if(typeof Iy<"u")return Iy.readFileSync(e);if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var n=File(e);n.open("r"),n.encoding="binary";var t=n.read();return n.close(),t}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function Oi(e){for(var n=Object.keys(e),t=[],r=0;r<n.length;++r)Object.prototype.hasOwnProperty.call(e,n[r])&&t.push(n[r]);return t}function Fg(e){for(var n=[],t=Oi(e),r=0;r!==t.length;++r)n[e[t[r]]]=t[r];return n}var jd=new Date(1899,11,30,0,0,0);function ar(e,n){var t=e.getTime();n&&(t-=1462*24*60*60*1e3);var r=jd.getTime()+(e.getTimezoneOffset()-jd.getTimezoneOffset())*6e4;return(t-r)/(24*60*60*1e3)}var Vw=new Date,T4=jd.getTime()+(Vw.getTimezoneOffset()-jd.getTimezoneOffset())*6e4,ky=Vw.getTimezoneOffset();function Yd(e){var n=new Date;return n.setTime(e*24*60*60*1e3+T4),n.getTimezoneOffset()!==ky&&n.setTime(n.getTime()+(n.getTimezoneOffset()-ky)*6e4),n}function O4(e){var n=0,t=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var o=1;o!=i.length;++o)if(i[o]){switch(t=1,o>3&&(r=!0),i[o].slice(i[o].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[o].slice(i[o].length-1));case"D":t*=24;case"H":t*=60;case"M":if(r)t*=60;else throw new Error("Unsupported ISO Duration Field: M");case"S":break}n+=t*parseInt(i[o],10)}return n}var Py=new Date("2017-02-19T19:06:09.000Z"),Uw=isNaN(Py.getFullYear())?new Date("2/19/17"):Py,I4=Uw.getFullYear()==2017;function On(e,n){var t=new Date(e);if(I4)return n>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):n<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(e instanceof Date)return e;if(Uw.getFullYear()==1917&&!isNaN(t.getFullYear())){var r=t.getFullYear();return e.indexOf(""+r)>-1||t.setFullYear(t.getFullYear()+100),t}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function bs(e,n){if(st&&Buffer.isBuffer(e)){if(n){if(e[0]==255&&e[1]==254)return iu(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return iu(Sw(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(n){if(e[0]==255&&e[1]==254)return iu(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return iu(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(o){return t[o]||o})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function Nn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var n={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=Nn(e[t]));return n}function Xt(e,n){for(var t="";t.length<n;)t+=e;return t}function pi(e){var n=Number(e);if(!isNaN(n))return isFinite(n)?n:NaN;if(!/\d/.test(e))return n;var t=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(n=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,o){return t=-t,o}),!isNaN(n=Number(r)))?n/t:n}var k4=["january","february","march","april","may","june","july","august","september","october","november","december"];function La(e){var n=new Date(e),t=new Date(NaN),r=n.getYear(),i=n.getMonth(),o=n.getDate();if(isNaN(o))return t;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&k4.indexOf(s)==-1)return t}else if(s.match(/[a-z]/))return t;return r<0||r>8099?t:(i>0||o>1)&&r!=101?n:e.match(/[^-0-9:,\/\\]/)?t:n}var P4=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(t,r,i){if(e||typeof r=="string")return t.split(r);for(var o=t.split(r),s=[o[0]],a=1;a<o.length;++a)s.push(i),s.push(o[a]);return s}}();function jw(e){return e?e.content&&e.type?bs(e.content,!0):e.data?tu(e.data):e.asNodeBuffer&&st?tu(e.asNodeBuffer().toString("binary")):e.asBinary?tu(e.asBinary()):e._data&&e._data.getContent?tu(bs(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Hw(e){if(!e)return null;if(e.data)return Eg(e.data);if(e.asNodeBuffer&&st)return e.asNodeBuffer();if(e._data&&e._data.getContent){var n=e._data.getContent();return typeof n=="string"?Eg(n):Array.prototype.slice.call(n)}return e.content&&e.type?e.content:null}function F4(e){return e&&e.name.slice(-4)===".bin"?Hw(e):jw(e)}function Gr(e,n){for(var t=e.FullPaths||Oi(e.files),r=n.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),o=0;o<t.length;++o){var s=t[o].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==s||i==s)return e.files?e.files[t[o]]:e.FileIndex[o]}return null}function Ng(e,n){var t=Gr(e,n);if(t==null)throw new Error("Cannot find file "+n+" in zip");return t}function hn(e,n,t){if(!t)return F4(Ng(e,n));if(!n)return null;try{return hn(e,n)}catch{return null}}function Ir(e,n,t){if(!t)return jw(Ng(e,n));if(!n)return null;try{return Ir(e,n)}catch{return null}}function $w(e,n,t){if(!t)return Hw(Ng(e,n));if(!n)return null;try{return $w(e,n)}catch{return null}}function Fy(e){for(var n=e.FullPaths||Oi(e.files),t=[],r=0;r<n.length;++r)n[r].slice(-1)!="/"&&t.push(n[r].replace(/^Root Entry[\/]/,""));return t.sort()}function N4(e,n,t){if(e.FullPaths){if(typeof t=="string"){var r;return st?r=Ss(t):r=t4(t),dt.utils.cfb_add(e,n,r)}dt.utils.cfb_add(e,n,t)}else e.file(n,t)}function qw(e,n){switch(n.type){case"base64":return dt.read(e,{type:"base64"});case"binary":return dt.read(e,{type:"binary"});case"buffer":case"array":return dt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+n.type)}function ru(e,n){if(e.charAt(0)=="/")return e.slice(1);var t=n.split("/");n.slice(-1)!="/"&&t.pop();for(var r=e.split("/");r.length!==0;){var i=r.shift();i===".."?t.pop():i!=="."&&t.push(i)}return t.join("/")}var Ww=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,R4=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,Ny=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,B4=/<[^>]*>/g,Xn=Ww.match(Ny)?Ny:B4,L4=/<\w*:/,V4=/<(\/?)\w+:/;function Ve(e,n,t){for(var r={},i=0,o=0;i!==e.length&&!((o=e.charCodeAt(i))===32||o===10||o===13);++i);if(n||(r[0]=e.slice(0,i)),i===e.length)return r;var s=e.match(R4),a=0,c="",d=0,h="",p="",g=1;if(s)for(d=0;d!=s.length;++d){for(p=s[d],o=0;o!=p.length&&p.charCodeAt(o)!==61;++o);for(h=p.slice(0,o).trim();p.charCodeAt(o+1)==32;)++o;for(g=(i=p.charCodeAt(o+1))==34||i==39?1:0,c=p.slice(o+1+g,p.length-g),a=0;a!=h.length&&h.charCodeAt(a)!==58;++a);if(a===h.length)h.indexOf("_")>0&&(h=h.slice(0,h.indexOf("_"))),r[h]=c,t||(r[h.toLowerCase()]=c);else{var x=(a===5&&h.slice(0,5)==="xmlns"?"xmlns":"")+h.slice(a+1);if(r[x]&&h.slice(a-3,a)=="ext")continue;r[x]=c,t||(r[x.toLowerCase()]=c)}}return r}function Ii(e){return e.replace(V4,"<$1")}var zw={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},U4=Fg(zw),gt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,n=/_x([\da-fA-F]{4})_/ig;return function t(r){var i=r+"",o=i.indexOf("<![CDATA[");if(o==-1)return i.replace(e,function(a,c){return zw[a]||String.fromCharCode(parseInt(c,a.indexOf("x")>-1?16:10))||a}).replace(n,function(a,c){return String.fromCharCode(parseInt(c,16))});var s=i.indexOf("]]>");return t(i.slice(0,o))+i.slice(o+9,s)+t(i.slice(s+3))}}(),j4=/[&<>'"]/g;var H4=/[\u0000-\u001f]/g;function Rg(e){var n=e+"";return n.replace(j4,function(t){return U4[t]}).replace(/\n/g,"<br/>").replace(H4,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}var Ry=function(){var e=/&#(\d+);/g;function n(t,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,n)}}();function Ht(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function ug(e){for(var n="",t=0,r=0,i=0,o=0,s=0,a=0;t<e.length;){if(r=e.charCodeAt(t++),r<128){n+=String.fromCharCode(r);continue}if(i=e.charCodeAt(t++),r>191&&r<224){s=(r&31)<<6,s|=i&63,n+=String.fromCharCode(s);continue}if(o=e.charCodeAt(t++),r<240){n+=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63);continue}s=e.charCodeAt(t++),a=((r&7)<<18|(i&63)<<12|(o&63)<<6|s&63)-65536,n+=String.fromCharCode(55296+(a>>>10&1023)),n+=String.fromCharCode(56320+(a&1023))}return n}function By(e){var n=$o(2*e.length),t,r,i=1,o=0,s=0,a;for(r=0;r<e.length;r+=i)i=1,(a=e.charCodeAt(r))<128?t=a:a<224?(t=(a&31)*64+(e.charCodeAt(r+1)&63),i=2):a<240?(t=(a&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,t=(a&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),t-=65536,s=55296+(t>>>10&1023),t=56320+(t&1023)),s!==0&&(n[o++]=s&255,n[o++]=s>>>8,s=0),n[o++]=t%256,n[o++]=t>>>8;return n.slice(0,o).toString("ucs2")}function Ly(e){return Ss(e,"binary").toString("utf8")}var Od="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",kt=st&&(Ly(Od)==ug(Od)&&Ly||By(Od)==ug(Od)&&By)||ug,iu=st?function(e){return Ss(e,"utf8").toString("binary")}:function(e){for(var n=[],t=0,r=0,i=0;t<e.length;)switch(r=e.charCodeAt(t++),!0){case r<128:n.push(String.fromCharCode(r));break;case r<2048:n.push(String.fromCharCode(192+(r>>6))),n.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(t++)-56320+(r<<10),n.push(String.fromCharCode(240+(i>>18&7))),n.push(String.fromCharCode(144+(i>>12&63))),n.push(String.fromCharCode(128+(i>>6&63))),n.push(String.fromCharCode(128+(i&63)));break;default:n.push(String.fromCharCode(224+(r>>12))),n.push(String.fromCharCode(128+(r>>6&63))),n.push(String.fromCharCode(128+(r&63)))}return n.join("")},mu=function(){var e={};return function(t,r){var i=t+"|"+(r||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+t+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+t+">",r||"")}}(),Gw=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(n){return[new RegExp("&"+n[0]+";","ig"),n[1]]});return function(t){for(var r=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),$4=function(){var e={};return function(t){return e[t]!==void 0?e[t]:e[t]=new RegExp("<(?:vt:)?"+t+">([\\s\\S]*?)</(?:vt:)?"+t+">","g")}}(),q4=/<\/?(?:vt:)?variant>/g,W4=/<(?:vt:)([^>]*)>([\s\S]*)</;function Vy(e,n){var t=Ve(e),r=e.match($4(t.baseType))||[],i=[];if(r.length!=t.size){if(n.WTF)throw new Error("unexpected vector length "+r.length+" != "+t.size);return i}return r.forEach(function(o){var s=o.replace(q4,"").match(W4);s&&i.push({v:kt(s[2]),t:s[1]})}),i}var z4=/(^\s|\s$|\n)/;function G4(e){return Oi(e).map(function(n){return" "+n+'="'+e[n]+'"'}).join("")}function Q4(e,n,t){return"<"+e+(t!=null?G4(t):"")+(n!=null?(n.match(z4)?' xml:space="preserve"':"")+">"+n+"</"+e:"/")+">"}function Bg(e){if(st&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return kt(Ms(Ig(e)));throw new Error("Bad input format: expected Buffer or string")}var gu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,X4={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Y4=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function K4(e,n){for(var t=1-2*(e[n+7]>>>7),r=((e[n+7]&127)<<4)+(e[n+6]>>>4&15),i=e[n+6]&15,o=5;o>=0;--o)i=i*256+e[n+o];return r==2047?i==0?t*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),t*Math.pow(2,r-52)*i)}function Z4(e,n,t){var r=(n<0||1/n==-1/0?1:0)<<7,i=0,o=0,s=r?-n:n;isFinite(s)?s==0?i=o=0:(i=Math.floor(Math.log(s)/Math.LN2),o=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?i=-1022:(o-=Math.pow(2,52),i+=1023)):(i=2047,o=isNaN(n)?26985:0);for(var a=0;a<=5;++a,o/=256)e[t+a]=o&255;e[t+6]=(i&15)<<4|o&15,e[t+7]=i>>4|r}var Uy=function(e){for(var n=[],t=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,o=e[0][r].length;i<o;i+=t)n.push.apply(n,e[0][r].slice(i,i+t));return n},jy=st?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(n){return Buffer.isBuffer(n)?n:Ss(n)})):Uy(e)}:Uy,Hy=function(e,n,t){for(var r=[],i=n;i<t;i+=2)r.push(String.fromCharCode(no(e,i)));return r.join("").replace(zn,"")},Kd=st?function(e,n,t){return Buffer.isBuffer(e)?e.toString("utf16le",n,t).replace(zn,""):Hy(e,n,t)}:Hy,$y=function(e,n,t){for(var r=[],i=n;i<n+t;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},Qw=st?function(e,n,t){return Buffer.isBuffer(e)?e.toString("hex",n,n+t):$y(e,n,t)}:$y,qy=function(e,n,t){for(var r=[],i=n;i<t;i++)r.push(String.fromCharCode(Pa(e,i)));return r.join("")},ja=st?function(n,t,r){return Buffer.isBuffer(n)?n.toString("utf8",t,r):qy(n,t,r)}:qy,Xw=function(e,n){var t=Tn(e,n);return t>0?ja(e,n+4,n+4+t-1):""},Lg=Xw,Yw=function(e,n){var t=Tn(e,n);return t>0?ja(e,n+4,n+4+t-1):""},Vg=Yw,Kw=function(e,n){var t=2*Tn(e,n);return t>0?ja(e,n+4,n+4+t-1):""},Ug=Kw,Zw=function(n,t){var r=Tn(n,t);return r>0?Kd(n,t+4,t+4+r):""},jg=Zw,Jw=function(e,n){var t=Tn(e,n);return t>0?ja(e,n+4,n+4+t):""},Hg=Jw,eb=function(e,n){return K4(e,n)},Hd=eb,tb=function(n){return Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array};st&&(Lg=function(n,t){if(!Buffer.isBuffer(n))return Xw(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},Vg=function(n,t){if(!Buffer.isBuffer(n))return Yw(n,t);var r=n.readUInt32LE(t);return r>0?n.toString("utf8",t+4,t+4+r-1):""},Ug=function(n,t){if(!Buffer.isBuffer(n))return Kw(n,t);var r=2*n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r-1)},jg=function(n,t){if(!Buffer.isBuffer(n))return Zw(n,t);var r=n.readUInt32LE(t);return n.toString("utf16le",t+4,t+4+r)},Hg=function(n,t){if(!Buffer.isBuffer(n))return Jw(n,t);var r=n.readUInt32LE(t);return n.toString("utf8",t+4,t+4+r)},Hd=function(n,t){return Buffer.isBuffer(n)?n.readDoubleLE(t):eb(n,t)},tb=function(n){return Buffer.isBuffer(n)||Array.isArray(n)||typeof Uint8Array<"u"&&n instanceof Uint8Array});function J4(){Kd=function(e,n,t){return wt.utils.decode(1200,e.slice(n,t)).replace(zn,"")},ja=function(e,n,t){return wt.utils.decode(65001,e.slice(n,t))},Lg=function(e,n){var t=Tn(e,n);return t>0?wt.utils.decode(Ba,e.slice(n+4,n+4+t-1)):""},Vg=function(e,n){var t=Tn(e,n);return t>0?wt.utils.decode(Ti,e.slice(n+4,n+4+t-1)):""},Ug=function(e,n){var t=2*Tn(e,n);return t>0?wt.utils.decode(1200,e.slice(n+4,n+4+t-1)):""},jg=function(e,n){var t=Tn(e,n);return t>0?wt.utils.decode(1200,e.slice(n+4,n+4+t)):""},Hg=function(e,n){var t=Tn(e,n);return t>0?wt.utils.decode(65001,e.slice(n+4,n+4+t)):""}}typeof wt<"u"&&J4();var Pa=function(e,n){return e[n]},no=function(e,n){return e[n+1]*256+e[n]},eN=function(e,n){var t=e[n+1]*256+e[n];return t<32768?t:(65535-t+1)*-1},Tn=function(e,n){return e[n+3]*(1<<24)+(e[n+2]<<16)+(e[n+1]<<8)+e[n]},vs=function(e,n){return e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]},tN=function(e,n){return e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3]};function ou(e,n){var t="",r,i,o=[],s,a,c,d;switch(n){case"dbcs":if(d=this.l,st&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)t+=String.fromCharCode(no(this,d)),d+=2;e*=2;break;case"utf8":t=ja(this,this.l,this.l+e);break;case"utf16le":e*=2,t=Kd(this,this.l,this.l+e);break;case"wstr":if(typeof wt<"u")t=wt.utils.decode(Ti,this.slice(this.l,this.l+2*e));else return ou.call(this,e,"dbcs");e=2*e;break;case"lpstr-ansi":t=Lg(this,this.l),e=4+Tn(this,this.l);break;case"lpstr-cp":t=Vg(this,this.l),e=4+Tn(this,this.l);break;case"lpwstr":t=Ug(this,this.l),e=4+2*Tn(this,this.l);break;case"lpp4":e=4+Tn(this,this.l),t=jg(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Tn(this,this.l),t=Hg(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,t="";(s=Pa(this,this.l+e++))!==0;)o.push(Td(s));t=o.join("");break;case"_wstr":for(e=0,t="";(s=no(this,this.l+e))!==0;)o.push(Td(s)),e+=2;e+=2,t=o.join("");break;case"dbcs-cont":for(t="",d=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Pa(this,d),this.l=d+1,a=ou.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+a;o.push(Td(no(this,d))),d+=2}t=o.join(""),e*=2;break;case"cpstr":if(typeof wt<"u"){t=wt.utils.decode(Ti,this.slice(this.l,this.l+e));break}case"sbcs-cont":for(t="",d=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return s=Pa(this,d),this.l=d+1,a=ou.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),o.join("")+a;o.push(Td(Pa(this,d))),d+=1}t=o.join("");break;default:switch(e){case 1:return r=Pa(this,this.l),this.l++,r;case 2:return r=(n==="i"?eN:no)(this,this.l),this.l+=2,r;case 4:case-4:return n==="i"||!(this[this.l+3]&128)?(r=(e>0?vs:tN)(this,this.l),this.l+=4,r):(i=Tn(this,this.l),this.l+=4,i);case 8:case-8:if(n==="f")return e==8?i=Hd(this,this.l):i=Hd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:t=Qw(this,this.l,e);break}}return this.l+=e,t}var nN=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255,e[t+2]=n>>>16&255,e[t+3]=n>>>24&255},rN=function(e,n,t){e[t]=n&255,e[t+1]=n>>8&255,e[t+2]=n>>16&255,e[t+3]=n>>24&255},iN=function(e,n,t){e[t]=n&255,e[t+1]=n>>>8&255};function oN(e,n,t){var r=0,i=0;if(t==="dbcs"){for(i=0;i!=n.length;++i)iN(this,n.charCodeAt(i),this.l+2*i);r=2*n.length}else if(t==="sbcs"){if(typeof wt<"u"&&Ba==874)for(i=0;i!=n.length;++i){var o=wt.utils.encode(Ba,n.charAt(i));this[this.l+i]=o[0]}else for(n=n.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=n.length;++i)this[this.l+i]=n.charCodeAt(i)&255;r=n.length}else if(t==="hex"){for(;i<e;++i)this[this.l++]=parseInt(n.slice(2*i,2*i+2),16)||0;return this}else if(t==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(n.length,e);++i){var a=n.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=n&255;break;case 2:r=2,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255;break;case 3:r=3,this[this.l]=n&255,n>>>=8,this[this.l+1]=n&255,n>>>=8,this[this.l+2]=n&255;break;case 4:r=4,nN(this,n,this.l);break;case 8:if(r=8,t==="f"){Z4(this,n,this.l);break}case 16:break;case-4:r=4,rN(this,n,this.l);break}return this.l+=r,this}function nb(e,n){var t=Qw(this,this.l,e.length>>1);if(t!==e)throw new Error(n+"Expected "+e+" saw "+t);this.l+=e.length>>1}function Fn(e,n){e.l=n,e.read_shift=ou,e.chk=nb,e.write_shift=oN}function Qn(e,n){e.l+=n}function mn(e){var n=$o(e);return Fn(n,0),n}function so(e,n,t){if(e){var r,i,o;Fn(e,e.l||0);for(var s=e.length,a=0,c=0;e.l<s;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var d=Qd[a]||Qd[65535];for(r=e.read_shift(1),o=r&127,i=1;i<4&&r&128;++i)o+=((r=e.read_shift(1))&127)<<7*i;c=e.l+o;var h=d.f&&d.f(e,o,t);if(e.l=c,n(h,d,a))return}}}function vg(){var e=[],n=st?256:2048,t=function(d){var h=mn(d);return Fn(h,0),h},r=t(n),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},o=function(d){return r&&d<r.length-r.l?r:(i(),r=t(Math.max(d+1,n)))},s=function(){return i(),Vo(e)},a=function(d){i(),r=d,r.l==null&&(r.l=r.length),o(n)};return{next:o,push:a,end:s,_bufs:e}}function su(e,n,t){var r=Nn(e);if(n.s?(r.cRel&&(r.c+=n.s.c),r.rRel&&(r.r+=n.s.r)):(r.cRel&&(r.c+=n.c),r.rRel&&(r.r+=n.r)),!t||t.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Wy(e,n,t){var r=Nn(e);return r.s=su(r.s,n.s,t),r.e=su(r.e,n.s,t),r}function au(e,n){if(e.cRel&&e.c<0)for(e=Nn(e);e.c<0;)e.c+=n>8?16384:256;if(e.rRel&&e.r<0)for(e=Nn(e);e.r<0;)e.r+=n>8?1048576:n>5?65536:16384;var t=Ge(e);return!e.cRel&&e.cRel!=null&&(t=cN(t)),!e.rRel&&e.rRel!=null&&(t=sN(t)),t}function lg(e,n){return e.s.r==0&&!e.s.rRel&&e.e.r==(n.biff>=12?1048575:n.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Cn(e.s.c)+":"+(e.e.cRel?"":"$")+Cn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(n.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Rn(e.s.r)+":"+(e.e.rRel?"":"$")+Rn(e.e.r):au(e.s,n.biff)+":"+au(e.e,n.biff)}function $g(e){return parseInt(aN(e),10)-1}function Rn(e){return""+(e+1)}function sN(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function aN(e){return e.replace(/\$(\d+)$/,"$1")}function qg(e){for(var n=uN(e),t=0,r=0;r!==n.length;++r)t=26*t+n.charCodeAt(r)-64;return t-1}function Cn(e){if(e<0)throw new Error("invalid column "+e);var n="";for(++e;e;e=Math.floor((e-1)/26))n=String.fromCharCode((e-1)%26+65)+n;return n}function cN(e){return e.replace(/^([A-Z])/,"$$$1")}function uN(e){return e.replace(/^\$([A-Z])/,"$1")}function lN(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sr(e){for(var n=0,t=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?n=10*n+(i-48):i>=65&&i<=90&&(t=26*t+(i-64))}return{c:t-1,r:n-1}}function Ge(e){for(var n=e.c+1,t="";n;n=(n-1)/26|0)t=String.fromCharCode((n-1)%26+65)+t;return t+(e.r+1)}function Ha(e){var n=e.indexOf(":");return n==-1?{s:sr(e),e:sr(e)}:{s:sr(e.slice(0,n)),e:sr(e.slice(n+1))}}function ft(e,n){return typeof n>"u"||typeof n=="number"?ft(e.s,e.e):(typeof e!="string"&&(e=Ge(e)),typeof n!="string"&&(n=Ge(n)),e==n?e:e+":"+n)}function Yt(e){var n={s:{c:0,r:0},e:{c:0,r:0}},t=0,r=0,i=0,o=e.length;for(t=0;r<o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(n.s.c=--t,t=0;r<o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;if(n.s.r=--t,r===o||i!=10)return n.e.c=n.s.c,n.e.r=n.s.r,n;for(++r,t=0;r!=o&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)t=26*t+i;for(n.e.c=--t,t=0;r!=o&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)t=10*t+i;return n.e.r=--t,n}function zy(e,n){var t=e.t=="d"&&n instanceof Date;if(e.z!=null)try{return e.w=Qr(e.z,t?ar(n):n)}catch{}try{return e.w=Qr((e.XF||{}).numFmtId||(t?14:0),t?ar(n):n)}catch{return""+n}}function oo(e,n,t){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),e.t=="e"?Os[e.v]||e.v:n==null?zy(e,e.v):zy(e,n))}function Wo(e,n){var t=n&&n.sheet?n.sheet:"Sheet1",r={};return r[t]=e,{SheetNames:[t],Sheets:r}}function rb(e,n,t){var r=t||{},i=e?Array.isArray(e):r.dense;gn!=null&&i==null&&(i=gn);var o=e||(i?[]:{}),s=0,a=0;if(o&&r.origin!=null){if(typeof r.origin=="number")s=r.origin;else{var c=typeof r.origin=="string"?sr(r.origin):r.origin;s=c.r,a=c.c}o["!ref"]||(o["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var h=Yt(o["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),s==-1&&(d.e.r=s=h.e.r+1)}for(var p=0;p!=n.length;++p)if(n[p]){if(!Array.isArray(n[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var g=0;g!=n[p].length;++g)if(!(typeof n[p][g]>"u")){var x={v:n[p][g]},v=s+p,E=a+g;if(d.s.r>v&&(d.s.r=v),d.s.c>E&&(d.s.c=E),d.e.r<v&&(d.e.r=v),d.e.c<E&&(d.e.c=E),n[p][g]&&typeof n[p][g]=="object"&&!Array.isArray(n[p][g])&&!(n[p][g]instanceof Date))x=n[p][g];else if(Array.isArray(x.v)&&(x.f=n[p][g][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(r.nullError)x.t="e",x.v=0;else if(r.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=r.dateNF||Ye[14],r.cellDates?(x.t="d",x.w=Qr(x.z,ar(x.v))):(x.t="n",x.v=ar(x.v),x.w=Qr(x.z,x.v))):x.t="s";if(i)o[v]||(o[v]=[]),o[v][E]&&o[v][E].z&&(x.z=o[v][E].z),o[v][E]=x;else{var _=Ge({c:E,r:v});o[_]&&o[_].z&&(x.z=o[_].z),o[_]=x}}}return d.s.c<1e7&&(o["!ref"]=ft(d)),o}function $a(e,n){return rb(null,e,n)}function dN(e){return e.read_shift(4,"i")}function Gn(e){var n=e.read_shift(4);return n===0?"":e.read_shift(n,"dbcs")}function fN(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Wg(e,n){var t=e.l,r=e.read_shift(1),i=Gn(e),o=[],s={t:i,h:i};if(r&1){for(var a=e.read_shift(4),c=0;c!=a;++c)o.push(fN(e));s.r=o}else s.r=[{ich:0,ifnt:0}];return e.l=t+n,s}var hN=Wg;function Xr(e){var n=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:n,iStyleRef:t}}function As(e){var n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:n}}var pN=Gn;function zg(e){var n=e.read_shift(4);return n===0||n===4294967295?"":e.read_shift(n,"dbcs")}var mN=Gn,_g=zg;function Gg(e){var n=e.slice(e.l,e.l+4),t=n[0]&1,r=n[0]&2;e.l+=4;var i=r===0?Hd([0,0,0,0,n[0]&252,n[1],n[2],n[3]],0):vs(n,0)>>2;return t?i/100:i}function ib(e){var n={s:{},e:{}};return n.s.r=e.read_shift(4),n.e.r=e.read_shift(4),n.s.c=e.read_shift(4),n.e.c=e.read_shift(4),n}var Ts=ib;function qn(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function gN(e){var n={},t=e.read_shift(1),r=t>>>1,i=e.read_shift(1),o=e.read_shift(2,"i"),s=e.read_shift(1),a=e.read_shift(1),c=e.read_shift(1);switch(e.l++,r){case 0:n.auto=1;break;case 1:n.index=i;var d=ys[i];d&&(n.rgb=Eu(d));break;case 2:n.rgb=Eu([s,a,c]);break;case 3:n.theme=i;break}return o!=0&&(n.tint=o>0?o/32767:o/32768),n}function xN(e){var n=e.read_shift(1);e.l++;var t={fBold:n&1,fItalic:n&2,fUnderline:n&4,fStrikeout:n&8,fOutline:n&16,fShadow:n&32,fCondense:n&64,fExtend:n&128};return t}function ob(e,n){var t={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return t[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,n==1?"lpstr":"lpwstr")}function EN(e){return ob(e,1)}function vN(e){return ob(e,2)}var Qg=2,_r=3,Id=11,Gy=12,$d=19;var kd=64,_N=65,CN=71;var yN=4108,wN=4126,An=80,sb=81,bN=[An,sb],DN={1:{n:"CodePage",t:Qg},2:{n:"Category",t:An},3:{n:"PresentationFormat",t:An},4:{n:"ByteCount",t:_r},5:{n:"LineCount",t:_r},6:{n:"ParagraphCount",t:_r},7:{n:"SlideCount",t:_r},8:{n:"NoteCount",t:_r},9:{n:"HiddenCount",t:_r},10:{n:"MultimediaClipCount",t:_r},11:{n:"ScaleCrop",t:Id},12:{n:"HeadingPairs",t:yN},13:{n:"TitlesOfParts",t:wN},14:{n:"Manager",t:An},15:{n:"Company",t:An},16:{n:"LinksUpToDate",t:Id},17:{n:"CharacterCount",t:_r},19:{n:"SharedDoc",t:Id},22:{n:"HyperlinksChanged",t:Id},23:{n:"AppVersion",t:_r,p:"version"},24:{n:"DigSig",t:_N},26:{n:"ContentType",t:An},27:{n:"ContentStatus",t:An},28:{n:"Language",t:An},29:{n:"Version",t:An},255:{},2147483648:{n:"Locale",t:$d},2147483651:{n:"Behavior",t:$d},1919054434:{}},SN={1:{n:"CodePage",t:Qg},2:{n:"Title",t:An},3:{n:"Subject",t:An},4:{n:"Author",t:An},5:{n:"Keywords",t:An},6:{n:"Comments",t:An},7:{n:"Template",t:An},8:{n:"LastAuthor",t:An},9:{n:"RevNumber",t:An},10:{n:"EditTime",t:kd},11:{n:"LastPrinted",t:kd},12:{n:"CreatedDate",t:kd},13:{n:"ModifiedDate",t:kd},14:{n:"PageCount",t:_r},15:{n:"WordCount",t:_r},16:{n:"CharCount",t:_r},17:{n:"Thumbnail",t:CN},18:{n:"Application",t:An},19:{n:"DocSecurity",t:_r},255:{},2147483648:{n:"Locale",t:$d},2147483651:{n:"Behavior",t:$d},1919054434:{}},Qy={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},MN=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function AN(e){return e.map(function(n){return[n>>16&255,n>>8&255,n&255]})}var TN=AN([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),ys=Nn(TN),Os={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},ab={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Xy={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function ON(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IN(e){var n=ON();if(!e||!e.match)return n;var t={};if((e.match(Xn)||[]).forEach(function(r){var i=Ve(r);switch(i[0].replace(L4,"<")){case"<?xml":break;case"<Types":n.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[i.Extension]=i.ContentType;break;case"<Override":n[Xy[i.ContentType]]!==void 0&&n[Xy[i.ContentType]].push(i.PartName);break}}),n.xmlns!==X4.CT)throw new Error("Unknown Namespace: "+n.xmlns);return n.calcchain=n.calcchains.length>0?n.calcchains[0]:"",n.sst=n.strs.length>0?n.strs[0]:"",n.style=n.styles.length>0?n.styles[0]:"",n.defaults=t,delete n.calcchains,n}var to={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Cg(e){var n=e.lastIndexOf("/");return e.slice(0,n+1)+"_rels/"+e.slice(n+1)+".rels"}function cu(e,n){var t={"!id":{}};if(!e)return t;n.charAt(0)!=="/"&&(n="/"+n);var r={};return(e.match(Xn)||[]).forEach(function(i){var o=Ve(i);if(o[0]==="<Relationship"){var s={};s.Type=o.Type,s.Target=o.Target,s.Id=o.Id,o.TargetMode&&(s.TargetMode=o.TargetMode);var a=o.TargetMode==="External"?o.Target:ru(o.Target,n);t[a]=s,r[o.Id]=s}}),t["!id"]=r,t}var kN="application/vnd.oasis.opendocument.spreadsheet";function PN(e,n){for(var t=Bg(e),r,i;r=gu.exec(t);)switch(r[3]){case"manifest":break;case"file-entry":if(i=Ve(r[0],!1),i.path=="/"&&i.type!==kN)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(n&&n.WTF)throw r}}var uu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],FN=function(){for(var e=new Array(uu.length),n=0;n<uu.length;++n){var t=uu[n],r="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[n]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function cb(e){var n={};e=kt(e);for(var t=0;t<uu.length;++t){var r=uu[t],i=e.match(FN[t]);i!=null&&i.length>0&&(n[r[1]]=gt(i[1])),r[2]==="date"&&n[r[1]]&&(n[r[1]]=On(n[r[1]]))}return n}var NN=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function ub(e,n,t,r){var i=[];if(typeof e=="string")i=Vy(e,r);else for(var o=0;o<e.length;++o)i=i.concat(e[o].map(function(h){return{v:h}}));var s=typeof n=="string"?Vy(n,r).map(function(h){return h.v}):n,a=0,c=0;if(s.length>0)for(var d=0;d!==i.length;d+=2){switch(c=+i[d+1].v,i[d].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=s.slice(a,a+c);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":t.NamedRanges=c,t.DefinedNames=s.slice(a,a+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=s.slice(a,a+c);break}a+=c}}function RN(e,n,t){var r={};return n||(n={}),e=kt(e),NN.forEach(function(i){var o=(e.match(mu(i[0]))||[])[1];switch(i[2]){case"string":o&&(n[i[1]]=gt(o));break;case"bool":n[i[1]]=o==="true";break;case"raw":var s=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));s&&s.length>0&&(r[i[1]]=s[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&ub(r.HeadingPairs,r.TitlesOfParts,n,t),n}var BN=/<[^>]+>[^<]*/g;function LN(e,n){var t={},r="",i=e.match(BN);if(i)for(var o=0;o!=i.length;++o){var s=i[o],a=Ve(s);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":r=gt(a.name);break;case"</property>":r=null;break;default:if(s.indexOf("<vt:")===0){var c=s.split(">"),d=c[0].slice(4),h=c[1];switch(d){case"lpstr":case"bstr":case"lpwstr":t[r]=gt(h);break;case"bool":t[r]=Ht(h);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[r]=parseInt(h,10);break;case"r4":case"r8":case"decimal":t[r]=parseFloat(h);break;case"filetime":case"date":t[r]=On(h);break;case"cy":case"error":t[r]=gt(h);break;default:if(d.slice(-1)=="/")break;n.WTF&&typeof console<"u"&&console.warn("Unexpected",s,d,c)}}else if(s.slice(0,2)!=="</"){if(n.WTF)throw new Error(s)}}}return t}var VN={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},dg;function UN(e,n,t){dg||(dg=Fg(VN)),n=dg[n]||n,e[n]=t}function Xg(e){var n=e.read_shift(4),t=e.read_shift(4);return new Date((t/1e7*Math.pow(2,32)+n/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function lb(e,n,t){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-r&3;)++e.l;return i}function db(e,n,t){var r=e.read_shift(0,"lpwstr");return t&&(e.l+=4-(r.length+1&3)&3),r}function fb(e,n,t){return n===31?db(e):lb(e,n,t)}function yg(e,n,t){return fb(e,n,t===!1?0:4)}function jN(e,n){if(!n)throw new Error("VtUnalignedString must have positive length");return fb(e,n,0)}function HN(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r){var i=e.l;t[r]=e.read_shift(0,"lpwstr").replace(zn,""),e.l-i&2&&(e.l+=2)}return t}function $N(e){for(var n=e.read_shift(4),t=[],r=0;r!=n;++r)t[r]=e.read_shift(0,"lpstr-cp").replace(zn,"");return t}function qN(e){var n=e.l,t=qd(e,sb);e[e.l]==0&&e[e.l+1]==0&&e.l-n&2&&(e.l+=2);var r=qd(e,_r);return[t,r]}function WN(e){for(var n=e.read_shift(4),t=[],r=0;r<n/2;++r)t.push(qN(e));return t}function Yy(e,n){for(var t=e.read_shift(4),r={},i=0;i!=t;++i){var o=e.read_shift(4),s=e.read_shift(4);r[o]=e.read_shift(s,n===1200?"utf16le":"utf8").replace(zn,"").replace(nu,"!"),n===1200&&s%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function hb(e){var n=e.read_shift(4),t=e.slice(e.l,e.l+n);return e.l+=n,(n&3)>0&&(e.l+=4-(n&3)&3),t}function zN(e){var n={};return n.Size=e.read_shift(4),e.l+=n.Size+3-(n.Size-1)%4,n}function qd(e,n,t){var r=e.read_shift(2),i,o=t||{};if(e.l+=2,n!==Gy&&r!==n&&bN.indexOf(n)===-1&&!((n&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+n+" saw "+r);switch(n===Gy?r:n){case 2:return i=e.read_shift(2,"i"),o.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return lb(e,r,4).replace(zn,"");case 31:return db(e);case 64:return Xg(e);case 65:return hb(e);case 71:return zN(e);case 80:return yg(e,r,!o.raw).replace(zn,"");case 81:return jN(e,r).replace(zn,"");case 4108:return WN(e);case 4126:case 4127:return r==4127?HN(e):$N(e);default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+r)}}function Ky(e,n){var t=e.l,r=e.read_shift(4),i=e.read_shift(4),o=[],s=0,a=0,c=-1,d={};for(s=0;s!=i;++s){var h=e.read_shift(4),p=e.read_shift(4);o[s]=[h,p+t]}o.sort(function(I,y){return I[1]-y[1]});var g={};for(s=0;s!=i;++s){if(e.l!==o[s][1]){var x=!0;if(s>0&&n)switch(n[o[s-1][0]].t){case 2:e.l+2===o[s][1]&&(e.l+=2,x=!1);break;case 80:e.l<=o[s][1]&&(e.l=o[s][1],x=!1);break;case 4108:e.l<=o[s][1]&&(e.l=o[s][1],x=!1);break}if((!n||s==0)&&e.l<=o[s][1]&&(x=!1,e.l=o[s][1]),x)throw new Error("Read Error: Expected address "+o[s][1]+" at "+e.l+" :"+s)}if(n){var v=n[o[s][0]];if(g[v.n]=qd(e,v.t,{raw:!0}),v.p==="version"&&(g[v.n]=String(g[v.n]>>16)+"."+("0000"+String(g[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(g[v.n]){case 0:g[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:fi(a=g[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+g[v.n])}}else if(o[s][0]===1){if(a=g.CodePage=qd(e,Qg),fi(a),c!==-1){var E=e.l;e.l=o[c][1],d=Yy(e,a),e.l=E}}else if(o[s][0]===0){if(a===0){c=s,e.l=o[s+1][1];continue}d=Yy(e,a)}else{var _=d[o[s][0]],M;switch(e[e.l]){case 65:e.l+=4,M=hb(e);break;case 30:e.l+=4,M=yg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,M=yg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,M=e.read_shift(4,"i");break;case 19:e.l+=4,M=e.read_shift(4);break;case 5:e.l+=4,M=e.read_shift(8,"f");break;case 11:e.l+=4,M=tn(e,4);break;case 64:e.l+=4,M=On(Xg(e));break;default:throw new Error("unparsed value: "+e[e.l])}g[_]=M}}return e.l=t+r,g}function Zy(e,n,t){var r=e.content;if(!r)return{};Fn(r,0);var i,o,s,a,c=0;r.chk("feff","Byte Order: "),r.read_shift(2);var d=r.read_shift(4),h=r.read_shift(16);if(h!==dt.utils.consts.HEADER_CLSID&&h!==t)throw new Error("Bad PropertySet CLSID "+h);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(o=r.read_shift(16),a=r.read_shift(4),i===1&&a!==r.l)throw new Error("Length mismatch: "+a+" !== "+r.l);i===2&&(s=r.read_shift(16),c=r.read_shift(4));var p=Ky(r,n),g={SystemIdentifier:d};for(var x in p)g[x]=p[x];if(g.FMTID=o,i===1)return g;if(c-r.l==2&&(r.l+=2),r.l!==c)throw new Error("Length mismatch 2: "+r.l+" !== "+c);var v;try{v=Ky(r,null)}catch{}for(x in v)g[x]=v[x];return g.FMTID=[o,s],g}function Lo(e,n){return e.read_shift(n),null}function GN(e,n,t){for(var r=[],i=e.l+n;e.l<i;)r.push(t(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}function tn(e,n){return e.read_shift(n)===1}function pn(e){return e.read_shift(2,"u")}function pb(e,n){return GN(e,n,pn)}function QN(e){var n=e.read_shift(1),t=e.read_shift(1);return t===1?n:n===1}function yu(e,n,t){var r=e.read_shift(t&&t.biff>=12?2:1),i="sbcs-cont",o=Ti;if(t&&t.biff>=8&&(Ti=1200),!t||t.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else t.biff==12&&(i="wstr");t.biff>=2&&t.biff<=5&&(i="cpstr");var a=r?e.read_shift(r,i):"";return Ti=o,a}function XN(e){var n=Ti;Ti=1200;var t=e.read_shift(2),r=e.read_shift(1),i=r&4,o=r&8,s=1+(r&1),a=0,c,d={};o&&(a=e.read_shift(2)),i&&(c=e.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,h);return o&&(e.l+=4*a),i&&(e.l+=c),d.t=p,o||(d.raw="<t>"+d.t+"</t>",d.r=d.t),Ti=n,d}function Ds(e,n,t){var r;if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(n,"cpstr");if(t.biff>=12)return e.read_shift(n,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(n,"sbcs-cont"):r=e.read_shift(n,"dbcs-cont"),r}function wu(e,n,t){var r=e.read_shift(t&&t.biff==2?1:2);return r===0?(e.l++,""):Ds(e,r,t)}function Is(e,n,t){if(t.biff>5)return wu(e,n,t);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function YN(e){var n=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[n,t]}function KN(e){var n=e.read_shift(4),t=e.l,r=!1;n>24&&(e.l+=n-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=t);var i=e.read_shift((r?n-24:n)>>1,"utf16le").replace(zn,"");return r&&(e.l+=24),i}function ZN(e){for(var n=e.read_shift(2),t="";n-- >0;)t+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return t+r.replace(/\\/g,"/");var o=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var s=e.read_shift(o>>1,"utf16le").replace(zn,"");return t+s}function JN(e,n){var t=e.read_shift(16);switch(n-=16,t){case"e0c9ea79f9bace118c8200aa004ba90b":return KN(e,n);case"0303000000000000c000000000000046":return ZN(e,n);default:throw new Error("Unsupported Moniker "+t)}}function Pd(e){var n=e.read_shift(4),t=n>0?e.read_shift(n,"utf16le").replace(zn,""):"";return t}function eR(e,n){var t=e.l+n,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var o,s,a,c,d="",h,p;i&16&&(o=Pd(e,t-e.l)),i&128&&(s=Pd(e,t-e.l)),(i&257)===257&&(a=Pd(e,t-e.l)),(i&257)===1&&(c=JN(e,t-e.l)),i&8&&(d=Pd(e,t-e.l)),i&32&&(h=e.read_shift(16)),i&64&&(p=Xg(e)),e.l=t;var g=s||a||c||"";g&&d&&(g+="#"+d),g||(g="#"+d),i&2&&g.charAt(0)=="/"&&g.charAt(1)!="/"&&(g="file://"+g);var x={Target:g};return h&&(x.guid=h),p&&(x.time=p),o&&(x.Tooltip=o),x}function mb(e){var n=e.read_shift(1),t=e.read_shift(1),r=e.read_shift(1),i=e.read_shift(1);return[n,t,r,i]}function gb(e,n){var t=mb(e,n);return t[3]=0,t}function ki(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return{r:n,c:t,ixfe:r}}function tR(e){var n=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:n,flags:t}}function nR(e,n,t){return n===0?"":Is(e,n,t)}function rR(e,n,t){var r=t.biff>8?4:2,i=e.read_shift(r),o=e.read_shift(r,"i"),s=e.read_shift(r,"i");return[i,o,s]}function xb(e){var n=e.read_shift(2),t=Gg(e);return[n,t]}function iR(e,n,t){e.l+=4,n-=4;var r=e.l+n,i=yu(e,n,t),o=e.read_shift(2);if(r-=e.l,o!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+o);return e.l+=o,i}function Zd(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:n},e:{c:i,r:t}}}function Eb(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(1),i=e.read_shift(1);return{s:{c:r,r:n},e:{c:i,r:t}}}var oR=Eb;function vb(e){e.l+=4;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[t,n,r]}function sR(e){var n={};return e.l+=4,e.l+=16,n.fSharedNote=e.read_shift(2),e.l+=4,n}function aR(e){var n={};return e.l+=4,e.cf=e.read_shift(2),n}function Hn(e){e.l+=2,e.l+=e.read_shift(2)}var cR={0:Hn,4:Hn,5:Hn,6:Hn,7:aR,8:Hn,9:Hn,10:Hn,11:Hn,12:Hn,13:sR,14:Hn,15:Hn,16:Hn,17:Hn,18:Hn,19:Hn,20:Hn,21:vb};function uR(e,n){for(var t=e.l+n,r=[];e.l<t;){var i=e.read_shift(2);e.l-=2;try{r.push(cR[i](e,t-e.l))}catch{return e.l=t,r}}return e.l!=t&&(e.l=t),r}function Fd(e,n){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),n-=2,n>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(n>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(n),t}function lR(e,n){return n===0||e.read_shift(2),1200}function dR(e,n,t){if(t.enc)return e.l+=n,"";var r=e.l,i=Is(e,0,t);return e.read_shift(n+r-e.l),i}function fR(e,n,t){var r=t&&t.biff==8||n==2?e.read_shift(2):(e.l+=n,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function hR(e,n,t){var r=e.read_shift(4),i=e.read_shift(1)&3,o=e.read_shift(1);switch(o){case 0:o="Worksheet";break;case 1:o="Macrosheet";break;case 2:o="Chartsheet";break;case 6:o="VBAModule";break}var s=yu(e,0,t);return s.length===0&&(s="Sheet1"),{pos:r,hs:i,dt:o,name:s}}function pR(e,n){for(var t=e.l+n,r=e.read_shift(4),i=e.read_shift(4),o=[],s=0;s!=i&&e.l<t;++s)o.push(XN(e));return o.Count=r,o.Unique=i,o}function mR(e,n){var t={};return t.dsst=e.read_shift(2),e.l+=n-2,t}function gR(e){var n={};n.r=e.read_shift(2),n.c=e.read_shift(2),n.cnt=e.read_shift(2)-n.c;var t=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(n.level=r&7),r&32&&(n.hidden=!0),r&64&&(n.hpt=t/20),n}function xR(e){var n=tR(e);if(n.type!=2211)throw new Error("Invalid Future Record "+n.type);var t=e.read_shift(4);return t!==0}function ER(e){return e.read_shift(2),e.read_shift(4)}function Jy(e,n,t){var r=0;t&&t.biff==2||(r=e.read_shift(2));var i=e.read_shift(2);t&&t.biff==2&&(r=1-(i>>15),i&=32767);var o={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[o,i]}function vR(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),c=e.read_shift(2),d=e.read_shift(2);return{Pos:[n,t],Dim:[r,i],Flags:o,CurTab:s,FirstTab:a,Selected:c,TabRatio:d}}function _R(e,n,t){if(t&&t.biff>=2&&t.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function CR(){}function yR(e,n,t){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=yu(e,0,t),r}function wR(e){var n=ki(e);return n.isst=e.read_shift(4),n}function bR(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=e.l+n,i=ki(e,6);t.biff==2&&e.l++;var o=wu(e,r-e.l,t);return i.val=o,i}function DR(e,n,t){var r=e.read_shift(2),i=Is(e,0,t);return[r,i]}var SR=Is;function ew(e,n,t){var r=e.l+n,i=t.biff==8||!t.biff?4:2,o=e.read_shift(i),s=e.read_shift(i),a=e.read_shift(2),c=e.read_shift(2);return e.l=r,{s:{r:o,c:a},e:{r:s,c}}}function MR(e){var n=e.read_shift(2),t=e.read_shift(2),r=xb(e);return{r:n,c:t,ixfe:r[0],rknum:r[1]}}function AR(e,n){for(var t=e.l+n-2,r=e.read_shift(2),i=e.read_shift(2),o=[];e.l<t;)o.push(xb(e));if(e.l!==t)throw new Error("MulRK read error");var s=e.read_shift(2);if(o.length!=s-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:s,rkrec:o}}function TR(e,n){for(var t=e.l+n-2,r=e.read_shift(2),i=e.read_shift(2),o=[];e.l<t;)o.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var s=e.read_shift(2);if(o.length!=s-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:s,ixfe:o}}function OR(e,n,t,r){var i={},o=e.read_shift(4),s=e.read_shift(4),a=e.read_shift(4),c=e.read_shift(2);return i.patternType=MN[a>>26],r.cellStyles&&(i.alc=o&7,i.fWrap=o>>3&1,i.alcV=o>>4&7,i.fJustLast=o>>7&1,i.trot=o>>8&255,i.cIndent=o>>16&15,i.fShrinkToFit=o>>20&1,i.iReadOrder=o>>22&2,i.fAtrNum=o>>26&1,i.fAtrFnt=o>>27&1,i.fAtrAlc=o>>28&1,i.fAtrBdr=o>>29&1,i.fAtrPat=o>>30&1,i.fAtrProt=o>>31&1,i.dgLeft=s&15,i.dgRight=s>>4&15,i.dgTop=s>>8&15,i.dgBottom=s>>12&15,i.icvLeft=s>>16&127,i.icvRight=s>>23&127,i.grbitDiag=s>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=c&127,i.icvBack=c>>7&127,i.fsxButton=c>>14&1),i}function IR(e,n,t){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,n-=6,r.data=OR(e,n,r.fStyle,t),r}function kR(e){e.l+=4;var n=[e.read_shift(2),e.read_shift(2)];if(n[0]!==0&&n[0]--,n[1]!==0&&n[1]--,n[0]>7||n[1]>7)throw new Error("Bad Gutters: "+n.join("|"));return n}function tw(e,n,t){var r=ki(e,6);(t.biff==2||n==9)&&++e.l;var i=QN(e,2);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function PR(e,n,t){t.biffguess&&t.biff==2&&(t.biff=5);var r=ki(e,6),i=qn(e,8);return r.val=i,r}var nw=nR;function FR(e,n,t){var r=e.l+n,i=e.read_shift(2),o=e.read_shift(2);if(t.sbcch=o,o==1025||o==14849)return[o,i];if(o<1||o>255)throw new Error("Unexpected SupBook type: "+o);for(var s=Ds(e,o),a=[];r>e.l;)a.push(wu(e));return[o,i,s,a]}function rw(e,n,t){var r=e.read_shift(2),i,o={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return t.sbcch===14849&&(i=iR(e,n-2,t)),o.body=i||e.read_shift(n-2),typeof i=="string"&&(o.Name=i),o}var NR=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function iw(e,n,t){var r=e.l+n,i=e.read_shift(2),o=e.read_shift(1),s=e.read_shift(1),a=e.read_shift(t&&t.biff==2?1:2),c=0;(!t||t.biff>=5)&&(t.biff!=5&&(e.l+=2),c=e.read_shift(2),t.biff==5&&(e.l+=2),e.l+=4);var d=Ds(e,s,t);i&32&&(d=NR[d.charCodeAt(0)]);var h=r-e.l;t&&t.biff==2&&--h;var p=r==e.l||a===0||!(h>0)?[]:gB(e,h,t,a);return{chKey:o,Name:d,itab:c,rgce:p}}function _b(e,n,t){if(t.biff<8)return RR(e,n,t);for(var r=[],i=e.l+n,o=e.read_shift(t.biff>8?4:2);o--!==0;)r.push(rR(e,t.biff>8?12:6,t));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function RR(e,n,t){e[e.l+1]==3&&e[e.l]++;var r=yu(e,n,t);return r.charCodeAt(0)==3?r.slice(1):r}function BR(e,n,t){if(t.biff<8){e.l+=n;return}var r=e.read_shift(2),i=e.read_shift(2),o=Ds(e,r,t),s=Ds(e,i,t);return[o,s]}function LR(e,n,t){var r=Eb(e,6);e.l++;var i=e.read_shift(1);return n-=8,[xB(e,n,t),i,r]}function ow(e,n,t){var r=oR(e,6);switch(t.biff){case 2:e.l++,n-=7;break;case 3:case 4:e.l+=2,n-=8;break;default:e.l+=6,n-=12}return[r,pB(e,n,t,r)]}function VR(e){var n=e.read_shift(4)!==0,t=e.read_shift(4)!==0,r=e.read_shift(4);return[n,t,r]}function UR(e,n,t){if(!(t.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),s=e.read_shift(2),a=Is(e,0,t);return t.biff<8&&e.read_shift(1),[{r,c:i},a,s,o]}}function jR(e,n,t){return UR(e,n,t)}function HR(e,n){for(var t=[],r=e.read_shift(2);r--;)t.push(Zd(e,n));return t}function $R(e,n,t){if(t&&t.biff<8)return WR(e,n,t);var r=vb(e,22),i=uR(e,n-22,r[1]);return{cmo:r,ft:i}}var qR={8:function(e,n){var t=e.l+n;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=t,{fmt:r}}};function WR(e,n,t){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,n-=36;var s=[];return s.push((qR[r]||Qn)(e,n,t)),{cmo:[i,r,o],ft:s}}function zR(e,n,t){var r=e.l,i="";try{e.l+=4;var o=(t.lastobj||{cmo:[0,0]}).cmo[1],s;[0,5,7,11,12,14].indexOf(o)==-1?e.l+=6:s=YN(e,6,t);var a=e.read_shift(2);e.read_shift(2),pn(e,2);var c=e.read_shift(2);e.l+=c;for(var d=1;d<e.lens.length-1;++d){if(e.l-r!=e.lens[d])throw new Error("TxO: bad continue record");var h=e[e.l],p=Ds(e,e.lens[d+1]-e.lens[d]-1);if(i+=p,i.length>=(h?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return e.l=r+n,{t:i}}catch{return e.l=r+n,{t:i}}}function GR(e,n){var t=Zd(e,8);e.l+=16;var r=eR(e,n-24);return[t,r]}function QR(e,n){e.read_shift(2);var t=Zd(e,8),r=e.read_shift((n-10)/2,"dbcs-cont");return r=r.replace(zn,""),[t,r]}function XR(e){var n=[0,0],t;return t=e.read_shift(2),n[0]=Qy[t]||t,t=e.read_shift(2),n[1]=Qy[t]||t,n}function YR(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(gb(e,8));return t}function KR(e){for(var n=e.read_shift(2),t=[];n-- >0;)t.push(gb(e,8));return t}function ZR(e){e.l+=2;var n={cxfs:0,crc:0};return n.cxfs=e.read_shift(2),n.crc=e.read_shift(4),n}function Cb(e,n,t){if(!t.cellStyles)return Qn(e,n);var r=t&&t.biff>=12?4:2,i=e.read_shift(r),o=e.read_shift(r),s=e.read_shift(r),a=e.read_shift(r),c=e.read_shift(2);r==2&&(e.l+=2);var d={s:i,e:o,w:s,ixfe:a,flags:c};return(t.biff>=5||!t.biff)&&(d.level=c>>8&7),d}function JR(e,n){var t={};return n<32||(e.l+=16,t.header=qn(e,8),t.footer=qn(e,8),e.l+=2),t}function e5(e,n,t){var r={area:!1};if(t.biff!=5)return e.l+=n,r;var i=e.read_shift(1);return e.l+=3,i&16&&(r.area=!0),r}var t5=ki,n5=pb,r5=wu;function i5(e){var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),i={fmt:n,env:t,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}function o5(e,n,t){t.biffguess&&t.biff==5&&(t.biff=2);var r=ki(e,6);++e.l;var i=Is(e,n-7,t);return r.t="str",r.val=i,r}function s5(e){var n=ki(e,6);++e.l;var t=qn(e,8);return n.t="n",n.val=t,n}function a5(e){var n=ki(e,6);++e.l;var t=e.read_shift(2);return n.t="n",n.val=t,n}function c5(e){var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,"sbcs-cont")}function u5(e,n){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=n-13}function l5(e,n,t){var r=e.l+n,i=ki(e,6),o=e.read_shift(2),s=Ds(e,o,t);return e.l=r,i.t="str",i.val=s,i}var d5=[2,3,48,49,131,139,140,245],sw=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},n=Fg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(a,c){var d=[],h=$o(1);switch(c.type){case"base64":h=di(kr(a));break;case"binary":h=di(a);break;case"buffer":case"array":h=a;break}Fn(h,0);var p=h.read_shift(1),g=!!(p&136),x=!1,v=!1;switch(p){case 2:break;case 3:break;case 48:x=!0,g=!0;break;case 49:x=!0,g=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var E=0,_=521;p==2&&(E=h.read_shift(2)),h.l+=3,p!=2&&(E=h.read_shift(4)),E>1048576&&(E=1e6),p!=2&&(_=h.read_shift(2));var M=h.read_shift(2),I=c.codepage||1252;p!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(I=e[h[h.l]]),h.l+=1,h.l+=2),v&&(h.l+=36);for(var y=[],q={},ee=Math.min(h.length,p==2?521:_-10-(x?264:0)),R=v?32:11;h.l<ee&&h[h.l]!=13;)switch(q={},q.name=wt.utils.decode(I,h.slice(h.l,h.l+R)).replace(/[\u0000\r\n].*$/g,""),h.l+=R,q.type=String.fromCharCode(h.read_shift(1)),p!=2&&!v&&(q.offset=h.read_shift(4)),q.len=h.read_shift(1),p==2&&(q.offset=h.read_shift(2)),q.dec=h.read_shift(1),q.name.length&&y.push(q),p!=2&&(h.l+=v?13:14),q.type){case"B":(!x||q.len!=8)&&c.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+q.name+":"+q.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+q.type)}if(h[h.l]!==13&&(h.l=_-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=_;var k=0,z=0;for(d[0]=[],z=0;z!=y.length;++z)d[0][z]=y[z].name;for(;E-- >0;){if(h[h.l]===42){h.l+=M;continue}for(++h.l,d[++k]=[],z=0,z=0;z!=y.length;++z){var V=h.slice(h.l,h.l+y[z].len);h.l+=y[z].len,Fn(V,0);var re=wt.utils.decode(I,V);switch(y[z].type){case"C":re.trim().length&&(d[k][z]=re.replace(/\s+$/,""));break;case"D":re.length===8?d[k][z]=new Date(+re.slice(0,4),+re.slice(4,6)-1,+re.slice(6,8)):d[k][z]=re;break;case"F":d[k][z]=parseFloat(re.trim());break;case"+":case"I":d[k][z]=v?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(re.trim().toUpperCase()){case"Y":case"T":d[k][z]=!0;break;case"N":case"F":d[k][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+re+"|")}break;case"M":if(!g)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[k][z]="##MEMO##"+(v?parseInt(re.trim(),10):V.read_shift(4));break;case"N":re=re.replace(/\u0000/g,"").trim(),re&&re!="."&&(d[k][z]=+re||0);break;case"@":d[k][z]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":d[k][z]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":d[k][z]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[k][z]=-V.read_shift(-8,"f");break;case"B":if(x&&y[z].len==8){d[k][z]=V.read_shift(8,"f");break}case"G":case"P":V.l+=y[z].len;break;case"0":if(y[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[z].type)}}}if(p!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=y,d}function r(a,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var h=$a(t(a,d),d);return h["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,h}function i(a,c){try{return Wo(r(a,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function s(a,c){var d=c||{};if(+d.codepage>=0&&fi(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=vg(),p=Ag(a,{header:1,raw:!0,cellDates:!0}),g=p[0],x=p.slice(1),v=a["!cols"]||[],E=0,_=0,M=0,I=1;for(E=0;E<g.length;++E){if(((v[E]||{}).DBF||{}).name){g[E]=v[E].DBF.name,++M;continue}if(g[E]!=null){if(++M,typeof g[E]=="number"&&(g[E]=g[E].toString(10)),typeof g[E]!="string")throw new Error("DBF Invalid column name "+g[E]+" |"+typeof g[E]+"|");if(g.indexOf(g[E])!==E){for(_=0;_<1024;++_)if(g.indexOf(g[E]+"_"+_)==-1){g[E]+="_"+_;break}}}}var y=Yt(a["!ref"]),q=[],ee=[],R=[];for(E=0;E<=y.e.c-y.s.c;++E){var k="",z="",V=0,re=[];for(_=0;_<x.length;++_)x[_][E]!=null&&re.push(x[_][E]);if(re.length==0||g[E]==null){q[E]="?";continue}for(_=0;_<re.length;++_){switch(typeof re[_]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=re[_]instanceof Date?"D":"C";break;default:z="C"}V=Math.max(V,String(re[_]).length),k=k&&k!=z?"C":z}V>250&&(V=250),z=((v[E]||{}).DBF||{}).type,z=="C"&&v[E].DBF.len>V&&(V=v[E].DBF.len),k=="B"&&z=="N"&&(k="N",R[E]=v[E].DBF.dec,V=v[E].DBF.len),ee[E]=k=="C"||z=="N"?V:o[k]||0,I+=ee[E],q[E]=k}var ne=h.next(32);for(ne.write_shift(4,318902576),ne.write_shift(4,x.length),ne.write_shift(2,296+32*M),ne.write_shift(2,I),E=0;E<4;++E)ne.write_shift(4,0);for(ne.write_shift(4,0|(+n[Ba]||3)<<8),E=0,_=0;E<g.length;++E)if(g[E]!=null){var W=h.next(32),fe=(g[E].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,fe,"sbcs"),W.write_shift(1,q[E]=="?"?"C":q[E],"sbcs"),W.write_shift(4,_),W.write_shift(1,ee[E]||o[q[E]]||0),W.write_shift(1,R[E]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),_+=ee[E]||o[q[E]]||0}var Pe=h.next(264);for(Pe.write_shift(4,13),E=0;E<65;++E)Pe.write_shift(4,0);for(E=0;E<x.length;++E){var Ee=h.next(I);for(Ee.write_shift(1,0),_=0;_<g.length;++_)if(g[_]!=null)switch(q[_]){case"L":Ee.write_shift(1,x[E][_]==null?63:x[E][_]?84:70);break;case"B":Ee.write_shift(8,x[E][_]||0,"f");break;case"N":var Be="0";for(typeof x[E][_]=="number"&&(Be=x[E][_].toFixed(R[_]||0)),M=0;M<ee[_]-Be.length;++M)Ee.write_shift(1,32);Ee.write_shift(1,Be,"sbcs");break;case"D":x[E][_]?(Ee.write_shift(4,("0000"+x[E][_].getFullYear()).slice(-4),"sbcs"),Ee.write_shift(2,("00"+(x[E][_].getMonth()+1)).slice(-2),"sbcs"),Ee.write_shift(2,("00"+x[E][_].getDate()).slice(-2),"sbcs")):Ee.write_shift(8,"00000000","sbcs");break;case"C":var Oe=String(x[E][_]!=null?x[E][_]:"").slice(0,ee[_]);for(Ee.write_shift(1,Oe,"sbcs"),M=0;M<ee[_]-Oe.length;++M)Ee.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:i,to_sheet:r,from_sheet:s}}(),f5=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},n=new RegExp("\x1BN("+Oi(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(g,x){var v=e[x];return typeof v=="number"?Cy(v):v},r=function(g,x,v){var E=x.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return E==59?g:Cy(E)};e["|"]=254;function i(g,x){switch(x.type){case"base64":return o(kr(g),x);case"binary":return o(g,x);case"buffer":return o(st&&Buffer.isBuffer(g)?g.toString("binary"):Ms(g),x);case"array":return o(bs(g),x)}throw new Error("Unrecognized type "+x.type)}function o(g,x){var v=g.split(/[\n\r]+/),E=-1,_=-1,M=0,I=0,y=[],q=[],ee=null,R={},k=[],z=[],V=[],re=0,ne;for(+x.codepage>=0&&fi(+x.codepage);M!==v.length;++M){re=0;var W=v[M].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(n,t),fe=W.replace(/;;/g,"\0").split(";").map(function(B){return B.replace(/\u0000/g,";")}),Pe=fe[0],Ee;if(W.length>0)switch(Pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":fe[1].charAt(0)=="P"&&q.push(W.slice(3).replace(/;;/g,";"));break;case"C":var Be=!1,Oe=!1,ht=!1,ye=!1,Fe=-1,oe=-1;for(I=1;I<fe.length;++I)switch(fe[I].charAt(0)){case"A":break;case"X":_=parseInt(fe[I].slice(1))-1,Oe=!0;break;case"Y":for(E=parseInt(fe[I].slice(1))-1,Oe||(_=0),ne=y.length;ne<=E;++ne)y[ne]=[];break;case"K":Ee=fe[I].slice(1),Ee.charAt(0)==='"'?Ee=Ee.slice(1,Ee.length-1):Ee==="TRUE"?Ee=!0:Ee==="FALSE"?Ee=!1:isNaN(pi(Ee))?isNaN(La(Ee).getDate())||(Ee=On(Ee)):(Ee=pi(Ee),ee!==null&&Ua(ee)&&(Ee=Yd(Ee))),typeof wt<"u"&&typeof Ee=="string"&&(x||{}).type!="string"&&(x||{}).codepage&&(Ee=wt.utils.decode(x.codepage,Ee)),Be=!0;break;case"E":ye=!0;var F=Na(fe[I].slice(1),{r:E,c:_});y[E][_]=[y[E][_],F];break;case"S":ht=!0,y[E][_]=[y[E][_],"S5S"];break;case"G":break;case"R":Fe=parseInt(fe[I].slice(1))-1;break;case"C":oe=parseInt(fe[I].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}if(Be&&(y[E][_]&&y[E][_].length==2?y[E][_][0]=Ee:y[E][_]=Ee,ee=null),ht){if(ye)throw new Error("SYLK shared formula cannot have own formula");var Z=Fe>-1&&y[Fe][oe];if(!Z||!Z[1])throw new Error("SYLK shared formula cannot find base");y[E][_][1]=Ib(Z[1],{r:E-Fe,c:_-oe})}break;case"F":var L=0;for(I=1;I<fe.length;++I)switch(fe[I].charAt(0)){case"X":_=parseInt(fe[I].slice(1))-1,++L;break;case"Y":for(E=parseInt(fe[I].slice(1))-1,ne=y.length;ne<=E;++ne)y[ne]=[];break;case"M":re=parseInt(fe[I].slice(1))/20;break;case"F":break;case"G":break;case"P":ee=q[parseInt(fe[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=fe[I].slice(1).split(" "),ne=parseInt(V[0],10);ne<=parseInt(V[1],10);++ne)re=parseInt(V[2],10),z[ne-1]=re===0?{hidden:!0}:{wch:re},Va(z[ne-1]);break;case"C":_=parseInt(fe[I].slice(1))-1,z[_]||(z[_]={});break;case"R":E=parseInt(fe[I].slice(1))-1,k[E]||(k[E]={}),re>0?(k[E].hpt=re,k[E].hpx=vu(re)):re===0&&(k[E].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}L<1&&(ee=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+W)}}return k.length>0&&(R["!rows"]=k),z.length>0&&(R["!cols"]=z),x&&x.sheetRows&&(y=y.slice(0,x.sheetRows)),[y,R]}function s(g,x){var v=i(g,x),E=v[0],_=v[1],M=$a(E,x);return Oi(_).forEach(function(I){M[I]=_[I]}),M}function a(g,x){return Wo(s(g,x),x)}function c(g,x,v,E){var _="C;Y"+(v+1)+";X"+(E+1)+";K";switch(g.t){case"n":_+=g.v||0,g.f&&!g.F&&(_+=";E"+Z8(g.f,{r:v,c:E}));break;case"b":_+=g.v?"TRUE":"FALSE";break;case"e":_+=g.w||g.v;break;case"d":_+='"'+(g.w||g.v)+'"';break;case"s":_+='"'+g.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function d(g,x){x.forEach(function(v,E){var _="F;W"+(E+1)+" "+(E+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=zd(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=Gd(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&g.push(_)})}function h(g,x){x.forEach(function(v,E){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*Ab(v.hpx)+";"),_.length>2&&g.push(_+"R"+(E+1))})}function p(g,x){var v=["ID;PWXL;N;E"],E=[],_=Yt(g["!ref"]),M,I=Array.isArray(g),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),g["!cols"]&&d(v,g["!cols"]),g["!rows"]&&h(v,g["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var q=_.s.r;q<=_.e.r;++q)for(var ee=_.s.c;ee<=_.e.c;++ee){var R=Ge({r:q,c:ee});M=I?(g[q]||[])[ee]:g[R],!(!M||M.v==null&&(!M.f||M.F))&&E.push(c(M,g,q,ee,x))}return v.join(y)+y+E.join(y)+y+"E"+y}return{to_workbook:a,to_sheet:s,from_sheet:p}}(),h5=function(){function e(o,s){switch(s.type){case"base64":return n(kr(o),s);case"binary":return n(o,s);case"buffer":return n(st&&Buffer.isBuffer(o)?o.toString("binary"):Ms(o),s);case"array":return n(bs(o),s)}throw new Error("Unrecognized type "+s.type)}function n(o,s){for(var a=o.split(`
`),c=-1,d=-1,h=0,p=[];h!==a.length;++h){if(a[h].trim()==="BOT"){p[++c]=[],d=0;continue}if(!(c<0)){var g=a[h].trim().split(","),x=g[0],v=g[1];++h;for(var E=a[h]||"";(E.match(/["]/g)||[]).length&1&&h<a.length-1;)E+=`
`+a[++h];switch(E=E.trim(),+x){case-1:if(E==="BOT"){p[++c]=[],d=0;continue}else if(E!=="EOD")throw new Error("Unrecognized DIF special command "+E);break;case 0:E==="TRUE"?p[c][d]=!0:E==="FALSE"?p[c][d]=!1:isNaN(pi(v))?isNaN(La(v).getDate())?p[c][d]=v:p[c][d]=On(v):p[c][d]=pi(v),++d;break;case 1:E=E.slice(1,E.length-1),E=E.replace(/""/g,'"'),eu&&E&&E.match(/^=".*"$/)&&(E=E.slice(2,-1)),p[c][d++]=E!==""?E:null;break}if(E==="EOD")break}}return s&&s.sheetRows&&(p=p.slice(0,s.sheetRows)),p}function t(o,s){return $a(e(o,s),s)}function r(o,s){return Wo(t(o,s),s)}var i=function(){var o=function(c,d,h,p,g){c.push(d),c.push(h+","+p),c.push('"'+g.replace(/"/g,'""')+'"')},s=function(c,d,h,p){c.push(d+","+h),c.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(c){var d=[],h=Yt(c["!ref"]),p,g=Array.isArray(c);o(d,"TABLE",0,1,"sheetjs"),o(d,"VECTORS",0,h.e.r-h.s.r+1,""),o(d,"TUPLES",0,h.e.c-h.s.c+1,""),o(d,"DATA",0,0,"");for(var x=h.s.r;x<=h.e.r;++x){s(d,-1,0,"BOT");for(var v=h.s.c;v<=h.e.c;++v){var E=Ge({r:x,c:v});if(p=g?(c[x]||[])[v]:c[E],!p){s(d,1,0,"");continue}switch(p.t){case"n":var _=eu?p.w:p.v;!_&&p.v!=null&&(_=p.v),_==null?eu&&p.f&&!p.F?s(d,1,0,"="+p.f):s(d,1,0,""):s(d,0,_,"V");break;case"b":s(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":s(d,1,0,!eu||isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=Qr(p.z||Ye[14],ar(On(p.v)))),eu?s(d,0,p.w,"V"):s(d,1,0,p.w);break;default:s(d,1,0,"")}}}s(d,-1,0,"EOD");var M=`\r
`,I=d.join(M);return I}}();return{to_workbook:r,to_sheet:t,from_sheet:i}}(),p5=function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function n(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(p,g){for(var x=p.split(`
`),v=-1,E=-1,_=0,M=[];_!==x.length;++_){var I=x[_].trim().split(":");if(I[0]==="cell"){var y=sr(I[1]);if(M.length<=y.r)for(v=M.length;v<=y.r;++v)M[v]||(M[v]=[]);switch(v=y.r,E=y.c,I[2]){case"t":M[v][E]=e(I[3]);break;case"v":M[v][E]=+I[3];break;case"vtf":var q=I[I.length-1];case"vtc":switch(I[3]){case"nl":M[v][E]=!!+I[4];break;default:M[v][E]=+I[4];break}I[2]=="vtf"&&(M[v][E]=[M[v][E],q])}}}return g&&g.sheetRows&&(M=M.slice(0,g.sheetRows)),M}function r(p,g){return $a(t(p,g),g)}function i(p,g){return Wo(r(p,g),g)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var g=[],x=[],v,E="",_=Ha(p["!ref"]),M=Array.isArray(p),I=_.s.r;I<=_.e.r;++I)for(var y=_.s.c;y<=_.e.c;++y)if(E=Ge({r:I,c:y}),v=M?(p[I]||[])[y]:p[E],!(!v||v.v==null||v.t==="z")){switch(x=["cell",E,"t"],v.t){case"s":case"str":x.push(n(v.v));break;case"n":v.f?(x[2]="vtf",x[3]="n",x[4]=v.v,x[5]=n(v.f)):(x[2]="v",x[3]=v.v);break;case"b":x[2]="vt"+(v.f?"f":"c"),x[3]="nl",x[4]=v.v?"1":"0",x[5]=n(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var q=ar(On(v.v));x[2]="vtc",x[3]="nd",x[4]=""+q,x[5]=v.w||Qr(v.z||Ye[14],q);break;case"e":continue}g.push(x.join(":"))}return g.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),g.push("valueformat:1:text-wiki"),g.join(`
`)}function h(p){return[o,s,a,s,d(p),c].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:h}}(),xu=function(){function e(h,p,g,x,v){v.raw?p[g][x]=h:h===""||(h==="TRUE"?p[g][x]=!0:h==="FALSE"?p[g][x]=!1:isNaN(pi(h))?isNaN(La(h).getDate())?p[g][x]=h:p[g][x]=On(h):p[g][x]=pi(h))}function n(h,p){var g=p||{},x=[];if(!h||h.length===0)return x;for(var v=h.split(/[\r\n]/),E=v.length-1;E>=0&&v[E].length===0;)--E;for(var _=10,M=0,I=0;I<=E;++I)M=v[I].indexOf(" "),M==-1?M=v[I].length:M++,_=Math.max(_,M);for(I=0;I<=E;++I){x[I]=[];var y=0;for(e(v[I].slice(0,_).trim(),x,I,y,g),y=1;y<=(v[I].length-_)/10+1;++y)e(v[I].slice(_+(y-1)*10,_+y*10).trim(),x,I,y,g)}return g.sheetRows&&(x=x.slice(0,g.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(h){for(var p={},g=!1,x=0,v=0;x<h.length;++x)(v=h.charCodeAt(x))==34?g=!g:!g&&v in t&&(p[v]=(p[v]||0)+1);v=[];for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&v.push([p[x],x]);if(!v.length){p=r;for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&v.push([p[x],x])}return v.sort(function(E,_){return E[0]-_[0]||r[E[1]]-r[_[1]]}),t[v.pop()[1]]||44}function o(h,p){var g=p||{},x="";gn!=null&&g.dense==null&&(g.dense=gn);var v=g.dense?[]:{},E={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(x=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(x=h.charAt(4),h=h.slice(6)):x=i(h.slice(0,1024)):g&&g.FS?x=g.FS:x=i(h.slice(0,1024));var _=0,M=0,I=0,y=0,q=0,ee=x.charCodeAt(0),R=!1,k=0,z=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var V=g.dateNF!=null?D4(g.dateNF):null;function re(){var ne=h.slice(y,q),W={};if(ne.charAt(0)=='"'&&ne.charAt(ne.length-1)=='"'&&(ne=ne.slice(1,-1).replace(/""/g,'"')),ne.length===0)W.t="z";else if(g.raw)W.t="s",W.v=ne;else if(ne.trim().length===0)W.t="s",W.v=ne;else if(ne.charCodeAt(0)==61)ne.charCodeAt(1)==34&&ne.charCodeAt(ne.length-1)==34?(W.t="s",W.v=ne.slice(2,-1).replace(/""/g,'"')):e6(ne)?(W.t="n",W.f=ne.slice(1)):(W.t="s",W.v=ne);else if(ne=="TRUE")W.t="b",W.v=!0;else if(ne=="FALSE")W.t="b",W.v=!1;else if(!isNaN(I=pi(ne)))W.t="n",g.cellText!==!1&&(W.w=ne),W.v=I;else if(!isNaN(La(ne).getDate())||V&&ne.match(V)){W.z=g.dateNF||Ye[14];var fe=0;V&&ne.match(V)&&(ne=S4(ne,g.dateNF,ne.match(V)||[]),fe=1),g.cellDates?(W.t="d",W.v=On(ne,fe)):(W.t="n",W.v=ar(On(ne,fe))),g.cellText!==!1&&(W.w=Qr(W.z,W.v instanceof Date?ar(W.v):W.v)),g.cellNF||delete W.z}else W.t="s",W.v=ne;if(W.t=="z"||(g.dense?(v[_]||(v[_]=[]),v[_][M]=W):v[Ge({c:M,r:_})]=W),y=q+1,z=h.charCodeAt(y),E.e.c<M&&(E.e.c=M),E.e.r<_&&(E.e.r=_),k==ee)++M;else if(M=0,++_,g.sheetRows&&g.sheetRows<=_)return!0}e:for(;q<h.length;++q)switch(k=h.charCodeAt(q)){case 34:z===34&&(R=!R);break;case ee:case 10:case 13:if(!R&&re())break e;break;default:break}return q-y>0&&re(),v["!ref"]=ft(E),v}function s(h,p){return!(p&&p.PRN)||p.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?o(h,p):$a(n(h,p),p)}function a(h,p){var g="",x=p.type=="string"?[0,0,0,0]:r1(h,p);switch(p.type){case"base64":g=kr(h);break;case"binary":g=h;break;case"buffer":p.codepage==65001?g=h.toString("utf8"):p.codepage&&typeof wt<"u"?g=wt.utils.decode(p.codepage,h):g=st&&Buffer.isBuffer(h)?h.toString("binary"):Ms(h);break;case"array":g=bs(h);break;case"string":g=h;break;default:throw new Error("Unrecognized type "+p.type)}return x[0]==239&&x[1]==187&&x[2]==191?g=kt(g.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?g=kt(g):p.type=="binary"&&typeof wt<"u"&&p.codepage&&(g=wt.utils.decode(p.codepage,wt.utils.encode(28591,g))),g.slice(0,19)=="socialcalc:version:"?p5.to_sheet(p.type=="string"?g:kt(g),p):s(g,p)}function c(h,p){return Wo(a(h,p),p)}function d(h){for(var p=[],g=Yt(h["!ref"]),x,v=Array.isArray(h),E=g.s.r;E<=g.e.r;++E){for(var _=[],M=g.s.c;M<=g.e.c;++M){var I=Ge({r:E,c:M});if(x=v?(h[E]||[])[M]:h[I],!x||x.v==null){_.push("          ");continue}for(var y=(x.w||(oo(x),x.w)||"").slice(0,10);y.length<10;)y+=" ";_.push(y+(M===0?" ":""))}p.push(_.join(""))}return p.join(`
`)}return{to_workbook:c,to_sheet:a,from_sheet:d}}();function m5(e,n){var t=n||{},r=!!t.WTF;t.WTF=!0;try{var i=f5.to_workbook(e,t);return t.WTF=r,i}catch(o){if(t.WTF=r,!o.message.match(/SYLK bad record ID/)&&r)throw o;return xu.to_workbook(e,n)}}var lu=function(){function e(F,Z,L){if(F){Fn(F,F.l||0);for(var B=L.Enum||Fe;F.l<F.length;){var se=F.read_shift(2),De=B[se]||B[65535],Ce=F.read_shift(2),be=F.l+Ce,ce=De.f&&De.f(F,Ce,L);if(F.l=be,Z(ce,De,se))return}}}function n(F,Z){switch(Z.type){case"base64":return t(di(kr(F)),Z);case"binary":return t(di(F),Z);case"buffer":case"array":return t(F,Z)}throw"Unsupported type "+Z.type}function t(F,Z){if(!F)return F;var L=Z||{};gn!=null&&L.dense==null&&(L.dense=gn);var B=L.dense?[]:{},se="Sheet1",De="",Ce=0,be={},ce=[],at=[],P={s:{r:0,c:0},e:{r:0,c:0}},$t=L.sheetRows||0;if(F[2]==0&&(F[3]==8||F[3]==9)&&F.length>=16&&F[14]==5&&F[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(F[2]==2)L.Enum=Fe,e(F,function(we,Kt,Pr){switch(Pr){case 0:L.vers=we,we>=4096&&(L.qpro=!0);break;case 6:P=we;break;case 204:we&&(De=we);break;case 222:De=we;break;case 15:case 51:L.qpro||(we[1].v=we[1].v.slice(1));case 13:case 14:case 16:Pr==14&&(we[2]&112)==112&&(we[2]&15)>1&&(we[2]&15)<15&&(we[1].z=L.dateNF||Ye[14],L.cellDates&&(we[1].t="d",we[1].v=Yd(we[1].v))),L.qpro&&we[3]>Ce&&(B["!ref"]=ft(P),be[se]=B,ce.push(se),B=L.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},Ce=we[3],se=De||"Sheet"+(Ce+1),De="");var mi=L.dense?(B[we[0].r]||[])[we[0].c]:B[Ge(we[0])];if(mi){mi.t=we[1].t,mi.v=we[1].v,we[1].z!=null&&(mi.z=we[1].z),we[1].f!=null&&(mi.f=we[1].f);break}L.dense?(B[we[0].r]||(B[we[0].r]=[]),B[we[0].r][we[0].c]=we[1]):B[Ge(we[0])]=we[1];break;default:}},L);else if(F[2]==26||F[2]==14)L.Enum=oe,F[2]==14&&(L.qpro=!0,F.l=0),e(F,function(we,Kt,Pr){switch(Pr){case 204:se=we;break;case 22:we[1].v=we[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(we[3]>Ce&&(B["!ref"]=ft(P),be[se]=B,ce.push(se),B=L.dense?[]:{},P={s:{r:0,c:0},e:{r:0,c:0}},Ce=we[3],se="Sheet"+(Ce+1)),$t>0&&we[0].r>=$t)break;L.dense?(B[we[0].r]||(B[we[0].r]=[]),B[we[0].r][we[0].c]=we[1]):B[Ge(we[0])]=we[1],P.e.c<we[0].c&&(P.e.c=we[0].c),P.e.r<we[0].r&&(P.e.r=we[0].r);break;case 27:we[14e3]&&(at[we[14e3][0]]=we[14e3][1]);break;case 1537:at[we[0]]=we[1],we[0]==Ce&&(se=we[1]);break;default:break}},L);else throw new Error("Unrecognized LOTUS BOF "+F[2]);if(B["!ref"]=ft(P),be[De||se]=B,ce.push(De||se),!at.length)return{SheetNames:ce,Sheets:be};for(var pt={},Dt=[],it=0;it<at.length;++it)be[ce[it]]?(Dt.push(at[it]||ce[it]),pt[at[it]]=be[at[it]]||be[ce[it]]):(Dt.push(at[it]),pt[at[it]]={"!ref":"A1"});return{SheetNames:Dt,Sheets:pt}}function r(F,Z){var L=Z||{};if(+L.codepage>=0&&fi(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var B=vg(),se=Yt(F["!ref"]),De=Array.isArray(F),Ce=[];li(B,0,o(1030)),li(B,6,c(se));for(var be=Math.min(se.e.r,8191),ce=se.s.r;ce<=be;++ce)for(var at=Rn(ce),P=se.s.c;P<=se.e.c;++P){ce===se.s.r&&(Ce[P]=Cn(P));var $t=Ce[P]+at,pt=De?(F[ce]||[])[P]:F[$t];if(!(!pt||pt.t=="z"))if(pt.t=="n")(pt.v|0)==pt.v&&pt.v>=-32768&&pt.v<=32767?li(B,13,x(ce,P,pt.v)):li(B,14,E(ce,P,pt.v));else{var Dt=oo(pt);li(B,15,p(ce,P,Dt.slice(0,239)))}}return li(B,1),B.end()}function i(F,Z){var L=Z||{};if(+L.codepage>=0&&fi(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var B=vg();li(B,0,s(F));for(var se=0,De=0;se<F.SheetNames.length;++se)(F.Sheets[F.SheetNames[se]]||{})["!ref"]&&li(B,27,ye(F.SheetNames[se],De++));var Ce=0;for(se=0;se<F.SheetNames.length;++se){var be=F.Sheets[F.SheetNames[se]];if(!(!be||!be["!ref"])){for(var ce=Yt(be["!ref"]),at=Array.isArray(be),P=[],$t=Math.min(ce.e.r,8191),pt=ce.s.r;pt<=$t;++pt)for(var Dt=Rn(pt),it=ce.s.c;it<=ce.e.c;++it){pt===ce.s.r&&(P[it]=Cn(it));var we=P[it]+Dt,Kt=at?(be[pt]||[])[it]:be[we];if(!(!Kt||Kt.t=="z"))if(Kt.t=="n")li(B,23,re(pt,it,Ce,Kt.v));else{var Pr=oo(Kt);li(B,22,k(pt,it,Ce,Pr.slice(0,239)))}}++Ce}}return li(B,1),B.end()}function o(F){var Z=mn(2);return Z.write_shift(2,F),Z}function s(F){var Z=mn(26);Z.write_shift(2,4096),Z.write_shift(2,4),Z.write_shift(4,0);for(var L=0,B=0,se=0,De=0;De<F.SheetNames.length;++De){var Ce=F.SheetNames[De],be=F.Sheets[Ce];if(!(!be||!be["!ref"])){++se;var ce=Ha(be["!ref"]);L<ce.e.r&&(L=ce.e.r),B<ce.e.c&&(B=ce.e.c)}}return L>8191&&(L=8191),Z.write_shift(2,L),Z.write_shift(1,se),Z.write_shift(1,B),Z.write_shift(2,0),Z.write_shift(2,0),Z.write_shift(1,1),Z.write_shift(1,2),Z.write_shift(4,0),Z.write_shift(4,0),Z}function a(F,Z,L){var B={s:{c:0,r:0},e:{c:0,r:0}};return Z==8&&L.qpro?(B.s.c=F.read_shift(1),F.l++,B.s.r=F.read_shift(2),B.e.c=F.read_shift(1),F.l++,B.e.r=F.read_shift(2),B):(B.s.c=F.read_shift(2),B.s.r=F.read_shift(2),Z==12&&L.qpro&&(F.l+=2),B.e.c=F.read_shift(2),B.e.r=F.read_shift(2),Z==12&&L.qpro&&(F.l+=2),B.s.c==65535&&(B.s.c=B.e.c=B.s.r=B.e.r=0),B)}function c(F){var Z=mn(8);return Z.write_shift(2,F.s.c),Z.write_shift(2,F.s.r),Z.write_shift(2,F.e.c),Z.write_shift(2,F.e.r),Z}function d(F,Z,L){var B=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(B[0].c=F.read_shift(1),B[3]=F.read_shift(1),B[0].r=F.read_shift(2),F.l+=2):(B[2]=F.read_shift(1),B[0].c=F.read_shift(2),B[0].r=F.read_shift(2)),B}function h(F,Z,L){var B=F.l+Z,se=d(F,Z,L);if(se[1].t="s",L.vers==20768){F.l++;var De=F.read_shift(1);return se[1].v=F.read_shift(De,"utf8"),se}return L.qpro&&F.l++,se[1].v=F.read_shift(B-F.l,"cstr"),se}function p(F,Z,L){var B=mn(7+L.length);B.write_shift(1,255),B.write_shift(2,Z),B.write_shift(2,F),B.write_shift(1,39);for(var se=0;se<B.length;++se){var De=L.charCodeAt(se);B.write_shift(1,De>=128?95:De)}return B.write_shift(1,0),B}function g(F,Z,L){var B=d(F,Z,L);return B[1].v=F.read_shift(2,"i"),B}function x(F,Z,L){var B=mn(7);return B.write_shift(1,255),B.write_shift(2,Z),B.write_shift(2,F),B.write_shift(2,L,"i"),B}function v(F,Z,L){var B=d(F,Z,L);return B[1].v=F.read_shift(8,"f"),B}function E(F,Z,L){var B=mn(13);return B.write_shift(1,255),B.write_shift(2,Z),B.write_shift(2,F),B.write_shift(8,L,"f"),B}function _(F,Z,L){var B=F.l+Z,se=d(F,Z,L);if(se[1].v=F.read_shift(8,"f"),L.qpro)F.l=B;else{var De=F.read_shift(2);q(F.slice(F.l,F.l+De),se),F.l+=De}return se}function M(F,Z,L){var B=Z&32768;return Z&=-32769,Z=(B?F:0)+(Z>=8192?Z-16384:Z),(B?"":"$")+(L?Cn(Z):Rn(Z))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function q(F,Z){Fn(F,0);for(var L=[],B=0,se="",De="",Ce="",be="";F.l<F.length;){var ce=F[F.l++];switch(ce){case 0:L.push(F.read_shift(8,"f"));break;case 1:De=M(Z[0].c,F.read_shift(2),!0),se=M(Z[0].r,F.read_shift(2),!1),L.push(De+se);break;case 2:{var at=M(Z[0].c,F.read_shift(2),!0),P=M(Z[0].r,F.read_shift(2),!1);De=M(Z[0].c,F.read_shift(2),!0),se=M(Z[0].r,F.read_shift(2),!1),L.push(at+P+":"+De+se)}break;case 3:if(F.l<F.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(F.read_shift(2));break;case 6:{for(var $t="";ce=F[F.l++];)$t+=String.fromCharCode(ce);L.push('"'+$t.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:be=L.pop(),Ce=L.pop(),L.push(["AND","OR"][ce-20]+"("+Ce+","+be+")");break;default:if(ce<32&&y[ce])be=L.pop(),Ce=L.pop(),L.push(Ce+y[ce]+be);else if(I[ce]){if(B=I[ce][1],B==69&&(B=F[F.l++]),B>L.length){console.error("WK1 bad formula parse 0x"+ce.toString(16)+":|"+L.join("|")+"|");return}var pt=L.slice(-B);L.length-=B,L.push(I[ce][0]+"("+pt.join(",")+")")}else return ce<=7?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=24?console.error("WK1 unsupported op "+ce.toString(16)):ce<=30?console.error("WK1 invalid opcode "+ce.toString(16)):ce<=115?console.error("WK1 unsupported function opcode "+ce.toString(16)):console.error("WK1 unrecognized opcode "+ce.toString(16))}}L.length==1?Z[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function ee(F){var Z=[{c:0,r:0},{t:"n",v:0},0];return Z[0].r=F.read_shift(2),Z[3]=F[F.l++],Z[0].c=F[F.l++],Z}function R(F,Z){var L=ee(F,Z);return L[1].t="s",L[1].v=F.read_shift(Z-4,"cstr"),L}function k(F,Z,L,B){var se=mn(6+B.length);se.write_shift(2,F),se.write_shift(1,L),se.write_shift(1,Z),se.write_shift(1,39);for(var De=0;De<B.length;++De){var Ce=B.charCodeAt(De);se.write_shift(1,Ce>=128?95:Ce)}return se.write_shift(1,0),se}function z(F,Z){var L=ee(F,Z);L[1].v=F.read_shift(2);var B=L[1].v>>1;if(L[1].v&1)switch(B&7){case 0:B=(B>>3)*5e3;break;case 1:B=(B>>3)*500;break;case 2:B=(B>>3)/20;break;case 3:B=(B>>3)/200;break;case 4:B=(B>>3)/2e3;break;case 5:B=(B>>3)/2e4;break;case 6:B=(B>>3)/16;break;case 7:B=(B>>3)/64;break}return L[1].v=B,L}function V(F,Z){var L=ee(F,Z),B=F.read_shift(4),se=F.read_shift(4),De=F.read_shift(2);if(De==65535)return B===0&&se===3221225472?(L[1].t="e",L[1].v=15):B===0&&se===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var Ce=De&32768;return De=(De&32767)-16446,L[1].v=(1-Ce*2)*(se*Math.pow(2,De+32)+B*Math.pow(2,De)),L}function re(F,Z,L,B){var se=mn(14);if(se.write_shift(2,F),se.write_shift(1,L),se.write_shift(1,Z),B==0)return se.write_shift(4,0),se.write_shift(4,0),se.write_shift(2,65535),se;var De=0,Ce=0,be=0,ce=0;return B<0&&(De=1,B=-B),Ce=Math.log2(B)|0,B/=Math.pow(2,Ce-31),ce=B>>>0,ce&2147483648||(B/=2,++Ce,ce=B>>>0),B-=ce,ce|=2147483648,ce>>>=0,B*=Math.pow(2,32),be=B>>>0,se.write_shift(4,be),se.write_shift(4,ce),Ce+=16383+(De?32768:0),se.write_shift(2,Ce),se}function ne(F,Z){var L=V(F,14);return F.l+=Z-14,L}function W(F,Z){var L=ee(F,Z),B=F.read_shift(4);return L[1].v=B>>6,L}function fe(F,Z){var L=ee(F,Z),B=F.read_shift(8,"f");return L[1].v=B,L}function Pe(F,Z){var L=fe(F,14);return F.l+=Z-10,L}function Ee(F,Z){return F[F.l+Z-1]==0?F.read_shift(Z,"cstr"):""}function Be(F,Z){var L=F[F.l++];L>Z-1&&(L=Z-1);for(var B="";B.length<L;)B+=String.fromCharCode(F[F.l++]);return B}function Oe(F,Z,L){if(!(!L.qpro||Z<21)){var B=F.read_shift(1);F.l+=17,F.l+=1,F.l+=2;var se=F.read_shift(Z-21,"cstr");return[B,se]}}function ht(F,Z){for(var L={},B=F.l+Z;F.l<B;){var se=F.read_shift(2);if(se==14e3){for(L[se]=[0,""],L[se][0]=F.read_shift(2);F[F.l];)L[se][1]+=String.fromCharCode(F[F.l]),F.l++;F.l++}}return L}function ye(F,Z){var L=mn(5+F.length);L.write_shift(2,14e3),L.write_shift(2,Z);for(var B=0;B<F.length;++B){var se=F.charCodeAt(B);L[L.l++]=se>127?95:se}return L[L.l++]=0,L}var Fe={0:{n:"BOF",f:pn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:g},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Ee},222:{n:"SHEETNAMELP",f:Be},65535:{n:""}},oe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:R},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:ne},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ht},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:fe},40:{n:"FORMULA28",f:Pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Ee},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Oe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:n}}();function g5(e){var n={},t=e.match(Xn),r=0,i=!1;if(t)for(;r!=t.length;++r){var o=Ve(t[r]);switch(o[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!o.val)break;case"<shadow>":case"<shadow/>":n.shadow=1;break;case"</shadow>":break;case"<charset":if(o.val=="1")break;n.cp=Tg[parseInt(o.val,10)];break;case"<outline":if(!o.val)break;case"<outline>":case"<outline/>":n.outline=1;break;case"</outline>":break;case"<rFont":n.name=o.val;break;case"<sz":n.sz=o.val;break;case"<strike":if(!o.val)break;case"<strike>":case"<strike/>":n.strike=1;break;case"</strike>":break;case"<u":if(!o.val)break;switch(o.val){case"double":n.uval="double";break;case"singleAccounting":n.uval="single-accounting";break;case"doubleAccounting":n.uval="double-accounting";break}case"<u>":case"<u/>":n.u=1;break;case"</u>":break;case"<b":if(o.val=="0")break;case"<b>":case"<b/>":n.b=1;break;case"</b>":break;case"<i":if(o.val=="0")break;case"<i>":case"<i/>":n.i=1;break;case"</i>":break;case"<color":o.rgb&&(n.color=o.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":n.family=o.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":n.valign=o.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(o[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+o[0])}}return n}var x5=function(){var e=mu("t"),n=mu("rPr");function t(o){var s=o.match(e);if(!s)return{t:"s",v:""};var a={t:"s",v:gt(s[1])},c=o.match(n);return c&&(a.s=g5(c[1])),a}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(s){return s.replace(r,"").split(i).map(t).filter(function(a){return a.v})}}(),E5=function(){var n=/(\r\n|\n)/g;function t(i,o,s){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),o.push('<span style="'+a.join("")+'">'),i.b&&(o.push("<b>"),s.push("</b>")),i.i&&(o.push("<i>"),s.push("</i>")),i.strike&&(o.push("<s>"),s.push("</s>"));var c=i.valign||"";return c=="superscript"||c=="super"?c="sup":c=="subscript"&&(c="sub"),c!=""&&(o.push("<"+c+">"),s.push("</"+c+">")),s.push("</span>"),i}function r(i){var o=[[],i.v,[]];return i.v?(i.s&&t(i.s,o[0],o[2]),o[0].join("")+o[1].replace(n,"<br/>")+o[2].join("")):""}return function(o){return o.map(r).join("")}}(),v5=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,_5=/<(?:\w+:)?r>/,C5=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Yg(e,n){var t=n?n.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=gt(kt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=kt(e),t&&(r.h=Rg(r.t))):e.match(_5)&&(r.r=kt(e),r.t=gt(kt((e.replace(C5,"").match(v5)||[]).join("").replace(Xn,""))),t&&(r.h=E5(x5(r.r)))),r):{t:""}}var y5=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,w5=/<(?:\w+:)?(?:si|sstItem)>/g,b5=/<\/(?:\w+:)?(?:si|sstItem)>/;function D5(e,n){var t=[],r="";if(!e)return t;var i=e.match(y5);if(i){r=i[2].replace(w5,"").split(b5);for(var o=0;o!=r.length;++o){var s=Yg(r[o].trim(),n);s!=null&&(t[t.length]=s)}i=Ve(i[1]),t.Count=i.count,t.Unique=i.uniqueCount}return t}function S5(e){return[e.read_shift(4),e.read_shift(4)]}function M5(e,n){var t=[],r=!1;return so(e,function(o,s,a){switch(a){case 159:t.Count=o[0],t.Unique=o[1];break;case 19:t.push(o);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(s.T,!r||n.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),t}function yb(e){if(typeof wt<"u")return wt.utils.encode(Ba,e);for(var n=[],t=e.split(""),r=0;r<t.length;++r)n[r]=t[r].charCodeAt(0);return n}function io(e,n){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),n>=4&&(e.l+=n-4),t}function A5(e){var n={};return n.id=e.read_shift(0,"lpp4"),n.R=io(e,4),n.U=io(e,4),n.W=io(e,4),n}function T5(e){for(var n=e.read_shift(4),t=e.l+n-4,r={},i=e.read_shift(4),o=[];i-- >0;)o.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=o,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return r}function O5(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(T5(e));return n}function I5(e){var n=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)n.push(e.read_shift(0,"lpp4"));return n}function k5(e){var n={};return e.read_shift(4),e.l+=4,n.id=e.read_shift(0,"lpp4"),n.name=e.read_shift(0,"lpp4"),n.R=io(e,4),n.U=io(e,4),n.W=io(e,4),n}function P5(e){var n=k5(e);if(n.ename=e.read_shift(0,"8lpp4"),n.blksz=e.read_shift(4),n.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return n}function wb(e,n){var t=e.l+n,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,r}function bb(e,n){var t={},r=e.l+n;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,r),e.l=r,t}function F5(e){var n=io(e);switch(n.Minor){case 2:return[n.Minor,N5(e,n)];case 3:return[n.Minor,R5(e,n)];case 4:return[n.Minor,B5(e,n)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+n.Minor)}function N5(e){var n=e.read_shift(4);if((n&63)!=36)throw new Error("EncryptionInfo mismatch");var t=e.read_shift(4),r=wb(e,t),i=bb(e,e.length-e.l);return{t:"Std",h:r,v:i}}function R5(){throw new Error("File is password-protected: ECMA-376 Extensible")}function B5(e){var n=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),r={};return t.replace(Xn,function(o){var s=Ve(o);switch(Ii(s[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":n.forEach(function(a){r[a]=s[a]});break;case"<dataIntegrity":r.encryptedHmacKey=s.encryptedHmacKey,r.encryptedHmacValue=s.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=s.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(s);break;default:throw s[0]}}),r}function L5(e,n){var t={},r=t.EncryptionVersionInfo=io(e,4);if(n-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);t.Flags=e.read_shift(4),n-=4;var i=e.read_shift(4);return n-=4,t.EncryptionHeader=wb(e,i),n-=i,t.EncryptionVerifier=bb(e,n),t}function V5(e){var n={},t=n.EncryptionVersionInfo=io(e,4);if(t.Major!=1||t.Minor!=1)throw"unrecognized version code "+t.Major+" : "+t.Minor;return n.Salt=e.read_shift(16),n.EncryptedVerifier=e.read_shift(16),n.EncryptedVerifierHash=e.read_shift(16),n}function U5(e){var n=0,t,r=yb(e),i=r.length+1,o,s,a,c,d;for(t=$o(i),t[0]=r.length,o=1;o!=i;++o)t[o]=r[o-1];for(o=i-1;o>=0;--o)s=t[o],a=n&16384?1:0,c=n<<1&32767,d=a|c,n=d^s;return n^52811}var Db=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],n=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(s){return(s/2|s*128)&255},i=function(s,a){return r(s^a)},o=function(s){for(var a=n[s.length-1],c=104,d=s.length-1;d>=0;--d)for(var h=s[d],p=0;p!=7;++p)h&64&&(a^=t[c]),h*=2,--c;return a};return function(s){for(var a=yb(s),c=o(a),d=a.length,h=$o(16),p=0;p!=16;++p)h[p]=0;var g,x,v;for((d&1)===1&&(g=c>>8,h[d]=i(e[0],g),--d,g=c&255,x=a[a.length-1],h[d]=i(x,g));d>0;)--d,g=c>>8,h[d]=i(a[d],g),--d,g=c&255,h[d]=i(a[d],g);for(d=15,v=15-a.length;v>0;)g=c>>8,h[d]=i(e[v],g),--d,--v,g=c&255,h[d]=i(a[d],g),--d,--v;return h}}(),j5=function(e,n,t,r,i){i||(i=n),r||(r=Db(e));var o,s;for(o=0;o!=n.length;++o)s=n[o],s^=r[t],s=(s>>5|s<<3)&255,i[o]=s,++t;return[i,t,r]},H5=function(e){var n=0,t=Db(e);return function(r){var i=j5("",r,n,t);return n=i[1],i[0]}};function $5(e,n,t,r){var i={key:pn(e),verificationBytes:pn(e)};return t.password&&(i.verifier=U5(t.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=H5(t.password)),i}function q5(e,n,t){var r=t||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=V5(e,n):r.Data=L5(e,n),r}function W5(e,n,t){var r={Type:t.biff>=8?e.read_shift(2):0};return r.Type?q5(e,n-2,r):$5(e,t.biff>=8?n:n-2,t,r),r}var z5=function(){function e(i,o){switch(o.type){case"base64":return n(kr(i),o);case"binary":return n(i,o);case"buffer":return n(st&&Buffer.isBuffer(i)?i.toString("binary"):Ms(i),o);case"array":return n(bs(i),o)}throw new Error("Unrecognized type "+o.type)}function n(i,o){var s=o||{},a=s.dense?[]:{},c=i.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,p){Array.isArray(a)&&(a[p]=[]);for(var g=/\\\w+\b/g,x=0,v,E=-1;v=g.exec(h);){switch(v[0]){case"\\cell":var _=h.slice(x,g.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++E,_.length){var M={v:_,t:"s"};Array.isArray(a)?a[p][E]=M:a[Ge({r:p,c:E})]=M}break}x=g.lastIndex}E>d.e.c&&(d.e.c=E)}),a["!ref"]=ft(d),a}function t(i,o){return Wo(e(i,o),o)}function r(i){for(var o=["{\\rtf1\\ansi"],s=Yt(i["!ref"]),a,c=Array.isArray(i),d=s.s.r;d<=s.e.r;++d){o.push("\\trowd\\trautofit1");for(var h=s.s.c;h<=s.e.c;++h)o.push("\\cellx"+(h+1));for(o.push("\\pard\\intbl"),h=s.s.c;h<=s.e.c;++h){var p=Ge({r:d,c:h});a=c?(i[d]||[])[h]:i[p],!(!a||a.v==null&&(!a.f||a.F))&&(o.push(" "+(a.w||(oo(a),a.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:t,to_sheet:e,from_sheet:r}}();function G5(e){var n=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(n.slice(0,2),16),parseInt(n.slice(2,4),16),parseInt(n.slice(4,6),16)]}function Eu(e){for(var n=0,t=1;n!=3;++n)t=t*256+(e[n]>255?255:e[n]<0?0:e[n]);return t.toString(16).toUpperCase().slice(1)}function Q5(e){var n=e[0]/255,t=e[1]/255,r=e[2]/255,i=Math.max(n,t,r),o=Math.min(n,t,r),s=i-o;if(s===0)return[0,0,n];var a=0,c=0,d=i+o;switch(c=s/(d>1?2-d:d),i){case n:a=((t-r)/s+6)%6;break;case t:a=(r-n)/s+2;break;case r:a=(n-t)/s+4;break}return[a/6,c,d/2]}function X5(e){var n=e[0],t=e[1],r=e[2],i=t*2*(r<.5?r:1-r),o=r-i/2,s=[o,o,o],a=6*n,c;if(t!==0)switch(a|0){case 0:case 6:c=i*a,s[0]+=i,s[1]+=c;break;case 1:c=i*(2-a),s[0]+=c,s[1]+=i;break;case 2:c=i*(a-2),s[1]+=i,s[2]+=c;break;case 3:c=i*(4-a),s[1]+=c,s[2]+=i;break;case 4:c=i*(a-4),s[2]+=i,s[0]+=c;break;case 5:c=i*(6-a),s[2]+=c,s[0]+=i;break}for(var d=0;d!=3;++d)s[d]=Math.round(s[d]*255);return s}function Wd(e,n){if(n===0)return e;var t=Q5(G5(e));return n<0?t[2]=t[2]*(1+n):t[2]=1-(1-t[2])*(1-n),Eu(X5(t))}var Sb=6,Y5=15,K5=1,or=Sb;function zd(e){return Math.floor((e+Math.round(128/or)/256)*or)}function Gd(e){return Math.floor((e-5)/or*100+.5)/100}function wg(e){return Math.round((e*or+5)/or*256)/256}function fg(e){return wg(Gd(zd(e)))}function Kg(e){var n=Math.abs(e-fg(e)),t=or;if(n>.005)for(or=K5;or<Y5;++or)Math.abs(e-fg(e))<=n&&(n=Math.abs(e-fg(e)),t=or);or=t}function Va(e){e.width?(e.wpx=zd(e.width),e.wch=Gd(e.wpx),e.MDW=or):e.wpx?(e.wch=Gd(e.wpx),e.width=wg(e.wch),e.MDW=or):typeof e.wch=="number"&&(e.width=wg(e.wch),e.wpx=zd(e.width),e.MDW=or),e.customWidth&&delete e.customWidth}var Z5=96,Mb=Z5;function Ab(e){return e*96/Mb}function vu(e){return e*Mb/96}var J5={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function e8(e,n,t,r){n.Borders=[];var i={},o=!1;(e[0].match(Xn)||[]).forEach(function(s){var a=Ve(s);switch(Ii(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=Ht(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=Ht(a.diagonalDown)),n.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in borders")}})}function t8(e,n,t,r){n.Fills=[];var i={},o=!1;(e[0].match(Xn)||[]).forEach(function(s){var a=Ve(s);switch(Ii(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},n.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":n.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in fills")}})}function n8(e,n,t,r){n.Fonts=[];var i={},o=!1;(e[0].match(Xn)||[]).forEach(function(s){var a=Ve(s);switch(Ii(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":n.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=kt(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?Ht(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?Ht(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?Ht(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?Ht(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?Ht(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?Ht(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?Ht(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=Tg[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=Ht(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var c=ys[i.color.index];i.color.index==81&&(c=ys[1]),c||(c=ys[1]),i.color.rgb=c[0].toString(16)+c[1].toString(16)+c[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&t.themeElements&&t.themeElements.clrScheme&&(i.color.rgb=Wd(t.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":o=!0;break;case"</AlternateContent>":o=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":o=!0;break;case"</ext>":o=!1;break;default:if(r&&r.WTF&&!o)throw new Error("unrecognized "+a[0]+" in fonts")}})}function r8(e,n,t){n.NumberFmt=[];for(var r=Oi(Ye),i=0;i<r.length;++i)n.NumberFmt[r[i]]=Ye[r[i]];var o=e[0].match(Xn);if(o)for(i=0;i<o.length;++i){var s=Ve(o[i]);switch(Ii(s[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=gt(kt(s.formatCode)),c=parseInt(s.numFmtId,10);if(n.NumberFmt[c]=a,c>0){if(c>392){for(c=392;c>60&&n.NumberFmt[c]!=null;--c);n.NumberFmt[c]=a}Cs(a,c)}}break;case"</numFmt>":break;default:if(t.WTF)throw new Error("unrecognized "+s[0]+" in numFmts")}}}var Nd=["numFmtId","fillId","fontId","borderId","xfId"],Rd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function i8(e,n,t){n.CellXf=[];var r,i=!1;(e[0].match(Xn)||[]).forEach(function(o){var s=Ve(o),a=0;switch(Ii(s[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=s,delete r[0],a=0;a<Nd.length;++a)r[Nd[a]]&&(r[Nd[a]]=parseInt(r[Nd[a]],10));for(a=0;a<Rd.length;++a)r[Rd[a]]&&(r[Rd[a]]=Ht(r[Rd[a]]));if(n.NumberFmt&&r.numFmtId>392){for(a=392;a>60;--a)if(n.NumberFmt[r.numFmtId]==n.NumberFmt[a]){r.numFmtId=a;break}}n.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var c={};s.vertical&&(c.vertical=s.vertical),s.horizontal&&(c.horizontal=s.horizontal),s.textRotation!=null&&(c.textRotation=s.textRotation),s.indent&&(c.indent=s.indent),s.wrapText&&(c.wrapText=Ht(s.wrapText)),r.alignment=c;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(t&&t.WTF&&!i)throw new Error("unrecognized "+s[0]+" in cellXfs")}})}var o8=function(){var n=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,t=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,o=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,c,d){var h={};if(!a)return h;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=a.match(n))&&r8(p,h,d),(p=a.match(i))&&n8(p,h,c,d),(p=a.match(r))&&t8(p,h,c,d),(p=a.match(o))&&e8(p,h,c,d),(p=a.match(t))&&i8(p,h,d),h}}();function s8(e,n){var t=e.read_shift(2),r=Gn(e,n-2);return[t,r]}function a8(e,n,t){var r={};r.sz=e.read_shift(2)/20;var i=xN(e,2,t);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var o=e.read_shift(2);switch(o===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(r.underline=s);var a=e.read_shift(1);a>0&&(r.family=a);var c=e.read_shift(1);switch(c>0&&(r.charset=c),e.l++,r.color=gN(e,8),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=Gn(e,n-21),r}var c8=Qn;function u8(e,n){var t=e.l+n,r=e.read_shift(2),i=e.read_shift(2);return e.l=t,{ixfe:r,numFmtId:i}}var l8=Qn;function d8(e,n,t){var r={};r.NumberFmt=[];for(var i in Ye)r.NumberFmt[i]=Ye[i];r.CellXf=[],r.Fonts=[];var o=[],s=!1;return so(e,function(c,d,h){switch(h){case 44:r.NumberFmt[c[0]]=c[1],Cs(c[1],c[0]);break;case 43:r.Fonts.push(c),c.color.theme!=null&&n&&n.themeElements&&n.themeElements.clrScheme&&(c.color.rgb=Wd(n.themeElements.clrScheme[c.color.theme].rgb,c.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:o[o.length-1]==617&&r.CellXf.push(c);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:o.push(h),s=!0;break;case 38:o.pop(),s=!1;break;default:if(d.T>0)o.push(h);else if(d.T<0)o.pop();else if(!s||t.WTF&&o[o.length-1]!=37)throw new Error("Unexpected record 0x"+h.toString(16))}}),r}var f8=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function h8(e,n,t){n.themeElements.clrScheme=[];var r={};(e[0].match(Xn)||[]).forEach(function(i){var o=Ve(i);switch(o[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=o.val;break;case"<a:sysClr":r.rgb=o.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":o[0].charAt(1)==="/"?(n.themeElements.clrScheme[f8.indexOf(o[0])]=r,r={}):r.name=o[0].slice(3,o[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+o[0]+" in clrScheme")}})}function p8(){}function m8(){}var g8=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,x8=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,E8=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function v8(e,n,t){n.themeElements={};var r;[["clrScheme",g8,h8],["fontScheme",x8,p8],["fmtScheme",E8,m8]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,n,t)})}var _8=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Tb(e,n){(!e||e.length===0)&&(e=C8());var t,r={};if(!(t=e.match(_8)))throw new Error("themeElements not found in theme");return v8(t[0],r,n),r.raw=e,r}function C8(e,n){if(n&&n.themeXLSX)return n.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var t=[Ww];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',t[t.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',t[t.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',t[t.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function y8(e,n,t){var r=e.l+n,i=e.read_shift(4);if(i!==124226){if(!t.cellStyles){e.l=r;return}var o=e.slice(e.l);e.l=r;var s;try{s=qw(o,{type:"array"})}catch{return}var a=Ir(s,"theme/theme/theme1.xml",!0);if(a)return Tb(a,t)}}function w8(e){return e.read_shift(4)}function b8(e){var n={};switch(n.xclrType=e.read_shift(2),n.nTintShade=e.read_shift(2),n.xclrType){case 0:e.l+=4;break;case 1:n.xclrValue=D8(e,4);break;case 2:n.xclrValue=mb(e,4);break;case 3:n.xclrValue=w8(e,4);break;case 4:e.l+=4;break}return e.l+=8,n}function D8(e,n){return Qn(e,n)}function S8(e,n){return Qn(e,n)}function M8(e){var n=e.read_shift(2),t=e.read_shift(2)-4,r=[n];switch(n){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=b8(e,t);break;case 6:r[1]=S8(e,t);break;case 14:case 15:r[1]=e.read_shift(t===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+n+" "+t)}return r}function A8(e,n){var t=e.l+n;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),o=[];i-- >0;)o.push(M8(e,t-e.l));return{ixfe:r,ext:o}}function T8(e,n){n.forEach(function(t){switch(t[0]){case 4:break;case 5:break;case 6:break;case 7:break;case 8:break;case 9:break;case 10:break;case 11:break;case 13:break;case 14:break;case 15:break}})}function O8(e,n){return{flags:e.read_shift(4),version:e.read_shift(4),name:Gn(e,n-8)}}function I8(e){for(var n=[],t=e.read_shift(4);t-- >0;)n.push([e.read_shift(4),e.read_shift(4)]);return n}function k8(e){return e.l+=4,e.read_shift(4)!=0}function P8(e,n,t){var r={Types:[],Cell:[],Value:[]},i=t||{},o=[],s=!1,a=2;return so(e,function(c,d,h){switch(h){case 335:r.Types.push({name:c.name});break;case 51:c.forEach(function(p){a==1?r.Cell.push({type:r.Types[p[0]-1].name,index:p[1]}):a==0&&r.Value.push({type:r.Types[p[0]-1].name,index:p[1]})});break;case 337:a=c?1:0;break;case 338:a=2;break;case 35:o.push(h),s=!0;break;case 36:o.pop(),s=!1;break;default:if(!d.T){if(!s||i.WTF&&o[o.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function F8(e,n,t){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i=!1,o=2,s;return e.replace(Xn,function(a){var c=Ve(a);switch(Ii(c[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:c.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<r.Types.length;++d)r.Types[d].name==c.name&&(s=r.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":o==1?r.Cell.push({type:r.Types[c.t-1].name,index:+c.v}):o==0&&r.Value.push({type:r.Types[c.t-1].name,index:+c.v});break;case"</rc>":break;case"<cellMetadata":o=1;break;case"</cellMetadata>":o=2;break;case"<valueMetadata":o=0;break;case"</valueMetadata>":o=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!s)break;s.offsets||(s.offsets=[]),s.offsets.push(+c.i);break;default:if(!i&&t.WTF)throw new Error("unrecognized "+c[0]+" in metadata")}return a}),r}function N8(e){var n=[];if(!e)return n;var t=1;return(e.match(Xn)||[]).forEach(function(r){var i=Ve(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?t=i.i:i.i=t,n.push(i);break}}),n}function R8(e){var n={};n.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),n.r=Ge(t);var r=e.read_shift(1);return r&2&&(n.l="1"),r&8&&(n.a="1"),n}function B8(e,n,t){var r=[],i=!1;return so(e,function(s,a,c){switch(c){case 63:r.push(s);break;default:if(!a.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function L8(e,n,t,r){if(!e)return e;var i=r||{},o=!1,s=!1;so(e,function(c,d,h){if(!s)switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:o=!0;break;case 36:o=!1;break;default:if(!d.T){if(!o||i.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},i)}function V8(e,n){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return n["!id"][t].Target}function aw(e,n,t,r){var i=Array.isArray(e),o;n.forEach(function(s){var a=sr(s.ref);if(i?(e[a.r]||(e[a.r]=[]),o=e[a.r][a.c]):o=e[s.ref],!o){o={t:"z"},i?e[a.r][a.c]=o:e[s.ref]=o;var c=Yt(e["!ref"]||"BDWGO1000001:A1");c.s.r>a.r&&(c.s.r=a.r),c.e.r<a.r&&(c.e.r=a.r),c.s.c>a.c&&(c.s.c=a.c),c.e.c<a.c&&(c.e.c=a.c);var d=ft(c);d!==e["!ref"]&&(e["!ref"]=d)}o.c||(o.c=[]);var h={a:s.author,t:s.t,r:s.r,T:t};s.h&&(h.h=s.h);for(var p=o.c.length-1;p>=0;--p){if(!t&&o.c[p].T)return;t&&!o.c[p].T&&o.c.splice(p,1)}if(t&&r){for(p=0;p<r.length;++p)if(h.a==r[p].id){h.a=r[p].name||h.a;break}}o.c.push(h)})}function U8(e,n){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(s){if(!(s===""||s.trim()==="")){var a=s.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&t.push(a[1])}});var o=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return o&&o[1]&&o[1].split(/<\/\w*:?comment>/).forEach(function(s){if(!(s===""||s.trim()==="")){var a=s.match(/<(?:\w+:)?comment[^>]*>/);if(a){var c=Ve(a[0]),d={author:c.authorId&&t[c.authorId]||"sheetjsghost",ref:c.ref,guid:c.guid},h=sr(c.ref);if(!(n.sheetRows&&n.sheetRows<=h.r)){var p=s.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),g=!!p&&!!p[1]&&Yg(p[1])||{r:"",t:"",h:""};d.r=g.r,g.r=="<t></t>"&&(g.t=g.h=""),d.t=(g.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),n.cellHTML&&(d.h=g.h),r.push(d)}}}}),r}function j8(e,n){var t=[],r=!1,i={},o=0;return e.replace(Xn,function(a,c){var d=Ve(a);switch(Ii(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":i.t!=null&&t.push(i);break;case"<text>":case"<text":o=c+a.length;break;case"</text>":i.t=e.slice(o,c).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return a}),t}function H8(e,n){var t=[],r=!1;return e.replace(Xn,function(o){var s=Ve(o);switch(Ii(s[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":t.push({name:s.displayname,id:s.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&n.WTF)throw new Error("unrecognized "+s[0]+" in threaded comments")}return o}),t}function $8(e){var n={};n.iauthor=e.read_shift(4);var t=Ts(e,16);return n.rfx=t.s,n.ref=Ge(t.s),e.l+=16,n}var q8=Gn;function W8(e,n){var t=[],r=[],i={},o=!1;return so(e,function(a,c,d){switch(d){case 632:r.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,n.sheetRows&&i.rfx&&n.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,t.push(i);break;case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!c.T){if(!o||n.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),t}var z8="application/vnd.ms-office.vbaProject";function G8(e){var n=dt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,r){if(!(t.slice(-1)==="/"||!t.match(/_VBA_PROJECT_CUR/))){var i=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");dt.utils.cfb_add(n,i,e.FileIndex[r].content)}}),dt.write(n)}function Q8(){return{"!type":"dialog"}}function X8(){return{"!type":"dialog"}}function Y8(){return{"!type":"macro"}}function K8(){return{"!type":"macro"}}var Na=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,n={r:0,c:0};function t(r,i,o,s){var a=!1,c=!1;o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1)),s.length==0?a=!0:s.charAt(0)=="["&&(a=!0,s=s.slice(1,-1));var d=o.length>0?parseInt(o,10)|0:0,h=s.length>0?parseInt(s,10)|0:0;return a?h+=n.c:--h,c?d+=n.r:--d,i+(a?"":"$")+Cn(h)+(c?"":"$")+Rn(d)}return function(i,o){return n=o,i.replace(e,t)}}(),Ob=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Z8=function(){return function(n,t){return n.replace(Ob,function(r,i,o,s,a,c){var d=qg(s)-(o?0:t.c),h=$g(c)-(a?0:t.r),p=h==0?"":a?h+1:"["+h+"]",g=d==0?"":o?d+1:"["+d+"]";return i+"R"+p+"C"+g})}}();function Ib(e,n){return e.replace(Ob,function(t,r,i,o,s,a){return r+(i=="$"?i+o:Cn(qg(o)+n.c))+(s=="$"?s+a:Rn($g(a)+n.r))})}function J8(e,n,t){var r=Ha(n),i=r.s,o=sr(t),s={r:o.r-i.r,c:o.c-i.c};return Ib(e,s)}function e6(e){return e.length!=1}function cw(e){return e.replace(/_xlfn\./g,"")}function fn(e){e.l+=1}function qo(e,n){var t=e.read_shift(n==1?1:2);return[t&16383,t>>14&1,t>>15&1]}function kb(e,n,t){var r=2;if(t){if(t.biff>=2&&t.biff<=5)return Pb(e,n,t);t.biff==12&&(r=4)}var i=e.read_shift(r),o=e.read_shift(r),s=qo(e,2),a=qo(e,2);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:o,c:a[0],cRel:a[1],rRel:a[2]}}}function Pb(e){var n=qo(e,2),t=qo(e,2),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:n[0],c:r,cRel:n[1],rRel:n[2]},e:{r:t[0],c:i,cRel:t[1],rRel:t[2]}}}function t6(e,n,t){if(t.biff<8)return Pb(e,n,t);var r=e.read_shift(t.biff==12?4:2),i=e.read_shift(t.biff==12?4:2),o=qo(e,2),s=qo(e,2);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function Fb(e,n,t){if(t&&t.biff>=2&&t.biff<=5)return n6(e,n,t);var r=e.read_shift(t&&t.biff==12?4:2),i=qo(e,2);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function n6(e){var n=qo(e,2),t=e.read_shift(1);return{r:n[0],c:t,cRel:n[1],rRel:n[2]}}function r6(e){var n=e.read_shift(2),t=e.read_shift(2);return{r:n,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function i6(e,n,t){var r=t&&t.biff?t.biff:8;if(r>=2&&r<=5)return o6(e,n,t);var i=e.read_shift(r>=12?4:2),o=e.read_shift(2),s=(o&16384)>>14,a=(o&32768)>>15;if(o&=16383,a==1)for(;i>524287;)i-=1048576;if(s==1)for(;o>8191;)o=o-16384;return{r:i,c:o,cRel:s,rRel:a}}function o6(e){var n=e.read_shift(2),t=e.read_shift(1),r=(n&32768)>>15,i=(n&16384)>>14;return n&=16383,r==1&&n>=8192&&(n=n-16384),i==1&&t>=128&&(t=t-256),{r:n,c:t,cRel:i,rRel:r}}function s6(e,n,t){var r=(e[e.l++]&96)>>5,i=kb(e,t.biff>=2&&t.biff<=5?6:8,t);return[r,i]}function a6(e,n,t){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}var s=kb(e,o,t);return[r,i,s]}function c6(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[r]}function u6(e,n,t){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),o=8;if(t)switch(t.biff){case 5:e.l+=12,o=6;break;case 12:o=12;break}return e.l+=o,[r,i]}function l6(e,n,t){var r=(e[e.l++]&96)>>5,i=t6(e,n-1,t);return[r,i]}function d6(e,n,t){var r=(e[e.l++]&96)>>5;return e.l+=t.biff==2?6:t.biff==12?14:7,[r]}function uw(e){var n=e[e.l+1]&1,t=1;return e.l+=4,[n,t]}function f6(e,n,t){e.l+=2;for(var r=e.read_shift(t&&t.biff==2?1:2),i=[],o=0;o<=r;++o)i.push(e.read_shift(t&&t.biff==2?1:2));return i}function h6(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function p6(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(t&&t.biff==2?1:2)]}function m6(e){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(2)]}function g6(e,n,t){var r=e[e.l+1]&255?1:0;return e.l+=t&&t.biff==2?3:4,[r]}function Nb(e){var n=e.read_shift(1),t=e.read_shift(1);return[n,t]}function x6(e){return e.read_shift(2),Nb(e,2)}function E6(e){return e.read_shift(2),Nb(e,2)}function v6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=Fb(e,0,t);return[r,i]}function _6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=i6(e,0,t);return[r,i]}function C6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);t&&t.biff==5&&(e.l+=12);var o=Fb(e,0,t);return[r,i,o]}function y6(e,n,t){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(t&&t.biff<=3?1:2);return[wB[i],Lb[i],r]}function w6(e,n,t){var r=e[e.l++],i=e.read_shift(1),o=t&&t.biff<=3?[r==88?-1:0,e.read_shift(1)]:b6(e);return[i,(o[0]===0?Lb:yB)[o[1]]]}function b6(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function D6(e,n,t){e.l+=t&&t.biff==2?3:4}function S6(e,n,t){if(e.l++,t&&t.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(t&&t.biff==2?1:2);return[r,i]}function M6(e){return e.l++,Os[e.read_shift(1)]}function A6(e){return e.l++,e.read_shift(2)}function T6(e){return e.l++,e.read_shift(1)!==0}function O6(e){return e.l++,qn(e,8)}function I6(e,n,t){return e.l++,yu(e,n-1,t)}function k6(e,n){var t=[e.read_shift(1)];if(n==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=tn(e,1)?"TRUE":"FALSE",n!=12&&(e.l+=7);break;case 37:case 16:t[1]=Os[e[e.l]],e.l+=n==12?4:8;break;case 0:e.l+=8;break;case 1:t[1]=qn(e,8);break;case 2:t[1]=Is(e,0,{biff:n>0&&n<8?2:n});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function P6(e,n,t){for(var r=e.read_shift(t.biff==12?4:2),i=[],o=0;o!=r;++o)i.push((t.biff==12?Ts:Zd)(e,8));return i}function F6(e,n,t){var r=0,i=0;t.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--r,--i==0&&(i=256));for(var o=0,s=[];o!=r&&(s[o]=[]);++o)for(var a=0;a!=i;++a)s[o][a]=k6(e,t.biff);return s}function N6(e,n,t){var r=e.read_shift(1)>>>5&3,i=!t||t.biff>=8?4:2,o=e.read_shift(i);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,o]}function R6(e,n,t){if(t.biff==5)return B6(e,n,t);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),o=e.read_shift(4);return[r,i,o]}function B6(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[n,t,r]}function L6(e,n,t){var r=e.read_shift(1)>>>5&3;e.l+=t&&t.biff==2?3:4;var i=e.read_shift(t&&t.biff==2?1:2);return[r,i]}function V6(e,n,t){var r=e.read_shift(1)>>>5&3,i=e.read_shift(t&&t.biff==2?1:2);return[r,i]}function U6(e,n,t){var r=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,t.biff==12&&(e.l+=2),[r]}function j6(e,n,t){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),o=4;if(t)switch(t.biff){case 5:o=15;break;case 12:o=6;break}return e.l+=o,[r,i]}var H6=Qn,$6=Qn,q6=Qn;function bu(e,n,t){return e.l+=2,[r6(e,4,t)]}function Zg(e){return e.l+=6,[]}var W6=bu,z6=Zg,G6=Zg,Q6=bu;function Rb(e){return e.l+=2,[pn(e),e.read_shift(2)&1]}var X6=bu,Y6=Rb,K6=Zg,Z6=bu,J6=bu,eB=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function tB(e){e.l+=2;var n=e.read_shift(2),t=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),o=e.read_shift(2),s=eB[t>>2&31];return{ixti:n,coltype:t&3,rt:s,idx:r,c:i,C:o}}function nB(e){return e.l+=2,[e.read_shift(4)]}function rB(e,n,t){return e.l+=5,e.l+=2,e.l+=t.biff==2?1:4,["PTGSHEET"]}function iB(e,n,t){return e.l+=t.biff==2?4:5,["PTGENDSHEET"]}function oB(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function sB(e){var n=e.read_shift(1)>>>5&3,t=e.read_shift(2);return[n,t]}function aB(e){return e.l+=4,[0,0]}var lw={1:{n:"PtgExp",f:S6},2:{n:"PtgTbl",f:q6},3:{n:"PtgAdd",f:fn},4:{n:"PtgSub",f:fn},5:{n:"PtgMul",f:fn},6:{n:"PtgDiv",f:fn},7:{n:"PtgPower",f:fn},8:{n:"PtgConcat",f:fn},9:{n:"PtgLt",f:fn},10:{n:"PtgLe",f:fn},11:{n:"PtgEq",f:fn},12:{n:"PtgGe",f:fn},13:{n:"PtgGt",f:fn},14:{n:"PtgNe",f:fn},15:{n:"PtgIsect",f:fn},16:{n:"PtgUnion",f:fn},17:{n:"PtgRange",f:fn},18:{n:"PtgUplus",f:fn},19:{n:"PtgUminus",f:fn},20:{n:"PtgPercent",f:fn},21:{n:"PtgParen",f:fn},22:{n:"PtgMissArg",f:fn},23:{n:"PtgStr",f:I6},26:{n:"PtgSheet",f:rB},27:{n:"PtgEndSheet",f:iB},28:{n:"PtgErr",f:M6},29:{n:"PtgBool",f:T6},30:{n:"PtgInt",f:A6},31:{n:"PtgNum",f:O6},32:{n:"PtgArray",f:d6},33:{n:"PtgFunc",f:y6},34:{n:"PtgFuncVar",f:w6},35:{n:"PtgName",f:N6},36:{n:"PtgRef",f:v6},37:{n:"PtgArea",f:s6},38:{n:"PtgMemArea",f:L6},39:{n:"PtgMemErr",f:H6},40:{n:"PtgMemNoMem",f:$6},41:{n:"PtgMemFunc",f:V6},42:{n:"PtgRefErr",f:U6},43:{n:"PtgAreaErr",f:c6},44:{n:"PtgRefN",f:_6},45:{n:"PtgAreaN",f:l6},46:{n:"PtgMemAreaN",f:oB},47:{n:"PtgMemNoMemN",f:sB},57:{n:"PtgNameX",f:R6},58:{n:"PtgRef3d",f:C6},59:{n:"PtgArea3d",f:a6},60:{n:"PtgRefErr3d",f:j6},61:{n:"PtgAreaErr3d",f:u6},255:{}},cB={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},uB={1:{n:"PtgElfLel",f:Rb},2:{n:"PtgElfRw",f:Z6},3:{n:"PtgElfCol",f:W6},6:{n:"PtgElfRwV",f:J6},7:{n:"PtgElfColV",f:Q6},10:{n:"PtgElfRadical",f:X6},11:{n:"PtgElfRadicalS",f:K6},13:{n:"PtgElfColS",f:z6},15:{n:"PtgElfColSV",f:G6},16:{n:"PtgElfRadicalLel",f:Y6},25:{n:"PtgList",f:tB},29:{n:"PtgSxName",f:nB},255:{}},lB={0:{n:"PtgAttrNoop",f:aB},1:{n:"PtgAttrSemi",f:g6},2:{n:"PtgAttrIf",f:p6},4:{n:"PtgAttrChoose",f:f6},8:{n:"PtgAttrGoto",f:h6},16:{n:"PtgAttrSum",f:D6},32:{n:"PtgAttrBaxcel",f:uw},33:{n:"PtgAttrBaxcel",f:uw},64:{n:"PtgAttrSpace",f:x6},65:{n:"PtgAttrSpaceSemi",f:E6},128:{n:"PtgAttrIfError",f:m6},255:{}};function Du(e,n,t,r){if(r.biff<8)return Qn(e,n);for(var i=e.l+n,o=[],s=0;s!==t.length;++s)switch(t[s][0]){case"PtgArray":t[s][1]=F6(e,0,r),o.push(t[s][1]);break;case"PtgMemArea":t[s][2]=P6(e,t[s][1],r),o.push(t[s][2]);break;case"PtgExp":r&&r.biff==12&&(t[s][1][1]=e.read_shift(4),o.push(t[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[s][0];default:break}return n=i-e.l,n!==0&&o.push(Qn(e,n)),o}function Su(e,n,t){for(var r=e.l+n,i,o,s=[];r!=e.l;)n=r-e.l,o=e[e.l],i=lw[o]||lw[cB[o]],(o===24||o===25)&&(i=(o===24?uB:lB)[e[e.l+1]]),!i||!i.f?Qn(e,n):s.push([i.n,i.f(e,n,t)]);return s}function dB(e){for(var n=[],t=0;t<e.length;++t){for(var r=e[t],i=[],o=0;o<r.length;++o){var s=r[o];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}n.push(i.join(","))}return n.join(";")}var fB={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function hB(e,n){if(!e&&!(n&&n.biff<=5&&n.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Bb(e,n,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[n]))return e.SheetNames[n];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[n];if(t.biff<8)return n>1e4&&(n-=65536),n<0&&(n=-n),n==0?"":e.XTI[n-1];if(!r)return"SH33TJSERR1";var i="";if(t.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return t.SID!=null?e.SheetNames[t.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function dw(e,n,t){var r=Bb(e,n,t);return r=="#REF"?r:hB(r,t)}function $n(e,n,t,r,i){var o=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},a=[],c,d,h,p=0,g=0,x,v="";if(!e[0]||!e[0][0])return"";for(var E=-1,_="",M=0,I=e[0].length;M<I;++M){var y=e[0][M];switch(y[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=a.pop(),d=a.pop(),E>=0){switch(e[0][E][1][0]){case 0:_=Xt(" ",e[0][E][1][1]);break;case 1:_=Xt("\r",e[0][E][1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}d=d+_,E=-1}a.push(d+fB[y[0]]+c);break;case"PtgIsect":c=a.pop(),d=a.pop(),a.push(d+" "+c);break;case"PtgUnion":c=a.pop(),d=a.pop(),a.push(d+","+c);break;case"PtgRange":c=a.pop(),d=a.pop(),a.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=su(y[1][1],s,i),a.push(au(h,o));break;case"PtgRefN":h=t?su(y[1][1],t,i):y[1][1],a.push(au(h,o));break;case"PtgRef3d":p=y[1][1],h=su(y[1][2],s,i),v=dw(r,p,i);var q=v;a.push(v+"!"+au(h,o));break;case"PtgFunc":case"PtgFuncVar":var ee=y[1][0],R=y[1][1];ee||(ee=0),ee&=127;var k=ee==0?[]:a.slice(-ee);a.length-=ee,R==="User"&&(R=k.shift()),a.push(R+"("+k.join(",")+")");break;case"PtgBool":a.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(y[1]);break;case"PtgNum":a.push(String(y[1]));break;case"PtgStr":a.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(y[1]);break;case"PtgAreaN":x=Wy(y[1][1],t?{s:t}:s,i),a.push(lg(x,i));break;case"PtgArea":x=Wy(y[1][1],s,i),a.push(lg(x,i));break;case"PtgArea3d":p=y[1][1],x=y[1][2],v=dw(r,p,i),a.push(v+"!"+lg(x,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":g=y[1][2];var z=(r.names||[])[g-1]||(r[0]||[])[g],V=z?z.Name:"SH33TJSNAME"+String(g);V&&V.slice(0,6)=="_xlfn."&&!i.xlfn&&(V=V.slice(6)),a.push(V);break;case"PtgNameX":var re=y[1][1];g=y[1][2];var ne;if(i.biff<=5)re<0&&(re=-re),r[re]&&(ne=r[re][g]);else{var W="";if(((r[re]||[])[0]||[])[0]==14849||(((r[re]||[])[0]||[])[0]==1025?r[re][g]&&r[re][g].itab>0&&(W=r.SheetNames[r[re][g].itab-1]+"!"):W=r.SheetNames[g-1]+"!"),r[re]&&r[re][g])W+=r[re][g].Name;else if(r[0]&&r[0][g])W+=r[0][g].Name;else{var fe=(Bb(r,re,i)||"").split(";;");fe[g-1]?W=fe[g-1]:W+="SH33TJSERRX"}a.push(W);break}ne||(ne={Name:"SH33TJSERRY"}),a.push(ne.Name);break;case"PtgParen":var Pe="(",Ee=")";if(E>=0){switch(_="",e[0][E][1][0]){case 2:Pe=Xt(" ",e[0][E][1][1])+Pe;break;case 3:Pe=Xt("\r",e[0][E][1][1])+Pe;break;case 4:Ee=Xt(" ",e[0][E][1][1])+Ee;break;case 5:Ee=Xt("\r",e[0][E][1][1])+Ee;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][E][1][0])}E=-1}a.push(Pe+a.pop()+Ee);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":h={c:y[1][1],r:y[1][0]};var Be={c:t.c,r:t.r};if(r.sharedf[Ge(h)]){var Oe=r.sharedf[Ge(h)];a.push($n(Oe,s,Be,r,i))}else{var ht=!1;for(c=0;c!=r.arrayf.length;++c)if(d=r.arrayf[c],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){a.push($n(d[1],s,Be,r,i)),ht=!0;break}ht||a.push(y[1])}break;case"PtgArray":a.push("{"+dB(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":E=M;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ye=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&E>=0&&ye.indexOf(e[0][M][0])==-1){y=e[0][E];var Fe=!0;switch(y[1][0]){case 4:Fe=!1;case 0:_=Xt(" ",y[1][1]);break;case 5:Fe=!1;case 1:_=Xt("\r",y[1][1]);break;default:if(_="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}a.push((Fe?_:"")+a.pop()+(Fe?"":_)),E=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function pB(e,n,t){var r=e.l+n,i=t.biff==2?1:2,o,s=e.read_shift(i);if(s==65535)return[[],Qn(e,n-2)];var a=Su(e,s,t);return n!==s+i&&(o=Du(e,n-s-i,a,t)),e.l=r,[a,o]}function mB(e,n,t){var r=e.l+n,i=t.biff==2?1:2,o,s=e.read_shift(i);if(s==65535)return[[],Qn(e,n-2)];var a=Su(e,s,t);return n!==s+i&&(o=Du(e,n-s-i,a,t)),e.l=r,[a,o]}function gB(e,n,t,r){var i=e.l+n,o=Su(e,r,t),s;return i!==e.l&&(s=Du(e,i-e.l,o,t)),[o,s]}function xB(e,n,t){var r=e.l+n,i,o=e.read_shift(2),s=Su(e,o,t);return o==65535?[[],Qn(e,n-2)]:(n!==o+2&&(i=Du(e,r-o-2,s,t)),[s,i])}function EB(e){var n;if(no(e,e.l+6)!==65535)return[qn(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return n=e[e.l+2]===1,e.l+=8,[n,"b"];case 2:return n=e[e.l+2],e.l+=8,[n,"e"];case 3:return e.l+=8,["","s"]}return[]}function hg(e,n,t){var r=e.l+n,i=ki(e,6);t.biff==2&&++e.l;var o=EB(e,8),s=e.read_shift(1);t.biff!=2&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var a=mB(e,r-e.l,t);return{cell:i,val:o[0],formula:a,shared:s>>3&1,tt:o[1]}}function Jd(e,n,t){var r=e.read_shift(4),i=Su(e,r,t),o=e.read_shift(4),s=o>0?Du(e,o,i,t):null;return[i,s]}var vB=Jd,ef=Jd,_B=Jd,CB=Jd,yB={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Lb={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},wB={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fw(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(n,t){return t.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function pg(e){var n=e.split(":"),t=n[0].split(".")[0];return[t,n[0].split(".")[1]+(n.length>1?":"+(n[1].split(".")[1]||n[1].split(".")[0]):"")]}var du={},Ra={};function fu(e,n){if(e){var t=[.7,.7,.75,.75,.3,.3];n=="xlml"&&(t=[1,1,1,1,.5,.5]),e.left==null&&(e.left=t[0]),e.right==null&&(e.right=t[1]),e.top==null&&(e.top=t[2]),e.bottom==null&&(e.bottom=t[3]),e.header==null&&(e.header=t[4]),e.footer==null&&(e.footer=t[5])}}function Vb(e,n,t,r,i,o){try{r.cellNF&&(e.z=Ye[n])}catch(a){if(r.WTF)throw a}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=On(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(Ye[n]==null&&Cs(b4[n]||"General",n),e.t==="e")e.w=e.w||Os[e.v];else if(n===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pu(e.v);else if(e.t==="d"){var s=ar(e.v);(s|0)===s?e.w=s.toString(10):e.w=pu(s)}else{if(e.v===void 0)return"";e.w=ws(e.v,Ra)}else e.t==="d"?e.w=Qr(n,ar(e.v),Ra):e.w=Qr(n,e.v,Ra)}catch(a){if(r.WTF)throw a}if(r.cellStyles&&t!=null)try{e.s=o.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Wd(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Wd(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(r.WTF&&o.Fills)throw a}}}function bB(e,n){var t=Yt(n);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=ft(t))}var DB=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,SB=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,MB=/<(?:\w:)?hyperlink [^>]*>/mg,AB=/"(\w*:\w*)"/,TB=/<(?:\w:)?col\b[^>]*[\/]?>/g,OB=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,IB=/<(?:\w:)?pageMargins[^>]*\/>/g,Ub=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,kB=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,PB=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function FB(e,n,t,r,i,o,s){if(!e)return e;r||(r={"!id":{}}),gn!=null&&n.dense==null&&(n.dense=gn);var a=n.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",h="",p=e.match(SB);p?(d=e.slice(0,p.index),h=e.slice(p.index+p[0].length)):d=h=e;var g=d.match(Ub);g?Jg(g[0],a,i,t):(g=d.match(kB))&&NB(g[0],g[1]||"",a,i,t,s,o);var x=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var v=d.slice(x,x+50).match(AB);v&&bB(a,v[1])}var E=d.match(PB);E&&E[1]&&jB(E[1],i);var _=[];if(n.cellStyles){var M=d.match(TB);M&&LB(_,M)}p&&HB(p[1],a,n,c,o,s);var I=h.match(OB);I&&(a["!autofilter"]=VB(I[0]));var y=[],q=h.match(DB);if(q)for(x=0;x!=q.length;++x)y[x]=Yt(q[x].slice(q[x].indexOf('"')+1));var ee=h.match(MB);ee&&RB(a,ee,r);var R=h.match(IB);if(R&&(a["!margins"]=BB(Ve(R[0]))),!a["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(a["!ref"]=ft(c)),n.sheetRows>0&&a["!ref"]){var k=Yt(a["!ref"]);n.sheetRows<=+k.e.r&&(k.e.r=n.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),a["!fullref"]=a["!ref"],a["!ref"]=ft(k))}return _.length>0&&(a["!cols"]=_),y.length>0&&(a["!merges"]=y),a}function Jg(e,n,t,r){var i=Ve(e);t.Sheets[r]||(t.Sheets[r]={}),i.codeName&&(t.Sheets[r].CodeName=gt(kt(i.codeName)))}function NB(e,n,t,r,i){Jg(e.slice(0,e.indexOf(">")),t,r,i)}function RB(e,n,t){for(var r=Array.isArray(e),i=0;i!=n.length;++i){var o=Ve(kt(n[i]),!0);if(!o.ref)return;var s=((t||{})["!id"]||[])[o.id];s?(o.Target=s.Target,o.location&&(o.Target+="#"+gt(o.location))):(o.Target="#"+gt(o.location),s={Target:o.Target,TargetMode:"Internal"}),o.Rel=s,o.tooltip&&(o.Tooltip=o.tooltip,delete o.tooltip);for(var a=Yt(o.ref),c=a.s.r;c<=a.e.r;++c)for(var d=a.s.c;d<=a.e.c;++d){var h=Ge({c:d,r:c});r?(e[c]||(e[c]=[]),e[c][d]||(e[c][d]={t:"z",v:void 0}),e[c][d].l=o):(e[h]||(e[h]={t:"z",v:void 0}),e[h].l=o)}}}function BB(e){var n={};return["left","right","top","bottom","header","footer"].forEach(function(t){e[t]&&(n[t]=parseFloat(e[t]))}),n}function LB(e,n){for(var t=!1,r=0;r!=n.length;++r){var i=Ve(n[r],!0);i.hidden&&(i.hidden=Ht(i.hidden));var o=parseInt(i.min,10)-1,s=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!t&&i.width&&(t=!0,Kg(i.width)),Va(i);o<=s;)e[o++]=Nn(i)}}function VB(e){var n={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return n}var UB=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function jB(e,n){n.Views||(n.Views=[{}]),(e.match(UB)||[]).forEach(function(t,r){var i=Ve(t);n.Views[r]||(n.Views[r]={}),+i.zoomScale&&(n.Views[r].zoom=+i.zoomScale),Ht(i.rightToLeft)&&(n.Views[r].RTL=!0)})}var HB=function(){var e=/<(?:\w+:)?c[ \/>]/,n=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,o=mu("v"),s=mu("f");return function(c,d,h,p,g,x){for(var v=0,E="",_=[],M=[],I=0,y=0,q=0,ee="",R,k,z=0,V=0,re,ne,W=0,fe=0,Pe=Array.isArray(x.CellXf),Ee,Be=[],Oe=[],ht=Array.isArray(d),ye=[],Fe={},oe=!1,F=!!h.sheetStubs,Z=c.split(n),L=0,B=Z.length;L!=B;++L){E=Z[L].trim();var se=E.length;if(se!==0){var De=0;e:for(v=0;v<se;++v)switch(E[v]){case">":if(E[v-1]!="/"){++v;break e}if(h&&h.cellStyles){if(k=Ve(E.slice(De,v),!0),z=k.r!=null?parseInt(k.r,10):z+1,V=-1,h.sheetRows&&h.sheetRows<z)continue;Fe={},oe=!1,k.ht&&(oe=!0,Fe.hpt=parseFloat(k.ht),Fe.hpx=vu(Fe.hpt)),k.hidden=="1"&&(oe=!0,Fe.hidden=!0),k.outlineLevel!=null&&(oe=!0,Fe.level=+k.outlineLevel),oe&&(ye[z-1]=Fe)}break;case"<":De=v;break}if(De>=v)break;if(k=Ve(E.slice(De,v),!0),z=k.r!=null?parseInt(k.r,10):z+1,V=-1,!(h.sheetRows&&h.sheetRows<z)){p.s.r>z-1&&(p.s.r=z-1),p.e.r<z-1&&(p.e.r=z-1),h&&h.cellStyles&&(Fe={},oe=!1,k.ht&&(oe=!0,Fe.hpt=parseFloat(k.ht),Fe.hpx=vu(Fe.hpt)),k.hidden=="1"&&(oe=!0,Fe.hidden=!0),k.outlineLevel!=null&&(oe=!0,Fe.level=+k.outlineLevel),oe&&(ye[z-1]=Fe)),_=E.slice(v).split(e);for(var Ce=0;Ce!=_.length&&_[Ce].trim().charAt(0)=="<";++Ce);for(_=_.slice(Ce),v=0;v!=_.length;++v)if(E=_[v].trim(),E.length!==0){if(M=E.match(t),I=v,y=0,q=0,E="<c "+(E.slice(0,1)=="<"?">":"")+E,M!=null&&M.length===2){for(I=0,ee=M[1],y=0;y!=ee.length&&!((q=ee.charCodeAt(y)-64)<1||q>26);++y)I=26*I+q;--I,V=I}else++V;for(y=0;y!=E.length&&E.charCodeAt(y)!==62;++y);if(++y,k=Ve(E.slice(0,y),!0),k.r||(k.r=Ge({r:z-1,c:V})),ee=E.slice(y),R={t:""},(M=ee.match(o))!=null&&M[1]!==""&&(R.v=gt(M[1])),h.cellFormula){if((M=ee.match(s))!=null&&M[1]!==""){if(R.f=gt(kt(M[1])).replace(/\r\n/g,`
`),h.xlfn||(R.f=cw(R.f)),M[0].indexOf('t="array"')>-1)R.F=(ee.match(i)||[])[1],R.F.indexOf(":")>-1&&Be.push([Yt(R.F),R.F]);else if(M[0].indexOf('t="shared"')>-1){ne=Ve(M[0]);var be=gt(kt(M[1]));h.xlfn||(be=cw(be)),Oe[parseInt(ne.si,10)]=[ne,be,k.r]}}else(M=ee.match(/<f[^>]*\/>/))&&(ne=Ve(M[0]),Oe[ne.si]&&(R.f=J8(Oe[ne.si][1],Oe[ne.si][2],k.r)));var ce=sr(k.r);for(y=0;y<Be.length;++y)ce.r>=Be[y][0].s.r&&ce.r<=Be[y][0].e.r&&ce.c>=Be[y][0].s.c&&ce.c<=Be[y][0].e.c&&(R.F=Be[y][1])}if(k.t==null&&R.v===void 0)if(R.f||R.F)R.v=0,R.t="n";else if(F)R.t="z";else continue;else R.t=k.t||"n";switch(p.s.c>V&&(p.s.c=V),p.e.c<V&&(p.e.c=V),R.t){case"n":if(R.v==""||R.v==null){if(!F)continue;R.t="z"}else R.v=parseFloat(R.v);break;case"s":if(typeof R.v>"u"){if(!F)continue;R.t="z"}else re=du[parseInt(R.v,10)],R.v=re.t,R.r=re.r,h.cellHTML&&(R.h=re.h);break;case"str":R.t="s",R.v=R.v!=null?kt(R.v):"",h.cellHTML&&(R.h=Rg(R.v));break;case"inlineStr":M=ee.match(r),R.t="s",M!=null&&(re=Yg(M[1]))?(R.v=re.t,h.cellHTML&&(R.h=re.h)):R.v="";break;case"b":R.v=Ht(R.v);break;case"d":h.cellDates?R.v=On(R.v,1):(R.v=ar(On(R.v,1)),R.t="n");break;case"e":(!h||h.cellText!==!1)&&(R.w=R.v),R.v=ab[R.v];break}if(W=fe=0,Ee=null,Pe&&k.s!==void 0&&(Ee=x.CellXf[k.s],Ee!=null&&(Ee.numFmtId!=null&&(W=Ee.numFmtId),h.cellStyles&&Ee.fillId!=null&&(fe=Ee.fillId))),Vb(R,W,fe,h,g,x),h.cellDates&&Pe&&R.t=="n"&&Ua(Ye[W])&&(R.t="d",R.v=Yd(R.v)),k.cm&&h.xlmeta){var at=(h.xlmeta.Cell||[])[+k.cm-1];at&&at.type=="XLDAPR"&&(R.D=!0)}if(ht){var P=sr(k.r);d[P.r]||(d[P.r]=[]),d[P.r][P.c]=R}else d[k.r]=R}}}}ye.length>0&&(d["!rows"]=ye)}}();function $B(e,n){var t={},r=e.l+n;t.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var o=e.read_shift(1);return e.l=r,o&7&&(t.level=o&7),o&16&&(t.hidden=!0),o&32&&(t.hpt=i/20),t}var qB=Ts;function WB(){}function zB(e,n){var t={},r=e[e.l];return++e.l,t.above=!(r&64),t.left=!(r&128),e.l+=18,t.name=pN(e,n-19),t}function GB(e){var n=Xr(e);return[n]}function QB(e){var n=As(e);return[n]}function XB(e){var n=Xr(e),t=e.read_shift(1);return[n,t,"b"]}function YB(e){var n=As(e),t=e.read_shift(1);return[n,t,"b"]}function KB(e){var n=Xr(e),t=e.read_shift(1);return[n,t,"e"]}function ZB(e){var n=As(e),t=e.read_shift(1);return[n,t,"e"]}function JB(e){var n=Xr(e),t=e.read_shift(4);return[n,t,"s"]}function eL(e){var n=As(e),t=e.read_shift(4);return[n,t,"s"]}function tL(e){var n=Xr(e),t=qn(e);return[n,t,"n"]}function jb(e){var n=As(e),t=qn(e);return[n,t,"n"]}function nL(e){var n=Xr(e),t=Gg(e);return[n,t,"n"]}function rL(e){var n=As(e),t=Gg(e);return[n,t,"n"]}function iL(e){var n=Xr(e),t=Wg(e);return[n,t,"is"]}function oL(e){var n=Xr(e),t=Gn(e);return[n,t,"str"]}function sL(e){var n=As(e),t=Gn(e);return[n,t,"str"]}function aL(e,n,t){var r=e.l+n,i=Xr(e);i.r=t["!row"];var o=e.read_shift(1),s=[i,o,"b"];if(t.cellFormula){e.l+=2;var a=ef(e,r-e.l,t);s[3]=$n(a,null,i,t.supbooks,t)}else e.l=r;return s}function cL(e,n,t){var r=e.l+n,i=Xr(e);i.r=t["!row"];var o=e.read_shift(1),s=[i,o,"e"];if(t.cellFormula){e.l+=2;var a=ef(e,r-e.l,t);s[3]=$n(a,null,i,t.supbooks,t)}else e.l=r;return s}function uL(e,n,t){var r=e.l+n,i=Xr(e);i.r=t["!row"];var o=qn(e),s=[i,o,"n"];if(t.cellFormula){e.l+=2;var a=ef(e,r-e.l,t);s[3]=$n(a,null,i,t.supbooks,t)}else e.l=r;return s}function lL(e,n,t){var r=e.l+n,i=Xr(e);i.r=t["!row"];var o=Gn(e),s=[i,o,"str"];if(t.cellFormula){e.l+=2;var a=ef(e,r-e.l,t);s[3]=$n(a,null,i,t.supbooks,t)}else e.l=r;return s}var dL=Ts;function fL(e,n){var t=e.l+n,r=Ts(e,16),i=zg(e),o=Gn(e),s=Gn(e),a=Gn(e);e.l=t;var c={rfx:r,relId:i,loc:o,display:a};return s&&(c.Tooltip=s),c}function hL(){}function pL(e,n,t){var r=e.l+n,i=ib(e,16),o=e.read_shift(1),s=[i];if(s[2]=o,t.cellFormula){var a=vB(e,r-e.l,t);s[1]=a}else e.l=r;return s}function mL(e,n,t){var r=e.l+n,i=Ts(e,16),o=[i];if(t.cellFormula){var s=CB(e,r-e.l,t);o[1]=s,e.l=r}else e.l=r;return o}var gL=["left","right","top","bottom","header","footer"];function xL(e){var n={};return gL.forEach(function(t){n[t]=qn(e,8)}),n}function EL(e){var n=e.read_shift(2);return e.l+=28,{RTL:n&32}}function vL(){}function _L(){}function CL(e,n,t,r,i,o,s){if(!e)return e;var a=n||{};r||(r={"!id":{}}),gn!=null&&a.dense==null&&(a.dense=gn);var c=a.dense?[]:{},d,h={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=[],g=!1,x=!1,v,E,_,M,I,y,q,ee,R,k=[];a.biff=12,a["!row"]=0;var z=0,V=!1,re=[],ne={},W=a.supbooks||i.supbooks||[[]];if(W.sharedf=ne,W.arrayf=re,W.SheetNames=i.SheetNames||i.Sheets.map(function(Fe){return Fe.name}),!a.supbooks&&(a.supbooks=W,i.Names))for(var fe=0;fe<i.Names.length;++fe)W[0][fe+1]=i.Names[fe];var Pe=[],Ee=[],Be=!1;Qd[16]={n:"BrtShortReal",f:jb};var Oe,ht;if(so(e,function(oe,F,Z){if(!x)switch(Z){case 148:d=oe;break;case 0:v=oe,a.sheetRows&&a.sheetRows<=v.r&&(x=!0),ee=Rn(M=v.r),a["!row"]=v.r,(oe.hidden||oe.hpt||oe.level!=null)&&(oe.hpt&&(oe.hpx=vu(oe.hpt)),Ee[oe.r]=oe);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(E={t:oe[2]},oe[2]){case"n":E.v=oe[1];break;case"s":q=du[oe[1]],E.v=q.t,E.r=q.r;break;case"b":E.v=!!oe[1];break;case"e":E.v=oe[1],a.cellText!==!1&&(E.w=Os[E.v]);break;case"str":E.t="s",E.v=oe[1];break;case"is":E.t="s",E.v=oe[1].t;break}if((_=s.CellXf[oe[0].iStyleRef])&&Vb(E,_.numFmtId,null,a,o,s),I=oe[0].c==-1?I+1:oe[0].c,a.dense?(c[M]||(c[M]=[]),c[M][I]=E):c[Cn(I)+ee]=E,a.cellFormula){for(V=!1,z=0;z<re.length;++z){var L=re[z];v.r>=L[0].s.r&&v.r<=L[0].e.r&&I>=L[0].s.c&&I<=L[0].e.c&&(E.F=ft(L[0]),V=!0)}!V&&oe.length>3&&(E.f=oe[3])}if(h.s.r>v.r&&(h.s.r=v.r),h.s.c>I&&(h.s.c=I),h.e.r<v.r&&(h.e.r=v.r),h.e.c<I&&(h.e.c=I),a.cellDates&&_&&E.t=="n"&&Ua(Ye[_.numFmtId])){var B=_s(E.v);B&&(E.t="d",E.v=new Date(B.y,B.m-1,B.d,B.H,B.M,B.S,B.u))}Oe&&(Oe.type=="XLDAPR"&&(E.D=!0),Oe=void 0),ht&&(ht=void 0);break;case 1:case 12:if(!a.sheetStubs||g)break;E={t:"z",v:void 0},I=oe[0].c==-1?I+1:oe[0].c,a.dense?(c[M]||(c[M]=[]),c[M][I]=E):c[Cn(I)+ee]=E,h.s.r>v.r&&(h.s.r=v.r),h.s.c>I&&(h.s.c=I),h.e.r<v.r&&(h.e.r=v.r),h.e.c<I&&(h.e.c=I),Oe&&(Oe.type=="XLDAPR"&&(E.D=!0),Oe=void 0),ht&&(ht=void 0);break;case 176:k.push(oe);break;case 49:Oe=((a.xlmeta||{}).Cell||[])[oe-1];break;case 494:var se=r["!id"][oe.relId];for(se?(oe.Target=se.Target,oe.loc&&(oe.Target+="#"+oe.loc),oe.Rel=se):oe.relId==""&&(oe.Target="#"+oe.loc),M=oe.rfx.s.r;M<=oe.rfx.e.r;++M)for(I=oe.rfx.s.c;I<=oe.rfx.e.c;++I)a.dense?(c[M]||(c[M]=[]),c[M][I]||(c[M][I]={t:"z",v:void 0}),c[M][I].l=oe):(y=Ge({c:I,r:M}),c[y]||(c[y]={t:"z",v:void 0}),c[y].l=oe);break;case 426:if(!a.cellFormula)break;re.push(oe),R=a.dense?c[M][I]:c[Cn(I)+ee],R.f=$n(oe[1],h,{r:v.r,c:I},W,a),R.F=ft(oe[0]);break;case 427:if(!a.cellFormula)break;ne[Ge(oe[0].s)]=oe[1],R=a.dense?c[M][I]:c[Cn(I)+ee],R.f=$n(oe[1],h,{r:v.r,c:I},W,a);break;case 60:if(!a.cellStyles)break;for(;oe.e>=oe.s;)Pe[oe.e--]={width:oe.w/256,hidden:!!(oe.flags&1),level:oe.level},Be||(Be=!0,Kg(oe.w/256)),Va(Pe[oe.e+1]);break;case 161:c["!autofilter"]={ref:ft(oe)};break;case 476:c["!margins"]=oe;break;case 147:i.Sheets[t]||(i.Sheets[t]={}),oe.name&&(i.Sheets[t].CodeName=oe.name),(oe.above||oe.left)&&(c["!outline"]={above:oe.above,left:oe.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),oe.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:g=!0;break;case 36:g=!1;break;case 37:p.push(Z),g=!0;break;case 38:p.pop(),g=!1;break;default:if(!F.T){if(!g||a.WTF)throw new Error("Unexpected record 0x"+Z.toString(16))}}},a),delete a.supbooks,delete a["!row"],!c["!ref"]&&(h.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(c["!ref"]=ft(d||h)),a.sheetRows&&c["!ref"]){var ye=Yt(c["!ref"]);a.sheetRows<=+ye.e.r&&(ye.e.r=a.sheetRows-1,ye.e.r>h.e.r&&(ye.e.r=h.e.r),ye.e.r<ye.s.r&&(ye.s.r=ye.e.r),ye.e.c>h.e.c&&(ye.e.c=h.e.c),ye.e.c<ye.s.c&&(ye.s.c=ye.e.c),c["!fullref"]=c["!ref"],c["!ref"]=ft(ye))}return k.length>0&&(c["!merges"]=k),Pe.length>0&&(c["!cols"]=Pe),Ee.length>0&&(c["!rows"]=Ee),c}function yL(e){var n=[],t=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(o){var s=o.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(n[+s[1]]=t?+s[2]:s[2])});var i=gt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(o){r=o.replace(/<.*?>/g,"")}),[n,i,r]}function wL(e,n,t,r,i,o){var s=o||{"!type":"chart"};if(!e)return o;var a=0,c=0,d="A",h={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var g=yL(p);h.s.r=h.s.c=0,h.e.c=a,d=Cn(a),g[0].forEach(function(x,v){s[d+Rn(v)]={t:"n",v:x,z:g[1]},c=v}),h.e.r<c&&(h.e.r=c),++a}),a>0&&(s["!ref"]=ft(h)),s}function bL(e,n,t,r,i){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s,a=e.match(Ub);return a&&Jg(a[0],o,i,t),(s=e.match(/drawing r:id="(.*?)"/))&&(o["!rel"]=s[1]),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}function DL(e,n){e.l+=10;var t=Gn(e,n-10);return{name:t}}function SL(e,n,t,r,i){if(!e)return e;r||(r={"!id":{}});var o={"!type":"chart","!drawel":null,"!rel":""},s=[],a=!1;return so(e,function(d,h,p){switch(p){case 550:o["!rel"]=d;break;case 651:i.Sheets[t]||(i.Sheets[t]={}),d.name&&(i.Sheets[t].CodeName=d.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(p);break;case 38:s.pop();break;default:if(h.T>0)s.push(p);else if(h.T<0)s.pop();else if(!a||n.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}},n),r["!id"][o["!rel"]]&&(o["!drawel"]=r["!id"][o["!rel"]]),o}var Hb=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],ML=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],AL=[],TL=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function hw(e,n){for(var t=0;t!=e.length;++t)for(var r=e[t],i=0;i!=n.length;++i){var o=n[i];if(r[o[0]]==null)r[o[0]]=o[1];else switch(o[2]){case"bool":typeof r[o[0]]=="string"&&(r[o[0]]=Ht(r[o[0]]));break;case"int":typeof r[o[0]]=="string"&&(r[o[0]]=parseInt(r[o[0]],10));break}}}function pw(e,n){for(var t=0;t!=n.length;++t){var r=n[t];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=Ht(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function $b(e){pw(e.WBProps,Hb),pw(e.CalcPr,TL),hw(e.WBView,ML),hw(e.Sheets,AL),Ra.date1904=Ht(e.WBProps.date1904)}var OL="][*?/\\".split("");function IL(e,n){if(e.length>31){if(n)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var t=!0;return OL.forEach(function(r){if(e.indexOf(r)!=-1){if(!n)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");t=!1}}),t}var kL=/<\w+:workbook/;function PL(e,n){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",o={},s=0;if(e.replace(Xn,function(c,d){var h=Ve(c);switch(Ii(h[0])){case"<?xml":break;case"<workbook":c.match(kL)&&(i="xmlns"+c.match(/<(\w+):/)[1]),t.xmlns=h[i];break;case"</workbook>":break;case"<fileVersion":delete h[0],t.AppVersion=h;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Hb.forEach(function(p){if(h[p[0]]!=null)switch(p[2]){case"bool":t.WBProps[p[0]]=Ht(h[p[0]]);break;case"int":t.WBProps[p[0]]=parseInt(h[p[0]],10);break;default:t.WBProps[p[0]]=h[p[0]]}}),h.codeName&&(t.WBProps.CodeName=kt(h.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete h[0],t.WBView.push(h);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(h.state){case"hidden":h.Hidden=1;break;case"veryHidden":h.Hidden=2;break;default:h.Hidden=0}delete h.state,h.name=gt(kt(h.name)),delete h[0],t.Sheets.push(h);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":o={},o.Name=kt(h.name),h.comment&&(o.Comment=h.comment),h.localSheetId&&(o.Sheet=+h.localSheetId),Ht(h.hidden||"0")&&(o.Hidden=!0),s=d+c.length;break;case"</definedName>":o.Ref=gt(kt(e.slice(s,d))),t.Names.push(o);break;case"<definedName/>":break;case"<calcPr":delete h[0],t.CalcPr=h;break;case"<calcPr/>":delete h[0],t.CalcPr=h;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&n.WTF)throw new Error("unrecognized "+h[0]+" in workbook")}return c}),Y4.indexOf(t.xmlns)===-1)throw new Error("Unknown Namespace: "+t.xmlns);return $b(t),t}function FL(e,n){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=_g(e,n-8),t.name=Gn(e),t}function NL(e,n){var t={},r=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var i=n>8?Gn(e):"";return i.length>0&&(t.CodeName=i),t.autoCompressPictures=!!(r&65536),t.backupFile=!!(r&64),t.checkCompatibility=!!(r&4096),t.date1904=!!(r&1),t.filterPrivacy=!!(r&8),t.hidePivotFieldList=!!(r&1024),t.promptedSolutions=!!(r&16),t.publishItems=!!(r&2048),t.refreshAllConnections=!!(r&262144),t.saveExternalLinkValues=!!(r&128),t.showBorderUnselectedTables=!!(r&4),t.showInkAnnotation=!!(r&32),t.showObjects=["all","placeholders","none"][r>>13&3],t.showPivotChartFilter=!!(r&32768),t.updateLinks=["userSet","never","always"][r>>8&3],t}function RL(e,n){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=n-8,t}function BL(e,n,t){var r=e.l+n;e.l+=4,e.l+=1;var i=e.read_shift(4),o=mN(e),s=_B(e,0,t),a=zg(e);e.l=r;var c={Name:o,Ptg:s};return i<268435455&&(c.Sheet=i),a&&(c.Comment=a),c}function LL(e,n){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;n||(n={}),n.biff=12;var o=[],s=[[]];return s.SheetNames=[],s.XTI=[],Qd[16]={n:"BrtFRTArchID$",f:RL},so(e,function(c,d,h){switch(h){case 156:s.SheetNames.push(c.name),t.Sheets.push(c);break;case 153:t.WBProps=c;break;case 39:c.Sheet!=null&&(n.SID=c.Sheet),c.Ref=$n(c.Ptg,null,null,s,n),delete n.SID,delete c.Ptg,o.push(c);break;case 1036:break;case 357:case 358:case 355:case 667:s[0].length?s.push([h,c]):s[0]=[h,c],s[s.length-1].XTI=[];break;case 362:s.length===0&&(s[0]=[],s[0].XTI=[]),s[s.length-1].XTI=s[s.length-1].XTI.concat(c),s.XTI=s.XTI.concat(c);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(h),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(h),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!d.T){if(!i||n.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+h.toString(16))}}},n),$b(t),t.Names=o,t.supbooks=s,t}function VL(e,n,t){return n.slice(-4)===".bin"?LL(e,t):PL(e,t)}function UL(e,n,t,r,i,o,s,a){return n.slice(-4)===".bin"?CL(e,r,t,i,o,s,a):FB(e,r,t,i,o,s,a)}function jL(e,n,t,r,i,o,s,a){return n.slice(-4)===".bin"?SL(e,r,t,i,o,s,a):bL(e,r,t,i,o,s,a)}function HL(e,n,t,r,i,o,s,a){return n.slice(-4)===".bin"?Y8(e,r,t,i,o,s,a):K8(e,r,t,i,o,s,a)}function $L(e,n,t,r,i,o,s,a){return n.slice(-4)===".bin"?Q8(e,r,t,i,o,s,a):X8(e,r,t,i,o,s,a)}function qL(e,n,t,r){return n.slice(-4)===".bin"?d8(e,t,r):o8(e,t,r)}function WL(e,n,t){return Tb(e,t)}function zL(e,n,t){return n.slice(-4)===".bin"?M5(e,t):D5(e,t)}function GL(e,n,t){return n.slice(-4)===".bin"?W8(e,t):U8(e,t)}function QL(e,n,t){return n.slice(-4)===".bin"?B8(e,n,t):N8(e,n,t)}function XL(e,n,t,r){return t.slice(-4)===".bin"?L8(e,n,t,r):void 0}function YL(e,n,t){return n.slice(-4)===".bin"?P8(e,n,t):F8(e,n,t)}var qb=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,Wb=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function ui(e,n){var t=e.split(/\s+/),r=[];if(n||(r[0]=t[0]),t.length===1)return r;var i=e.match(qb),o,s,a,c;if(i)for(c=0;c!=i.length;++c)o=i[c].match(Wb),(s=o[1].indexOf(":"))===-1?r[o[1]]=o[2].slice(1,o[2].length-1):(o[1].slice(0,6)==="xmlns:"?a="xmlns"+o[1].slice(6):a=o[1].slice(s+1),r[a]=o[2].slice(1,o[2].length-1));return r}function KL(e){var n=e.split(/\s+/),t={};if(n.length===1)return t;var r=e.match(qb),i,o,s,a;if(r)for(a=0;a!=r.length;++a)i=r[a].match(Wb),(o=i[1].indexOf(":"))===-1?t[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?s="xmlns"+i[1].slice(6):s=i[1].slice(o+1),t[s]=i[2].slice(1,i[2].length-1));return t}var hu;function ZL(e,n){var t=hu[e]||gt(e);return t==="General"?ws(n):Qr(t,n)}function JL(e,n,t,r){var i=r;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Ht(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=On(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[gt(n)]=i}function e7(e,n,t){if(e.t!=="z"){if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Os[e.v]:n==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pu(e.v):e.w=ws(e.v):e.w=ZL(n||"General",e.v)}catch(o){if(t.WTF)throw o}try{var r=hu[n]||n||"General";if(t.cellNF&&(e.z=r),t.cellDates&&e.t=="n"&&Ua(r)){var i=_s(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(o){if(t.WTF)throw o}}}function t7(e,n,t){if(t.cellStyles&&n.Interior){var r=n.Interior;r.Pattern&&(r.patternType=J5[r.Pattern]||r.Pattern)}e[n.ID]=n}function n7(e,n,t,r,i,o,s,a,c,d){var h="General",p=r.StyleID,g={};d=d||{};var x=[],v=0;for(p===void 0&&a&&(p=a.StyleID),p===void 0&&s&&(p=s.StyleID);o[p]!==void 0&&(o[p].nf&&(h=o[p].nf),o[p].Interior&&x.push(o[p].Interior),!!o[p].Parent);)p=o[p].Parent;switch(t.Type){case"Boolean":r.t="b",r.v=Ht(e);break;case"String":r.t="s",r.r=Ry(gt(e)),r.v=e.indexOf("<")>-1?gt(n||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(On(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=gt(e):r.v<60&&(r.v=r.v-1),(!h||h=="General")&&(h="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=ab[e],d.cellText!==!1&&(r.w=e);break;default:e==""&&n==""?r.t="z":(r.t="s",r.v=Ry(n||e));break}if(e7(r,h,d),d.cellFormula!==!1)if(r.Formula){var E=gt(r.Formula);E.charCodeAt(0)==61&&(E=E.slice(1)),r.f=Na(E,i),delete r.Formula,r.ArrayRange=="RC"?r.F=Na("RC:RC",i):r.ArrayRange&&(r.F=Na(r.ArrayRange,i),c.push([Yt(r.F),r.F]))}else for(v=0;v<c.length;++v)i.r>=c[v][0].s.r&&i.r<=c[v][0].e.r&&i.c>=c[v][0].s.c&&i.c<=c[v][0].e.c&&(r.F=c[v][1]);d.cellStyles&&(x.forEach(function(_){!g.patternType&&_.patternType&&(g.patternType=_.patternType)}),r.s=g),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function r7(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function mg(e,n){var t=n||{};Bw();var r=tu(Bg(e));(t.type=="binary"||t.type=="array"||t.type=="base64")&&(typeof wt<"u"?r=wt.utils.decode(65001,Eg(r)):r=kt(r));var i=r.slice(0,1024).toLowerCase(),o=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var s=Nn(t);return s.type="string",xu.to_workbook(r,s)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Kt){i.indexOf("<"+Kt)>=0&&(o=!0)}),o)return f7(r,t);hu={"General Number":"General","General Date":Ye[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Ye[15],"Short Date":Ye[14],"Long Time":Ye[19],"Medium Time":Ye[18],"Short Time":Ye[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Ye[2],Standard:Ye[4],Percent:Ye[10],Scientific:Ye[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,c=[],d;gn!=null&&t.dense==null&&(t.dense=gn);var h={},p=[],g=t.dense?[]:{},x="",v={},E={},_=ui('<Data ss:Type="String">'),M=0,I=0,y=0,q={s:{r:2e6,c:2e6},e:{r:0,c:0}},ee={},R={},k="",z=0,V=[],re={},ne={},W=0,fe=[],Pe=[],Ee={},Be=[],Oe,ht=!1,ye=[],Fe=[],oe={},F=0,Z=0,L={Sheets:[],WBProps:{date1904:!1}},B={};gu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var se="";a=gu.exec(r);)switch(a[3]=(se=a[3]).toLowerCase()){case"data":if(se=="data"){if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&c.push([a[3],!0]);break}if(c[c.length-1][1])break;a[1]==="/"?n7(r.slice(M,a.index),k,_,c[c.length-1][0]=="comment"?Ee:v,{c:I,r:y},ee,Be[I],E,ye,t):(k="",_=ui(a[0]),M=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(Pe.length>0&&(v.c=Pe),(!t.sheetRows||t.sheetRows>y)&&v.v!==void 0&&(t.dense?(g[y]||(g[y]=[]),g[y][I]=v):g[Cn(I)+Rn(y)]=v),v.HRef&&(v.l={Target:gt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(F=I+(parseInt(v.MergeAcross,10)|0),Z=y+(parseInt(v.MergeDown,10)|0),V.push({s:{c:I,r:y},e:{c:F,r:Z}})),!t.sheetStubs)v.MergeAcross?I=F+1:++I;else if(v.MergeAcross||v.MergeDown){for(var De=I;De<=F;++De)for(var Ce=y;Ce<=Z;++Ce)(De>I||Ce>y)&&(t.dense?(g[Ce]||(g[Ce]=[]),g[Ce][De]={t:"z"}):g[Cn(De)+Rn(Ce)]={t:"z"});I=F+1}else++I;else v=KL(a[0]),v.Index&&(I=+v.Index-1),I<q.s.c&&(q.s.c=I),I>q.e.c&&(q.e.c=I),a[0].slice(-2)==="/>"&&++I,Pe=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(y<q.s.r&&(q.s.r=y),y>q.e.r&&(q.e.r=y),a[0].slice(-2)==="/>"&&(E=ui(a[0]),E.Index&&(y=+E.Index-1)),I=0,++y):(E=ui(a[0]),E.Index&&(y=+E.Index-1),oe={},(E.AutoFitHeight=="0"||E.Height)&&(oe.hpx=parseInt(E.Height,10),oe.hpt=Ab(oe.hpx),Fe[y]=oe),E.Hidden=="1"&&(oe.hidden=!0,Fe[y]=oe));break;case"worksheet":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"));p.push(x),q.s.r<=q.e.r&&q.s.c<=q.e.c&&(g["!ref"]=ft(q),t.sheetRows&&t.sheetRows<=q.e.r&&(g["!fullref"]=g["!ref"],q.e.r=t.sheetRows-1,g["!ref"]=ft(q))),V.length&&(g["!merges"]=V),Be.length>0&&(g["!cols"]=Be),Fe.length>0&&(g["!rows"]=Fe),h[x]=g}else q={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=I=0,c.push([a[3],!1]),d=ui(a[0]),x=gt(d.Name),g=t.dense?[]:{},V=[],ye=[],Fe=[],B={name:x,Hidden:0},L.Sheets.push(B);break;case"table":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else{if(a[0].slice(-2)=="/>")break;c.push([a[3],!1]),Be=[],ht=!1}break;case"style":a[1]==="/"?t7(ee,R,t):R=ui(a[0]);break;case"numberformat":R.nf=gt(ui(a[0]).Format||"General"),hu[R.nf]&&(R.nf=hu[R.nf]);for(var be=0;be!=392&&Ye[be]!=R.nf;++be);if(be==392){for(be=57;be!=392;++be)if(Ye[be]==null){Cs(R.nf,be);break}}break;case"column":if(c[c.length-1][0]!=="table")break;if(Oe=ui(a[0]),Oe.Hidden&&(Oe.hidden=!0,delete Oe.Hidden),Oe.Width&&(Oe.wpx=parseInt(Oe.Width,10)),!ht&&Oe.wpx>10){ht=!0,or=Sb;for(var ce=0;ce<Be.length;++ce)Be[ce]&&Va(Be[ce])}ht&&Va(Oe),Be[Oe.Index-1||Be.length]=Oe;for(var at=0;at<+Oe.Span;++at)Be[Be.length]=Nn(Oe);break;case"namedrange":if(a[1]==="/")break;L.Names||(L.Names=[]);var P=Ve(a[0]),$t={Name:P.Name,Ref:Na(P.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&($t.Sheet=L.Sheets.length-1),L.Names.push($t);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?k+=r.slice(z,a.index):z=a.index+a[0].length;break;case"interior":if(!t.cellStyles)break;R.Interior=ui(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?UN(re,se,r.slice(W,a.index)):W=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else c.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"));r7(Ee),Pe.push(Ee)}else c.push([a[3],!1]),d=ui(a[0]),Ee={a:d.Author};break;case"autofilter":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var pt=ui(a[0]);g["!autofilter"]={ref:Na(pt.Range).replace(/\$/g,"")},c.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&c.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((d=c.pop())[0]!==a[3])throw new Error("Bad state: "+d.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&c.push([a[3],!0]);break;case"null":break;default:if(c.length==0&&a[3]=="document"||c.length==0&&a[3]=="uof")return _w(r,t);var Dt=!0;switch(c[c.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Dt=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Dt=!1}break;case"excelworkbook":switch(a[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Dt=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:Dt=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(r.slice(W,a.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2;break}else W=a.index+a[0].length;break;case"header":g["!margins"]||fu(g["!margins"]={},"xlml"),isNaN(+Ve(a[0]).Margin)||(g["!margins"].header=+Ve(a[0]).Margin);break;case"footer":g["!margins"]||fu(g["!margins"]={},"xlml"),isNaN(+Ve(a[0]).Margin)||(g["!margins"].footer=+Ve(a[0]).Margin);break;case"pagemargins":var it=Ve(a[0]);g["!margins"]||fu(g["!margins"]={},"xlml"),isNaN(+it.Top)||(g["!margins"].top=+it.Top),isNaN(+it.Left)||(g["!margins"].left=+it.Left),isNaN(+it.Right)||(g["!margins"].right=+it.Right),isNaN(+it.Bottom)||(g["!margins"].bottom=+it.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":g["!outline"]||(g["!outline"]={}),g["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Dt=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Dt=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Dt=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Dt=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Dt=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Dt=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Dt=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Dt=!1}break;case"smarttags":break;default:Dt=!1;break}if(Dt||a[3].match(/!\[CDATA/))break;if(!c[c.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+c.join("|");if(c[c.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?JL(ne,se,fe,r.slice(W,a.index)):(fe=a,W=a.index+a[0].length);break}if(t.WTF)throw"Unrecognized tag: "+a[3]+"|"+c.join("|")}var we={};return!t.bookSheets&&!t.bookProps&&(we.Sheets=h),we.SheetNames=p,we.Workbook=L,we.SSF=Nn(Ye),we.Props=re,we.Custprops=ne,we}function bg(e,n){switch(n1(n=n||{}),n.type||"base64"){case"base64":return mg(kr(e),n);case"binary":case"buffer":case"file":return mg(e,n);case"array":return mg(Ms(e),n)}}function i7(e){var n={},t=e.content;if(t.l=28,n.AnsiUserType=t.read_shift(0,"lpstr-ansi"),n.AnsiClipboardFormat=EN(t),t.length-t.l<=4)return n;var r=t.read_shift(4);if(r==0||r>40||(t.l-=4,n.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4)||(r=t.read_shift(4),r!==1907505652)||(n.UnicodeClipboardFormat=vN(t),r=t.read_shift(4),r==0||r>40))return n;t.l-=4,n.Reserved2=t.read_shift(0,"lpwstr")}var o7=[60,1084,2066,2165,2175];function s7(e,n,t,r,i){var o=r,s=[],a=t.slice(t.l,t.l+o);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}s.push(a),t.l+=o;for(var c=no(t,t.l),d=Dg[c],h=0;d!=null&&o7.indexOf(c)>-1;)o=no(t,t.l+2),h=t.l+4,c==2066?h+=4:(c==2165||c==2175)&&(h+=12),a=t.slice(h,t.l+4+o),s.push(a),t.l+=4+o,d=Dg[c=no(t,t.l)];var p=Vo(s);Fn(p,0);var g=0;p.lens=[];for(var x=0;x<s.length;++x)p.lens.push(g),g+=s[x].length;if(p.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+r;return n.f(p,p.length,i)}function Mi(e,n,t){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,n.cellNF&&(e.z=Ye[r])}catch(o){if(n.WTF)throw o}if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Os[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=pu(e.v):e.w=ws(e.v):e.w=Qr(r,e.v,{date1904:!!t,dateNF:n&&n.dateNF})}catch(o){if(n.WTF)throw o}if(n.cellDates&&r&&e.t=="n"&&Ua(Ye[r]||String(r))){var i=_s(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Bd(e,n,t){return{v:e,ixfe:n,t}}function a7(e,n){var t={opts:{}},r={};gn!=null&&n.dense==null&&(n.dense=gn);var i=n.dense?[]:{},o={},s={},a=null,c=[],d="",h={},p,g="",x,v,E,_,M={},I=[],y,q,ee=[],R=[],k={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},V=function(rt){return rt<8?ys[rt]:rt<64&&R[rt-8]||ys[rt]},re=function(rt,Zt,Fr){var xn=Zt.XF.data;if(!(!xn||!xn.patternType||!Fr||!Fr.cellStyles)){Zt.s={},Zt.s.patternType=xn.patternType;var zo;(zo=Eu(V(xn.icvFore)))&&(Zt.s.fgColor={rgb:zo}),(zo=Eu(V(xn.icvBack)))&&(Zt.s.bgColor={rgb:zo})}},ne=function(rt,Zt,Fr){if(!(oe>1)&&!(Fr.sheetRows&&rt.r>=Fr.sheetRows)){if(Fr.cellStyles&&Zt.XF&&Zt.XF.data&&re(rt,Zt,Fr),delete Zt.ixfe,delete Zt.XF,p=rt,g=Ge(rt),(!s||!s.s||!s.e)&&(s={s:{r:0,c:0},e:{r:0,c:0}}),rt.r<s.s.r&&(s.s.r=rt.r),rt.c<s.s.c&&(s.s.c=rt.c),rt.r+1>s.e.r&&(s.e.r=rt.r+1),rt.c+1>s.e.c&&(s.e.c=rt.c+1),Fr.cellFormula&&Zt.f){for(var xn=0;xn<I.length;++xn)if(!(I[xn][0].s.c>rt.c||I[xn][0].s.r>rt.r)&&!(I[xn][0].e.c<rt.c||I[xn][0].e.r<rt.r)){Zt.F=ft(I[xn][0]),(I[xn][0].s.c!=rt.c||I[xn][0].s.r!=rt.r)&&delete Zt.f,Zt.f&&(Zt.f=""+$n(I[xn][1],s,rt,ye,W));break}}Fr.dense?(i[rt.r]||(i[rt.r]=[]),i[rt.r][rt.c]=Zt):i[g]=Zt}},W={enc:!1,sbcch:0,snames:[],sharedf:M,arrayf:I,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!n&&!!n.cellStyles,WTF:!!n&&!!n.wtf};n.password&&(W.password=n.password);var fe,Pe=[],Ee=[],Be=[],Oe=[],ht=!1,ye=[];ye.SheetNames=W.snames,ye.sharedf=W.sharedf,ye.arrayf=W.arrayf,ye.names=[],ye.XTI=[];var Fe=0,oe=0,F=0,Z=[],L=[],B;W.codepage=1200,fi(1200);for(var se=!1;e.l<e.length-1;){var De=e.l,Ce=e.read_shift(2);if(Ce===0&&Fe===10)break;var be=e.l===e.length?0:e.read_shift(2),ce=Dg[Ce];if(ce&&ce.f){if(n.bookSheets&&Fe===133&&Ce!==133)break;if(Fe=Ce,ce.r===2||ce.r==12){var at=e.read_shift(2);if(be-=2,!W.enc&&at!==Ce&&((at&255)<<8|at>>8)!==Ce)throw new Error("rt mismatch: "+at+"!="+Ce);ce.r==12&&(e.l+=10,be-=10)}var P={};if(Ce===10?P=ce.f(e,be,W):P=s7(Ce,ce,e,be,W),oe==0&&[9,521,1033,2057].indexOf(Fe)===-1)continue;switch(Ce){case 34:t.opts.Date1904=k.WBProps.date1904=P;break;case 134:t.opts.WriteProtect=!0;break;case 47:if(W.enc||(e.l=0),W.enc=P,!n.password)throw new Error("File is password-protected");if(P.valid==null)throw new Error("Encryption scheme unsupported");if(!P.valid)throw new Error("Password is incorrect");break;case 92:W.lastuser=P;break;case 66:var $t=Number(P);switch($t){case 21010:$t=1200;break;case 32768:$t=1e4;break;case 32769:$t=1252;break}fi(W.codepage=$t),se=!0;break;case 317:W.rrtabid=P;break;case 25:W.winlocked=P;break;case 439:t.opts.RefreshAll=P;break;case 12:t.opts.CalcCount=P;break;case 16:t.opts.CalcDelta=P;break;case 17:t.opts.CalcIter=P;break;case 13:t.opts.CalcMode=P;break;case 14:t.opts.CalcPrecision=P;break;case 95:t.opts.CalcSaveRecalc=P;break;case 15:W.CalcRefMode=P;break;case 2211:t.opts.FullCalc=P;break;case 129:P.fDialog&&(i["!type"]="dialog"),P.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),P.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:ee.push(P);break;case 430:ye.push([P]),ye[ye.length-1].XTI=[];break;case 35:case 547:ye[ye.length-1].push(P);break;case 24:case 536:B={Name:P.Name,Ref:$n(P.rgce,s,null,ye,W)},P.itab>0&&(B.Sheet=P.itab-1),ye.names.push(B),ye[0]||(ye[0]=[],ye[0].XTI=[]),ye[ye.length-1].push(P),P.Name=="_xlnm._FilterDatabase"&&P.itab>0&&P.rgce&&P.rgce[0]&&P.rgce[0][0]&&P.rgce[0][0][0]=="PtgArea3d"&&(L[P.itab-1]={ref:ft(P.rgce[0][0][1][2])});break;case 22:W.ExternCount=P;break;case 23:ye.length==0&&(ye[0]=[],ye[0].XTI=[]),ye[ye.length-1].XTI=ye[ye.length-1].XTI.concat(P),ye.XTI=ye.XTI.concat(P);break;case 2196:if(W.biff<8)break;B!=null&&(B.Comment=P[1]);break;case 18:i["!protect"]=P;break;case 19:P!==0&&W.WTF&&console.error("Password verifier: "+P);break;case 133:o[P.pos]=P,W.snames.push(P.name);break;case 10:{if(--oe)break;if(s.e){if(s.e.r>0&&s.e.c>0){if(s.e.r--,s.e.c--,i["!ref"]=ft(s),n.sheetRows&&n.sheetRows<=s.e.r){var pt=s.e.r;s.e.r=n.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=ft(s),s.e.r=pt}s.e.r++,s.e.c++}Pe.length>0&&(i["!merges"]=Pe),Ee.length>0&&(i["!objects"]=Ee),Be.length>0&&(i["!cols"]=Be),Oe.length>0&&(i["!rows"]=Oe),k.Sheets.push(z)}d===""?h=i:r[d]=i,i=n.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(W.biff===8&&(W.biff={9:2,521:3,1033:4}[Ce]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[P.BIFFVer]||8),W.biffguess=P.BIFFVer==0,P.BIFFVer==0&&P.dt==4096&&(W.biff=5,se=!0,fi(W.codepage=28591)),W.biff==8&&P.BIFFVer==0&&P.dt==16&&(W.biff=2),oe++)break;if(i=n.dense?[]:{},W.biff<8&&!se&&(se=!0,fi(W.codepage=n.codepage||1252)),W.biff<5||P.BIFFVer==0&&P.dt==4096){d===""&&(d="Sheet1"),s={s:{r:0,c:0},e:{r:0,c:0}};var Dt={pos:e.l-be,name:d};o[Dt.pos]=Dt,W.snames.push(d)}else d=(o[De]||{name:""}).name;P.dt==32&&(i["!type"]="chart"),P.dt==64&&(i["!type"]="macro"),Pe=[],Ee=[],W.arrayf=I=[],Be=[],Oe=[],ht=!1,z={Hidden:(o[De]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(n.dense?(i[P.r]||[])[P.c]:i[Ge({c:P.c,r:P.r})])&&++P.c,y={ixfe:P.ixfe,XF:ee[P.ixfe]||{},v:P.val,t:"n"},F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:P.c,r:P.r},y,n);break;case 5:case 517:y={ixfe:P.ixfe,XF:ee[P.ixfe],v:P.val,t:P.t},F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:P.c,r:P.r},y,n);break;case 638:y={ixfe:P.ixfe,XF:ee[P.ixfe],v:P.rknum,t:"n"},F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:P.c,r:P.r},y,n);break;case 189:for(var it=P.c;it<=P.C;++it){var we=P.rkrec[it-P.c][0];y={ixfe:we,XF:ee[we],v:P.rkrec[it-P.c][1],t:"n"},F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:it,r:P.r},y,n)}break;case 6:case 518:case 1030:{if(P.val=="String"){a=P;break}if(y=Bd(P.val,P.cell.ixfe,P.tt),y.XF=ee[y.ixfe],n.cellFormula){var Kt=P.formula;if(Kt&&Kt[0]&&Kt[0][0]&&Kt[0][0][0]=="PtgExp"){var Pr=Kt[0][0][1][0],mi=Kt[0][0][1][1],Pi=Ge({r:Pr,c:mi});M[Pi]?y.f=""+$n(P.formula,s,P.cell,ye,W):y.F=((n.dense?(i[Pr]||[])[mi]:i[Pi])||{}).F}else y.f=""+$n(P.formula,s,P.cell,ye,W)}F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne(P.cell,y,n),a=P}break;case 7:case 519:if(a)a.val=P,y=Bd(P,a.cell.ixfe,"s"),y.XF=ee[y.ixfe],n.cellFormula&&(y.f=""+$n(a.formula,s,a.cell,ye,W)),F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne(a.cell,y,n),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{I.push(P);var qa=Ge(P[0].s);if(x=n.dense?(i[P[0].s.r]||[])[P[0].s.c]:i[qa],n.cellFormula&&x){if(!a||!qa||!x)break;x.f=""+$n(P[1],s,P[0],ye,W),x.F=ft(P[0])}}break;case 1212:{if(!n.cellFormula)break;if(g){if(!a)break;M[Ge(a.cell)]=P[0],x=n.dense?(i[a.cell.r]||[])[a.cell.c]:i[Ge(a.cell)],(x||{}).f=""+$n(P[0],s,p,ye,W)}}break;case 253:y=Bd(c[P.isst].t,P.ixfe,"s"),c[P.isst].h&&(y.h=c[P.isst].h),y.XF=ee[y.ixfe],F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:P.c,r:P.r},y,n);break;case 513:n.sheetStubs&&(y={ixfe:P.ixfe,XF:ee[P.ixfe],t:"z"},F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:P.c,r:P.r},y,n));break;case 190:if(n.sheetStubs)for(var ao=P.c;ao<=P.C;++ao){var Cr=P.ixfe[ao-P.c];y={ixfe:Cr,XF:ee[Cr],t:"z"},F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:ao,r:P.r},y,n)}break;case 214:case 516:case 4:y=Bd(P.val,P.ixfe,"s"),y.XF=ee[y.ixfe],F>0&&(y.z=Z[y.ixfe>>8&63]),Mi(y,n,t.opts.Date1904),ne({c:P.c,r:P.r},y,n);break;case 0:case 512:oe===1&&(s=P);break;case 252:c=P;break;case 1054:if(W.biff==4){Z[F++]=P[1];for(var Fi=0;Fi<F+163&&Ye[Fi]!=P[1];++Fi);Fi>=163&&Cs(P[1],F+163)}else Cs(P[1],P[0]);break;case 30:{Z[F++]=P;for(var co=0;co<F+163&&Ye[co]!=P;++co);co>=163&&Cs(P,F+163)}break;case 229:Pe=Pe.concat(P);break;case 93:Ee[P.cmo[0]]=W.lastobj=P;break;case 438:W.lastobj.TxO=P;break;case 127:W.lastobj.ImData=P;break;case 440:for(_=P[0].s.r;_<=P[0].e.r;++_)for(E=P[0].s.c;E<=P[0].e.c;++E)x=n.dense?(i[_]||[])[E]:i[Ge({c:E,r:_})],x&&(x.l=P[1]);break;case 2048:for(_=P[0].s.r;_<=P[0].e.r;++_)for(E=P[0].s.c;E<=P[0].e.c;++E)x=n.dense?(i[_]||[])[E]:i[Ge({c:E,r:_})],x&&x.l&&(x.l.Tooltip=P[1]);break;case 28:{if(W.biff<=5&&W.biff>=2)break;x=n.dense?(i[P[0].r]||[])[P[0].c]:i[Ge(P[0])];var Wa=Ee[P[2]];x||(n.dense?(i[P[0].r]||(i[P[0].r]=[]),x=i[P[0].r][P[0].c]={t:"z"}):x=i[Ge(P[0])]={t:"z"},s.e.r=Math.max(s.e.r,P[0].r),s.s.r=Math.min(s.s.r,P[0].r),s.e.c=Math.max(s.e.c,P[0].c),s.s.c=Math.min(s.s.c,P[0].c)),x.c||(x.c=[]),v={a:P[1],t:Wa.TxO.t},x.c.push(v)}break;case 2173:T8(ee[P.ixfe],P.ext);break;case 125:{if(!W.cellStyles)break;for(;P.e>=P.s;)Be[P.e--]={width:P.w/256,level:P.level||0,hidden:!!(P.flags&1)},ht||(ht=!0,Kg(P.w/256)),Va(Be[P.e+1])}break;case 520:{var Yn={};P.level!=null&&(Oe[P.r]=Yn,Yn.level=P.level),P.hidden&&(Oe[P.r]=Yn,Yn.hidden=!0),P.hpt&&(Oe[P.r]=Yn,Yn.hpt=P.hpt,Yn.hpx=vu(P.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||fu(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ce]]=P;break;case 161:i["!margins"]||fu(i["!margins"]={}),i["!margins"].header=P.header,i["!margins"].footer=P.footer;break;case 574:P.RTL&&(k.Views[0].RTL=!0);break;case 146:R=P;break;case 2198:fe=P;break;case 140:q=P;break;case 442:d?z.CodeName=P||z.name:k.WBProps.CodeName=P||"ThisWorkbook";break}}else ce||console.error("Missing Info for XLS Record 0x"+Ce.toString(16)),e.l+=be}return t.SheetNames=Oi(o).sort(function(gi,rt){return Number(gi)-Number(rt)}).map(function(gi){return o[gi].name}),n.bookSheets||(t.Sheets=r),!t.SheetNames.length&&h["!ref"]?(t.SheetNames.push("Sheet1"),t.Sheets&&(t.Sheets.Sheet1=h)):t.Preamble=h,t.Sheets&&L.forEach(function(gi,rt){t.Sheets[t.SheetNames[rt]]["!autofilter"]=gi}),t.Strings=c,t.SSF=Nn(Ye),W.enc&&(t.Encryption=W.enc),fe&&(t.Themes=fe),t.Metadata={},q!==void 0&&(t.Metadata.Country=q),ye.names.length>0&&(k.Names=ye.names),t.Workbook=k,t}var mw={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function c7(e,n,t){var r=dt.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=Zy(r,DN,mw.DSI);for(var o in i)n[o]=i[o]}catch(d){if(t.WTF)throw d}var s=dt.find(e,"/!SummaryInformation");if(s&&s.size>0)try{var a=Zy(s,SN,mw.SI);for(var c in a)n[c]==null&&(n[c]=a[c])}catch(d){if(t.WTF)throw d}n.HeadingPairs&&n.TitlesOfParts&&(ub(n.HeadingPairs,n.TitlesOfParts,n,t),delete n.HeadingPairs,delete n.TitlesOfParts)}function zb(e,n){n||(n={}),n1(n),Dw(),n.codepage&&Og(n.codepage);var t,r;if(e.FullPaths){if(dt.find(e,"/encryption"))throw new Error("File is password-protected");t=dt.find(e,"!CompObj"),r=dt.find(e,"/Workbook")||dt.find(e,"/Book")}else{switch(n.type){case"base64":e=di(kr(e));break;case"binary":e=di(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Fn(e,0),r={content:e}}var i,o;if(t&&i7(t),n.bookProps&&!n.bookSheets)i={};else{var s=st?"buffer":"array";if(r&&r.content)i=a7(r.content,n);else if((o=dt.find(e,"PerfectOffice_MAIN"))&&o.content)i=lu.to_workbook(o.content,(n.type=s,n));else if((o=dt.find(e,"NativeContent_MAIN"))&&o.content)i=lu.to_workbook(o.content,(n.type=s,n));else throw(o=dt.find(e,"MN0"))&&o.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");n.bookVBA&&e.FullPaths&&dt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=G8(e))}var a={};return e.FullPaths&&c7(e,a,n),i.Props=i.Custprops=a,n.bookFiles&&(i.cfb=e),i}var Qd={0:{f:$B},1:{f:GB},2:{f:nL},3:{f:KB},4:{f:XB},5:{f:tL},6:{f:oL},7:{f:JB},8:{f:lL},9:{f:uL},10:{f:aL},11:{f:cL},12:{f:QB},13:{f:rL},14:{f:ZB},15:{f:YB},16:{f:jb},17:{f:sL},18:{f:eL},19:{f:Wg},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:BL},40:{},42:{},43:{f:a8},44:{f:s8},45:{f:c8},46:{f:l8},47:{f:u8},48:{},49:{f:dN},50:{},51:{f:I8},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Cb},62:{f:iL},63:{f:R8},64:{f:vL},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qn,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:EL},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:zB},148:{f:qB,p:16},151:{f:hL},152:{},153:{f:NL},154:{},155:{},156:{f:FL},157:{},158:{},159:{T:1,f:S5},160:{T:-1},161:{T:1,f:Ts},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:dL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:O8},336:{T:-1},337:{f:k8,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:_g},357:{},358:{},359:{},360:{T:1},361:{},362:{f:_b},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:pL},427:{f:mL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:xL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:WB},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:fL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:_g},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:q8},633:{T:1},634:{T:-1},635:{T:1,f:$8},636:{T:-1},637:{f:hN},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:DL},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:_L},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Dg={6:{f:hg},10:{f:Lo},12:{f:pn},13:{f:pn},14:{f:tn},15:{f:tn},16:{f:qn},17:{f:tn},18:{f:tn},19:{f:pn},20:{f:nw},21:{f:nw},23:{f:_b},24:{f:iw},25:{f:tn},26:{},27:{},28:{f:jR},29:{},34:{f:tn},35:{f:rw},38:{f:qn},39:{f:qn},40:{f:qn},41:{f:qn},42:{f:tn},43:{f:tn},47:{f:W5},49:{f:yR},51:{f:pn},60:{},61:{f:vR},64:{f:tn},65:{f:CR},66:{f:pn},77:{},80:{},81:{},82:{},85:{f:pn},89:{},90:{},91:{},92:{f:dR},93:{f:$R},94:{},95:{f:tn},96:{},97:{},99:{f:tn},125:{f:Cb},128:{f:kR},129:{f:fR},130:{f:pn},131:{f:tn},132:{f:tn},133:{f:hR},134:{},140:{f:XR},141:{f:pn},144:{},146:{f:KR},151:{},152:{},153:{},154:{},155:{},156:{f:pn},157:{},158:{},160:{f:n5},161:{f:JR},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:AR},190:{f:TR},193:{f:Lo},197:{},198:{},199:{},200:{},201:{},202:{f:tn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:pn},220:{},221:{f:tn},222:{},224:{f:IR},225:{f:lR},226:{f:Lo},227:{},229:{f:HR},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pR},253:{f:wR},255:{f:mR},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:pb},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:tn},353:{f:Lo},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:FR},431:{f:tn},432:{},433:{},434:{},437:{},438:{f:zR},439:{f:tn},440:{f:GR},441:{},442:{f:wu},443:{},444:{f:pn},445:{},446:{},448:{f:Lo},449:{f:ER,r:2},450:{f:Lo},512:{f:ew},513:{f:t5},515:{f:PR},516:{f:bR},517:{f:tw},519:{f:r5},520:{f:gR},523:{},545:{f:ow},549:{f:Jy},566:{},574:{f:_R},638:{f:MR},659:{},1048:{},1054:{f:DR},1084:{},1212:{f:LR},2048:{f:QR},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Fd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Lo},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:ZR,r:12},2173:{f:A8,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:tn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:BR,r:12},2197:{},2198:{f:y8,r:12},2199:{},2200:{},2201:{},2202:{f:VR,r:12},2203:{f:Lo},2204:{},2205:{},2206:{},2207:{},2211:{f:xR},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:pn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:e5},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:YR},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ew},1:{},2:{f:a5},3:{f:s5},4:{f:o5},5:{f:tw},7:{f:c5},8:{},9:{f:Fd},11:{},22:{f:pn},30:{f:SR},31:{},32:{},33:{f:ow},36:{},37:{f:Jy},50:{f:u5},62:{},52:{},67:{},68:{f:pn},69:{},86:{},126:{},127:{f:i5},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:l5},223:{},234:{},354:{},421:{},518:{f:hg},521:{f:Fd},536:{f:iw},547:{f:rw},561:{},579:{},1030:{f:hg},1033:{f:Fd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function li(e,n,t,r){var i=n;if(!isNaN(i)){var o=r||(t||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,o),o>0&&tb(t)&&e.push(t)}}function gw(e,n){var t=n||{};gn!=null&&t.dense==null&&(t.dense=gn);var r=t.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var o=e.match(/<\/table/i),s=i.index,a=o&&o.index||e.length,c=P4(e.slice(s,a),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,h=0,p=0,g=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(s=0;s<c.length;++s){var E=c[s].trim(),_=E.slice(0,3).toLowerCase();if(_=="<tr"){if(++d,t.sheetRows&&t.sheetRows<=d){--d;break}h=0;continue}if(!(_!="<td"&&_!="<th")){var M=E.split(/<\/t[dh]>/i);for(a=0;a<M.length;++a){var I=M[a].trim();if(I.match(/<t[dh]/i)){for(var y=I,q=0;y.charAt(0)=="<"&&(q=y.indexOf(">"))>-1;)y=y.slice(q+1);for(var ee=0;ee<v.length;++ee){var R=v[ee];R.s.c==h&&R.s.r<d&&d<=R.e.r&&(h=R.e.c+1,ee=-1)}var k=Ve(I.slice(0,I.indexOf(">")));g=k.colspan?+k.colspan:1,((p=+k.rowspan)>1||g>1)&&v.push({s:{r:d,c:h},e:{r:d+(p||1)-1,c:h+g-1}});var z=k.t||k["data-t"]||"";if(!y.length){h+=g;continue}if(y=Gw(y),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>h&&(x.s.c=h),x.e.c<h&&(x.e.c=h),!y.length){h+=g;continue}var V={t:"s",v:y};t.raw||!y.trim().length||z=="s"||(y==="TRUE"?V={t:"b",v:!0}:y==="FALSE"?V={t:"b",v:!1}:isNaN(pi(y))?isNaN(La(y).getDate())||(V={t:"d",v:On(y)},t.cellDates||(V={t:"n",v:ar(V.v)}),V.z=t.dateNF||Ye[14]):V={t:"n",v:pi(y)}),t.dense?(r[d]||(r[d]=[]),r[d][h]=V):r[Ge({r:d,c:h})]=V,h+=g}}}}return r["!ref"]=ft(x),v.length&&(r["!merges"]=v),r}function u7(e,n,t,r){for(var i=e["!merges"]||[],o=[],s=n.s.c;s<=n.e.c;++s){for(var a=0,c=0,d=0;d<i.length;++d)if(!(i[d].s.r>t||i[d].s.c>s)&&!(i[d].e.r<t||i[d].e.c<s)){if(i[d].s.r<t||i[d].s.c<s){a=-1;break}a=i[d].e.r-i[d].s.r+1,c=i[d].e.c-i[d].s.c+1;break}if(!(a<0)){var h=Ge({r:t,c:s}),p=r.dense?(e[t]||[])[s]:e[h],g=p&&p.v!=null&&(p.h||Rg(p.w||(oo(p),p.w)||""))||"",x={};a>1&&(x.rowspan=a),c>1&&(x.colspan=c),r.editable?g='<span contenteditable="true">'+g+"</span>":p&&(x["data-t"]=p&&p.t||"z",p.v!=null&&(x["data-v"]=p.v),p.z!=null&&(x["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(g='<a href="'+p.l.Target+'">'+g+"</a>")),x.id=(r.id||"sjs")+"-"+h,o.push(Q4("td",g,x))}}var v="<tr>";return v+o.join("")+"</tr>"}var l7='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',d7="</body></html>";function f7(e,n){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||t.length==0)throw new Error("Invalid HTML: could not find <table>");if(t.length==1)return Wo(gw(t[0],n),n);var r=i1();return t.forEach(function(i,o){o1(r,gw(i,n),"Sheet"+(o+1))}),r}function h7(e,n,t){var r=[];return r.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function p7(e,n){var t=n||{},r=t.header!=null?t.header:l7,i=t.footer!=null?t.footer:d7,o=[r],s=Ha(e["!ref"]);t.dense=Array.isArray(e),o.push(h7(e,s,t));for(var a=s.s.r;a<=s.e.r;++a)o.push(u7(e,s,a,t));return o.push("</table>"+i),o.join("")}function Gb(e,n,t){var r=t||{};gn!=null&&(r.dense=gn);var i=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var s=typeof r.origin=="string"?sr(r.origin):r.origin;i=s.r,o=s.c}var a=n.getElementsByTagName("tr"),c=Math.min(r.sheetRows||1e7,a.length),d={s:{r:0,c:0},e:{r:i,c:o}};if(e["!ref"]){var h=Ha(e["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),i==-1&&(d.e.r=i=h.e.r+1)}var p=[],g=0,x=e["!rows"]||(e["!rows"]=[]),v=0,E=0,_=0,M=0,I=0,y=0;for(e["!cols"]||(e["!cols"]=[]);v<a.length&&E<c;++v){var q=a[v];if(xw(q)){if(r.display)continue;x[E]={hidden:!0}}var ee=q.children;for(_=M=0;_<ee.length;++_){var R=ee[_];if(!(r.display&&xw(R))){var k=R.hasAttribute("data-v")?R.getAttribute("data-v"):R.hasAttribute("v")?R.getAttribute("v"):Gw(R.innerHTML),z=R.getAttribute("data-z")||R.getAttribute("z");for(g=0;g<p.length;++g){var V=p[g];V.s.c==M+o&&V.s.r<E+i&&E+i<=V.e.r&&(M=V.e.c+1-o,g=-1)}y=+R.getAttribute("colspan")||1,((I=+R.getAttribute("rowspan")||1)>1||y>1)&&p.push({s:{r:E+i,c:M+o},e:{r:E+i+(I||1)-1,c:M+o+(y||1)-1}});var re={t:"s",v:k},ne=R.getAttribute("data-t")||R.getAttribute("t")||"";k!=null&&(k.length==0?re.t=ne||"z":r.raw||k.trim().length==0||ne=="s"||(k==="TRUE"?re={t:"b",v:!0}:k==="FALSE"?re={t:"b",v:!1}:isNaN(pi(k))?isNaN(La(k).getDate())||(re={t:"d",v:On(k)},r.cellDates||(re={t:"n",v:ar(re.v)}),re.z=r.dateNF||Ye[14]):re={t:"n",v:pi(k)})),re.z===void 0&&z!=null&&(re.z=z);var W="",fe=R.getElementsByTagName("A");if(fe&&fe.length)for(var Pe=0;Pe<fe.length&&!(fe[Pe].hasAttribute("href")&&(W=fe[Pe].getAttribute("href"),W.charAt(0)!="#"));++Pe);W&&W.charAt(0)!="#"&&(re.l={Target:W}),r.dense?(e[E+i]||(e[E+i]=[]),e[E+i][M+o]=re):e[Ge({c:M+o,r:E+i})]=re,d.e.c<M+o&&(d.e.c=M+o),M+=y}}++E}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,E-1+i),e["!ref"]=ft(d),E>=c&&(e["!fullref"]=ft((d.e.r=a.length-v+E-1+i,d))),e}function Qb(e,n){var t=n||{},r=t.dense?[]:{};return Gb(r,e,n)}function m7(e,n){return Wo(Qb(e,n),n)}function xw(e){var n="",t=g7(e);return t&&(n=t(e).getPropertyValue("display")),n||(n=e.style&&e.style.display),n==="none"}function g7(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function x7(e){var n=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),t=gt(n.replace(/<[^>]*>/g,""));return[t]}var Ew={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Xb(e,n){var t=n||{};gn!=null&&t.dense==null&&(t.dense=gn);var r=Bg(e),i=[],o,s,a={name:""},c="",d=0,h,p,g={},x=[],v=t.dense?[]:{},E,_,M={value:""},I="",y=0,q,ee=[],R=-1,k=-1,z={s:{r:1e6,c:1e7},e:{r:0,c:0}},V=0,re={},ne=[],W={},fe=0,Pe=0,Ee=[],Be=1,Oe=1,ht=[],ye={Names:[]},Fe={},oe=["",""],F=[],Z={},L="",B=0,se=!1,De=!1,Ce=0;for(gu.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");E=gu.exec(r);)switch(E[3]=E[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":E[1]==="/"?(z.e.c>=z.s.c&&z.e.r>=z.s.r?v["!ref"]=ft(z):v["!ref"]="A1:A1",t.sheetRows>0&&t.sheetRows<=z.e.r&&(v["!fullref"]=v["!ref"],z.e.r=t.sheetRows-1,v["!ref"]=ft(z)),ne.length&&(v["!merges"]=ne),Ee.length&&(v["!rows"]=Ee),h.name=h.\u540D\u79F0||h.name,typeof JSON<"u"&&JSON.stringify(h),x.push(h.name),g[h.name]=v,De=!1):E[0].charAt(E[0].length-2)!=="/"&&(h=Ve(E[0],!1),R=k=-1,z.s.r=z.s.c=1e7,z.e.r=z.e.c=0,v=t.dense?[]:{},ne=[],Ee=[],De=!0);break;case"table-row-group":E[1]==="/"?--V:++V;break;case"table-row":case"\u884C":if(E[1]==="/"){R+=Be,Be=1;break}if(p=Ve(E[0],!1),p.\u884C\u53F7?R=p.\u884C\u53F7-1:R==-1&&(R=0),Be=+p["number-rows-repeated"]||1,Be<10)for(Ce=0;Ce<Be;++Ce)V>0&&(Ee[R+Ce]={level:V});k=-1;break;case"covered-table-cell":E[1]!=="/"&&++k,t.sheetStubs&&(t.dense?(v[R]||(v[R]=[]),v[R][k]={t:"z"}):v[Ge({r:R,c:k})]={t:"z"}),I="",ee=[];break;case"table-cell":case"\u6570\u636E":if(E[0].charAt(E[0].length-2)==="/")++k,M=Ve(E[0],!1),Oe=parseInt(M["number-columns-repeated"]||"1",10),_={t:"z",v:null},M.formula&&t.cellFormula!=!1&&(_.f=fw(gt(M.formula))),(M.\u6570\u636E\u7C7B\u578B||M["value-type"])=="string"&&(_.t="s",_.v=gt(M["string-value"]||""),t.dense?(v[R]||(v[R]=[]),v[R][k]=_):v[Ge({r:R,c:k})]=_),k+=Oe-1;else if(E[1]!=="/"){++k,I="",y=0,ee=[],Oe=1;var be=Be?R+Be-1:R;if(k>z.e.c&&(z.e.c=k),k<z.s.c&&(z.s.c=k),R<z.s.r&&(z.s.r=R),be>z.e.r&&(z.e.r=be),M=Ve(E[0],!1),F=[],Z={},_={t:M.\u6570\u636E\u7C7B\u578B||M["value-type"],v:null},t.cellFormula)if(M.formula&&(M.formula=gt(M.formula)),M["number-matrix-columns-spanned"]&&M["number-matrix-rows-spanned"]&&(fe=parseInt(M["number-matrix-rows-spanned"],10)||0,Pe=parseInt(M["number-matrix-columns-spanned"],10)||0,W={s:{r:R,c:k},e:{r:R+fe-1,c:k+Pe-1}},_.F=ft(W),ht.push([W,_.F])),M.formula)_.f=fw(M.formula);else for(Ce=0;Ce<ht.length;++Ce)R>=ht[Ce][0].s.r&&R<=ht[Ce][0].e.r&&k>=ht[Ce][0].s.c&&k<=ht[Ce][0].e.c&&(_.F=ht[Ce][1]);switch((M["number-columns-spanned"]||M["number-rows-spanned"])&&(fe=parseInt(M["number-rows-spanned"],10)||0,Pe=parseInt(M["number-columns-spanned"],10)||0,W={s:{r:R,c:k},e:{r:R+fe-1,c:k+Pe-1}},ne.push(W)),M["number-columns-repeated"]&&(Oe=parseInt(M["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Ht(M["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(M.value);break;case"percentage":_.t="n",_.v=parseFloat(M.value);break;case"currency":_.t="n",_.v=parseFloat(M.value);break;case"date":_.t="d",_.v=On(M["date-value"]),t.cellDates||(_.t="n",_.v=ar(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=O4(M["time-value"])/86400,t.cellDates&&(_.t="d",_.v=Yd(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(M.\u6570\u636E\u6570\u503C);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",M["string-value"]!=null&&(I=gt(M["string-value"]),ee=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(se=!1,_.t==="s"&&(_.v=I||"",ee.length&&(_.R=ee),se=y==0),Fe.Target&&(_.l=Fe),F.length>0&&(_.c=F,F=[]),I&&t.cellText!==!1&&(_.w=I),se&&(_.t="z",delete _.v),(!se||t.sheetStubs)&&!(t.sheetRows&&t.sheetRows<=R))for(var ce=0;ce<Be;++ce){if(Oe=parseInt(M["number-columns-repeated"]||"1",10),t.dense)for(v[R+ce]||(v[R+ce]=[]),v[R+ce][k]=ce==0?_:Nn(_);--Oe>0;)v[R+ce][k+Oe]=Nn(_);else for(v[Ge({r:R+ce,c:k})]=_;--Oe>0;)v[Ge({r:R+ce,c:k+Oe})]=Nn(_);z.e.c<=k&&(z.e.c=k)}Oe=parseInt(M["number-columns-repeated"]||"1",10),k+=Oe-1,Oe=0,_={},I="",ee=[]}Fe={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(E[1]==="/"){if((o=i.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!0]);break;case"annotation":if(E[1]==="/"){if((o=i.pop())[0]!==E[3])throw"Bad state: "+o;Z.t=I,ee.length&&(Z.R=ee),Z.a=L,F.push(Z)}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);L="",B=0,I="",y=0,ee=[];break;case"creator":E[1]==="/"?L=r.slice(B,E.index):B=E.index+E[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(E[1]==="/"){if((o=i.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&i.push([E[3],!1]);I="",y=0,ee=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(E[1]==="/"){if(re[a.name]=c,(o=i.pop())[0]!==E[3])throw"Bad state: "+o}else E[0].charAt(E[0].length-2)!=="/"&&(c="",a=Ve(E[0],!1),i.push([E[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Ve(E[0],!1),c+=Ew[E[3]][s.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":s=Ve(E[0],!1),c+=Ew[E[3]][s.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(E[0].slice(-2)==="/>")break;if(E[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":c+=r.slice(d,E.index);break}else d=E.index+E[0].length;break;case"named-range":s=Ve(E[0],!1),oe=pg(s["cell-range-address"]);var at={Name:s.name,Ref:oe[0]+"!"+oe[1]};De&&(at.Sheet=x.length),ye.Names.push(at);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(E[1]==="/"&&(!M||!M["string-value"])){var P=x7(r.slice(y,E.index),q);I=(I.length>0?I+`
`:"")+P[0]}else q=Ve(E[0],!1),y=E.index+E[0].length;break;case"s":break;case"database-range":if(E[1]==="/")break;try{oe=pg(Ve(E[0])["target-range-address"]),g[oe[0]]["!autofilter"]={ref:oe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(E[1]!=="/"){if(Fe=Ve(E[0],!1),!Fe.href)break;Fe.Target=gt(Fe.href),delete Fe.href,Fe.Target.charAt(0)=="#"&&Fe.Target.indexOf(".")>-1?(oe=pg(Fe.Target.slice(1)),Fe.Target="#"+oe[0]+"!"+oe[1]):Fe.Target.match(/^\.\.[\\\/]/)&&(Fe.Target=Fe.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(E[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(t.WTF)throw new Error(E)}}var $t={Sheets:g,SheetNames:x,Workbook:ye};return t.bookSheets&&delete $t.Sheets,$t}function vw(e,n){n=n||{},Gr(e,"META-INF/manifest.xml")&&PN(hn(e,"META-INF/manifest.xml"),n);var t=Ir(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var r=Xb(kt(t),n);return Gr(e,"meta.xml")&&(r.Props=cb(hn(e,"meta.xml"))),r}function _w(e,n){return Xb(e,n)}function e1(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Sg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):kt(Ms(e))}function Mg(e){var n=e.reduce(function(i,o){return i+o.length},0),t=new Uint8Array(n),r=0;return e.forEach(function(i){t.set(i,r),r+=i.length}),t}function Cw(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function E7(e,n){for(var t=(e[n+15]&127)<<7|e[n+14]>>1,r=e[n+14]&1,i=n+13;i>=n;--i)r=r*256+e[i];return(e[n+15]&128?-r:r)*Math.pow(10,t-6176)}function _u(e,n){var t=n?n[0]:0,r=e[t]&127;e:if(e[t++]>=128&&(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,28),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,35),++t,e[t++]<128)||(r+=(e[t]&127)*Math.pow(2,42),++t,e[t++]<128)))break e;return n&&(n[0]=t),r}function yn(e){var n=0,t=e[n]&127;e:if(e[n++]>=128){if(t|=(e[n]&127)<<7,e[n++]<128||(t|=(e[n]&127)<<14,e[n++]<128)||(t|=(e[n]&127)<<21,e[n++]<128))break e;t|=(e[n]&127)<<28}return t}function Wn(e){for(var n=[],t=[0];t[0]<e.length;){var r=t[0],i=_u(e,t),o=i&7;i=Math.floor(i/8);var s=0,a;if(i==0)break;switch(o){case 0:{for(var c=t[0];e[t[0]++]>=128;);a=e.slice(c,t[0])}break;case 5:s=4,a=e.slice(t[0],t[0]+s),t[0]+=s;break;case 1:s=8,a=e.slice(t[0],t[0]+s),t[0]+=s;break;case 2:s=_u(e,t),a=e.slice(t[0],t[0]+s),t[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(i," at offset ").concat(r))}var d={data:a,type:o};n[i]==null?n[i]=[d]:n[i].push(d)}return n}function t1(e,n){return e?.map(function(t){return n(t.data)})||[]}function v7(e){for(var n,t=[],r=[0];r[0]<e.length;){var i=_u(e,r),o=Wn(e.slice(r[0],r[0]+i));r[0]+=i;var s={id:yn(o[1][0].data),messages:[]};o[2].forEach(function(a){var c=Wn(a.data),d=yn(c[3][0].data);s.messages.push({meta:c,data:e.slice(r[0],r[0]+d)}),r[0]+=d}),(n=o[3])!=null&&n[0]&&(s.merge=yn(o[3][0].data)>>>0>0),t.push(s)}return t}function _7(e,n){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],r=_u(n,t),i=[];t[0]<n.length;){var o=n[t[0]]&3;if(o==0){var s=n[t[0]++]>>2;if(s<60)++s;else{var a=s-59;s=n[t[0]],a>1&&(s|=n[t[0]+1]<<8),a>2&&(s|=n[t[0]+2]<<16),a>3&&(s|=n[t[0]+3]<<24),s>>>=0,s++,t[0]+=a}i.push(n.slice(t[0],t[0]+s)),t[0]+=s;continue}else{var c=0,d=0;if(o==1?(d=(n[t[0]]>>2&7)+4,c=(n[t[0]++]&224)<<3,c|=n[t[0]++]):(d=(n[t[0]++]>>2)+1,o==2?(c=n[t[0]]|n[t[0]+1]<<8,t[0]+=2):(c=(n[t[0]]|n[t[0]+1]<<8|n[t[0]+2]<<16|n[t[0]+3]<<24)>>>0,t[0]+=4)),i=[Mg(i)],c==0)throw new Error("Invalid offset 0");if(c>i[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(i.push(i[0].slice(-c)),d-=c;d>=i[i.length-1].length;)i.push(i[i.length-1]),d-=i[i.length-1].length;i.push(i[0].slice(-c,-c+d))}}var h=Mg(i);if(h.length!=r)throw new Error("Unexpected length: ".concat(h.length," != ").concat(r));return h}function C7(e){for(var n=[],t=0;t<e.length;){var r=e[t++],i=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,n.push(_7(r,e.slice(t,t+i))),t+=i}if(t!==e.length)throw new Error("data is not a valid framed stream!");return Mg(n)}function y7(e,n,t,r){var i=e1(e),o=i.getUint32(4,!0),s=(r>1?12:8)+Cw(o&(r>1?3470:398))*4,a=-1,c=-1,d=NaN,h=new Date(2001,0,1);o&512&&(a=i.getUint32(s,!0),s+=4),s+=Cw(o&(r>1?12288:4096))*4,o&16&&(c=i.getUint32(s,!0),s+=4),o&32&&(d=i.getFloat64(s,!0),s+=8),o&64&&(h.setTime(h.getTime()+i.getFloat64(s,!0)*1e3),s+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:n[c]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(a>-1)p={t:"s",v:t[a]};else if(c>-1)p={t:"s",v:n[c]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function w7(e,n,t){var r=e1(e),i=r.getUint32(8,!0),o=12,s=-1,a=-1,c=NaN,d=NaN,h=new Date(2001,0,1);i&1&&(c=E7(e,o),o+=16),i&2&&(d=r.getFloat64(o,!0),o+=8),i&4&&(h.setTime(h.getTime()+r.getFloat64(o,!0)*1e3),o+=8),i&8&&(a=r.getUint32(o,!0),o+=4),i&16&&(s=r.getUint32(o,!0),o+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:c};break;case 3:p={t:"s",v:n[a]};break;case 5:p={t:"d",v:h};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(s>-1)p={t:"s",v:t[s]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:c};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return p}function b7(e,n,t){switch(e[0]){case 0:case 1:case 2:case 3:return y7(e,n,t,e[0]);case 5:return w7(e,n,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Ho(e){var n=Wn(e);return _u(n[1][0].data)}function yw(e,n){var t=Wn(n.data),r=yn(t[1][0].data),i=t[3],o=[];return(i||[]).forEach(function(s){var a=Wn(s.data),c=yn(a[1][0].data)>>>0;switch(r){case 1:o[c]=Sg(a[3][0].data);break;case 8:{var d=e[Ho(a[9][0].data)][0],h=Wn(d.data),p=e[Ho(h[1][0].data)][0],g=yn(p.meta[1][0].data);if(g!=2001)throw new Error("2000 unexpected reference to ".concat(g));var x=Wn(p.data);o[c]=x[3].map(function(v){return Sg(v.data)}).join("")}break}}),o}function D7(e,n){var t,r,i,o,s,a,c,d,h,p,g,x,v,E,_=Wn(e),M=yn(_[1][0].data)>>>0,I=yn(_[2][0].data)>>>0,y=((r=(t=_[8])==null?void 0:t[0])==null?void 0:r.data)&&yn(_[8][0].data)>0||!1,q,ee;if((o=(i=_[7])==null?void 0:i[0])!=null&&o.data&&n!=0)q=(a=(s=_[7])==null?void 0:s[0])==null?void 0:a.data,ee=(d=(c=_[6])==null?void 0:c[0])==null?void 0:d.data;else if((p=(h=_[4])==null?void 0:h[0])!=null&&p.data&&n!=1)q=(x=(g=_[4])==null?void 0:g[0])==null?void 0:x.data,ee=(E=(v=_[3])==null?void 0:v[0])==null?void 0:E.data;else throw"NUMBERS Tile missing ".concat(n," cell storage");for(var R=y?4:1,k=e1(q),z=[],V=0;V<q.length/2;++V){var re=k.getUint16(V*2,!0);re<65535&&z.push([V,re])}if(z.length!=I)throw"Expected ".concat(I," cells, found ").concat(z.length);var ne=[];for(V=0;V<z.length-1;++V)ne[z[V][0]]=ee.subarray(z[V][1]*R,z[V+1][1]*R);return z.length>=1&&(ne[z[z.length-1][0]]=ee.subarray(z[z.length-1][1]*R)),{R:M,cells:ne}}function S7(e,n){var t,r=Wn(n.data),i=(t=r?.[7])!=null&&t[0]?yn(r[7][0].data)>>>0>0?1:0:-1,o=t1(r[5],function(s){return D7(s,i)});return{nrows:yn(r[4][0].data)>>>0,data:o.reduce(function(s,a){return s[a.R]||(s[a.R]=[]),a.cells.forEach(function(c,d){if(s[a.R][d])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(d));s[a.R][d]=c}),s},[])}}function M7(e,n,t){var r,i=Wn(n.data),o={s:{r:0,c:0},e:{r:0,c:0}};if(o.e.r=(yn(i[6][0].data)>>>0)-1,o.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(o.e.c=(yn(i[7][0].data)>>>0)-1,o.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));t["!ref"]=ft(o);var s=Wn(i[4][0].data),a=yw(e,e[Ho(s[4][0].data)][0]),c=(r=s[17])!=null&&r[0]?yw(e,e[Ho(s[17][0].data)][0]):[],d=Wn(s[3][0].data),h=0;d[1].forEach(function(p){var g=Wn(p.data),x=e[Ho(g[2][0].data)][0],v=yn(x.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var E=S7(e,x);E.data.forEach(function(_,M){_.forEach(function(I,y){var q=Ge({r:h+M,c:y}),ee=b7(I,a,c);ee&&(t[q]=ee)})}),h+=E.nrows})}function A7(e,n){var t=Wn(n.data),r={"!ref":"A1"},i=e[Ho(t[2][0].data)],o=yn(i[0].meta[1][0].data);if(o!=6001)throw new Error("6000 unexpected reference to ".concat(o));return M7(e,i[0],r),r}function T7(e,n){var t,r=Wn(n.data),i={name:(t=r[1])!=null&&t[0]?Sg(r[1][0].data):"",sheets:[]},o=t1(r[2],Ho);return o.forEach(function(s){e[s].forEach(function(a){var c=yn(a.meta[1][0].data);c==6e3&&i.sheets.push(A7(e,a))})}),i}function O7(e,n){var t=i1(),r=Wn(n.data),i=t1(r[1],Ho);if(i.forEach(function(o){e[o].forEach(function(s){var a=yn(s.meta[1][0].data);if(a==2){var c=T7(e,s);c.sheets.forEach(function(d,h){o1(t,d,h==0?c.name:c.name+"_"+h,!0)})}})}),t.SheetNames.length==0)throw new Error("Empty NUMBERS file");return t}function gg(e){var n,t,r,i,o={},s=[];if(e.FullPaths.forEach(function(c){if(c.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(c){if(c.name.match(/\.iwa$/)){var d;try{d=C7(c.content)}catch(p){return console.log("?? "+c.content.length+" "+(p.message||p))}var h;try{h=v7(d)}catch(p){return console.log("## "+(p.message||p))}h.forEach(function(p){o[p.id]=p.messages,s.push(p.id)})}}),!s.length)throw new Error("File has no messages");var a=((i=(r=(t=(n=o?.[1])==null?void 0:n[0])==null?void 0:t.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&yn(o[1][0].meta[1][0].data)==1&&o[1][0];if(a||s.forEach(function(c){o[c].forEach(function(d){var h=yn(d.meta[1][0].data)>>>0;if(h==1)if(!a)a=d;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return O7(o,a)}function I7(e){return function(t){for(var r=0;r!=e.length;++r){var i=e[r];t[i[0]]===void 0&&(t[i[0]]=i[1]),i[2]==="n"&&(t[i[0]]=Number(t[i[0]]))}}}function n1(e){I7([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function k7(e){return to.WS.indexOf(e)>-1?"sheet":to.CS&&e==to.CS?"chart":to.DS&&e==to.DS?"dialog":to.MS&&e==to.MS?"macro":e&&e.length?e:"sheet"}function P7(e,n){if(!e)return 0;try{e=n.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,k7(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function F7(e,n,t,r,i,o,s,a,c,d,h,p){try{o[r]=cu(Ir(e,t,!0),n);var g=hn(e,n),x;switch(a){case"sheet":x=UL(g,n,i,c,o[r],d,h,p);break;case"chart":if(x=jL(g,n,i,c,o[r],d,h,p),!x||!x["!drawel"])break;var v=ru(x["!drawel"].Target,n),E=Cg(v),_=V8(Ir(e,v,!0),cu(Ir(e,E,!0),v)),M=ru(_,v),I=Cg(M);x=wL(Ir(e,M,!0),M,c,cu(Ir(e,I,!0),M),d,x);break;case"macro":x=HL(g,n,i,c,o[r],d,h,p);break;case"dialog":x=$L(g,n,i,c,o[r],d,h,p);break;default:throw new Error("Unrecognized sheet type "+a)}s[r]=x;var y=[];o&&o[r]&&Oi(o[r]).forEach(function(q){var ee="";if(o[r][q].Type==to.CMNT){ee=ru(o[r][q].Target,n);var R=GL(hn(e,ee,!0),ee,c);if(!R||!R.length)return;aw(x,R,!1)}o[r][q].Type==to.TCMNT&&(ee=ru(o[r][q].Target,n),y=y.concat(j8(hn(e,ee,!0),c)))}),y&&y.length&&aw(x,y,!0,c.people||[])}catch(q){if(c.WTF)throw q}}function Wr(e){return e.charAt(0)=="/"?e.slice(1):e}function N7(e,n){if(Bw(),n=n||{},n1(n),Gr(e,"META-INF/manifest.xml")||Gr(e,"objectdata.xml"))return vw(e,n);if(Gr(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof gg<"u"){if(e.FileIndex)return gg(e);var t=dt.utils.cfb_new();return Fy(e).forEach(function(Pe){N4(t,Pe,$w(e,Pe))}),gg(t)}throw new Error("Unsupported NUMBERS file")}if(!Gr(e,"[Content_Types].xml"))throw Gr(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Gr(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=Fy(e),i=IN(Ir(e,"[Content_Types].xml")),o=!1,s,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",hn(e,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!hn(e,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),o=!0}i.workbooks[0].slice(-3)=="bin"&&(o=!0);var c={},d={};if(!n.bookSheets&&!n.bookProps){if(du=[],i.sst)try{du=zL(hn(e,Wr(i.sst)),i.sst,n)}catch(Pe){if(n.WTF)throw Pe}n.cellStyles&&i.themes.length&&(c=WL(Ir(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],n)),i.style&&(d=qL(hn(e,Wr(i.style)),i.style,c,n))}i.links.map(function(Pe){try{var Ee=cu(Ir(e,Cg(Wr(Pe))),Pe);return XL(hn(e,Wr(Pe)),Ee,Pe,n)}catch{}});var h=VL(hn(e,Wr(i.workbooks[0])),i.workbooks[0],n),p={},g="";i.coreprops.length&&(g=hn(e,Wr(i.coreprops[0]),!0),g&&(p=cb(g)),i.extprops.length!==0&&(g=hn(e,Wr(i.extprops[0]),!0),g&&RN(g,p,n)));var x={};(!n.bookSheets||n.bookProps)&&i.custprops.length!==0&&(g=Ir(e,Wr(i.custprops[0]),!0),g&&(x=LN(g,n)));var v={};if((n.bookSheets||n.bookProps)&&(h.Sheets?s=h.Sheets.map(function(Ee){return Ee.name}):p.Worksheets&&p.SheetNames.length>0&&(s=p.SheetNames),n.bookProps&&(v.Props=p,v.Custprops=x),n.bookSheets&&typeof s<"u"&&(v.SheetNames=s),n.bookSheets?v.SheetNames:n.bookProps))return v;s={};var E={};n.bookDeps&&i.calcchain&&(E=QL(hn(e,Wr(i.calcchain)),i.calcchain,n));var _=0,M={},I,y;{var q=h.Sheets;p.Worksheets=q.length,p.SheetNames=[];for(var ee=0;ee!=q.length;++ee)p.SheetNames[ee]=q[ee].name}var R=o?"bin":"xml",k=i.workbooks[0].lastIndexOf("/"),z=(i.workbooks[0].slice(0,k+1)+"_rels/"+i.workbooks[0].slice(k+1)+".rels").replace(/^\//,"");Gr(e,z)||(z="xl/_rels/workbook."+R+".rels");var V=cu(Ir(e,z,!0),z.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(n.xlmeta=YL(hn(e,Wr(i.metadata[0])),i.metadata[0],n)),(i.people||[]).length>=1&&(n.people=H8(hn(e,Wr(i.people[0])),n)),V&&(V=P7(V,h.Sheets));var re=hn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=p.Worksheets;++_){var ne="sheet";if(V&&V[_]?(I="xl/"+V[_][1].replace(/[\/]?xl\//,""),Gr(e,I)||(I=V[_][1]),Gr(e,I)||(I=z.replace(/_rels\/.*$/,"")+V[_][1]),ne=V[_][2]):(I="xl/worksheets/sheet"+(_+1-re)+"."+R,I=I.replace(/sheet0\./,"sheet.")),y=I.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),n&&n.sheets!=null)switch(typeof n.sheets){case"number":if(_!=n.sheets)continue e;break;case"string":if(p.SheetNames[_].toLowerCase()!=n.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(n.sheets)){for(var W=!1,fe=0;fe!=n.sheets.length;++fe)typeof n.sheets[fe]=="number"&&n.sheets[fe]==_&&(W=1),typeof n.sheets[fe]=="string"&&n.sheets[fe].toLowerCase()==p.SheetNames[_].toLowerCase()&&(W=1);if(!W)continue e}}F7(e,I,y,p.SheetNames[_],_,M,s,ne,n,h,c,d)}return v={Directory:i,Workbook:h,Props:p,Custprops:x,Deps:E,Sheets:s,SheetNames:p.SheetNames,Strings:du,Styles:d,Themes:c,SSF:Nn(Ye)},n&&n.bookFiles&&(e.files?(v.keys=r,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(Pe,Ee){Pe=Pe.replace(/^Root Entry[\/]/,""),v.keys.push(Pe),v.files[Pe]=e.FileIndex[Ee]}))),n&&n.bookVBA&&(i.vba.length>0?v.vbaraw=hn(e,Wr(i.vba[0]),!0):i.defaults&&i.defaults.bin===z8&&(v.vbaraw=hn(e,"xl/vbaProject.bin",!0))),v}function R7(e,n){var t=n||{},r="Workbook",i=dt.find(e,r);try{if(r="/!DataSpaces/Version",i=dt.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(A5(i.content),r="/!DataSpaces/DataSpaceMap",i=dt.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=O5(i.content);if(o.length!==1||o[0].comps.length!==1||o[0].comps[0].t!==0||o[0].name!=="StrongEncryptionDataSpace"||o[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=dt.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=I5(i.content);if(s.length!=1||s[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=dt.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);P5(i.content)}catch{}if(r="/EncryptionInfo",i=dt.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=F5(i.content);if(r="/EncryptedPackage",i=dt.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,t.password||"",t);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,t.password||"",t);throw new Error("File is password-protected")}function r1(e,n){var t="";switch((n||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=kr(e.slice(0,12));break;case"binary":t=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(n&&n.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function B7(e,n){return dt.find(e,"EncryptedPackage")?R7(e,n):zb(e,n)}function L7(e,n){var t,r=e,i=n||{};return i.type||(i.type=st&&Buffer.isBuffer(e)?"buffer":"base64"),t=qw(r,i),N7(t,i)}function Yb(e,n){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return bg(e.slice(t),n);default:break e}return xu.to_workbook(e,n)}function V7(e,n){var t="",r=r1(e,n);switch(n.type){case"base64":t=kr(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=bs(e);break;default:throw new Error("Unrecognized type "+n.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(t=kt(t)),n.type="binary",Yb(t,n)}function U7(e,n){var t=e;return n.type=="base64"&&(t=kr(t)),t=wt.utils.decode(1200,t.slice(2),"str"),n.type="binary",Yb(t,n)}function j7(e){return e.match(/[^\x00-\x7F]/)?iu(e):e}function xg(e,n,t,r){return r?(t.type="string",xu.to_workbook(e,t)):xu.to_workbook(n,t)}function Xd(e,n){Dw();var t=n||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Xd(new Uint8Array(e),(t=Nn(t),t.type="array",t));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!t.type&&(t.type=typeof Deno<"u"?"buffer":"array");var r=e,i=[0,0,0,0],o=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),Ra={},t.dateNF&&(Ra.dateNF=t.dateNF),t.type||(t.type=st&&Buffer.isBuffer(e)?"buffer":"base64"),t.type=="file"&&(t.type=st?"buffer":"binary",r=A4(e),typeof Uint8Array<"u"&&!st&&(t.type="array")),t.type=="string"&&(o=!0,t.type="binary",t.codepage=65001,r=j7(e)),t.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var s=new ArrayBuffer(3),a=new Uint8Array(s);if(a.foo="bar",!a.foo)return t=Nn(t),t.type="array",Xd(Ig(r),t)}switch((i=r1(r,t))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return B7(dt.read(r,t),t);break;case 9:if(i[1]<=8)return zb(r,t);break;case 60:return bg(r,t);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return m5(r,t);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return h5.to_workbook(r,t);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?L7(r,t):xg(e,r,t,o);case 239:return i[3]===60?bg(r,t):xg(e,r,t,o);case 255:if(i[1]===254)return U7(r,t);if(i[1]===0&&i[2]===2&&i[3]===0)return lu.to_workbook(r,t);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return lu.to_workbook(r,t);break;case 3:case 131:case 139:case 140:return sw.to_workbook(r,t);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return z5.to_workbook(r,t);break;case 10:case 13:case 32:return V7(r,t);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return d5.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?sw.to_workbook(r,t):xg(e,r,t,o)}function H7(e,n,t,r,i,o,s,a){var c=Rn(t),d=a.defval,h=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),p=!0,g=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(g,"__rowNum__",{value:t,enumerable:!1})}catch{g.__rowNum__=t}else g.__rowNum__=t;if(!s||e[t])for(var x=n.s.c;x<=n.e.c;++x){var v=s?e[t][x]:e[r[x]+c];if(v===void 0||v.t===void 0){if(d===void 0)continue;o[x]!=null&&(g[o[x]]=d);continue}var E=v.v;switch(v.t){case"z":if(E==null)break;continue;case"e":E=E==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(o[x]!=null){if(E==null)if(v.t=="e"&&E===null)g[o[x]]=null;else if(d!==void 0)g[o[x]]=d;else if(h&&E===null)g[o[x]]=null;else continue;else g[o[x]]=h&&(v.t!=="n"||v.t==="n"&&a.rawNumbers!==!1)?E:oo(v,E,a);E!=null&&(p=!1)}}return{row:g,isempty:p}}function Ag(e,n){if(e==null||e["!ref"]==null)return[];var t={t:"n",v:0},r=0,i=1,o=[],s=0,a="",c={s:{r:0,c:0},e:{r:0,c:0}},d=n||{},h=d.range!=null?d.range:e["!ref"];switch(d.header===1?r=1:d.header==="A"?r=2:Array.isArray(d.header)?r=3:d.header==null&&(r=0),typeof h){case"string":c=Yt(h);break;case"number":c=Yt(e["!ref"]),c.s.r=h;break;default:c=h}r>0&&(i=0);var p=Rn(c.s.r),g=[],x=[],v=0,E=0,_=Array.isArray(e),M=c.s.r,I=0,y={};_&&!e[M]&&(e[M]=[]);var q=d.skipHidden&&e["!cols"]||[],ee=d.skipHidden&&e["!rows"]||[];for(I=c.s.c;I<=c.e.c;++I)if(!(q[I]||{}).hidden)switch(g[I]=Cn(I),t=_?e[M][I]:e[g[I]+p],r){case 1:o[I]=I-c.s.c;break;case 2:o[I]=g[I];break;case 3:o[I]=d.header[I-c.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),a=s=oo(t,null,d),E=y[s]||0,!E)y[s]=1;else{do a=s+"_"+E++;while(y[a]);y[s]=E,y[a]=1}o[I]=a}for(M=c.s.r+i;M<=c.e.r;++M)if(!(ee[M]||{}).hidden){var R=H7(e,c,M,g,r,o,_,d);(R.isempty===!1||(r===1?d.blankrows!==!1:d.blankrows))&&(x[v++]=R.row)}return x.length=v,x}var ww=/"/g;function $7(e,n,t,r,i,o,s,a){for(var c=!0,d=[],h="",p=Rn(t),g=n.s.c;g<=n.e.c;++g)if(r[g]){var x=a.dense?(e[t]||[])[g]:e[r[g]+p];if(x==null)h="";else if(x.v!=null){c=!1,h=""+(a.rawNumbers&&x.t=="n"?x.v:oo(x,null,a));for(var v=0,E=0;v!==h.length;++v)if((E=h.charCodeAt(v))===i||E===o||E===34||a.forceQuotes){h='"'+h.replace(ww,'""')+'"';break}h=="ID"&&(h='"ID"')}else x.f!=null&&!x.F?(c=!1,h="="+x.f,h.indexOf(",")>=0&&(h='"'+h.replace(ww,'""')+'"')):h="";d.push(h)}return a.blankrows===!1&&c?null:d.join(s)}function Kb(e,n){var t=[],r=n??{};if(e==null||e["!ref"]==null)return"";var i=Yt(e["!ref"]),o=r.FS!==void 0?r.FS:",",s=o.charCodeAt(0),a=r.RS!==void 0?r.RS:`
`,c=a.charCodeAt(0),d=new RegExp((o=="|"?"\\|":o)+"+$"),h="",p=[];r.dense=Array.isArray(e);for(var g=r.skipHidden&&e["!cols"]||[],x=r.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(g[v]||{}).hidden||(p[v]=Cn(v));for(var E=0,_=i.s.r;_<=i.e.r;++_)(x[_]||{}).hidden||(h=$7(e,i,_,p,s,c,o,r),h!=null&&(r.strip&&(h=h.replace(d,"")),(h||r.blankrows!==!1)&&t.push((E++?a:"")+h)));return delete r.dense,t.join("")}function q7(e,n){n||(n={}),n.FS="	",n.RS=`
`;var t=Kb(e,n);if(typeof wt>"u"||n.type=="string")return t;var r=wt.utils.encode(1200,t,"str");return"\xFF\xFE"+r}function W7(e){var n="",t,r="";if(e==null||e["!ref"]==null)return[];var i=Yt(e["!ref"]),o="",s=[],a,c=[],d=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)s[a]=Cn(a);for(var h=i.s.r;h<=i.e.r;++h)for(o=Rn(h),a=i.s.c;a<=i.e.c;++a)if(n=s[a]+o,t=d?(e[h]||[])[a]:e[n],r="",t!==void 0){if(t.F!=null){if(n=t.F,!t.f)continue;r=t.f,n.indexOf(":")==-1&&(n=n+":"+n)}if(t.f!=null)r=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)r=""+t.v;else if(t.t=="b")r=t.v?"TRUE":"FALSE";else if(t.w!==void 0)r="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?r="'"+t.v:r=""+t.v}}c[c.length]=n+"="+r}return c}function Zb(e,n,t){var r=t||{},i=+!r.skipHeader,o=e||{},s=0,a=0;if(o&&r.origin!=null)if(typeof r.origin=="number")s=r.origin;else{var c=typeof r.origin=="string"?sr(r.origin):r.origin;s=c.r,a=c.c}var d,h={s:{c:0,r:0},e:{c:a,r:s+n.length-1+i}};if(o["!ref"]){var p=Yt(o["!ref"]);h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),s==-1&&(s=p.e.r+1,h.e.r=s+n.length-1+i)}else s==-1&&(s=0,h.e.r=n.length-1+i);var g=r.header||[],x=0;n.forEach(function(E,_){Oi(E).forEach(function(M){(x=g.indexOf(M))==-1&&(g[x=g.length]=M);var I=E[M],y="z",q="",ee=Ge({c:a+x,r:s+_+i});d=Cu(o,ee),I&&typeof I=="object"&&!(I instanceof Date)?o[ee]=I:(typeof I=="number"?y="n":typeof I=="boolean"?y="b":typeof I=="string"?y="s":I instanceof Date?(y="d",r.cellDates||(y="n",I=ar(I)),q=r.dateNF||Ye[14]):I===null&&r.nullError&&(y="e",I=0),d?(d.t=y,d.v=I,delete d.w,delete d.R,q&&(d.z=q)):o[ee]=d={t:y,v:I},q&&(d.z=q))})}),h.e.c=Math.max(h.e.c,a+g.length-1);var v=Rn(s);if(i)for(x=0;x<g.length;++x)o[Cn(x+a)+v]={t:"s",v:g[x]};return o["!ref"]=ft(h),o}function z7(e,n){return Zb(null,e,n)}function Cu(e,n,t){if(typeof n=="string"){if(Array.isArray(e)){var r=sr(n);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[n]||(e[n]={t:"z"})}return typeof n!="number"?Cu(e,Ge(n)):Cu(e,Ge({r:n,c:t||0}))}function G7(e,n){if(typeof n=="number"){if(n>=0&&e.SheetNames.length>n)return n;throw new Error("Cannot find sheet # "+n)}else if(typeof n=="string"){var t=e.SheetNames.indexOf(n);if(t>-1)return t;throw new Error("Cannot find sheet name |"+n+"|")}else throw new Error("Cannot find sheet |"+n+"|")}function i1(){return{SheetNames:[],Sheets:{}}}function o1(e,n,t,r){var i=1;if(!t)for(;i<=65535&&e.SheetNames.indexOf(t="Sheet"+i)!=-1;++i,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(t)>=0){var o=t.match(/(^.*?)(\d+)$/);i=o&&+o[2]||0;var s=o&&o[1]||t;for(++i;i<=65535&&e.SheetNames.indexOf(t=s+i)!=-1;++i);}if(IL(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=n,t}function Q7(e,n,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=G7(e,n);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[r].Hidden=t}function X7(e,n){return e.z=n,e}function Jb(e,n,t){return n?(e.l={Target:n},t&&(e.l.Tooltip=t)):delete e.l,e}function Y7(e,n,t){return Jb(e,"#"+n,t)}function K7(e,n,t){e.c||(e.c=[]),e.c.push({t:n,a:t||"SheetJS"})}function Z7(e,n,t,r){for(var i=typeof n!="string"?n:Yt(n),o=typeof n=="string"?n:ft(n),s=i.s.r;s<=i.e.r;++s)for(var a=i.s.c;a<=i.e.c;++a){var c=Cu(e,s,a);c.t="n",c.F=o,delete c.v,s==i.s.r&&a==i.s.c&&(c.f=t,r&&(c.D=!0))}return e}var e2={encode_col:Cn,encode_row:Rn,encode_cell:Ge,encode_range:ft,decode_col:qg,decode_row:$g,split_cell:lN,decode_cell:sr,decode_range:Ha,format_cell:oo,sheet_add_aoa:rb,sheet_add_json:Zb,sheet_add_dom:Gb,aoa_to_sheet:$a,json_to_sheet:z7,table_to_sheet:Qb,table_to_book:m7,sheet_to_csv:Kb,sheet_to_txt:q7,sheet_to_json:Ag,sheet_to_html:p7,sheet_to_formulae:W7,sheet_to_row_object_array:Ag,sheet_get_cell:Cu,book_new:i1,book_append_sheet:o1,book_set_sheet_visibility:Q7,cell_set_number_format:X7,cell_set_hyperlink:Jb,cell_set_internal_link:Y7,cell_add_comment:K7,sheet_set_array_formula:Z7,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};var iX=bw.version;function e9(e,n){if(e&1&&(l(0,"option",27),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function t9(e,n){if(e&1&&(l(0,"option",27),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function n9(e,n){if(e&1&&(l(0,"div")(1,"div",28),f(2),u(),l(3,"audio",29),N(4,"source",30),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(2),te("T\u1EC7p \u0111\xE3 ch\u1ECDn: ",t.text,""),m(2),O("src",t.text,Qt)}}function r9(e,n){if(e&1){let t=ve();l(0,"div")(1,"label")(2,"input",31),ge("ngModelChange",function(i){let o=U(t).$implicit;return xe(o.text,i)||(o.text=i),j(i)}),u(),l(3,"div",32)(4,"i",33),H("click",function(){let i=U(t).index,o=D().index,s=D();return j(s.toggleAnswer(o,i))}),u()(),l(5,"i",34),H("click",function(){let i=U(t).index,o=D().index,s=D();return j(s.removeAnswer(o,i))}),u()()()}if(e&2){let t=n.$implicit;m(2),me("ngModel",t.text),m(2),O("ngClass",t.isCorrect?"fa-toggle-on":"fa-toggle-off")}}function i9(e,n){if(e&1){let t=ve();l(0,"div",12)(1,"div",13)(2,"h1"),f(3),u(),l(4,"span",14),H("click",function(){let i=U(t).index,o=D();return j(o.removeQuestion(i))}),f(5,"\xD7"),u()(),l(6,"div",15)(7,"select",16),ge("ngModelChange",function(i){let o=U(t).$implicit;return xe(o.category,i)||(o.category=i),j(i)}),l(8,"option",17),f(9,"Danh m\u1EE5c c\xE2u h\u1ECFi"),u(),G(10,e9,2,2,"option",18),u(),l(11,"select",16),ge("ngModelChange",function(i){let o=U(t).$implicit;return xe(o.group,i)||(o.group=i),j(i)}),l(12,"option",17),f(13,"Nh\xF3m c\xE2u h\u1ECFi"),u(),G(14,t9,2,2,"option",18),u()(),l(15,"div",19)(16,"textarea",20),ge("ngModelChange",function(i){let o=U(t).$implicit;return xe(o.text,i)||(o.text=i),j(i)}),u()(),l(17,"div",21)(18,"label",22),f(19," Ch\u1ECDn t\u1EC7p MP3 "),u(),l(20,"input",23),H("change",function(i){let o=U(t).index,s=D();return j(s.onFileSelected(i,o))}),u(),G(21,n9,6,2,"div",24),u(),l(22,"div",25),G(23,r9,6,2,"div",26),l(24,"button",0),H("click",function(){let i=U(t).index,o=D();return j(o.addAnswer(i))}),f(25,"Th\xEAm c\xE2u tr\u1EA3 l\u1EDDi"),u()()()}if(e&2){let t=n.$implicit,r=n.index,i=D();m(3),te("Th\xEAm c\xE2u h\u1ECFi v\xE0o th\u01B0 vi\u1EC7n ",r+1,""),m(4),me("ngModel",t.category),m(3),O("ngForOf",i.categories),m(),me("ngModel",t.group),m(3),O("ngForOf",i.groups),m(2),me("ngModel",t.text),m(2),fs("for","audio-upload-",r,""),m(2),fs("id","audio-upload-",r,""),m(),O("ngIf",t.text&&t.text.startsWith("http")),m(2),O("ngForOf",t.answers)}}function o9(e,n){if(e&1&&(l(0,"div")(1,"p")(2,"strong"),f(3,"File \xE2m thanh:"),u(),f(4),u(),l(5,"audio",29),N(6,"source",30),f(7," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(4),te(" ",t.text,""),m(2),O("src",t.text,Qt)}}function s9(e,n){e&1&&(l(0,"span"),f(1,"(\u0110\xFAng)"),u())}function a9(e,n){if(e&1&&(l(0,"li"),f(1),G(2,s9,2,0,"span",24),u()),e&2){let t=n.$implicit;m(),te(" ",t.text," "),m(),O("ngIf",t.isCorrect)}}function c9(e,n){if(e&1&&(l(0,"li")(1,"p")(2,"strong"),f(3),u(),f(4),u(),l(5,"p")(6,"strong"),f(7,"Danh m\u1EE5c:"),u(),f(8),u(),l(9,"p")(10,"strong"),f(11,"Nh\xF3m:"),u(),f(12),u(),G(13,o9,8,2,"div",24),l(14,"p")(15,"strong"),f(16,"C\xE1c c\xE2u tr\u1EA3 l\u1EDDi:"),u()(),l(17,"ul"),G(18,a9,3,2,"li",26),u()()),e&2){let t=n.$implicit,r=n.index;m(3),te("C\xE2u ",r+1,":"),m(),te(" ",t.text,""),m(4),te(" ",t.category,""),m(4),te(" ",t.group,""),m(),O("ngIf",t.text&&(t.text.startsWith("http")||t.text.startsWith("blob:"))),m(5),O("ngForOf",t.answers)}}function u9(e,n){if(e&1){let t=ve();l(0,"div",35)(1,"div",36)(2,"h2"),f(3,"Xem tr\u01B0\u1EDBc c\xE1c c\xE2u h\u1ECFi"),u(),l(4,"ul"),G(5,c9,19,6,"li",26),u(),l(6,"button",14),H("click",function(){U(t);let i=D();return j(i.closePreview())}),f(7,"\u0110\xF3ng"),u()()()}if(e&2){let t=D();m(5),O("ngForOf",t.questions)}}var tf=class e{constructor(n,t){this.questionService=n;this.router=t}questions=[];category="";group="";categories=["Grammar","Vocabulary","Reading Comprehension","Listening Comprehension","Pronunciation","Translation"];groups=["Beginner","Intermediate","Advanced"];uploadedQuestions=[];isPreviewVisible=!1;question;ngOnInit(){let n=history.state;n.question&&this.questions.push(n.question)}addQuestion(){this.questions.push({text:"",answers:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],category:"",group:"",status:"pending"})}removeQuestion(n){this.questions.splice(n,1)}addAnswer(n){this.questions[n].answers.push({text:"",isCorrect:!1})}removeAnswer(n,t){this.questions[n].answers.splice(t,1)}toggleAnswer(n,t){let r=this.questions[n].answers[t];r.isCorrect=!r.isCorrect}saveAllQuestions(){this.questionService.bulkAddQuestions(this.questions).subscribe({next:()=>{alert("T\u1EA5t c\u1EA3 c\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c l\u01B0u th\xE0nh c\xF4ng!"),window.history.back()},error:n=>{console.error("Error saving questions:",n),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi l\u01B0u c\xE2u h\u1ECFi.")}})}openPreview(){this.isPreviewVisible=!0}closePreview(){this.isPreviewVisible=!1}onFileUpload(n){let t=n.target.files[0];if(!t)return;let r=new FileReader;r.onload=i=>{let o=i.target.result,s=Xd(o,{type:"binary"}),a=s.SheetNames[0],c=s.Sheets[a],d=e2.sheet_to_json(c,{header:1});this.populateQuestionsFromExcel(d)},r.readAsBinaryString(t)}populateQuestionsFromExcel(n){let t=n.slice(1).map(r=>({text:r[0]||"",category:r[1]||"",group:r[2]||"",answers:[{text:r[3]||"",isCorrect:r[7]==="true"},{text:r[4]||"",isCorrect:r[8]==="true"},{text:r[5]||"",isCorrect:r[9]==="true"},{text:r[6]||"",isCorrect:r[10]==="true"}],status:r[11]==="pending"||r[11]==="approved"||r[11]==="rejected"?r[11]:"pending"}));this.questions=[...this.questions,...t]}removeUploadedQuestion(n){this.uploadedQuestions.splice(n,1)}saveQuestion(){let n=this.questions[0];n.category=this.category,n.group=this.group,n.text.trim()?this.questionService.addQuestion(n).subscribe({next:()=>alert("C\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c l\u01B0u."),error:t=>console.error(t)}):alert("Vui l\xF2ng nh\u1EADp n\u1ED9i dung c\xE2u h\u1ECFi.")}resetForm(){this.questions=[{text:"",answers:[{text:"",isCorrect:!1},{text:"",isCorrect:!1}],status:"pending",category:"",group:""}],this.category="",this.group=""}goBack(){window.history.back()}closeForm(){window.history.back()}onFileSelected(n,t){let r=n.target.files[0];if(r&&r.type.startsWith("audio/")){let i=new FormData;i.append("audioFile",r),this.questionService.uploadAudioFile(i).subscribe({next:o=>{this.questions[t].text=o.audioUrl},error:o=>{console.error("File upload error:",o),alert("C\xF3 l\u1ED7i khi t\u1EA3i t\u1EC7p \xE2m thanh l\xEAn.")}})}else alert("Vui l\xF2ng ch\u1ECDn t\u1EC7p \xE2m thanh h\u1EE3p l\u1EC7.")}updateQuestions(){let n=this.questions.filter(t=>t.text.trim()!==""&&t.answers.length>0);if(n.length===0){alert("Kh\xF4ng c\xF3 c\xE2u h\u1ECFi n\xE0o h\u1EE3p l\u1EC7 \u0111\u1EC3 c\u1EADp nh\u1EADt.");return}n.forEach(t=>{this.questionService.updateQuestion(t).subscribe({next:r=>{console.log("C\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt:",r),alert("C\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c c\u1EADp nh\u1EADt th\xE0nh c\xF4ng!"),window.history.back()},error:r=>{console.error("L\u1ED7i khi c\u1EADp nh\u1EADt c\xE2u h\u1ECFi:",r),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi c\u1EADp nh\u1EADt c\xE2u h\u1ECFi.")}})})}static \u0275fac=function(t){return new(t||e)(Q(vr),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-question"]],standalone:!0,features:[Me],decls:18,vars:2,consts:[[3,"click"],["class","container",4,"ngFor","ngForOf"],[1,"footer"],[1,"button-group"],[1,"upload-btn"],["type","file","accept",".xlsx, .xls",3,"change"],[1,"fas","fa-upload"],[1,"add-btn",3,"click"],[1,"save-btn",3,"click"],[1,"preview-btn",3,"click"],[1,"update-btn",3,"click"],["class","preview-modal",4,"ngIf"],[1,"container"],[1,"header"],[1,"close-btn",3,"click"],[1,"input-group"],[3,"ngModelChange","ngModel"],["value","","disabled",""],[3,"value",4,"ngFor","ngForOf"],[1,"question-content"],["rows","3","placeholder","Nh\u1EADp n\u1ED9i dung c\xE2u h\u1ECFi",3,"ngModelChange","ngModel"],[1,"audio-upload"],[1,"file-upload-btn",3,"for"],["type","file","accept","audio/mpeg","hidden","",3,"change","id"],[4,"ngIf"],[1,"answer-options"],[4,"ngFor","ngForOf"],[3,"value"],[1,"file-info"],["controls",""],["type","audio/mpeg",3,"src"],["type","text","placeholder","C\xE2u tr\u1EA3 l\u1EDDi...",3,"ngModelChange","ngModel"],[1,"toggle-btn"],[1,"fas",3,"click","ngClass"],[1,"fas","fa-trash-alt","icon",3,"click"],[1,"preview-modal"],[1,"modal-content"]],template:function(t,r){t&1&&(l(0,"button",0),H("click",function(){return r.goBack()}),f(1,"Quay l\u1EA1i"),u(),G(2,i9,26,12,"div",1),l(3,"div",2)(4,"div",3)(5,"label",4)(6,"input",5),H("change",function(o){return r.onFileUpload(o)}),u(),N(7,"i",6),f(8," T\u1EA3i file l\xEAn "),u(),l(9,"button",7),H("click",function(){return r.addQuestion()}),f(10,"Th\xEAm c\xE2u h\u1ECFi m\u1EDBi"),u(),l(11,"button",8),H("click",function(){return r.saveAllQuestions()}),f(12,"L\u01B0u t\u1EA5t c\u1EA3 c\xE2u h\u1ECFi"),u(),l(13,"button",9),H("click",function(){return r.openPreview()}),f(14,"Xem tr\u01B0\u1EDBc c\xE1c c\xE2u h\u1ECFi"),u(),l(15,"button",10),H("click",function(){return r.updateQuestions()}),f(16,"C\u1EADp nh\u1EADt c\xE2u h\u1ECFi"),u()()(),G(17,u9,8,1,"div",11)),t&2&&(m(2),O("ngForOf",r.questions),m(15),O("ngIf",r.isPreviewVisible))},dependencies:[Ue,hr,lt,We,He,gr,xr,jt,jn,Ot,Vt],styles:['@charset "UTF-8";.container[_ngcontent-%COMP%]{margin:20px auto;padding:20px;border:1px solid #ddd;border-radius:5px;background-color:#f9f9f9;width:80%;transition:transform .3s ease,box-shadow .3s ease}.container[_ngcontent-%COMP%]:hover{transform:scale(1.01);box-shadow:0 8px 15px #0000001a}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;transition:background-color .2s ease}.header[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:18px;color:#333;transition:color .2s ease}.header[_ngcontent-%COMP%]:hover   h1[_ngcontent-%COMP%]{color:#007bff}.close-btn[_ngcontent-%COMP%]{cursor:pointer;font-size:24px;color:#d9534f;transition:color .2s ease}.close-btn[_ngcontent-%COMP%]:hover{color:#c9302c}.input-group[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:15px;transition:transform .2s ease}.input-group[_ngcontent-%COMP%]:hover{transform:translate(3px)}.audio-upload[_ngcontent-%COMP%]{margin-top:15px;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}.audio-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;color:#333;display:block;margin-bottom:5px}.audio-upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{display:none}.audio-upload[_ngcontent-%COMP%]   .file-upload-btn[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;background-color:#f1f1f1;border:1px solid #ccc;border-radius:8px;cursor:pointer;transition:background-color .3s ease,transform .2s ease}.audio-upload[_ngcontent-%COMP%]   .file-upload-btn[_ngcontent-%COMP%]:hover{background-color:#e2e2e2;transform:scale(1.05)}.audio-upload[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]{margin-top:10px;font-size:14px;color:#333;padding:5px;background-color:#f9f9f9;border:1px solid #ddd;border-radius:5px;transition:opacity .3s ease}.audio-upload[_ngcontent-%COMP%]   .file-info[_ngcontent-%COMP%]:hover{opacity:.7}select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:8px;background-color:#fff;transition:border-color .3s ease,box-shadow .3s ease}select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{border-color:#5bc0de;outline:none;box-shadow:0 0 5px #5bc0de99}.answer-options[_ngcontent-%COMP%]{margin-top:20px}.answer-options[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:10px;transition:transform .3s ease}.answer-options[_ngcontent-%COMP%]:hover{transform:translateY(3px)}.answer-options[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:80%;padding:10px;margin-right:10px;border:1px solid #afaeae;border-radius:5px;flex-grow:1}.toggle-btn[_ngcontent-%COMP%]{display:inline-block;margin-left:10px;cursor:pointer;transition:transform .3s ease}.toggle-btn[_ngcontent-%COMP%]:hover{transform:rotate(10deg)}.fas[_ngcontent-%COMP%]{font-size:18px;color:#0585fc;transition:color .3s ease}.fas.fa-toggle-on[_ngcontent-%COMP%]{color:#5bc0de}.fas.fa-toggle-off[_ngcontent-%COMP%]{color:#00ff2a}.icon[_ngcontent-%COMP%]{cursor:pointer;margin-left:10px;transition:color .3s ease}.icon[_ngcontent-%COMP%]:hover{color:#0004ff}.button-group[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:15px;align-items:center;flex-wrap:wrap}button[_ngcontent-%COMP%]{padding:12px 20px;font-size:14px;border:1px solid transparent;border-radius:8px;cursor:pointer;transition:all .3s ease-in-out;background-color:#fff;color:#333;box-shadow:4px 4px 8px #0000004d;margin:5px}.upload-btn[_ngcontent-%COMP%]{display:flex;align-items:center;padding:12px 20px;background-color:#fff;color:#000;border:none;border-radius:8px;cursor:pointer;transition:background-color .3s ease,box-shadow .3s ease}.upload-btn[_ngcontent-%COMP%]:hover{background-color:#add6f7;box-shadow:0 8px 15px #0000001a}.add-btn[_ngcontent-%COMP%]{background-color:#fff;color:#000;transition:background-color .3s ease,transform .3s ease}.add-btn[_ngcontent-%COMP%]:hover{background-color:#8ce1fb;transform:translateY(-1px)}.save-btn[_ngcontent-%COMP%]{background-color:#fff;color:#000;transition:background-color .3s ease,transform .3s ease}.save-btn[_ngcontent-%COMP%]:hover{background-color:#85fb85;transform:translateY(-1px)}.preview-btn[_ngcontent-%COMP%]{background-color:#fff;color:#000;transition:background-color .3s ease,transform .3s ease}.preview-btn[_ngcontent-%COMP%]:hover{background-color:#a086f5;transform:translateY(-1px)}.update-btn[_ngcontent-%COMP%]{background-color:#fff;color:#000;transition:background-color .3s ease,transform .3s ease}.update-btn[_ngcontent-%COMP%]:hover{background-color:#f5c05d;transform:translateY(-1px)}.preview-modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center;animation:_ngcontent-%COMP%_fadeInModal .5s ease-in-out}.modal-content[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;width:80%;max-height:80%;overflow-y:auto}.preview-modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px;animation:_ngcontent-%COMP%_fadeIn .5s ease-in-out}.preview-modal[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:20px;background-color:#d9534f;color:#fff;padding:10px 20px;border:none;border-radius:8px;cursor:pointer;transition:background-color .3s ease}.preview-modal[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#c9302c}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_fadeInModal{0%{opacity:0}to{opacity:1}}']})};function l9(e,n){if(e&1&&(l(0,"div",26)(1,"p"),f(2),u()()),e&2){let t=D();m(2),ae(t.errorMessage)}}function d9(e,n){if(e&1){let t=ve();l(0,"tr")(1,"td"),f(2),u(),l(3,"td"),f(4),u(),l(5,"td"),f(6),u(),l(7,"td"),f(8),u(),l(9,"td")(10,"button",31),H("click",function(){let i=U(t).$implicit,o=D(3);return j(o.viewExamDetails(i.user))}),f(11," Xem chi ti\u1EBFt "),u()()()}if(e&2){let t=n.$implicit;m(2),ae(t.user),m(2),ae(t.username),m(2),ae(t.email),m(2),ae(t.score)}}function f9(e,n){if(e&1&&(l(0,"div")(1,"h2"),f(2,"Danh s\xE1ch ng\u01B0\u1EDDi tham gia"),u(),l(3,"table")(4,"thead")(5,"tr")(6,"th"),f(7,"ID"),u(),l(8,"th"),f(9,"T\xEAn ng\u01B0\u1EDDi tham gia"),u(),l(10,"th"),f(11,"Email"),u(),l(12,"th"),f(13,"\u0110i\u1EC3m"),u(),l(14,"th"),f(15,"Chi ti\u1EBFt"),u()()(),l(16,"tbody"),G(17,d9,12,4,"tr",30),u()()()),e&2){let t=D(2);m(17),O("ngForOf",t.statistics.participants)}}function h9(e,n){e&1&&(l(0,"div"),f(1," Kh\xF4ng c\xF3 ng\u01B0\u1EDDi tham gia n\xE0o. "),u())}function p9(e,n){if(e&1&&(l(0,"div",27)(1,"h1",28),f(2),u(),l(3,"p")(4,"strong"),f(5,"T\u1ED5ng s\u1ED1 ng\u01B0\u1EDDi tham gia:"),u(),f(6),u(),l(7,"p")(8,"strong"),f(9,"\u0110i\u1EC3m trung b\xECnh:"),u(),f(10),u(),l(11,"p")(12,"strong"),f(13,"\u0110i\u1EC3m cao nh\u1EA5t:"),u(),f(14),u(),l(15,"p")(16,"strong"),f(17,"\u0110i\u1EC3m th\u1EA5p nh\u1EA5t:"),u(),f(18),u(),l(19,"p")(20,"strong"),f(21,"T\u1EF7 l\u1EC7 \u0111\u1EADu:"),u(),f(22),u(),G(23,f9,18,1,"div",29)(24,h9,2,0,"div",29),u()),e&2){let t=D();m(2),te("Th\u1ED1ng k\xEA b\xE0i ki\u1EC3m tra: ",t.statistics.exam.username,""),m(4),te(" ",t.statistics.totalParticipants,""),m(4),te(" ",t.statistics.averageScore,""),m(4),te(" ",t.statistics.highestScore,""),m(4),te(" ",t.statistics.lowestScore,""),m(4),te(" ",t.statistics.passPercentage,"%"),m(),O("ngIf",t.statistics.participants&&t.statistics.participants.length),m(),O("ngIf",!t.statistics.participants||t.statistics.participants.length===0)}}var nf=class e{constructor(n,t,r,i){this.authService=n;this.router=t;this.route=r;this.examService=i}user=null;isDropdownActive=!1;examId="";statistics=null;errorMessage="";ngOnInit(){if(this.user=this.authService.getCurrentUser(),this.examId=this.route.snapshot.paramMap.get("id"),console.log("Exam ID from URL:",this.examId),!this.examId){this.errorMessage="M\xE3 b\xE0i ki\u1EC3m tra kh\xF4ng h\u1EE3p l\u1EC7.";return}this.loadStatistics()}goBack(){window.history.back()}viewExamDetails(n){if(console.log("viewExamDetails called"),console.log("Exam ID:",this.examId),console.log("User ID:",n),!this.examId){this.errorMessage="M\xE3 b\xE0i ki\u1EC3m tra kh\xF4ng h\u1EE3p l\u1EC7!",console.error("Exam ID kh\xF4ng h\u1EE3p l\u1EC7!");return}if(!n){this.errorMessage="User ID kh\xF4ng h\u1EE3p l\u1EC7!",console.error("User ID kh\xF4ng h\u1EE3p l\u1EC7!",n);return}this.examService.getStudentExamDetails(this.examId,n).subscribe({next:t=>{if(console.log("API response data:",t),!t){this.errorMessage="Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u chi ti\u1EBFt b\xE0i ki\u1EC3m tra cho User ID n\xE0y!",alert(this.errorMessage);return}console.log("Navigating to exam-result-detail page with:",this.examId,n),this.router.navigate(["/student-result-detail",this.examId,n])},error:t=>{console.error("Error fetching student exam details:",t),this.errorMessage="Kh\xF4ng th\u1EC3 t\u1EA3i chi ti\u1EBFt b\xE0i ki\u1EC3m tra. Vui l\xF2ng th\u1EED l\u1EA1i sau."}})}loadStatistics(){this.examService.getExamStatistics(this.examId).subscribe({next:n=>{if(console.log("Data from API:",n),n&&!n.error){if(this.statistics=n,console.log("Participants:",this.statistics.participants),!this.statistics.participants||!this.statistics.participants.length){this.errorMessage="Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u ng\u01B0\u1EDDi tham gia.";return}}else this.errorMessage="Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u th\u1ED1ng k\xEA cho b\xE0i ki\u1EC3m tra n\xE0y."},error:n=>{console.error("Error loading statistics:",n),this.errorMessage="Kh\xF4ng th\u1EC3 t\u1EA3i th\u1ED1ng k\xEA. Vui l\xF2ng th\u1EED l\u1EA1i sau."}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}logout(){this.authService.logout().subscribe({next:()=>{window.location.href="/login"},error:n=>{console.error("Logout error:",n)}})}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(Re),Q(dn),Q(It))};static \u0275cmp=Se({type:e,selectors:[["app-teacher-statistics"]],standalone:!0,features:[Me],decls:35,vars:6,consts:[[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["href","/teacher-statistics",1,"active"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","#"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"go-back-container"],[1,"go-back-button",3,"click"],["class","error-message",4,"ngIf"],["class","statistics-container",4,"ngIf"],[1,"error-message"],[1,"statistics-container"],[1,"exam-title"],[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"click"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1),N(2,"img",2),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",3)(6,"a",4),f(7,"T\u1ED5ng k\u1EBFt"),u()(),l(8,"div",5),N(9,"i",6)(10,"i",7),l(11,"img",8),H("click",function(){return r.toggleDropdown()}),u(),l(12,"div",9)(13,"div",10),N(14,"img",11),l(15,"div",12)(16,"div",13),f(17),u(),l(18,"div",14),f(19),u()()(),l(20,"div",15)(21,"a",16),N(22,"i",17),f(23," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(24,"a",18),N(25,"i",19),f(26," C\xE0i \u0111\u1EB7t chung"),u(),l(27,"a",20),H("click",function(){return r.logout()}),N(28,"i",21),f(29," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(30,"div",22)(31,"button",23),H("click",function(){return r.goBack()}),f(32,"Quay l\u1EA1i"),u()(),G(33,l9,3,1,"div",24)(34,p9,25,8,"div",25)),t&2&&(m(12),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(14),O("ngIf",r.errorMessage),m(),O("ngIf",r.statistics))},dependencies:[Ue,lt,We,He],styles:["body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5;transition:background-color .3s ease}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0;transition:background-color .3s ease}.navbar[_ngcontent-%COMP%]:hover{background-color:#f1f1f1}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px;transition:transform .3s ease}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center;transition:transform .3s ease}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500;position:relative;transition:color .3s ease,transform .3s ease}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff;transform:scale(1.1)}.nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer;transition:transform .3s ease}.user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000;opacity:0;transform:translateY(-20px);transition:opacity .3s ease,transform .3s ease}.dropdown.active[_ngcontent-%COMP%]{display:block;opacity:1;transform:translateY(0)}.profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px;transition:transform .3s ease}.profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.view-profile[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:5px 10px;border-radius:5px;text-align:center;text-decoration:none;font-size:12px;transition:background-color .3s ease}.view-profile[_ngcontent-%COMP%]:hover{background-color:#0056b3}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px;position:relative;transition:color .3s ease,transform .3s ease}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff;transform:scale(1.05)}.go-back-container[_ngcontent-%COMP%]{margin:20px 0;text-align:left}.go-back-button[_ngcontent-%COMP%]{padding:10px 20px;background-color:#3498db;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease,transform .3s ease}.go-back-button[_ngcontent-%COMP%]:hover{background-color:#2980b9;transform:scale(1.05)}.error-message[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;padding:15px;margin:10px 0;border-radius:5px;font-size:14px;opacity:0;transform:translateY(-20px);transition:opacity .3s ease,transform .3s ease}.error-message.show[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.statistics-container[_ngcontent-%COMP%]{background-color:#f4f4f4;padding:20px;border-radius:5px;box-shadow:0 2px 4px #0000001a;transition:box-shadow .3s ease}.statistics-container[_ngcontent-%COMP%]:hover{box-shadow:0 4px 8px #00000026}.exam-title[_ngcontent-%COMP%]{font-size:24px;margin-bottom:20px;transition:font-size .3s ease}.statistics-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;margin:5px 0}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:20px;transition:transform .3s ease}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:left;border:1px solid #ddd}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;transition:background-color .3s ease}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover{background-color:#2980b9}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:5px 10px;background-color:#2ecc71;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease,transform .3s ease}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#27ae60;transform:scale(1.05)}h2[_ngcontent-%COMP%]{margin-top:30px;font-size:20px;font-weight:700;transition:font-size .3s ease}div.error[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff;padding:15px;border-radius:5px;font-size:14px;transition:transform .3s ease}div.error.show[_ngcontent-%COMP%]{transform:translateY(0)}"]})};function m9(e,n){if(e&1){let t=ve();l(0,"div",43)(1,"div",44),N(2,"i",45),l(3,"span",46),f(4),u()(),l(5,"div",47)(6,"button",48),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.editCategory(i))}),N(7,"i",49),u(),l(8,"button",50),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.deleteCategory(i))}),N(9,"i",51),u()()()}if(e&2){let t=n.$implicit;m(4),ae(t.name)}}function g9(e,n){if(e&1&&(l(0,"div",41),G(1,m9,10,1,"div",42),u()),e&2){let t=D();m(),O("ngForOf",t.categories)}}function x9(e,n){e&1&&(l(0,"div",52),N(1,"i",53),l(2,"p"),f(3,'No categories found. Click "T\u1EA1o danh m\u1EE5c" to add one.'),u()())}function E9(e,n){if(e&1){let t=ve();l(0,"div",54)(1,"div",55)(2,"h2"),f(3,"Th\xEAm danh m\u1EE5c"),u(),l(4,"input",56),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newCategoryName,i)||(o.newCategoryName=i),j(i)}),H("keyup.enter",function(){U(t);let i=D();return j(i.addCategory())}),u(),l(5,"div",57)(6,"button",58),H("click",function(){U(t);let i=D();return j(i.closeAddCategoryModal())}),f(7,"\u0110\xF3ng"),u(),l(8,"button",59),H("click",function(){U(t);let i=D();return j(i.addCategory())}),f(9," Th\xEAm "),u()()()()}if(e&2){let t=D();m(4),me("ngModel",t.newCategoryName),m(4),O("disabled",!t.newCategoryName.trim())}}var rf=class e{constructor(n){this.authService=n}user=null;isDropdownActive=!1;isAddCategoryModalOpen=!1;newCategoryName="";categories=[];ngOnInit(){this.user=this.authService.getCurrentUser(),this.loadCategories()}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}openAddCategoryModal(){this.isAddCategoryModalOpen=!0}closeAddCategoryModal(){this.isAddCategoryModalOpen=!1,this.newCategoryName=""}addCategory(){if(this.newCategoryName.trim()!==""){let n={id:this.categories.length+1,name:this.newCategoryName.trim()};this.categories.push(n),this.saveCategories(),this.closeAddCategoryModal()}}editCategory(n){let t=prompt("Enter new category name:",n.name);t&&t.trim()!==""&&(n.name=t.trim(),this.saveCategories())}deleteCategory(n){confirm("Are you sure you want to delete this category?")&&(this.categories=this.categories.filter(t=>t.id!==n.id),this.saveCategories())}saveCategories(){localStorage.setItem("categories",JSON.stringify(this.categories))}loadCategories(){let n=localStorage.getItem("categories");n&&(this.categories=JSON.parse(n))}logout(){this.authService.logout().subscribe({next:()=>{window.location.href="/login"},error:n=>{console.error("Logout error:",n)}})}static \u0275fac=function(t){return new(t||e)(Q(ze))};static \u0275cmp=Se({type:e,selectors:[["app-teacher-category"]],standalone:!0,features:[Me],decls:56,vars:7,consts:[[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["href","/teacher-dashboard"],["href","/teacher-library",1,"active"],["href","/teacher-class"],["href","/teacher-statistics"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","#"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"content"],[1,"container"],[1,"header"],["href","/teacher-library"],["href","/teacher-category",1,"active"],["href","/teacher-group"],[1,"tab"],[1,"search-bar"],["type","text","placeholder","Nh\u1EADp t\u1EEB kh\xF3a"],[1,"fas","fa-search"],[1,"actions"],[1,"create",3,"click"],[1,"fas","fa-plus"],["class","category-list",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","modal",4,"ngIf"],[1,"category-list"],["class","category-item",4,"ngFor","ngForOf"],[1,"category-item"],[1,"category-content"],[1,"fa-solid","fa-list"],[1,"category-name"],[1,"category-actions"],[1,"edit-btn",3,"click"],[1,"fas","fa-edit"],[1,"delete-btn",3,"click"],[1,"fas","fa-trash"],[1,"empty-state"],[1,"fas","fa-folder-open"],[1,"modal"],[1,"modal-content"],["type","text","placeholder","T\xEAn danh m\u1EE5c",3,"ngModelChange","keyup.enter","ngModel"],[1,"modal-actions"],[1,"cancel-btn",3,"click"],[1,"confirm-btn",3,"click","disabled"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1),N(2,"img",2),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",3)(6,"a",4),f(7,"B\xE0i ki\u1EC3m tra"),u(),l(8,"a",5),f(9,"Th\u01B0 vi\u1EC7n c\xE2u h\u1ECFi"),u(),l(10,"a",6),f(11,"L\u1EDBp"),u(),l(12,"a",7),f(13,"T\u1ED5ng k\u1EBFt"),u()(),l(14,"div",8),N(15,"i",9)(16,"i",10),l(17,"img",11),H("click",function(){return r.toggleDropdown()}),u(),l(18,"div",12)(19,"div",13),N(20,"img",14),l(21,"div",15)(22,"div",16),f(23),u(),l(24,"div",17),f(25),u()()(),l(26,"div",18)(27,"a",19),N(28,"i",20),f(29," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(30,"a",21),N(31,"i",22),f(32," C\xE0i \u0111\u1EB7t chung"),u(),l(33,"a",23),H("click",function(){return r.logout()}),N(34,"i",24),f(35," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(36,"div",25)(37,"div",26)(38,"div",27)(39,"a",28),f(40,"C\xE2u h\u1ECFi"),u(),l(41,"a",29),f(42,"Danh m\u1EE5c"),u(),l(43,"a",30),f(44,"Nh\xF3m"),u()(),l(45,"div",31)(46,"div",32),N(47,"input",33)(48,"i",34),u(),l(49,"div",35)(50,"button",36),H("click",function(){return r.openAddCategoryModal()}),f(51," T\u1EA1o danh m\u1EE5c "),N(52,"i",37),u()()(),G(53,g9,2,1,"div",38)(54,x9,4,0,"div",39)(55,E9,10,2,"div",40),u()()),t&2&&(m(18),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(28),O("ngIf",r.categories.length>0),m(),O("ngIf",r.categories.length===0),m(),O("ngIf",r.isAddCategoryModalOpen))},dependencies:[Ue,lt,We,He,jt,Ot,Vt],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:12px;color:#666}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .view-profile[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:5px 10px;border-radius:5px;text-align:center;text-decoration:none;font-size:12px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:10px 15px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.content[_ngcontent-%COMP%]   .container[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto;padding:20px;background-color:#fff}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;padding:10px 0;border-bottom:1px solid #ddd}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#333;margin:0 15px;font-size:16px}.content[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#4a3aff;border-bottom:2px solid #4a3aff}.content[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:20px 0}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;width:30%}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:16px}.content[_ngcontent-%COMP%]   .search-bar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:-30px;color:#aaa}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4a3aff;color:#fff;border:none;padding:10px 20px;border-radius:4px;font-size:16px;cursor:pointer}.content[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{background-color:#ddd;color:#333}.content[_ngcontent-%COMP%]   .category-list[_ngcontent-%COMP%]{margin-top:20px}.content[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:15px;margin-bottom:10px;background-color:#f8f9fa;border-radius:8px;border:1px solid #e9ecef;transition:all .3s ease}.content[_ngcontent-%COMP%]   .category-item[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.content[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.content[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4a3aff}.content[_ngcontent-%COMP%]   .category-content[_ngcontent-%COMP%]   .category-name[_ngcontent-%COMP%]{font-size:16px;color:#333}.content[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]{display:flex;gap:10px}.content[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;padding:5px;cursor:pointer;transition:all .3s ease}.content[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button.edit-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4a3aff}.content[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#dc3545}.content[_ngcontent-%COMP%]   .category-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#6c757d}.content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px;margin-bottom:20px}.content[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#00000080;display:flex;justify-content:center;align-items:center}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;width:400px;max-width:90%}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:20px;border:1px solid #e9ecef;border-radius:8px}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;cursor:pointer;transition:all .3s ease}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]   button.cancel-btn[_ngcontent-%COMP%]{background-color:#e9ecef;color:#333}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]   button.confirm-btn[_ngcontent-%COMP%]{background-color:#4a3aff;color:#fff}.content[_ngcontent-%COMP%]   .modal[_ngcontent-%COMP%]   .modal-content[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}']})};var v9=()=>({exact:!0});function _9(e,n){e&1&&(l(0,"div",28),N(1,"div",29),l(2,"p"),f(3,"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u..."),u()())}function C9(e,n){if(e&1){let t=ve();l(0,"div",34)(1,"div",35)(2,"h3"),f(3),u(),l(4,"span",36),f(5),u()(),l(6,"p",37),f(7),u(),l(8,"div",38)(9,"p")(10,"strong"),f(11,"Th\u1EDDi gian:"),u(),f(12),u(),l(13,"p")(14,"strong"),f(15,"T\u1ED5ng s\u1ED1 c\xE2u h\u1ECFi:"),u(),f(16),u(),l(17,"p")(18,"strong"),f(19,"Th\u1EDDi h\u1EA1n:"),u(),f(20),u()(),l(21,"div",39)(22,"button",40),H("click",function(){let i=U(t).$implicit,o=D(3);return j(o.takeExam(i))}),N(23,"i",41),f(24," Th\u1EF1c hi\u1EC7n b\xE0i thi "),u()()()}if(e&2){let t=n.$implicit,r=D(3);m(3),ae(t.name),m(2),te("",t.duration," ph\xFAt"),m(2),ae(t.description),m(5),Wt(" ",r.formatDate(t.startDate)," - ",r.formatDate(t.endDate)," "),m(4),te(" ",t.totalQuestions," c\xE2u "),m(4),te(" ",r.getTimeRemaining(t)," ")}}function y9(e,n){if(e&1&&(l(0,"div",32),G(1,C9,25,7,"div",33),u()),e&2){let t=D(2);m(),O("ngForOf",t.activeExams)}}function w9(e,n){e&1&&(l(0,"div",42),N(1,"img",43),l(2,"p"),f(3,"Hi\u1EC7n t\u1EA1i kh\xF4ng c\xF3 b\xE0i thi n\xE0o \u0111ang di\u1EC5n ra"),u()())}function b9(e,n){if(e&1){let t=ve();l(0,"div",45)(1,"div",35)(2,"h3"),f(3),u(),l(4,"span",46),f(5,"\u0110\xE3 ho\xE0n th\xE0nh"),u()(),l(6,"div",38)(7,"p")(8,"strong"),f(9,"Th\u1EDDi gian:"),u(),f(10),u(),l(11,"p")(12,"strong"),f(13,"S\u1ED1 c\xE2u h\u1ECFi:"),u(),f(14),u(),l(15,"p")(16,"strong"),f(17,"S\u1ED1 \u0111i\u1EC3m:"),u(),f(18),u(),l(19,"p")(20,"strong"),f(21,"N\u1ED9p b\xE0i l\xFAc:"),u(),f(22),u()(),l(23,"div",39)(24,"button",47),H("click",function(){let i=U(t).$implicit,o=D(3);return j(o.viewResult(i._id))}),N(25,"i",48),f(26," Xem chi ti\u1EBFt k\u1EBFt qu\u1EA3 "),u()()()}if(e&2){let t=n.$implicit,r=D(3);m(3),ae(t.name),m(7),Wt(" ",r.formatDate(t.startDate)," - ",r.formatDate(t.endDate)," "),m(4),te(" ",t.totalQuestions," "),m(4),te(" ",t.correctAnswers,"/ 10 "),m(4),te(" ",r.formatDate(t.submittedAt)," ")}}function D9(e,n){if(e&1&&(l(0,"div",32),G(1,b9,27,6,"div",44),u()),e&2){let t=D(2);m(),O("ngForOf",t.completedExams)}}function S9(e,n){e&1&&(l(0,"div",42),N(1,"img",49),l(2,"p"),f(3,"Ch\u01B0a c\xF3 b\xE0i thi n\xE0o \u0111\u01B0\u1EE3c ho\xE0n th\xE0nh"),u()())}function M9(e,n){if(e&1&&(cn(0),l(1,"div",30)(2,"h2"),f(3,"B\xE0i thi \u0111ang di\u1EC5n ra"),u(),G(4,y9,2,1,"div",31)(5,w9,4,0,"ng-template",null,0,nr),u(),l(7,"div",30)(8,"h2"),f(9,"B\xE0i thi \u0111\xE3 ho\xE0n th\xE0nh"),u(),G(10,D9,2,1,"div",31)(11,S9,4,0,"ng-template",null,1,nr),u(),un()),e&2){let t=Nt(6),r=Nt(12),i=D();m(4),O("ngIf",i.activeExams.length>0)("ngIfElse",t),m(6),O("ngIf",i.completedExams.length>0)("ngIfElse",r)}}var of=class e{constructor(n,t,r){this.authService=n;this.examService=t;this.router=r}user=null;isDropdownActive=!1;examHistory=[];activeExams=[];completedExams=[];loading=!0;ngOnInit(){this.user=this.authService.getCurrentUser(),this.user&&(this.loadExamsAndHistory(),this.router.events.pipe(Bn(n=>n instanceof Or)).subscribe(n=>{n.url==="/student-dashboard"&&this.loadExamsAndHistory()}))}calculateTotalQuestions(n){return n&&Array.isArray(n.sections)?n.sections.reduce((t,r)=>t+(Array.isArray(r.questions)?r.questions.length:0),0):0}processExam(n){let t=this.calculateTotalQuestions(n),r=new Date;return{_id:n._id,name:n.name||n.examName||"B\xE0i thi m\u1EDBi",description:n.description||"450",startDate:new Date(n.startDate),endDate:new Date(n.endDate),duration:n.duration||0,status:n.status||"published",sections:n.sections||[],score:0,correctAnswers:0,totalQuestions:t,maxScore:t,percentageScore:0,startTime:r,endTime:r,submittedAt:r}}processCompletedExam(n,t){let r=this.calculateTotalQuestions(n),i=t.score||0,o=new Date(t.startTime),s=new Date(t.endTime);return{_id:n._id,name:t.examName||n.name||"B\xE0i thi m\u1EDBi",description:t.description||n.description||"450",startDate:new Date(n.startDate),endDate:new Date(n.endDate),duration:n.duration||0,status:"completed",sections:n.sections||[],score:i,correctAnswers:i,totalQuestions:r,maxScore:r,percentageScore:i/r*100,startTime:o,endTime:s,submittedAt:s}}loadExamsAndHistory(){this.loading=!0,this.activeExams=[],this.completedExams=[];let n=sessionStorage.getItem("lastExamResult"),t=null;if(n)try{t=JSON.parse(n),sessionStorage.removeItem("lastExamResult")}catch(r){console.error("Error parsing last result:",r)}this.user&&this.examService.getExamHistory(this.user._id).subscribe({next:r=>{console.log("Exam History:",r);let i=new Set(r.map(o=>o.examId._id||o.examId));t&&i.add(t.examId._id||t.examId),this.examService.getPublishedExams().subscribe({next:o=>{console.log("Published Exams:",o);let s=new Date;o.forEach(a=>{let c=new Date(a.startDate),d=new Date(a.endDate);if(i.has(a._id)){let h=r.find(p=>(p.examId._id||p.examId)===a._id);if(!h&&t&&(t.examId._id===a._id||t.examId===a._id)&&(h=t),h){let p=this.processCompletedExam(a,h);console.log("Processed completed exam:",p),this.completedExams.push(p)}}else if(a.status==="published"&&c<=s&&d>=s){let h=this.processExam(a);console.log("Processed active exam:",h),this.activeExams.push(h)}}),this.completedExams.sort((a,c)=>c.submittedAt.getTime()-a.submittedAt.getTime()),console.log("Final Active Exams:",this.activeExams),console.log("Final Completed Exams:",this.completedExams),this.loading=!1},error:o=>{console.error("Error loading exams:",o),this.loading=!1}})},error:r=>{console.error("Error loading exam history:",r),this.loading=!1}})}takeExam(n){let t=qe(de({},n),{startDate:n.startDate.toISOString(),endDate:n.endDate.toISOString()});sessionStorage.setItem("currentExam",JSON.stringify(t)),this.router.navigate(["/exam-take",n._id])}viewResult(n){let t=this.completedExams.find(r=>r._id===n);this.router.navigate(["/exam-result-detail",n],{state:{examData:t}})}refreshDashboard(){this.loadExamsAndHistory()}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}formatDate(n){if(!n)return"-";try{return new Date(n).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch(t){return console.error("Error formatting date:",n,t),"-"}}formatScore(n){return`${n.correctAnswers}/${n.totalQuestions} (${n.percentageScore.toFixed(1)}%)`}getTimeRemaining(n){let t=new Date,r=n.endDate,i=Math.abs(r.getTime()-t.getTime());return`C\xF2n ${Math.ceil(i/(1e3*60*60*24))} ng\xE0y`}getPercentageScore(n){return n.percentageScore||0}getProgressBarColor(n){let t=this.getPercentageScore(n);return t>=80?"#10b981":t>=60?"#3b82f6":t>=40?"#f59e0b":"#ef4444"}logout(){this.authService.logout().subscribe({next:()=>{this.router.navigate(["/login"])},error:n=>{console.error("Logout error:",n)}})}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(It),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-student-dashboard"]],standalone:!0,features:[Me],decls:35,vars:8,consts:[["noActiveExams",""],["noCompletedExams",""],[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["routerLink","/student-dashboard","routerLinkActive","active",3,"routerLinkActiveOptions"],["routerLink","/exam-history","routerLinkActive","active"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["routerLink","/profile"],[1,"fas","fa-user-graduate"],["routerLink","/settings"],[1,"fas","fa-cog"],[3,"click"],[1,"fas","fa-sign-out-alt"],[1,"content"],["class","loading-state",4,"ngIf"],[4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"section"],["class","exam-grid",4,"ngIf","ngIfElse"],[1,"exam-grid"],["class","exam-item",4,"ngFor","ngForOf"],[1,"exam-item"],[1,"exam-header"],[1,"duration-badge"],[1,"description"],[1,"exam-info"],[1,"exam-actions"],[1,"start-exam-btn",3,"click"],[1,"fas","fa-play"],[1,"empty-state"],["src","../../assets/img/pic01.png","alt","No Active Exams","height","100","width","100"],["class","exam-item completed",4,"ngFor","ngForOf"],[1,"exam-item","completed"],[1,"completed-badge"],[1,"view-result-btn",3,"click"],[1,"fas","fa-eye"],["src","../../assets/img/pic01.png","alt","No Completed Exams","height","100","width","100"]],template:function(t,r){t&1&&(l(0,"div",2)(1,"div",3),N(2,"img",4),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",5)(6,"a",6),f(7,"B\xE0i ki\u1EC3m tra"),u(),l(8,"a",7),f(9,"Th\u1ED1ng k\xEA k\u1EBFt qu\u1EA3"),u()(),l(10,"div",8),N(11,"i",9)(12,"i",10),l(13,"img",11),H("click",function(){return r.toggleDropdown()}),u(),l(14,"div",12)(15,"div",13),N(16,"img",14),l(17,"div",15)(18,"div",16),f(19),u(),l(20,"div",17),f(21),u()()(),l(22,"div",18)(23,"a",19),N(24,"i",20),f(25," Th\xF4ng tin c\xE1 nh\xE2n "),u(),l(26,"a",21),N(27,"i",22),f(28," C\xE0i \u0111\u1EB7t chung "),u(),l(29,"a",23),H("click",function(){return r.logout()}),N(30,"i",24),f(31," \u0110\u0103ng xu\u1EA5t "),u()()()()(),l(32,"div",25),G(33,_9,4,0,"div",26)(34,M9,13,4,"ng-container",27),u()),t&2&&(m(6),O("routerLinkActiveOptions",Yv(7,v9)),m(8),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(12),O("ngIf",r.loading),m(),O("ngIf",!r.loading))},dependencies:[Ue,lt,We,He,mr,bn,ed],styles:["body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f9f9f9;color:#333}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0;box-shadow:0 2px 4px #0000001a}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500;padding-bottom:5px;transition:color .3s ease,border-bottom .3s ease}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff;border-bottom:2px solid #007bff}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#888;margin-right:15px;cursor:pointer;transition:color .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#007bff}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer;transition:transform .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:250px;z-index:1000;transition:opacity .3s ease;opacity:0;visibility:hidden}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block;opacity:1;visibility:visible;animation:_ngcontent-%COMP%_fadeIn .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:12px;color:#666}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:10px 15px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px;transition:color .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.content[_ngcontent-%COMP%]{padding:20px;max-width:1200px;margin:0 auto}.content[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]{text-align:center;padding:40px}.content[_ngcontent-%COMP%]   .loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #f3f3f3;border-top:4px solid #007bff;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{background-color:#fff;padding:20px;margin-bottom:20px;border-radius:8px;box-shadow:0 2px 5px #0000001a;transition:transform .2s ease,box-shadow .2s ease}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000001a}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;margin-bottom:20px;font-size:20px;font-weight:500;color:#007bff;padding-bottom:10px;border-bottom:2px solid #e0e0e0}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:8px;border:1px solid #e0e0e0;transition:all .3s ease}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #0000001a}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item.completed[_ngcontent-%COMP%]{border-left:4px solid #4caf50}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:15px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#333;font-size:18px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]   .duration-badge[_ngcontent-%COMP%], .content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]   .completed-badge[_ngcontent-%COMP%]{padding:4px 8px;border-radius:12px;font-size:12px;font-weight:500}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]   .duration-badge[_ngcontent-%COMP%]{background-color:#e3f2fd;color:#1976d2}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-header[_ngcontent-%COMP%]   .completed-badge[_ngcontent-%COMP%]{background-color:#e8f5e9;color:#2e7d32}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{color:#666;margin-bottom:15px;font-size:14px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-info[_ngcontent-%COMP%]{margin:15px 0}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#666;font-size:14px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333;font-weight:500}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-info[_ngcontent-%COMP%]   .score-info[_ngcontent-%COMP%]{margin-top:10px;padding-top:10px;border-top:1px dashed #e0e0e0}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-info[_ngcontent-%COMP%]   .score-info[_ngcontent-%COMP%]   .score[_ngcontent-%COMP%]{color:#4caf50;font-weight:500;font-size:16px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]{margin-top:15px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;padding:10px 15px;border:none;border-radius:4px;font-weight:500;cursor:pointer;transition:background-color .3s ease}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.start-exam-btn[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.start-exam-btn[_ngcontent-%COMP%]:hover{background-color:#0056b3}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.view-result-btn[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.view-result-btn[_ngcontent-%COMP%]:hover{background-color:#388e3c}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;padding:40px;background:#f8f9fa;border-radius:8px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;margin-bottom:20px;opacity:.7}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{color:#666;font-size:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;padding:10px}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{margin:10px 0;width:100%;justify-content:space-around}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 5px;font-size:14px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{width:100%;top:100%}.content[_ngcontent-%COMP%]{padding:10px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:15px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .exam-item[_ngcontent-%COMP%]{margin-bottom:15px}}.dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{max-height:300px;overflow-y:auto}.dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]::-webkit-scrollbar{width:8px}.dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1}.dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#888;border-radius:3px}.dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#555}"]})};function A9(e,n){e&1&&(l(0,"div",27),N(1,"div",28),l(2,"p"),f(3,"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u..."),u()())}function T9(e,n){if(e&1&&(l(0,"div",29),N(1,"i",30),l(2,"p"),f(3),u()()),e&2){let t=D();m(3),ae(t.error)}}function O9(e,n){if(e&1&&(l(0,"div")(1,"div",31)(2,"div",32)(3,"h4"),f(4,"T\u1ED5ng S\u1ED1 B\xE0i Ki\u1EC3m Tra"),u(),l(5,"p"),f(6),u()(),l(7,"div",32)(8,"h4"),f(9,"\u0110i\u1EC3m Trung B\xECnh"),u(),l(10,"p"),f(11),u()(),l(12,"div",32)(13,"h4"),f(14,"T\u1ED5ng Th\u1EDDi Gian L\xE0m B\xE0i"),u(),l(15,"p"),f(16),u()(),l(17,"div",32)(18,"h4"),f(19,"S\u1ED1 B\xE0i Ki\u1EC3m Tra \u0110\xE3 Ho\xE0n Th\xE0nh"),u(),l(20,"p"),f(21),u()(),l(22,"div",32)(23,"h4"),f(24,"\u0110i\u1EC3m Cao Nh\u1EA5t"),u(),l(25,"p"),f(26),u()(),l(27,"div",32)(28,"h4"),f(29,"\u0110i\u1EC3m Th\u1EA5p Nh\u1EA5t"),u(),l(30,"p"),f(31),u()()()()),e&2){let t=D();m(6),ae(t.examStats.totalExams),m(5),ae(t.examStats.averageScore),m(5),te("",t.examStats.totalTimeSpentInMinutes," ph\xFAt"),m(5),ae(t.examStats.completedExams),m(5),ae(t.examStats.highestScore),m(5),ae(t.examStats.lowestScore)}}function I9(e,n){e&1&&(l(0,"div",34),N(1,"img",35),l(2,"p"),f(3,"Hi\u1EC7n t\u1EA1i kh\xF4ng c\xF3 b\xE0i thi n\xE0o trong l\u1ECBch s\u1EED"),u()())}function k9(e,n){if(e&1&&G(0,I9,4,0,"div",33),e&2){let t=D();O("ngIf",!t.loading&&!t.error)}}var sf=class e{constructor(n,t,r){this.authService=n;this.examService=t;this.router=r}user=null;examHistory=[];examStats=null;loading=!0;error=null;isDropdownActive=!1;ngOnInit(){this.user=this.authService.getCurrentUser(),this.user&&this.loadExamHistory()}loadExamHistory(){if(this.loading=!0,this.error=null,!this.user?._id){this.error="Kh\xF4ng t\xECm th\u1EA5y th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng",this.loading=!1;return}this.examService.getExamHistory(this.user._id).subscribe({next:n=>{this.examHistory=n,this.calculateStats(),this.loading=!1},error:n=>{console.error("Error loading exam history:",n),this.error="Kh\xF4ng th\u1EC3 t\u1EA3i l\u1ECBch s\u1EED b\xE0i thi. Vui l\xF2ng th\u1EED l\u1EA1i sau.",this.loading=!1}})}calculateStats(){let n=this.examHistory.length,t=this.examHistory.filter(d=>d.score!==null).length,r=this.examHistory.reduce((d,h)=>d+(h.score||0),0),i=n>0?r/n:0,o=this.examHistory.reduce((d,h)=>{let p=new Date(h.startTime),g=new Date(h.endTime);return d+Math.round((g.getTime()-p.getTime())/6e4)},0),s=this.formatDuration(o),a=Math.max(...this.examHistory.map(d=>d.score||0)),c=Math.min(...this.examHistory.map(d=>d.score||0));this.examStats={totalExams:n,completedExams:t,averageScore:i,totalTimeSpent:s,totalTimeSpentInMinutes:o,highestScore:a,lowestScore:c}}formatDuration(n){let t=Math.floor(n/60),r=n%60;return`${t>0?`${t} gi\u1EDD `:""}${r} ph\xFAt`}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}filterResults(n){let t=n.target.value.toLowerCase();this.examHistory=this.examHistory.filter(r=>r.examId.name.toLowerCase().includes(t)||r.examId.description.toLowerCase().includes(t))}logout(){this.authService.logout().subscribe({next:()=>{this.router.navigate(["/login"])},error:n=>{console.error("Logout error:",n)}})}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(It),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-exam-history"]],standalone:!0,features:[Me],decls:39,vars:7,consts:[["noExams",""],[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["routerLink","/student-dashboard"],["routerLink","/exam-history","routerLinkActive","active"],[1,"user-menu"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["routerLink","/profile"],[1,"fas","fa-user-graduate"],["routerLink","/settings"],[1,"fas","fa-cog"],[3,"click"],[1,"fas","fa-sign-out-alt"],[1,"container"],[1,"section"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],[4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[1,"fas","fa-exclamation-circle"],[1,"stats-summary"],[1,"stat-item"],["class","empty-state",4,"ngIf"],[1,"empty-state"],["src","../../assets/img/pic4.png","alt","No Exams"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",1)(1,"div",2),N(2,"img",3),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",4)(6,"a",5),f(7,"B\xE0i ki\u1EC3m tra"),u(),l(8,"a",6),f(9,"Th\u1ED1ng k\xEA k\u1EBFt qu\u1EA3"),u()(),l(10,"div",7)(11,"img",8),H("click",function(){return U(i),j(r.toggleDropdown())}),u(),l(12,"div",9)(13,"div",10),N(14,"img",11),l(15,"div",12)(16,"div",13),f(17),u(),l(18,"div",14),f(19),u()()(),l(20,"div",15)(21,"a",16),N(22,"i",17),f(23," Th\xF4ng tin c\xE1 nh\xE2n "),u(),l(24,"a",18),N(25,"i",19),f(26," C\xE0i \u0111\u1EB7t chung "),u(),l(27,"a",20),H("click",function(){return U(i),j(r.logout())}),N(28,"i",21),f(29," \u0110\u0103ng xu\u1EA5t "),u()()()()(),l(30,"div",22)(31,"div",23)(32,"h2"),f(33,"Th\u1ED1ng k\xEA k\u1EBFt qu\u1EA3 b\xE0i thi"),u(),G(34,A9,4,0,"div",24)(35,T9,4,1,"div",25)(36,O9,32,6,"div",26)(37,k9,1,1,"ng-template",null,0,nr),u()()}t&2&&(m(12),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(15),O("ngIf",r.loading),m(),O("ngIf",r.error),m(),O("ngIf",!r.loading&&!r.error&&r.examStats))},dependencies:[Ue,We,He,mr,bn,ed],styles:['@charset "UTF-8";.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:.75rem 1.5rem;background-color:#fff;box-shadow:0 2px 4px #0000001a;position:sticky;top:0;z-index:100}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;width:auto}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:1.125rem;font-weight:500;color:#1f2937}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{display:flex;align-items:center;gap:2rem;margin-left:3rem;flex-grow:1}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none;color:#4b5563;font-weight:500;padding:.5rem 0;border-bottom:2px solid transparent;transition:all .2s ease}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#3b82f6}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#3b82f6;border-bottom-color:#3b82f6}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.25rem;color:#6b7280;cursor:pointer;transition:color .2s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]:hover{color:#3b82f6}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border-radius:50%;cursor:pointer;transition:transform .2s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:100%;right:0;width:280px;background:#fff;border-radius:.5rem;box-shadow:0 4px 6px -1px #0000001a;margin-top:.5rem}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block;animation:_ngcontent-%COMP%_slideDown .2s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #e5e7eb;display:flex;align-items:center;gap:1rem}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500;color:#1f2937}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:.875rem;color:#6b7280}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:.5rem 0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;color:#4b5563;text-decoration:none;transition:background-color .2s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#f3f4f6;color:#3b82f6}.container[_ngcontent-%COMP%]{width:100%;max-width:1200px;margin:0 auto;text-align:center;padding:20px;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}.stats-summary[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:30px;margin-top:40px}.stat-item[_ngcontent-%COMP%]{background-color:#fff;padding:40px;border-radius:10px;box-shadow:0 4px 8px #0000001a;text-align:center;min-height:150px;display:flex;flex-direction:column;justify-content:space-between;align-items:center;transition:transform .3s ease,box-shadow .3s ease;animation:_ngcontent-%COMP%_slideDown 1s ease-out}@keyframes _ngcontent-%COMP%_slideDown{0%{transform:translateY(-20px);opacity:0}to{transform:translateY(0);opacity:1}}.stat-item[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin-bottom:30px;font-size:18px;color:#2c3e50;transition:color .3s ease;flex-grow:1;align-self:flex-start}.stat-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;font-weight:700;color:#34495e;margin-top:10px}.stat-bar[_ngcontent-%COMP%]{height:12px;background-color:#4caf50;border-radius:6px;margin:15px 0;transition:width .5s ease-in-out,background-color .3s ease}.stat-item[_ngcontent-%COMP%]:hover{background-color:#ecf0f1;box-shadow:0 6px 12px #00000026;transform:translateY(-5px)}.stat-item[_ngcontent-%COMP%]:hover   h4[_ngcontent-%COMP%]{color:#1abc9c}.stat-item[_ngcontent-%COMP%]:hover   p[_ngcontent-%COMP%]{color:#16a085}.stat-bar[_ngcontent-%COMP%]:hover{background-color:#3e8e41}.empty-state[_ngcontent-%COMP%]{text-align:center;margin-top:70px;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;height:auto;transition:transform .3s ease}.empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.05)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#7f8c8d;transition:color .3s ease}.empty-state[_ngcontent-%COMP%]:hover   p[_ngcontent-%COMP%]{color:#34495e}@media (max-width: 768px){.stats-summary[_ngcontent-%COMP%]{grid-template-columns:1fr;gap:20px}.container[_ngcontent-%COMP%]{padding:10px}}h2[_ngcontent-%COMP%]{font-size:32px;color:#2c3e50;margin-bottom:20px;text-align:center;font-weight:700;letter-spacing:1px;transition:color .3s ease,transform .3s ease;animation:_ngcontent-%COMP%_fadeIn 1s ease-in-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}h2[_ngcontent-%COMP%]:hover{color:#16a085;transform:translateY(-5px)}@media (max-width: 768px){h2[_ngcontent-%COMP%]{font-size:28px;margin-bottom:15px}}']})};function P9(e,n){if(e&1&&(l(0,"div")(1,"div",6)(2,"p")(3,"strong"),f(4,"ID:"),u(),f(5),u(),l(6,"p")(7,"strong"),f(8,"T\xEAn ng\u01B0\u1EDDi d\xF9ng:"),u(),f(9),u(),l(10,"p")(11,"strong"),f(12,"Email:"),u(),f(13),u(),l(14,"p")(15,"strong"),f(16,"Vai tr\xF2:"),u(),l(17,"span",7),f(18),u()(),l(19,"p")(20,"strong"),f(21,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i:"),u(),f(22),u(),l(23,"p")(24,"strong"),f(25,"Gi\u1EDBi t\xEDnh:"),u(),l(26,"span",7),f(27),u()(),l(28,"p")(29,"strong"),f(30,"Ng\xE0y sinh:"),u(),f(31),zt(32,"date"),u()()()),e&2){let t=D();m(5),te(" ",t.user._id,""),m(4),te(" ",t.user.username,""),m(4),te(" ",t.user.email,""),m(5),te(" ",t.user.role==="teacher"?"Gi\xE1o vi\xEAn":t.user.role==="student"?"H\u1ECDc vi\xEAn":t.user.role==="admin"?"Qu\u1EA3n tr\u1ECB vi\xEAn":"Vai tr\xF2 kh\xF4ng x\xE1c \u0111\u1ECBnh"," "),m(4),te(" ",t.user.phoneNumber,""),m(5),te(" ",t.user.gender==="male"?"Nam":t.user.gender==="female"?"N\u1EEF":t.user.gender==="other"?"Kh\xE1c":"Kh\xF4ng x\xE1c \u0111\u1ECBnh"," "),m(4),te(" ",So(32,7,t.user.dateOfBirth,"dd-MM-yyyy"),"")}}function F9(e,n){e&1&&(l(0,"div",8)(1,"p"),f(2,"Kh\xF4ng c\xF3 th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng."),u()())}function N9(e,n){e&1&&(l(0,"button",9),f(1,"Ch\u1EC9nh s\u1EEDa th\xF4ng tin"),u()),e&2&&O("routerLink","/settings")}var af=class e{constructor(n,t){this.authService=n;this.router=t}user=null;ngOnInit(){this.authService.getCurrentUserFromApi().subscribe(n=>{this.user=n,console.log("User from API:",this.user)},n=>{console.error("L\u1ED7i khi l\u1EA5y th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng t\u1EEB API:",n)})}goBack(){window.history.back()}navigateToSettings(){this.router.navigate(["/settings"])}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-profile"]],standalone:!0,features:[Me],decls:11,vars:3,consts:[[1,"profile-container"],[4,"ngIf"],["class","no-user",4,"ngIf"],[3,"click"],[3,"routerLink",4,"ngIf"],[1,"footer"],[1,"profile-info"],[1,"gender"],[1,"no-user"],[3,"routerLink"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"h2"),f(2,"Th\xF4ng tin c\xE1 nh\xE2n"),u(),G(3,P9,33,10,"div",1)(4,F9,3,0,"div",2),l(5,"button",3),H("click",function(){return r.goBack()}),f(6,"Quay l\u1EA1i"),u(),G(7,N9,2,1,"button",4),l(8,"div",5)(9,"p"),f(10,"\xA9 2024, Qu\u1EA3n l\xFD ng\u01B0\u1EDDi d\xF9ng"),u()()()),t&2&&(m(3),O("ngIf",r.user),m(),O("ngIf",!r.user),m(3),O("ngIf",r.user))},dependencies:[Ue,We,pr,He,mr,bn],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Arial,sans-serif;background-color:#f4f7fc;margin:0;padding:0}.profile-container[_ngcontent-%COMP%]{width:80%;max-width:800px;margin:50px auto;padding:30px;background-color:#fff;border-radius:10px;box-shadow:0 4px 8px #0000001a;text-align:center}.profile-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;color:#333;margin-bottom:20px;text-transform:uppercase;letter-spacing:2px;font-weight:700}.profile-info[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:15px;margin-bottom:20px;text-align:left}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#555;margin:10px 0}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#333;font-weight:700}.profile-info[_ngcontent-%COMP%]   .gender[_ngcontent-%COMP%]{font-style:italic}.profile-container[_ngcontent-%COMP%]   .no-user[_ngcontent-%COMP%]{font-size:16px;color:#777;font-style:italic}button[_ngcontent-%COMP%]{display:inline-block;padding:10px 20px;margin-top:20px;margin-right:10px;border:none;border-radius:5px;background-color:#007bff;color:#fff;font-size:16px;cursor:pointer;transition:background-color .3s ease}button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button[_ngcontent-%COMP%]:disabled{background-color:#ccc;cursor:not-allowed}footer[_ngcontent-%COMP%]{text-align:center;margin-top:30px;font-size:14px;color:#aaa}footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10p 0}']})};function R9(e,n){if(e&1){let t=ve();l(0,"div",22)(1,"div",3)(2,"label",23),f(3,"M\u1EADt kh\u1EA9u c\u0169:"),u(),l(4,"input",24),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.updatedUser.currentPassword,i)||(o.updatedUser.currentPassword=i),j(i)}),u()(),l(5,"div",3)(6,"label",25),f(7,"M\u1EADt kh\u1EA9u m\u1EDBi:"),u(),l(8,"input",26),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.updatedUser.newPassword,i)||(o.updatedUser.newPassword=i),j(i)}),u()()()}if(e&2){let t=D(2);m(4),me("ngModel",t.updatedUser.currentPassword),m(4),me("ngModel",t.updatedUser.newPassword)}}function B9(e,n){if(e&1){let t=ve();l(0,"div")(1,"form",2),H("ngSubmit",function(){U(t);let i=D();return j(i.updateUser())}),l(2,"div",3)(3,"label",4),f(4,"T\xEAn ng\u01B0\u1EDDi d\xF9ng:"),u(),l(5,"input",5),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.updatedUser.username,i)||(o.updatedUser.username=i),j(i)}),u()(),l(6,"div",3)(7,"label",6),f(8,"Email:"),u(),l(9,"input",7),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.updatedUser.email,i)||(o.updatedUser.email=i),j(i)}),u()(),l(10,"div",3)(11,"label",8),f(12,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i:"),u(),l(13,"input",9),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.updatedUser.phoneNumber,i)||(o.updatedUser.phoneNumber=i),j(i)}),u()(),l(14,"div",3)(15,"label",10),f(16,"Gi\u1EDBi t\xEDnh:"),u(),l(17,"select",11),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.updatedUser.gender,i)||(o.updatedUser.gender=i),j(i)}),l(18,"option",12),f(19,"Nam"),u(),l(20,"option",13),f(21,"N\u1EEF"),u(),l(22,"option",14),f(23,"Kh\xE1c"),u()()(),l(24,"div",3)(25,"label",15),f(26,"Ng\xE0y sinh:"),u(),l(27,"input",16),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.updatedUser.dateOfBirth,i)||(o.updatedUser.dateOfBirth=i),j(i)}),u()(),l(28,"button",17),H("click",function(){U(t);let i=D();return j(i.togglePasswordForm())}),f(29),u(),G(30,R9,9,2,"div",18),l(31,"div",19)(32,"button",20),H("click",function(){U(t);let i=D();return j(i.goBack())}),f(33,"Quay l\u1EA1i"),u(),l(34,"button",21),f(35,"C\u1EADp nh\u1EADt th\xF4ng tin"),u()()()()}if(e&2){let t=D();m(5),me("ngModel",t.updatedUser.username),m(4),me("ngModel",t.updatedUser.email),m(4),me("ngModel",t.updatedUser.phoneNumber),m(4),me("ngModel",t.updatedUser.gender),m(10),me("ngModel",t.updatedUser.dateOfBirth),m(2),te(" ",t.showPasswordForm?"\u1EA8n":"Thay \u0111\u1ED5i m\u1EADt kh\u1EA9u"," "),m(),O("ngIf",t.showPasswordForm)}}var cf=class e{constructor(n,t){this.authService=n;this.router=t}user=null;updatedUser={};showPasswordForm=!1;ngOnInit(){this.user=this.authService.getCurrentUser(),this.user&&(this.updatedUser=de({},this.user))}togglePasswordForm(){this.showPasswordForm=!this.showPasswordForm}updateUser(){if(this.updatedUser){if(this.showPasswordForm){if(!this.updatedUser.currentPassword||!this.updatedUser.newPassword){alert("Vui l\xF2ng nh\u1EADp \u0111\u1EA7y \u0111\u1EE7 m\u1EADt kh\u1EA9u c\u0169 v\xE0 m\u1EADt kh\u1EA9u m\u1EDBi.");return}if(this.updatedUser.currentPassword===this.updatedUser.newPassword){alert("M\u1EADt kh\u1EA9u m\u1EDBi kh\xF4ng \u0111\u01B0\u1EE3c tr\xF9ng v\u1EDBi m\u1EADt kh\u1EA9u c\u0169.");return}}this.authService.updateUser(this.updatedUser).subscribe({next:n=>{alert("C\u1EADp nh\u1EADt th\xF4ng tin th\xE0nh c\xF4ng!"),this.router.navigate(["/profile"])},error:n=>{alert("C\xF3 l\u1ED7i x\u1EA3y ra khi c\u1EADp nh\u1EADt th\xF4ng tin. Vui l\xF2ng th\u1EED l\u1EA1i.")}})}else console.error("No user data to update.")}goBack(){window.history.back()}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-settings"]],standalone:!0,features:[Me],decls:4,vars:1,consts:[[1,"settings-container"],[4,"ngIf"],[3,"ngSubmit"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","required","",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","phoneNumber"],["type","text","id","phoneNumber","name","phoneNumber",3,"ngModelChange","ngModel"],["for","gender"],["id","gender","name","gender",3,"ngModelChange","ngModel"],["value","male"],["value","female"],["value","other"],["for","dateOfBirth"],["type","date","id","dateOfBirth","name","dateOfBirth",3,"ngModelChange","ngModel"],["type","button",3,"click"],["class","password-form",4,"ngIf"],[1,"form-buttons"],[1,"back-button",3,"click"],["type","submit"],[1,"password-form"],["for","currentPassword"],["type","password","id","currentPassword","name","currentPassword",3,"ngModelChange","ngModel"],["for","newPassword"],["type","password","id","newPassword","name","newPassword",3,"ngModelChange","ngModel"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"h2"),f(2,"C\xE0i \u0110\u1EB7t Chung"),u(),G(3,B9,36,7,"div",1),u()),t&2&&(m(3),O("ngIf",r.user))},dependencies:[Ue,We,He,Mn,gr,xr,jt,jn,Ot,Sn,_n,Vt,Pn],styles:['@charset "UTF-8";.settings-container[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;padding:20px;background-color:#fff;border-radius:8px;box-shadow:0 4px 8px #0000001a}.settings-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#333;font-size:24px;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-size:16px;color:#555;margin-bottom:8px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;font-size:16px;border:1px solid #ddd;border-radius:4px;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#007bff;outline:none}.form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:20px}.form-buttons[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;margin-top:20px}button[_ngcontent-%COMP%]{padding:12px 30px;font-size:16px;border-radius:50px;border:none;cursor:pointer;font-weight:700;text-transform:uppercase;transition:all .3s ease;outline:none;width:100%}button.back-button[_ngcontent-%COMP%]{width:40%;background-color:#f1f1f1;color:#333;border:1px solid #ccc}button.back-button[_ngcontent-%COMP%]:hover{background-color:#e1e1e1;transform:translateY(-2px)}button[type=submit][_ngcontent-%COMP%]{width:60%;background-color:#007bff;color:#fff;border:none;transition:all .3s ease}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}button[_ngcontent-%COMP%]:active{transform:translateY(2px)}.settings-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]{text-align:center;margin-top:30px}.settings-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#777;font-size:14px}']})};var L9=e=>({warning:e});function V9(e,n){if(e&1){let t=ve();l(0,"div",16)(1,"button",17),H("click",function(){U(t);let i=D(2);return j(i.previousSection())}),N(2,"i",18),f(3," Ph\u1EA7n tr\u01B0\u1EDBc "),u(),l(4,"span"),f(5),u(),l(6,"button",17),H("click",function(){U(t);let i=D(2);return j(i.nextSection())}),f(7," Ph\u1EA7n ti\u1EBFp "),N(8,"i",19),u()()}if(e&2){let t=D(2);m(),O("disabled",t.currentSection===0),m(4),Wt("Ph\u1EA7n ",t.currentSection+1,"/",t.exam.sections.length,""),m(),O("disabled",t.currentSection===t.exam.sections.length-1)}}function U9(e,n){if(e&1&&(cn(0),l(1,"p"),f(2,"Ch\u1ECDn c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng:"),u(),l(3,"audio",28),N(4,"source",29),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u(),un()),e&2){let t=D().$implicit;m(4),O("src",t.questionId==null?null:t.questionId.text,Qt)}}function j9(e,n){if(e&1&&(cn(0),f(1),un()),e&2){let t=D().$implicit;m(),te(" ",(t.questionId==null?null:t.questionId.text)||"Kh\xF4ng c\xF3 d\u1EEF li\u1EC7u c\xE2u h\u1ECFi"," ")}}function H9(e,n){if(e&1){let t=ve();l(0,"label")(1,"input",30),H("change",function(){let i=U(t).$implicit,o=D().$implicit,s=D(3);return j(s.onAnswerSelected(o._id,i.text))}),u(),l(2,"span",31),f(3),u()()}if(e&2){let t=n.$implicit,r=D().$implicit,i=D(3);xt("selected",i.isAnswerSelected(r._id,t.text)),m(),O("name","question"+r._id)("value",t.text)("checked",i.isAnswerSelected(r._id,t.text))("disabled",i.isExamEnded),m(2),ae(t.text)}}function $9(e,n){if(e&1&&(l(0,"div",22)(1,"div",23)(2,"h4"),f(3),u(),l(4,"span",24),f(5),u()(),G(6,U9,6,1,"ng-container",25)(7,j9,2,1,"ng-container",25),l(8,"div",26),G(9,H9,4,7,"label",27),u()()),e&2){let t=n.$implicit,r=n.index;m(3),te("C\xE2u ",r+1,""),m(2),te("",t.score," \u0111i\u1EC3m"),m(),O("ngIf",t.questionId==null||t.questionId.text==null?null:t.questionId.text.includes("http")),m(),O("ngIf",!(!(t.questionId==null||t.questionId.text==null)&&t.questionId.text.includes("http"))),m(2),O("ngForOf",t.questionId.answers)}}function q9(e,n){if(e&1&&(l(0,"div",20)(1,"h3"),f(2),u(),l(3,"p"),f(4),u(),G(5,$9,10,5,"div",21),u()),e&2){let t=n.$implicit,r=n.index,i=D(2);xt("active",r===i.currentSection)("hidden",r!==i.currentSection),m(2),ae(t.title),m(2),ae(t.description),m(),O("ngForOf",t.questions)}}function W9(e,n){if(e&1){let t=ve();l(0,"button",32),H("click",function(){U(t);let i=D(2);return j(i.previousSection())}),N(1,"i",33),f(2," Ph\u1EA7n tr\u01B0\u1EDBc "),u()}}function z9(e,n){if(e&1){let t=ve();l(0,"button",32),H("click",function(){U(t);let i=D(2);return j(i.nextSection())}),f(1," Ph\u1EA7n ti\u1EBFp "),N(2,"i",34),u()}}function G9(e,n){if(e&1&&(l(0,"button",35),f(1," N\u1ED9p b\xE0i thi "),u()),e&2){let t=D(2);O("disabled",t.isExamEnded||t.answeredQuestions===0)}}function Q9(e,n){if(e&1){let t=ve();l(0,"div",2)(1,"div",3)(2,"h2"),f(3),u(),l(4,"div",4)(5,"div",5),N(6,"i",6),l(7,"span"),f(8),u()(),l(9,"div",7)(10,"div",8),f(11),u()()()(),l(12,"div",9)(13,"p")(14,"strong"),f(15,"M\xF4 t\u1EA3:"),u(),f(16),u(),l(17,"p")(18,"strong"),f(19,"Th\u1EDDi gian:"),u(),f(20),zt(21,"date"),zt(22,"date"),u(),l(23,"p")(24,"strong"),f(25,"Th\u1EDDi l\u01B0\u1EE3ng:"),u(),f(26),u(),l(27,"p")(28,"strong"),f(29,"\u0110i\u1EC3m t\u1ED1i \u0111a:"),u(),f(30),u()(),l(31,"form",10),H("ngSubmit",function(){U(t);let i=D();return j(i.submitExam())}),G(32,V9,9,4,"div",11)(33,q9,6,7,"div",12),l(34,"div",13),G(35,W9,3,0,"button",14)(36,z9,3,0,"button",14)(37,G9,2,1,"button",15),u()()()}if(e&2){let t=D();m(3),ae(t.exam.name),m(2),O("ngClass",Kv(21,L9,t.shouldShowWarning())),m(3),ae(t.formatTime(t.remainingTime)),m(2),u0("width",t.progressPercentage,"%"),m(),Wt(" ",t.answeredQuestions,"/",t.totalQuestions," "),m(5),te(" ",t.exam.description,""),m(4),Wt(" ",tr(21,17,t.exam.startDate)," - ",tr(22,19,t.exam.endDate),""),m(6),te(" ",t.exam.duration," ph\xFAt"),m(4),te(" ",t.exam.maxScore,""),m(2),O("ngIf",t.exam.sections.length>1),m(),O("ngForOf",t.exam.sections),m(2),O("ngIf",t.currentSection>0),m(),O("ngIf",t.currentSection<t.exam.sections.length-1),m(),O("ngIf",t.currentSection===t.exam.sections.length-1)}}function X9(e,n){e&1&&(l(0,"div",36),N(1,"div",37),l(2,"p"),f(3,"\u0110ang t\u1EA3i d\u1EEF li\u1EC7u b\xE0i thi..."),u()())}var uf=class e{constructor(n,t,r){this.route=n;this.examService=t;this.router=r}exam=null;examId=null;selectedAnswers={};remainingTime=0;timerInterval;examStartTime=null;isExamEnded=!1;answeredQuestions=0;totalQuestions=0;currentSection=0;isSubmitting=!1;errorMessage="";showConfirmSubmit=!1;showTimeoutWarning=!1;ngOnInit(){this.examId=this.route.snapshot.paramMap.get("id"),this.examId&&(this.loadExam(this.examId),this.loadSavedExamState())}ngOnDestroy(){this.clearTimer(),this.saveExamState()}loadExam(n){this.examService.getExamById(n).subscribe({next:t=>{this.exam=t,this.totalQuestions=this.calculateTotalQuestions(),this.examStartTime||this.startExam(),this.initializeTimer()},error:t=>{console.error("Error loading exam:",t),this.showErrorMessage("Kh\xF4ng th\u1EC3 t\u1EA3i b\xE0i thi. Vui l\xF2ng th\u1EED l\u1EA1i sau.")}})}startExam(){this.examStartTime=new Date,this.isExamEnded=!1,this.examId&&localStorage.setItem(`exam_${this.examId}_start`,this.examStartTime.toISOString())}loadSavedExamState(){if(this.examId)try{let n=localStorage.getItem(`exam_${this.examId}_state`);if(n){let t=JSON.parse(n),r={};Object.entries(t.answers).forEach(([o,s])=>{s&&s.answer&&s.questionId&&(r[o]={questionId:s.questionId,answer:s.answer,timestamp:new Date(s.timestamp)})}),this.selectedAnswers=r;let i=new Date(t.startTime);this.examStartTime=isNaN(i.getTime())?new Date:i,this.currentSection=typeof t.currentSection=="number"?t.currentSection:0,this.answeredQuestions=Object.keys(r).length}else this.examStartTime=new Date}catch(n){console.error("Error loading saved state:",n),this.clearSavedState(),this.examStartTime=new Date}}saveExamState(){if(this.examId){let n={answers:this.selectedAnswers,startTime:this.examStartTime,currentSection:this.currentSection};localStorage.setItem(`exam_${this.examId}_state`,JSON.stringify(n))}}clearSavedState(){this.examId&&(localStorage.removeItem(`exam_${this.examId}_state`),localStorage.removeItem(`exam_${this.examId}_start`))}clearTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)}initializeTimer(){if(!this.exam||!this.examStartTime)return;let n=this.exam.duration*60*1e3,t=new Date(this.examStartTime.getTime()+n),r=new Date;if(r>=t){this.endExam();return}this.remainingTime=Math.floor((t.getTime()-r.getTime())/1e3),this.startTimer()}startTimer(){this.clearTimer(),this.timerInterval=setInterval(()=>{this.remainingTime--,this.remainingTime<=300&&!this.showTimeoutWarning&&(this.showTimeoutWarning=!0),this.remainingTime<=0&&this.endExam()},1e3)}shouldShowWarning(){return this.remainingTime<=300}formatTime(n){let t=Math.floor(n/3600),r=Math.floor(n%3600/60),i=n%60;return`${t.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}:${i.toString().padStart(2,"0")}`}get progressPercentage(){return this.totalQuestions===0?0:this.answeredQuestions/this.totalQuestions*100}previousSection(){this.currentSection>0&&this.currentSection--}nextSection(){this.currentSection<(this.exam?.sections.length??0)-1&&this.currentSection++}goToSection(n){n>=0&&n<(this.exam?.sections.length??0)&&(this.currentSection=n)}onAnswerSelected(n,t){if(this.isExamEnded||this.isSubmitting)return;this.selectedAnswers[n]?.answer===t?delete this.selectedAnswers[n]:this.selectedAnswers[n]={questionId:n,answer:t,timestamp:new Date},this.answeredQuestions=Object.keys(this.selectedAnswers).length,this.saveExamState()}isAnswerSelected(n,t){return this.selectedAnswers[n]?.answer===t}getAnsweredInSection(n){return n.questions.filter(t=>this.selectedAnswers[t._id]).length}isQuestionAnswered(n){return!!this.selectedAnswers[n]}isSectionCompleted(n){if(!this.exam)return!1;let t=this.exam.sections[n];return this.getAnsweredInSection(t)===t.questions.length}get canSubmit(){return!this.isExamEnded&&!this.isSubmitting&&Object.keys(this.selectedAnswers).length>0&&this.currentSection===(this.exam?.sections.length??0)-1}submitExam(){if(!this.exam||!this.examId||this.isExamEnded||this.isSubmitting)return;if(!this.showConfirmSubmit){this.showConfirmSubmit=!0;return}if(!this.examStartTime){this.showErrorMessage("Th\u1EDDi gian b\u1EAFt \u0111\u1EA7u kh\xF4ng h\u1EE3p l\u1EC7");return}this.isSubmitting=!0;let n=[];this.exam.sections.forEach(r=>{r.questions.forEach(i=>{let o=this.selectedAnswers[i._id];o&&n.push({questionId:i._id,answer:o.answer,timestamp:o.timestamp.toISOString()})})});let t={answers:n,startTime:this.examStartTime.toISOString(),endTime:new Date().toISOString()};this.examService.submitExam(this.examId,t).subscribe({next:r=>{this.isSubmitting=!1,this.clearSavedState();let i={_id:r.id,examId:{_id:this.examId,name:this.exam?.name,maxScore:this.exam?.maxScore},score:r.score,maxScore:r.maxScore,percentageScore:r.percentageScore,startTime:t.startTime,endTime:t.endTime,answers:r.answers||[]};sessionStorage.setItem("lastExamResult",JSON.stringify(i));let o=`
          B\xE0i thi: ${this.exam?.name}
          \u0110i\u1EC3m s\u1ED1: ${r.score}/${r.maxScore}
          T\u1EF7 l\u1EC7 \u0111\xFAng: ${r.percentageScore.toFixed(1)}%
        `;alert(o),this.router.navigate(["/student-dashboard"])},error:r=>{this.isSubmitting=!1,console.error("Error submitting exam:",r),this.showErrorMessage("C\xF3 l\u1ED7i x\u1EA3y ra khi n\u1ED9p b\xE0i thi. Vui l\xF2ng th\u1EED l\u1EA1i.")}})}formatExamResult(n){return`
      \u0110i\u1EC3m s\u1ED1: ${n.score}/${n.maxScore}
      T\u1EF7 l\u1EC7 \u0111\xFAng: ${n.percentageScore.toFixed(1)}%
      Th\u1EDDi gian l\xE0m b\xE0i: ${this.formatDuration(n.duration)}
    `}formatDuration(n){let t=Math.floor(n/60),r=n%60;return t>0?`${t} gi\u1EDD ${r} ph\xFAt`:`${r} ph\xFAt`}confirmSubmit(){this.showConfirmSubmit=!1,this.submitExam()}cancelSubmit(){this.showConfirmSubmit=!1}acknowledgeTimeWarning(){this.showTimeoutWarning=!1}showErrorMessage(n){this.errorMessage=n,setTimeout(()=>{this.errorMessage=""},5e3)}endExam(){this.isExamEnded||(this.isExamEnded=!0,this.clearTimer(),Object.keys(this.selectedAnswers).length>0?this.showConfirmSubmit=!0:(this.showErrorMessage("B\xE0i thi k\u1EBFt th\xFAc m\xE0 kh\xF4ng c\xF3 c\xE2u tr\u1EA3 l\u1EDDi n\xE0o \u0111\u01B0\u1EE3c ghi nh\u1EADn."),this.router.navigate(["/exams-history"])))}calculateTotalQuestions(){return this.exam?this.exam.sections.reduce((n,t)=>n+t.questions.length,0):0}static \u0275fac=function(t){return new(t||e)(Q(dn),Q(It),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-exam-take"]],standalone:!0,features:[Me],decls:2,vars:2,consts:[["class","exam-container",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"exam-container"],[1,"exam-header"],[1,"exam-stats"],[1,"timer",3,"ngClass"],[1,"fas","fa-clock"],[1,"progress-bar"],[1,"progress"],[1,"exam-info"],[3,"ngSubmit"],["class","section-navigation",4,"ngIf"],["class","exam-section",3,"active","hidden",4,"ngFor","ngForOf"],[1,"exam-footer"],["type","button","class","btn-secondary",3,"click",4,"ngIf"],["type","submit","class","btn-primary",3,"disabled",4,"ngIf"],[1,"section-navigation"],["type","button",3,"click","disabled"],[1,"fas","fa-chevron-left"],[1,"fas","fa-chevron-right"],[1,"exam-section"],["class","question-container",4,"ngFor","ngForOf"],[1,"question-container"],[1,"question-header"],[1,"question-points"],[4,"ngIf"],[1,"answers-container"],[3,"selected",4,"ngFor","ngForOf"],["controls",""],["type","audio/mpeg",3,"src"],["type","radio",3,"change","name","value","checked","disabled"],[1,"answer-text"],["type","button",1,"btn-secondary",3,"click"],[1,"fas","fa-arrow-left"],[1,"fas","fa-arrow-right"],["type","submit",1,"btn-primary",3,"disabled"],[1,"loading-container"],[1,"spinner"]],template:function(t,r){t&1&&G(0,Q9,38,23,"div",0)(1,X9,4,0,"div",1),t&2&&(O("ngIf",r.exam),m(),O("ngIf",!r.exam))},dependencies:[Ue,hr,lt,We,pr,He,Mn,Sn,Pn],styles:[".exam-container[_ngcontent-%COMP%]{max-width:900px;margin:3rem auto;padding:2.5rem;background-color:#fff;border-radius:12px;box-shadow:0 8px 16px #0000001a}.exam-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.exam-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;font-size:2.4rem;font-weight:600}.exam-stats[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.timer[_ngcontent-%COMP%]{display:flex;align-items:center;color:#495057;font-size:1.1rem}.timer[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.5rem}.timer.warning[_ngcontent-%COMP%]{color:#e74c3c}.progress-bar[_ngcontent-%COMP%]{width:200px;height:16px;background-color:#e9ecef;border-radius:8px;overflow:hidden}.progress[_ngcontent-%COMP%]{height:100%;background-color:#3498db;text-align:right;color:#fff;font-size:.9rem;line-height:16px;padding-right:.5rem}.exam-info[_ngcontent-%COMP%]{background-color:#f8f9fa;padding:1.8rem;border-radius:8px;margin-bottom:2.5rem}.exam-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:.6rem 0;color:#495057;font-size:1.1rem}.exam-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#2c3e50;margin-right:.5rem}.exam-section[_ngcontent-%COMP%]{margin-bottom:3.5rem}.exam-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#3498db;font-size:1.8rem;margin-bottom:1.2rem;padding-bottom:.6rem;border-bottom:2px solid #e9ecef}.exam-section[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#495057;margin-bottom:1.8rem;line-height:1.6}.question-container[_ngcontent-%COMP%]{background-color:#fff;padding:1.8rem;margin-bottom:2rem;border:1px solid #e9ecef;border-radius:8px;transition:transform .2s,box-shadow .2s}.question-container[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 8px 16px #0000001a}.question-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.4rem}.question-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;font-size:1.3rem;font-weight:500}.question-header[_ngcontent-%COMP%]   .question-points[_ngcontent-%COMP%]{color:#495057;font-size:1rem}.question-text[_ngcontent-%COMP%]{color:#495057;margin-bottom:1.4rem}.answers-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.2rem}.answers-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;align-items:center;padding:1rem 1.2rem;background-color:#f8f9fa;border-radius:6px;cursor:pointer;transition:background-color .2s}.answers-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.answers-container[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:1rem;width:20px;height:20px;accent-color:#3498db}.answers-container[_ngcontent-%COMP%]   .answer-text[_ngcontent-%COMP%]{color:#495057;font-size:1rem}.section-navigation[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem}.section-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{display:flex;align-items:center;background-color:#f8f9fa;color:#495057;border:none;border-radius:6px;padding:.8rem 1.2rem;font-size:1rem;cursor:pointer;transition:background-color .2s}.section-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.section-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.section-navigation[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0 .5rem}.exam-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-top:2rem}.btn-secondary[_ngcontent-%COMP%]{background-color:#f8f9fa;color:#495057;border:none;border-radius:6px;padding:.8rem 1.2rem;font-size:1rem;cursor:pointer;transition:background-color .2s}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.btn-primary[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;border-radius:6px;padding:.8rem 1.2rem;font-size:1rem;cursor:pointer;transition:background-color .2s}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#2980b9}.loading-container[_ngcontent-%COMP%]{text-align:center;padding:3.5rem;color:#495057}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;margin-bottom:1.2rem}.spinner[_ngcontent-%COMP%]{width:40px;height:40px;margin:0 auto;border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media (max-width: 768px){.exam-container[_ngcontent-%COMP%]{padding:1.5rem;margin:1.5rem}.exam-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:2rem}.exam-stats[_ngcontent-%COMP%]{gap:1rem}.progress-bar[_ngcontent-%COMP%]{width:150px}.exam-info[_ngcontent-%COMP%]{padding:1.5rem}.exam-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem}.exam-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.6rem}.question-container[_ngcontent-%COMP%]{padding:1.2rem}.question-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-size:1.2rem}.answers-container[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{padding:.8rem 1rem}.answers-container[_ngcontent-%COMP%]   .answer-text[_ngcontent-%COMP%]{font-size:.95rem}}"]})};var Y9=(e,n,t,r)=>({correct:e,incorrect:n,"user-selected":t,"correct-answer":r});function K9(e,n){e&1&&(l(0,"div",5),N(1,"div",6),l(2,"p"),f(3,"\u0110ang t\u1EA3i k\u1EBFt qu\u1EA3 b\xE0i thi..."),u()())}function Z9(e,n){if(e&1){let t=ve();l(0,"div",7)(1,"p"),f(2),u(),l(3,"button",8),H("click",function(){U(t);let i=D();return j(i.goBack())}),f(4,"Quay l\u1EA1i"),u()()}if(e&2){let t=D();m(2),ae(t.error)}}function J9(e,n){if(e&1&&(cn(0),f(1),un()),e&2){let t=D().$implicit;m(),te(" ",(t==null||t.questionId==null?null:t.questionId.text)||"N\u1ED9i dung c\xE2u h\u1ECFi kh\xF4ng kh\u1EA3 d\u1EE5ng"," ")}}function eV(e,n){if(e&1&&(cn(0),l(1,"audio",18),N(2,"source",19),f(3," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u(),un()),e&2){let t=D().$implicit;m(2),O("src",t==null||t.questionId==null?null:t.questionId.text,Qt)}}function tV(e,n){if(e&1&&(l(0,"div",22)(1,"label"),N(2,"input",23),f(3),u()()),e&2){let t=n.$implicit,r=D(2).$implicit;O("ngClass",l0(3,Y9,t.isCorrect&&t.text===r.userAnswer,!t.isCorrect&&t.text===r.userAnswer,t.text===r.userAnswer,t.isCorrect&&t.text!==r.userAnswer)),m(2),O("checked",t.text===r.userAnswer),m(),te(" ",t.text," ")}}function nV(e,n){if(e&1&&(l(0,"div",20),G(1,tV,4,8,"div",21),u()),e&2){let t=D().$implicit;m(),O("ngForOf",t==null||t.questionId==null?null:t.questionId.answers)}}function rV(e,n){if(e&1&&(l(0,"span"),f(1),u()),e&2){let t=D().$implicit;m(),ae(t.userAnswer)}}function iV(e,n){e&1&&(l(0,"span"),f(1,"Ch\u01B0a tr\u1EA3 l\u1EDDi"),u())}function oV(e,n){if(e&1&&(l(0,"span"),f(1),u()),e&2){let t=D().$implicit,r=D(3);m(),ae(r.getCorrectAnswer(t))}}function sV(e,n){if(e&1&&(l(0,"div",14)(1,"p")(2,"strong"),f(3),u(),G(4,J9,2,1,"ng-container",4),u(),G(5,eV,4,1,"ng-container",4),l(6,"p",15)(7,"strong"),f(8,"\u0110i\u1EC3m:"),u(),f(9),u(),G(10,nV,2,1,"div",16),l(11,"p",17)(12,"strong"),f(13,"\u0110\xE1p \xE1n c\u1EE7a b\u1EA1n: "),u(),G(14,rV,2,1,"span",4)(15,iV,2,0,"span",4),u(),l(16,"p"),N(17,"strong"),G(18,oV,2,1,"span",4),u()()),e&2){let t=n.$implicit,r=D().$implicit,i=D(2);m(3),te("C\xE2u h\u1ECFi ",r.questions.indexOf(t)+1,":"),m(),O("ngIf",!(!(t==null||t.questionId==null||t.questionId.text==null)&&t.questionId.text.startsWith("http"))),m(),O("ngIf",t==null||t.questionId==null||t.questionId.text==null?null:t.questionId.text.startsWith("http")),m(4),te(" ",t.score," \u0111i\u1EC3m"),m(),O("ngIf",t&&t.questionId&&t.questionId.answers&&t.questionId.answers.length>0),m(4),O("ngIf",t.userAnswer),m(),O("ngIf",!t.userAnswer),m(3),O("ngIf",i.hasCorrectAnswer(t))}}function aV(e,n){if(e&1&&(l(0,"div")(1,"h5"),f(2),u(),G(3,sV,19,8,"div",13),u()),e&2){let t=n.$implicit;m(2),te("M\xF4 t\u1EA3: ",t.title,""),m(),O("ngForOf",t.questions)}}function cV(e,n){if(e&1&&(cn(0),l(1,"div",9)(2,"h1"),f(3),u(),l(4,"p")(5,"b"),f(6,"M\xF4 t\u1EA3: "),u(),f(7),u(),l(8,"p")(9,"b"),f(10,"H\u1ECDc vi\xEAn: "),u(),f(11),u()(),l(12,"div",10)(13,"h2"),f(14,"K\u1EBFt qu\u1EA3 t\u1ED5ng quan"),u(),l(15,"p"),f(16),u(),l(17,"p"),f(18),u(),l(19,"p"),f(20),u(),l(21,"p"),f(22),u()(),l(23,"div",11)(24,"h2"),f(25,"C\xE1c ph\u1EA7n thi"),u(),G(26,aV,4,2,"div",12),u(),un()),e&2){let t=D();m(3),ae(t.examResult.examId.name),m(4),ae(t.examResult.examId.description),m(4),ae(t.user==null?null:t.user.username),m(5),te("T\u1ED5ng s\u1ED1 c\xE2u h\u1ECFi: ",t.getTotalQuestions(),""),m(2),te("S\u1ED1 \u0111i\u1EC3m: ",t.examResult.score,"/10"),m(2),te("Th\u1EDDi gian b\u1EAFt \u0111\u1EA7u: ",t.formatDate(t.examResult.startTime),""),m(2),te("Th\u1EDDi gian k\u1EBFt th\xFAc: ",t.formatDate(t.examResult.endTime),""),m(4),O("ngForOf",t.examResult.examId.sections)}}var lf=class e{constructor(n,t,r,i){this.route=n;this.examService=t;this.authService=r;this.router=i}loading=!0;error=null;examResult=null;examId=null;userId=null;user=null;ngOnInit(){let n=this.route.snapshot.paramMap.get("examId"),t=this.route.snapshot.paramMap.get("userId"),r=this.route.snapshot.paramMap.get("id");if(n&&t)this.examId=n,this.userId=t;else if(r)this.examId=r,this.userId=null;else{this.error="Kh\xF4ng t\xECm th\u1EA5y th\xF4ng tin b\xE0i thi",this.loading=!1;return}this.user=this.authService.getCurrentUser(),this.loadExamResult()}loadExamResult(){if(!this.examId){this.error="Kh\xF4ng t\xECm th\u1EA5y th\xF4ng tin b\xE0i thi",this.loading=!1;return}let n=this.authService.getCurrentUser();if(!n?._id){this.error="Kh\xF4ng t\xECm th\u1EA5y th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng",this.loading=!1;return}this.examService.getExamHistory(n._id).subscribe({next:t=>{console.log("Fetched Exam History:",t);let r=t.find(i=>i._id===this.examId||i.examId===this.examId||i.examId?._id===this.examId);r?typeof r.examId=="string"?this.examService.getExamDetails(r.examId).subscribe({next:i=>{r.examId=i,this.mapUserAnswers(r)},error:i=>{console.error("Error fetching exam details:",i),this.error="Kh\xF4ng th\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u chi ti\u1EBFt b\xE0i thi"}}):r.examId.sections?this.mapUserAnswers(r):this.error="Kh\xF4ng t\xECm th\u1EA5y danh s\xE1ch c\xE2u h\u1ECFi trong b\xE0i thi":this.error="Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u b\xE0i thi",this.loading=!1},error:t=>{console.error("Error loading exam result:",t),this.error="Kh\xF4ng th\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u b\xE0i thi",this.loading=!1}})}mapUserAnswers(n){let t=0,r=0;n.examId.sections.forEach(i=>{i.questions.forEach(o=>{let s=n.answers.find(a=>a.questionId===o._id);o.userAnswer=s?.answer||null,s?.answer===this.getCorrectAnswer(o)&&t++,r++})}),n.correctAnswers=t,n.totalQuestions=r,this.examResult=n,console.log("Processed Exam Result:",this.examResult)}formatDate(n){return new Date(n).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}goBack(){window.history.back()}getCorrectAnswer(n){if(n&&Array.isArray(n.answers)){let t=n.answers.find(r=>r.isCorrect);return t?t.text:"Kh\xF4ng c\xF3 \u0111\xE1p \xE1n \u0111\xFAng"}return"Kh\xF4ng c\xF3 \u0111\xE1p \xE1n \u0111\xFAng"}hasCorrectAnswer(n){return n.answers&&Array.isArray(n.answers)&&n.answers.some(t=>t.isCorrect)}isArray(n){return Array.isArray(n)}getTotalQuestions(){return this.examResult?.examId?.sections?this.examResult.examId.sections.reduce((n,t)=>n+(t.questions?.length||0),0):0}static \u0275fac=function(t){return new(t||e)(Q(dn),Q(It),Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-exam-result-detail"]],standalone:!0,features:[Me],decls:6,vars:3,consts:[[1,"container"],[1,"go-back",3,"click"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],[4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[3,"click"],[1,"exam-header"],[1,"summary-card"],[1,"sections"],[4,"ngFor","ngForOf"],["class","question",4,"ngFor","ngForOf"],[1,"question"],[2,"color","red"],["class","answers",4,"ngIf"],[2,"color","green"],["controls",""],["type","audio/mpeg",3,"src"],[1,"answers"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["type","radio","disabled","",3,"checked"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"button",1),H("click",function(){return r.goBack()}),f(2,"Quay l\u1EA1i"),u(),G(3,K9,4,0,"div",2)(4,Z9,5,1,"div",3)(5,cV,27,8,"ng-container",4),u()),t&2&&(m(3),O("ngIf",r.loading),m(),O("ngIf",r.error),m(),O("ngIf",!r.loading&&r.examResult))},dependencies:[Ue,hr,lt,We,He],styles:['@charset "UTF-8";*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;background-color:#f8f9fa;color:#333}.container[_ngcontent-%COMP%]{max-width:1100px;margin:30px auto;padding:20px;background-color:#fff;border-radius:10px;box-shadow:0 4px 10px #0000001a}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;color:#555}.spinner[_ngcontent-%COMP%]{margin:20px auto;width:60px;height:60px;border:6px solid #f0f0f0;border-top:6px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1.5s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]{text-align:center;color:#e74c3c;font-size:18px}.error-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:12px 25px;border-radius:5px;font-size:16px;cursor:pointer;border:none}.error-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.exam-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.exam-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;color:#333;font-weight:700}.exam-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#555}button.go-back[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:12px 20px;border-radius:5px;font-size:16px;cursor:pointer;border:none;position:absolute;top:20px;left:20px;box-shadow:0 2px 5px #0000001a}button.go-back[_ngcontent-%COMP%]:hover{background-color:#2980b9}button.go-back[_ngcontent-%COMP%]:focus{outline:none}.summary-card[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 6px #0000001a;margin-bottom:30px;border:2px solid #3498db}.summary-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;color:#3498db;margin-bottom:20px}.summary-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#555}.sections[_ngcontent-%COMP%]{margin-top:30px}.sections[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:26px;color:#333;margin-bottom:20px}h5[_ngcontent-%COMP%]{font-size:20px;color:#3498db;margin-bottom:20px}.question[_ngcontent-%COMP%]{background-color:#f9f9f9;padding:20px;margin-bottom:20px;border-radius:8px;box-shadow:0 2px 5px #0000000d}.question[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#333;margin-bottom:15px}.answers[_ngcontent-%COMP%]{margin-top:10px}.answers[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;color:#555;display:block;margin:5px 0;cursor:pointer}.answers[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:10px}.answers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#048eb4;font-weight:700}.correct[_ngcontent-%COMP%]{color:#12bcda}.incorrect[_ngcontent-%COMP%]{color:#e74c3c}.user-selected[_ngcontent-%COMP%]{background-color:#eafaf1;border-radius:5px;padding:5px}.correct-answer[_ngcontent-%COMP%]{background-color:#d5f5e3;border-radius:5px;padding:5px}']})};var uV=(e,n,t,r)=>({correct:e,incorrect:n,"user-selected":t,"correct-answer":r});function lV(e,n){e&1&&(l(0,"div",5),N(1,"div",6),l(2,"p"),f(3,"\u0110ang t\u1EA3i k\u1EBFt qu\u1EA3 b\xE0i thi..."),u()())}function dV(e,n){if(e&1){let t=ve();l(0,"div",7)(1,"p"),f(2),u(),l(3,"button",8),H("click",function(){U(t);let i=D();return j(i.goBack())}),f(4,"Quay l\u1EA1i"),u()()}if(e&2){let t=D();m(2),ae(t.error)}}function fV(e,n){if(e&1&&(cn(0),f(1),un()),e&2){let t=D().$implicit;m(),te(" ",(t==null||t.questionId==null?null:t.questionId.text)||"N\u1ED9i dung c\xE2u h\u1ECFi kh\xF4ng kh\u1EA3 d\u1EE5ng"," ")}}function hV(e,n){if(e&1&&(cn(0),l(1,"audio",18),N(2,"source",19),f(3," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u(),un()),e&2){let t=D().$implicit;m(2),O("src",t==null||t.questionId==null?null:t.questionId.text,Qt)}}function pV(e,n){if(e&1&&(l(0,"div",22)(1,"label"),N(2,"input",23),f(3),u()()),e&2){let t=n.$implicit,r=D(2).$implicit;O("ngClass",l0(3,uV,t.isCorrect&&t.text===r.userAnswer,!t.isCorrect&&t.text===r.userAnswer,t.text===r.userAnswer,t.isCorrect&&t.text!==r.userAnswer)),m(2),O("checked",t.text===r.userAnswer),m(),te(" ",t.text," ")}}function mV(e,n){if(e&1&&(l(0,"div",20),G(1,pV,4,8,"div",21),u()),e&2){let t=D().$implicit;m(),O("ngForOf",t.questionId.answers)}}function gV(e,n){if(e&1&&(l(0,"span"),f(1),u()),e&2){let t=D().$implicit;m(),ae(t.userAnswer)}}function xV(e,n){e&1&&(l(0,"span"),f(1,"Ch\u01B0a tr\u1EA3 l\u1EDDi"),u())}function EV(e,n){if(e&1&&(l(0,"span"),f(1),u()),e&2){let t=D().$implicit,r=D(3);m(),ae(r.getCorrectAnswer(t))}}function vV(e,n){if(e&1&&(l(0,"div",14)(1,"p")(2,"strong"),f(3),u(),G(4,fV,2,1,"ng-container",4),u(),G(5,hV,4,1,"ng-container",4),l(6,"p",15)(7,"strong"),f(8,"\u0110i\u1EC3m:"),u(),f(9),u(),G(10,mV,2,1,"div",16),l(11,"p",17)(12,"strong"),f(13,"\u0110\xE1p \xE1n c\u1EE7a b\u1EA1n: "),u(),G(14,gV,2,1,"span",4)(15,xV,2,0,"span",4),u(),l(16,"p"),N(17,"strong"),G(18,EV,2,1,"span",4),u()()),e&2){let t=n.$implicit,r=D().$implicit,i=D(2);m(3),te("C\xE2u h\u1ECFi ",r.questions.indexOf(t)+1,":"),m(),O("ngIf",!(!(t==null||t.questionId==null||t.questionId.text==null)&&t.questionId.text.startsWith("http"))),m(),O("ngIf",t==null||t.questionId==null||t.questionId.text==null?null:t.questionId.text.startsWith("http")),m(4),te(" ",t.score," \u0111i\u1EC3m"),m(),O("ngIf",t&&t.questionId&&t.questionId.answers&&t.questionId.answers.length>0),m(4),O("ngIf",t.userAnswer),m(),O("ngIf",!t.userAnswer),m(3),O("ngIf",i.hasCorrectAnswer(t))}}function _V(e,n){if(e&1&&(l(0,"div")(1,"h5"),f(2),u(),G(3,vV,19,8,"div",13),u()),e&2){let t=n.$implicit;m(2),te("M\xF4 t\u1EA3: ",t.title,""),m(),O("ngForOf",t.questions)}}function CV(e,n){if(e&1&&(cn(0),l(1,"div",9)(2,"h1"),f(3),u(),l(4,"p")(5,"b"),f(6,"M\xF4 t\u1EA3: "),u(),f(7),u(),l(8,"p")(9,"b"),f(10,"H\u1ECDc vi\xEAn: "),u(),f(11),u()(),l(12,"div",10)(13,"h2"),f(14,"K\u1EBFt qu\u1EA3 t\u1ED5ng quan"),u(),l(15,"p"),f(16),u(),l(17,"p"),f(18),u(),l(19,"p"),f(20),u(),l(21,"p"),f(22),u()(),l(23,"div",11)(24,"h2"),f(25,"C\xE1c ph\u1EA7n thi"),u(),G(26,_V,4,2,"div",12),u(),un()),e&2){let t=D();m(3),ae(t.examResult.examId.name),m(4),ae(t.examResult.examId.description),m(4),ae(t.user==null?null:t.user.username),m(5),te("T\u1ED5ng s\u1ED1 c\xE2u h\u1ECFi: ",t.getTotalQuestions(),""),m(2),te("S\u1ED1 \u0111i\u1EC3m: ",t.examResult.score,"/10"),m(2),te("Th\u1EDDi gian b\u1EAFt \u0111\u1EA7u: ",t.formatDate(t.examResult.startTime),""),m(2),te("Th\u1EDDi gian k\u1EBFt th\xFAc: ",t.formatDate(t.examResult.endTime),""),m(4),O("ngForOf",t.examResult.examId.sections)}}var df=class e{constructor(n,t,r,i){this.route=n;this.examService=t;this.authService=r;this.router=i}loading=!0;error=null;examResult=null;examId=null;userId=null;user=null;ngOnInit(){let n=this.route.snapshot.paramMap.get("examId"),t=this.route.snapshot.paramMap.get("userId");n&&(this.examId=n),t&&(this.userId=t),this.userId&&this.authService.getUserById(this.userId).subscribe({next:r=>{this.user=r,this.loadExamResult()},error:r=>{console.error("Error fetching user details:",r),this.error="Kh\xF4ng th\u1EC3 t\u1EA3i th\xF4ng tin ng\u01B0\u1EDDi d\xF9ng",this.loading=!1}})}loadExamResult(){if(!this.examId||!this.userId){this.error="Kh\xF4ng t\xECm th\u1EA5y th\xF4ng tin b\xE0i thi ho\u1EB7c ng\u01B0\u1EDDi d\xF9ng",this.loading=!1;return}console.log("Loading exam result for userId:",this.userId),this.examService.getExamHistory(this.userId).subscribe({next:n=>{console.log("Fetched Exam History:",n);let t=n.find(r=>r._id===this.examId||r.examId===this.examId||r.examId?._id===this.examId);t?typeof t.examId=="string"?this.examService.getExamDetails(t.examId).subscribe({next:r=>{t.examId=r,this.mapUserAnswers(t)},error:r=>{console.error("Error fetching exam details:",r),this.error="Kh\xF4ng th\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u chi ti\u1EBFt b\xE0i thi"}}):t.examId.sections?this.mapUserAnswers(t):this.error="Kh\xF4ng t\xECm th\u1EA5y danh s\xE1ch c\xE2u h\u1ECFi trong b\xE0i thi":this.error="Kh\xF4ng t\xECm th\u1EA5y d\u1EEF li\u1EC7u b\xE0i thi",this.loading=!1},error:n=>{console.error("Error loading exam result:",n),this.error="Kh\xF4ng th\u1EC3 t\u1EA3i d\u1EEF li\u1EC7u b\xE0i thi",this.loading=!1}})}mapUserAnswers(n){let t=0,r=0;n.examId.sections.forEach(i=>{i.questions.forEach(o=>{let s=n.answers.find(a=>a.questionId===o._id);o.userAnswer=s?.answer||null,s?.answer===this.getCorrectAnswer(o)&&t++,r++})}),n.correctAnswers=t,n.totalQuestions=r,this.examResult=n,console.log("Processed Exam Result:",this.examResult)}formatDate(n){return new Date(n).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}goBack(){window.history.back()}getCorrectAnswer(n){if(n&&Array.isArray(n.answers)){let t=n.answers.find(r=>r.isCorrect);return t?t.text:"Kh\xF4ng c\xF3 \u0111\xE1p \xE1n \u0111\xFAng"}return"Kh\xF4ng c\xF3 \u0111\xE1p \xE1n \u0111\xFAng"}hasCorrectAnswer(n){return n.answers&&Array.isArray(n.answers)&&n.answers.some(t=>t.isCorrect)}isArray(n){return Array.isArray(n)}getTotalQuestions(){return this.examResult?.examId?.sections?this.examResult.examId.sections.reduce((n,t)=>n+(t.questions?.length||0),0):0}static \u0275fac=function(t){return new(t||e)(Q(dn),Q(It),Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-student-result-detail"]],standalone:!0,features:[Me],decls:6,vars:3,consts:[[1,"container"],[1,"go-back",3,"click"],["class","loading-state",4,"ngIf"],["class","error-state",4,"ngIf"],[4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"error-state"],[3,"click"],[1,"exam-header"],[1,"summary-card"],[1,"sections"],[4,"ngFor","ngForOf"],["class","question",4,"ngFor","ngForOf"],[1,"question"],[2,"color","red"],["class","answers",4,"ngIf"],[2,"color","green"],["controls",""],["type","audio/mpeg",3,"src"],[1,"answers"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"ngClass"],["type","radio","disabled","",3,"checked"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"button",1),H("click",function(){return r.goBack()}),f(2,"Quay l\u1EA1i"),u(),G(3,lV,4,0,"div",2)(4,dV,5,1,"div",3)(5,CV,27,8,"ng-container",4),u()),t&2&&(m(3),O("ngIf",r.loading),m(),O("ngIf",r.error),m(),O("ngIf",!r.loading&&r.examResult))},dependencies:[Ue,hr,lt,We,He],styles:['@charset "UTF-8";*[_ngcontent-%COMP%]{margin:0;padding:0;box-sizing:border-box}body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;background-color:#f8f9fa;color:#333}.container[_ngcontent-%COMP%]{max-width:1100px;margin:30px auto;padding:20px;background-color:#fff;border-radius:10px;box-shadow:0 4px 10px #0000001a}.loading-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;color:#555}.spinner[_ngcontent-%COMP%]{margin:20px auto;width:60px;height:60px;border:6px solid #f0f0f0;border-top:6px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1.5s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.error-state[_ngcontent-%COMP%]{text-align:center;color:#e74c3c;font-size:18px}.error-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:12px 25px;border-radius:5px;font-size:16px;cursor:pointer;border:none}.error-state[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.exam-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.exam-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px;color:#333;font-weight:700}.exam-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#555}button.go-back[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:12px 20px;border-radius:5px;font-size:16px;cursor:pointer;border:none;position:absolute;top:20px;left:20px;box-shadow:0 2px 5px #0000001a}button.go-back[_ngcontent-%COMP%]:hover{background-color:#2980b9}button.go-back[_ngcontent-%COMP%]:focus{outline:none}.summary-card[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:8px;box-shadow:0 2px 6px #0000001a;margin-bottom:30px;border:2px solid #3498db}.summary-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:24px;color:#3498db;margin-bottom:20px}.summary-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:16px;color:#555}.sections[_ngcontent-%COMP%]{margin-top:30px}.sections[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:26px;color:#333;margin-bottom:20px}h5[_ngcontent-%COMP%]{font-size:20px;color:#3498db;margin-bottom:20px}.question[_ngcontent-%COMP%]{background-color:#f9f9f9;padding:20px;margin-bottom:20px;border-radius:8px;box-shadow:0 2px 5px #0000000d}.question[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:18px;color:#333;margin-bottom:15px}.answers[_ngcontent-%COMP%]{margin-top:10px}.answers[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:16px;color:#555;display:block;margin:5px 0;cursor:pointer}.answers[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{margin-right:10px}.answers[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#048eb4;font-weight:700}.correct[_ngcontent-%COMP%]{color:#12bcda}.incorrect[_ngcontent-%COMP%]{color:#e74c3c}.user-selected[_ngcontent-%COMP%]{background-color:#eafaf1;border-radius:5px;padding:5px}.correct-answer[_ngcontent-%COMP%]{background-color:#d5f5e3;border-radius:5px;padding:5px}']})};function yV(e,n){if(e&1){let t=ve();l(0,"div",22)(1,"button",23),H("click",function(){let i=U(t).$implicit,o=D();return j(o.onMenuItemClick(i.route))}),f(2),u()()}if(e&2){let t=n.$implicit;m(2),te(" ",t.label," ")}}var ff=class e{constructor(n,t){this.router=n;this.authService=t}isDropdownActive=!1;user=null;menuItems=[{label:"Qu\u1EA3n l\xFD ng\u01B0\u1EDDi d\xF9ng",route:"/admin-user"},{label:"Qu\u1EA3n l\xFD ng\xE2n h\xE0ng c\xE2u h\u1ECFi",route:"/admin-question"},{label:"Qu\u1EA3n l\xFD b\xE0i thi",route:"/admin-exam"}];ngOnInit(){let n=this.authService.getCurrentUser();n?n.role!=="admin"?this.router.navigate(["/unauthorized"]):console.log("Admin Dashboard \u0111\xE3 \u0111\u01B0\u1EE3c kh\u1EDFi t\u1EA1o"):this.router.navigate(["/login"])}onMenuItemClick(n){this.router.navigate([n])}logout(){this.authService.logout().subscribe({next:()=>{window.location.href="/login"},error:n=>{console.error("Logout error:",n)}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}static \u0275fac=function(t){return new(t||e)(Q(Re),Q(ze))};static \u0275cmp=Se({type:e,selectors:[["app-admin-dashboard"]],standalone:!0,features:[Me],decls:31,vars:5,consts:[[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"user-menu"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","#"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"nav-links"],[1,"admin-dashboard"],[1,"dashboard-menu"],["class","menu-item",4,"ngFor","ngForOf"],[1,"menu-item"],[1,"menu-button",3,"click"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1),N(2,"img",2),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",3)(6,"img",4),H("click",function(){return r.toggleDropdown()}),u(),l(7,"div",5)(8,"div",6),N(9,"img",7),l(10,"div",8)(11,"div",9),f(12),u(),l(13,"div",10),f(14),u()()(),l(15,"div",11)(16,"a",12),N(17,"i",13),f(18," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(19,"a",14),N(20,"i",15),f(21," C\xE0i \u0111\u1EB7t chung"),u(),l(22,"a",16),H("click",function(){return r.logout()}),N(23,"i",17),f(24," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(25,"div",18)(26,"h1"),f(27,"Ch\xE0o m\u1EEBng \u0111\u1EBFn v\u1EDBi Admin Dashboard"),u()(),l(28,"div",19)(29,"div",20),G(30,yV,3,1,"div",21),u()()),t&2&&(m(7),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(16),O("ngForOf",r.menuItems))},dependencies:[Ue,lt],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:12px;color:#000}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:10px 15px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.admin-dashboard[_ngcontent-%COMP%]{text-align:center;padding:20px}.admin-dashboard[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2em;margin-bottom:20px}.admin-dashboard[_ngcontent-%COMP%]   .dashboard-menu[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:20px;margin-top:30px}.admin-dashboard[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{flex:1;text-align:center}.admin-dashboard[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]{padding:35px;font-size:1.2em;width:100%;cursor:pointer;background-color:#4caf50;color:#fff;border:none;border-radius:5px;transition:background-color .3s ease}.admin-dashboard[_ngcontent-%COMP%]   .menu-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.nav-links[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100px;background-color:#f9f9f9;border-bottom:2px solid #e0e0e0}.nav-links[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5em;color:#333;font-weight:600;margin:0;text-align:center;letter-spacing:1px;text-transform:uppercase;padding:10px 0}']})};var hf=class e{constructor(n){this.http=n}apiUrl="http://localhost:3000";getUsers(){let n=localStorage.getItem("auth_token"),t=new Bt({Authorization:`Bearer ${n}`});return this.http.get(`${this.apiUrl}/users`,{headers:t})}updateUserRole(n,t){let r=localStorage.getItem("auth_token"),i=new Bt({Authorization:`Bearer ${r}`});return this.http.put(`${this.apiUrl}/users/${n}/role`,{role:t},{headers:i})}deleteUser(n){let t=localStorage.getItem("auth_token"),r=new Bt({Authorization:`Bearer ${t}`});return this.http.delete(`${this.apiUrl}/users/${n}`,{headers:r})}createUser(n){let t=localStorage.getItem("auth_token"),r=new Bt({Authorization:`Bearer ${t}`});return this.http.post(`${this.apiUrl}/users`,n,{headers:r})}updateUser(n){let t=localStorage.getItem("auth_token"),r=new Bt({Authorization:`Bearer ${t}`});return this.http.put(`${this.apiUrl}/users/${n._id}`,n,{headers:r})}static \u0275fac=function(t){return new(t||e)(ke(Ki))};static \u0275prov=Ae({token:e,factory:e.\u0275fac,providedIn:"root"})};function bV(e,n){if(e&1){let t=ve();l(0,"div",5)(1,"h2"),f(2,"T\u1EA1o t\xE0i kho\u1EA3n m\u1EDBi"),u(),l(3,"form",6),H("ngSubmit",function(){U(t);let i=D();return j(i.createAccount())}),l(4,"label",7),f(5,"T\xEAn ng\u01B0\u1EDDi d\xF9ng"),u(),l(6,"input",8),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.username,i)||(o.newUser.username=i),j(i)}),u(),l(7,"label",9),f(8,"Email"),u(),l(9,"input",10),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.email,i)||(o.newUser.email=i),j(i)}),u(),l(10,"label",11),f(11,"M\u1EADt kh\u1EA9u"),u(),l(12,"input",12),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.password,i)||(o.newUser.password=i),j(i)}),u(),l(13,"label",13),f(14,"Vai tr\xF2"),u(),l(15,"select",14),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.role,i)||(o.newUser.role=i),j(i)}),l(16,"option",15),f(17,"Admin"),u(),l(18,"option",16),f(19,"Teacher"),u(),l(20,"option",17),f(21,"Student"),u()(),l(22,"label",18),f(23,"Ng\xE0y sinh"),u(),l(24,"input",19),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.dateOfBirth,i)||(o.newUser.dateOfBirth=i),j(i)}),u(),l(25,"label",20),f(26,"Gi\u1EDBi t\xEDnh"),u(),l(27,"select",21),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.gender,i)||(o.newUser.gender=i),j(i)}),l(28,"option",22),f(29,"Nam"),u(),l(30,"option",23),f(31,"N\u1EEF"),u(),l(32,"option",24),f(33,"Kh\xE1c"),u()(),l(34,"label",25),f(35,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),u(),l(36,"input",26),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.newUser.phoneNumber,i)||(o.newUser.phoneNumber=i),j(i)}),u(),l(37,"button",27),f(38,"T\u1EA1o t\xE0i kho\u1EA3n"),u()()()}if(e&2){let t=D();m(6),me("ngModel",t.newUser.username),m(3),me("ngModel",t.newUser.email),m(3),me("ngModel",t.newUser.password),m(3),me("ngModel",t.newUser.role),m(9),me("ngModel",t.newUser.dateOfBirth),m(3),me("ngModel",t.newUser.gender),m(9),me("ngModel",t.newUser.phoneNumber)}}function DV(e,n){if(e&1){let t=ve();l(0,"input",8),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.userToEdit.username,i)||(o.userToEdit.username=i),j(i)}),u()}if(e&2){let t=D(2);me("ngModel",t.userToEdit.username)}}function SV(e,n){if(e&1){let t=ve();l(0,"input",10),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.userToEdit.email,i)||(o.userToEdit.email=i),j(i)}),u()}if(e&2){let t=D(2);me("ngModel",t.userToEdit.email)}}function MV(e,n){if(e&1){let t=ve();l(0,"select",14),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.userToEdit.role,i)||(o.userToEdit.role=i),j(i)}),l(1,"option",15),f(2,"Admin"),u(),l(3,"option",16),f(4,"Teacher"),u(),l(5,"option",17),f(6,"Student"),u()()}if(e&2){let t=D(2);me("ngModel",t.userToEdit.role)}}function AV(e,n){if(e&1){let t=ve();l(0,"input",19),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.userToEdit.dateOfBirth,i)||(o.userToEdit.dateOfBirth=i),j(i)}),u()}if(e&2){let t=D(2);me("ngModel",t.userToEdit.dateOfBirth)}}function TV(e,n){if(e&1){let t=ve();l(0,"select",21),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.userToEdit.gender,i)||(o.userToEdit.gender=i),j(i)}),l(1,"option",22),f(2,"Nam"),u(),l(3,"option",23),f(4,"N\u1EEF"),u(),l(5,"option",24),f(6,"Kh\xE1c"),u()()}if(e&2){let t=D(2);me("ngModel",t.userToEdit.gender)}}function OV(e,n){if(e&1){let t=ve();l(0,"input",26),ge("ngModelChange",function(i){U(t);let o=D(2);return xe(o.userToEdit.phoneNumber,i)||(o.userToEdit.phoneNumber=i),j(i)}),u()}if(e&2){let t=D(2);me("ngModel",t.userToEdit.phoneNumber)}}function IV(e,n){if(e&1){let t=ve();l(0,"div",5)(1,"h2"),f(2,"Ch\u1EC9nh s\u1EEDa t\xE0i kho\u1EA3n"),u(),l(3,"form",6),H("ngSubmit",function(){U(t);let i=D();return j(i.updateUser())}),l(4,"label",7),f(5,"T\xEAn ng\u01B0\u1EDDi d\xF9ng"),u(),G(6,DV,1,1,"input",28),l(7,"label",9),f(8,"Email"),u(),G(9,SV,1,1,"input",29),l(10,"label",13),f(11,"Vai tr\xF2"),u(),G(12,MV,7,1,"select",30),l(13,"label",18),f(14,"Ng\xE0y sinh"),u(),G(15,AV,1,1,"input",31),l(16,"label",20),f(17,"Gi\u1EDBi t\xEDnh"),u(),G(18,TV,7,1,"select",32),l(19,"label",25),f(20,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),u(),G(21,OV,1,1,"input",33),l(22,"button",27),f(23,"C\u1EADp nh\u1EADt t\xE0i kho\u1EA3n"),u()()()}if(e&2){let t=D();m(6),O("ngIf",t.userToEdit),m(3),O("ngIf",t.userToEdit),m(3),O("ngIf",t.userToEdit),m(3),O("ngIf",t.userToEdit),m(3),O("ngIf",t.userToEdit),m(3),O("ngIf",t.userToEdit)}}function kV(e,n){if(e&1){let t=ve();l(0,"tr")(1,"td"),f(2),u(),l(3,"td"),f(4),u(),l(5,"td"),f(6),u(),l(7,"td"),f(8),zt(9,"date"),u(),l(10,"td"),f(11),zt(12,"date"),u(),l(13,"td"),f(14),u(),l(15,"td"),f(16),u(),l(17,"td")(18,"button",34),H("click",function(){let i=U(t).$implicit,o=D();return j(o.toggleEditUser(i))}),f(19,"Ch\u1EC9nh s\u1EEDa"),u(),l(20,"button",34),H("click",function(){let i=U(t).$implicit,o=D();return j(o.updateUserRole(i,"admin"))}),f(21,"Set Admin"),u(),l(22,"button",34),H("click",function(){let i=U(t).$implicit,o=D();return j(o.updateUserRole(i,"teacher"))}),f(23,"Set Teacher"),u(),l(24,"button",34),H("click",function(){let i=U(t).$implicit,o=D();return j(o.updateUserRole(i,"student"))}),f(25,"Set Student"),u(),l(26,"button",34),H("click",function(){let i=U(t).$implicit,o=D();return j(o.deleteUser(i))}),f(27,"X\xF3a"),u()()()}if(e&2){let t=n.$implicit;m(2),ae(t.username),m(2),ae(t.email),m(2),ae(t.role),m(2),ae(So(9,7,t.createdAt,"dd/MM/yyyy")),m(3),ae(So(12,10,t.dateOfBirth,"dd/MM/yyyy")),m(3),ae(t.gender),m(2),ae(t.phoneNumber)}}var pf=class e{constructor(n,t,r){this.authService=n;this.userService=t;this.router=r}user=null;users=[];isDropdownActive=!1;isCreateAccountVisible=!1;isEditUserVisible=!1;userToEdit={};newUser={username:"",email:"",password:"",role:"student",dateOfBirth:"",gender:"male",phoneNumber:""};ngOnInit(){this.user=this.authService.getCurrentUser(),this.user.role!=="admin"?this.router.navigate(["/unauthorized"]):this.loadUsers()}goBack(){this.router.navigate(["/admin-dashboard"])}loadUsers(){this.userService.getUsers().subscribe({next:n=>{this.users=n},error:n=>{n.status===403?(console.error("B\u1EA1n kh\xF4ng c\xF3 quy\u1EC1n truy c\u1EADp:",n.error.message),alert("Vui l\xF2ng \u0111\u0103ng nh\u1EADp l\u1EA1i!"),this.router.navigate(["/login"])):console.error("L\u1ED7i t\u1EA3i danh s\xE1ch ng\u01B0\u1EDDi d\xF9ng:",n)}})}createAccount(){this.userService.createUser(this.newUser).subscribe({next:n=>{alert("T\u1EA1o t\xE0i kho\u1EA3n th\xE0nh c\xF4ng!"),this.loadUsers(),this.resetForm(),this.isCreateAccountVisible=!1},error:n=>{console.error("L\u1ED7i t\u1EA1o t\xE0i kho\u1EA3n:",n),alert("\u0110\xE3 x\u1EA3y ra l\u1ED7i khi t\u1EA1o t\xE0i kho\u1EA3n.")}})}resetForm(){this.newUser={username:"",email:"",password:"",role:"student",dateOfBirth:"",gender:"male",phoneNumber:""}}toggleCreateAccount(){this.isCreateAccountVisible=!this.isCreateAccountVisible}toggleEditUser(n){this.isEditUserVisible=!this.isEditUserVisible,this.isEditUserVisible?(this.userToEdit=de({},n),console.log("Editing user:",this.userToEdit)):this.userToEdit=null}updateUser(){console.log("Updating user:",this.userToEdit),this.userToEdit&&this.userService.updateUser(this.userToEdit).subscribe({next:()=>{alert("C\u1EADp nh\u1EADt t\xE0i kho\u1EA3n th\xE0nh c\xF4ng!"),this.loadUsers(),this.isEditUserVisible=!1},error:n=>{console.error("L\u1ED7i c\u1EADp nh\u1EADt t\xE0i kho\u1EA3n:",n),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi c\u1EADp nh\u1EADt t\xE0i kho\u1EA3n.")}})}updateUserRole(n,t){this.userService.updateUserRole(n._id,t).subscribe({next:()=>{alert(`\u0110\xE3 c\u1EADp nh\u1EADt vai tr\xF2 c\u1EE7a ${n.username} th\xE0nh ${t}`),this.loadUsers()},error:r=>{console.error("L\u1ED7i c\u1EADp nh\u1EADt vai tr\xF2:",r)}})}deleteUser(n){confirm(`B\u1EA1n c\xF3 ch\u1EAFc mu\u1ED1n x\xF3a ng\u01B0\u1EDDi d\xF9ng ${n.username}?`)&&this.userService.deleteUser(n._id).subscribe({next:()=>{alert(`\u0110\xE3 x\xF3a ng\u01B0\u1EDDi d\xF9ng ${n.username}`),this.loadUsers()},error:t=>{console.error("L\u1ED7i x\xF3a ng\u01B0\u1EDDi d\xF9ng:",t)}})}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(hf),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-admin-user"]],standalone:!0,features:[Me],decls:30,vars:3,consts:[[1,"go-back-button",3,"click"],[1,"nav-links"],[1,"create-account-button",3,"click"],["class","create-account",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"create-account"],[3,"ngSubmit"],["for","username"],["type","text","id","username","name","username","required","",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email","required","",3,"ngModelChange","ngModel"],["for","password"],["type","password","id","password","name","password","required","",3,"ngModelChange","ngModel"],["for","role"],["id","role","name","role","required","",3,"ngModelChange","ngModel"],["value","admin"],["value","teacher"],["value","student"],["for","dateOfBirth"],["type","date","id","dateOfBirth","name","dateOfBirth","required","",3,"ngModelChange","ngModel"],["for","gender"],["id","gender","name","gender","required","",3,"ngModelChange","ngModel"],["value","male"],["value","female"],["value","other"],["for","phoneNumber"],["type","text","id","phoneNumber","name","phoneNumber","required","",3,"ngModelChange","ngModel"],["type","submit"],["type","text","id","username","name","username","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","email","id","email","name","email","required","",3,"ngModel","ngModelChange",4,"ngIf"],["id","role","name","role","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","date","id","dateOfBirth","name","dateOfBirth","required","",3,"ngModel","ngModelChange",4,"ngIf"],["id","gender","name","gender","required","",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","id","phoneNumber","name","phoneNumber","required","",3,"ngModel","ngModelChange",4,"ngIf"],[3,"click"]],template:function(t,r){t&1&&(l(0,"button",0),H("click",function(){return r.goBack()}),f(1,"Quay l\u1EA1i Dashboard"),u(),l(2,"div",1)(3,"h1"),f(4,"Qu\u1EA3n l\xFD ng\u01B0\u1EDDi d\xF9ng"),u()(),l(5,"button",2),H("click",function(){return r.toggleCreateAccount()}),f(6,"T\u1EA1o t\xE0i kho\u1EA3n m\u1EDBi"),u(),G(7,bV,39,7,"div",3)(8,IV,24,6,"div",3),l(9,"table")(10,"thead")(11,"tr")(12,"th"),f(13,"T\xEAn ng\u01B0\u1EDDi d\xF9ng"),u(),l(14,"th"),f(15,"Email"),u(),l(16,"th"),f(17,"Vai tr\xF2"),u(),l(18,"th"),f(19,"Ng\xE0y t\u1EA1o"),u(),l(20,"th"),f(21,"Ng\xE0y sinh"),u(),l(22,"th"),f(23,"Gi\u1EDBi t\xEDnh"),u(),l(24,"th"),f(25,"S\u1ED1 \u0111i\u1EC7n tho\u1EA1i"),u(),l(26,"th"),f(27,"H\xE0nh \u0111\u1ED9ng"),u()()(),l(28,"tbody"),G(29,kV,28,13,"tr",4),u()()),t&2&&(m(7),O("ngIf",r.isCreateAccountVisible),m(),O("ngIf",r.isEditUserVisible),m(21),O("ngForOf",r.users))},dependencies:[Ue,lt,We,pr,He,Mn,gr,xr,jt,jn,Ot,Sn,_n,Vt,Pn],styles:['@charset "UTF-8";table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-top:20px;box-shadow:0 4px 8px #0000001a}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px 15px;text-align:left;font-size:16px}th[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff}td[_ngcontent-%COMP%]{background-color:#f9f9f9}tr[_ngcontent-%COMP%]:nth-child(2n)   td[_ngcontent-%COMP%]{background-color:#f1f1f1}tr[_ngcontent-%COMP%]:hover{background-color:#e2f7e2}button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;border:none;padding:8px 16px;cursor:pointer;border-radius:4px;font-size:14px;transition:background-color .3s;margin-right:8px;display:inline-block}button[_ngcontent-%COMP%]:hover{background-color:#45a049}button[_ngcontent-%COMP%]:focus{outline:none}button.delete[_ngcontent-%COMP%]{background-color:#f44336}button.delete[_ngcontent-%COMP%]:hover{background-color:#e53935}@media (max-width: 768px){table[_ngcontent-%COMP%]{width:100%;font-size:14px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:10px}button[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}}.go-back-button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;border:none;cursor:pointer;border-radius:4px;font-size:16px;margin-top:20px;transition:background-color .3s;display:inline-block}.go-back-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.go-back-button[_ngcontent-%COMP%]:focus{outline:none}.nav-links[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100px;background-color:#f9f9f9;border-bottom:2px solid #e0e0e0}.nav-links[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5em;color:#333;font-weight:600;margin:0;text-align:center;letter-spacing:1px;text-transform:uppercase;padding:10px 0}.create-account-button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;border:none;cursor:pointer;border-radius:4px;font-size:16px;margin-top:20px;transition:background-color .3s;display:inline-block}.create-account-button[_ngcontent-%COMP%]:hover{background-color:#45a049}.create-account-button[_ngcontent-%COMP%]:focus{outline:none}.create-account[_ngcontent-%COMP%]{margin-top:30px;background-color:#f9f9f9;padding:20px;border-radius:4px;box-shadow:0 4px 8px #0000001a}.create-account[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8em;color:#333;margin-bottom:20px}.create-account[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:700}.create-account[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .create-account[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;margin-bottom:20px;border:1px solid #ccc;border-radius:4px;font-size:16px}.create-account[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;border:none;cursor:pointer;border-radius:4px;font-size:16px;transition:background-color .3s;width:100%;margin-top:10px}.create-account[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#45a049}.create-account[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:focus{outline:none}.create-account[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .create-account[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:12px;margin-bottom:12px}']})};var t2=(e,n)=>({"fa-chevron-down":e,"fa-chevron-up":n}),n2=(e,n)=>({"correct-answer":e,"incorrect-answer":n});function PV(e,n){if(e&1&&(l(0,"option",47),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function FV(e,n){if(e&1&&(l(0,"option",47),f(1),u()),e&2){let t=n.$implicit;O("value",t),m(),ae(t)}}function NV(e,n){if(e&1){let t=ve();l(0,"div",40)(1,"div",41)(2,"label"),f(3,"Danh m\u1EE5c:"),u(),l(4,"select",42),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.selectedCategory,i)||(o.selectedCategory=i),j(i)}),l(5,"option",43),f(6,"T\u1EA5t c\u1EA3"),u(),G(7,PV,2,2,"option",44),u()(),l(8,"div",41)(9,"label"),f(10,"Nh\xF3m:"),u(),l(11,"select",42),ge("ngModelChange",function(i){U(t);let o=D();return xe(o.selectedGroup,i)||(o.selectedGroup=i),j(i)}),l(12,"option",43),f(13,"T\u1EA5t c\u1EA3"),u(),G(14,FV,2,2,"option",44),u()(),l(15,"div",45)(16,"button",46),H("click",function(){U(t);let i=D();return j(i.clearFilters())}),f(17,"X\xF3a b\u1ED9 l\u1ECDc"),u(),l(18,"button",46),H("click",function(){U(t);let i=D();return j(i.filterQuestions())}),f(19,"\xC1p d\u1EE5ng"),u()()()}if(e&2){let t=D();m(4),me("ngModel",t.selectedCategory),m(3),O("ngForOf",t.uniqueCategories),m(4),me("ngModel",t.selectedGroup),m(3),O("ngForOf",t.uniqueGroups)}}function RV(e,n){if(e&1&&(l(0,"div")(1,"p"),f(2,"Listen and choose the correct answer: "),u(),l(3,"audio",64),N(4,"source",65),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(4),O("src",t.text,Qt)}}function BV(e,n){if(e&1&&(l(0,"div")(1,"div",66),f(2),u()()),e&2){let t=D().$implicit;m(2),ae(t.text)}}function LV(e,n){if(e&1&&(l(0,"li")(1,"span",69),f(2),u()()),e&2){let t=n.$implicit;m(),O("ngClass",Do(2,n2,t.isCorrect,!t.isCorrect)),m(),ae(t.text)}}function VV(e,n){if(e&1&&(l(0,"div",67)(1,"p")(2,"strong"),f(3,"C\xE2u tr\u1EA3 l\u1EDDi:"),u()(),l(4,"ul"),G(5,LV,3,5,"li",68),u()()),e&2){let t=D().$implicit;m(5),O("ngForOf",t.answers)}}function UV(e,n){if(e&1&&(l(0,"span",70),N(1,"i",71),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.category," ")}}function jV(e,n){if(e&1&&(l(0,"span",72),N(1,"i",73),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.group," ")}}function HV(e,n){if(e&1){let t=ve();l(0,"div",49)(1,"div",50)(2,"div",51)(3,"strong"),f(4),u()(),G(5,RV,6,1,"div",37)(6,BV,3,1,"div",37)(7,VV,6,1,"div",52),l(8,"div",53),G(9,UV,3,1,"span",54)(10,jV,3,1,"span",55),l(11,"span",56),N(12,"i",57),f(13),u()()(),l(14,"div",58)(15,"button",59),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.approveQuestion(i))}),f(16,"Duy\u1EC7t"),u(),l(17,"button",60),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.editQuestion(i))}),N(18,"i",61),u(),l(19,"button",62),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.deleteQuestion(i))}),N(20,"i",63),u()()()}if(e&2){let t=n.$implicit,r=n.index,i=D(2);m(4),te("C\xE2u h\u1ECFi s\u1ED1 ",r+1,":"),m(),O("ngIf",t.text&&t.text.startsWith("http")),m(),O("ngIf",!t.text.startsWith("http")),m(),O("ngIf",t.answers&&t.answers.length>0),m(2),O("ngIf",t.category),m(),O("ngIf",t.group),m(3),Wt(" ",i.countCorrectAnswers(t),"/",i.getTotalAnswers(t)," c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng ")}}function $V(e,n){if(e&1&&(l(0,"div"),G(1,HV,21,8,"div",48),u()),e&2){let t=D();m(),O("ngForOf",t.pendingQuestions)}}function qV(e,n){if(e&1&&(l(0,"div")(1,"p"),f(2,"Listen and choose the correct answer: "),u(),l(3,"audio",64),N(4,"source",65),f(5," Tr\xECnh duy\u1EC7t c\u1EE7a b\u1EA1n kh\xF4ng h\u1ED7 tr\u1EE3 ph\xE1t \xE2m thanh. "),u()()),e&2){let t=D().$implicit;m(4),O("src",t.text,Qt)}}function WV(e,n){if(e&1&&(l(0,"div")(1,"div",66),f(2),u()()),e&2){let t=D().$implicit;m(2),ae(t.text)}}function zV(e,n){if(e&1&&(l(0,"li")(1,"span",69),f(2),u()()),e&2){let t=n.$implicit;m(),O("ngClass",Do(2,n2,t.isCorrect,!t.isCorrect)),m(),ae(t.text)}}function GV(e,n){if(e&1&&(l(0,"div",67)(1,"p")(2,"strong"),f(3,"C\xE2u tr\u1EA3 l\u1EDDi:"),u()(),l(4,"ul"),G(5,zV,3,5,"li",68),u()()),e&2){let t=D().$implicit;m(5),O("ngForOf",t.answers)}}function QV(e,n){if(e&1&&(l(0,"span",70),N(1,"i",71),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.category," ")}}function XV(e,n){if(e&1&&(l(0,"span",72),N(1,"i",73),f(2),u()),e&2){let t=D().$implicit;m(2),te(" ",t.group," ")}}function YV(e,n){if(e&1){let t=ve();l(0,"div",49)(1,"div",50)(2,"div",51)(3,"strong"),f(4),u()(),G(5,qV,6,1,"div",37)(6,WV,3,1,"div",37)(7,GV,6,1,"div",52),l(8,"div",53),G(9,QV,3,1,"span",54)(10,XV,3,1,"span",55),l(11,"span",56),N(12,"i",57),f(13),u()()(),l(14,"div",58)(15,"button",62),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.deleteQuestion(i))}),N(16,"i",63),u()()()}if(e&2){let t=n.$implicit,r=n.index,i=D(2);m(4),te("C\xE2u h\u1ECFi s\u1ED1 ",r+1,":"),m(),O("ngIf",t.text&&t.text.startsWith("http")),m(),O("ngIf",!t.text.startsWith("http")),m(),O("ngIf",t.answers&&t.answers.length>0),m(2),O("ngIf",t.category),m(),O("ngIf",t.group),m(3),Wt(" ",i.countCorrectAnswers(t),"/",i.getTotalAnswers(t)," c\xE2u tr\u1EA3 l\u1EDDi \u0111\xFAng ")}}function KV(e,n){if(e&1&&(l(0,"div"),G(1,YV,17,8,"div",48),u()),e&2){let t=D();m(),O("ngForOf",t.approvedQuestions)}}function ZV(e,n){e&1&&(l(0,"div",74)(1,"p"),f(2,"Kh\xF4ng t\xECm th\u1EA5y c\xE2u h\u1ECFi n\xE0o. H\xE3y th\xEAm c\xE2u h\u1ECFi m\u1EDBi!"),u()())}var mf=class e{constructor(n,t,r){this.authService=n;this.questionService=t;this.router=r}user=null;isDropdownActive=!1;questions=[];filteredQuestions=[];selectedCategory="";selectedGroup="";uniqueCategories=[];uniqueGroups=[];isFilterDropdownVisible=!1;filteredApprovedQuestions=[];isStatusDropdownVisible=!1;approvedQuestions=[];pendingQuestions=[];showPending=!0;showApproved=!1;isPendingOpen=!0;isApprovedOpen=!0;ngOnInit(){this.user=this.authService.getCurrentUser(),this.loadQuestions()}loadQuestions(){this.questionService.getQuestions().subscribe({next:n=>{this.questions=n,this.filteredQuestions=n,this.filteredApprovedQuestions=n.filter(t=>t.status==="approved"),this.updateUniqueFilters(),this.splitQuestionsByStatus()},error:n=>{console.error("Error loading questions:",n)}})}updateUniqueFilters(){this.uniqueCategories=[...new Set(this.questions.map(n=>n.category).filter(Boolean))],this.uniqueGroups=[...new Set(this.questions.map(n=>n.group).filter(Boolean))]}filterQuestions(){this.filteredQuestions=this.questions.filter(n=>{let t=this.selectedCategory?n.category===this.selectedCategory:!0,r=this.selectedGroup?n.group===this.selectedGroup:!0;return t&&r}),this.splitQuestionsByStatus()}splitQuestionsByStatus(){this.approvedQuestions=this.filteredQuestions.filter(n=>n.status==="approved"),this.pendingQuestions=this.filteredQuestions.filter(n=>n.status==="pending")}approveQuestion(n){this.changeQuestionStatus(n,"approved")}rejectQuestion(n){this.changeQuestionStatus(n,"pending")}changeQuestionStatus(n,t){n._id&&(n.status=t,this.questionService.updateQuestionStatus(n._id,t).subscribe({next:()=>{this.loadQuestions(),alert(`C\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c ${t==="approved"?"ph\xEA duy\u1EC7t":"ch\u1EDD ph\xEA duy\u1EC7t"}`)},error:r=>{console.error("Error updating question status:",r),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi c\u1EADp nh\u1EADt tr\u1EA1ng th\xE1i c\xE2u h\u1ECFi")}}))}toggleFilterDropdown(){this.isFilterDropdownVisible=!this.isFilterDropdownVisible}editQuestion(n){this.router.navigate(["/question"],{state:{question:n}})}deleteQuestion(n){n._id&&confirm("B\u1EA1n c\xF3 ch\u1EAFc mu\u1ED1n x\xF3a c\xE2u h\u1ECFi n\xE0y kh\xF4ng?")&&this.questionService.deleteQuestion(n._id).subscribe({next:()=>{this.questions=this.questions.filter(t=>t._id!==n._id),this.filteredQuestions=this.filteredQuestions.filter(t=>t._id!==n._id),this.updateUniqueFilters(),alert("C\xE2u h\u1ECFi \u0111\xE3 \u0111\u01B0\u1EE3c x\xF3a")},error:t=>{console.error("Error deleting question:",t),alert("C\xF3 l\u1ED7i x\u1EA3y ra khi x\xF3a c\xE2u h\u1ECFi")}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}clearFilters(){this.selectedCategory="",this.selectedGroup="",this.filteredQuestions=this.questions,this.isFilterDropdownVisible=!1}searchQuestions(n){let t=n.target.value.toLowerCase();t?this.filteredQuestions=this.questions.filter(r=>r.text.toLowerCase().includes(t)||r.category?.toLowerCase().includes(t)||r.group?.toLowerCase().includes(t)):this.filteredQuestions=this.questions,this.splitQuestionsByStatus()}createNewQuestion(){this.router.navigate(["/question"])}logout(){this.authService.logout().subscribe({next:()=>{window.location.href="/login"},error:n=>{console.error("Logout error:",n)}})}getCorrectAnswers(n){return n.answers.filter(r=>r.isCorrect).map(r=>r.text).join(", ")}countCorrectAnswers(n){return n.answers.filter(t=>t.isCorrect).length}getTotalAnswers(n){return n.answers.length}goBack(){this.router.navigate(["/admin-dashboard"])}toggleStatusDropdown(){this.isStatusDropdownVisible=!this.isStatusDropdownVisible}showPendingQuestions(){this.showPending=!0,this.showApproved=!1}showApprovedQuestions(){this.showPending=!1,this.showApproved=!0}togglePendingQuestions(){this.isPendingOpen=!this.isPendingOpen}toggleApprovedQuestions(){this.isApprovedOpen=!this.isApprovedOpen}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(vr),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-admin-question"]],standalone:!0,features:[Me],decls:56,vars:17,consts:[[1,"navbar"],[1,"logo"],[1,"go-back-button",3,"click"],[1,"nav-links"],[1,"user-menu"],[1,"fas","fa-question-circle"],[1,"fas","fa-bell"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar",1,"avatar",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar",1,"avatar"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","#"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"content"],[1,"container"],[1,"tab"],[1,"search-bar"],["type","text","placeholder","Nh\u1EADp t\u1EEB kh\xF3a",3,"input"],[1,"fas","fa-search"],[1,"question-count"],[1,"actions"],[1,"filter",3,"click"],[1,"fa-solid","fa-filter"],[1,"create",3,"click"],[1,"fas","fa-plus"],["class","filter-dropdown",4,"ngIf"],[1,"questions-list","pending-questions"],[1,"section-title",3,"click"],[1,"fas",3,"ngClass"],[4,"ngIf"],[1,"questions-list","approved-questions"],["class","empty-state",4,"ngIf"],[1,"filter-dropdown"],[1,"filter-group"],[3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"filter-actions"],[3,"click"],[3,"value"],["class","question-item",4,"ngFor","ngForOf"],[1,"question-item"],[1,"question-content"],[1,"question-number"],["class","question-answer",4,"ngIf"],[1,"question-info"],["class","category",4,"ngIf"],["class","group",4,"ngIf"],[1,"answers-count"],[1,"fas","fa-check-circle"],[1,"question-actions"],[1,"approve-btn",3,"click"],[1,"edit-btn",3,"click"],[1,"fas","fa-edit"],[1,"delete-btn",3,"click"],[1,"fas","fa-trash"],["controls",""],["type","audio/mpeg",3,"src"],[1,"question-text"],[1,"question-answer"],[4,"ngFor","ngForOf"],[3,"ngClass"],[1,"category"],[1,"fas","fa-folder"],[1,"group"],[1,"fas","fa-layer-group"],[1,"empty-state"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),H("click",function(){return r.goBack()}),f(3,"Quay l\u1EA1i Dashboard"),u()(),l(4,"div",3)(5,"h1"),f(6,"Qu\u1EA3n l\xFD ng\xE2n h\xE0ng c\xE2u h\u1ECFi"),u()(),l(7,"div",4),N(8,"i",5)(9,"i",6),l(10,"img",7),H("click",function(){return r.toggleDropdown()}),u(),l(11,"div",8)(12,"div",9),N(13,"img",10),l(14,"div",11)(15,"div",12),f(16),u(),l(17,"div",13),f(18),u()()(),l(19,"div",14)(20,"a",15),N(21,"i",16),f(22," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(23,"a",17),N(24,"i",18),f(25," C\xE0i \u0111\u1EB7t chung"),u(),l(26,"a",19),H("click",function(){return r.logout()}),N(27,"i",20),f(28," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(29,"div",21)(30,"div",22)(31,"div",23)(32,"div",24)(33,"input",25),H("input",function(o){return r.searchQuestions(o)}),u(),N(34,"i",26),u(),l(35,"div",27),f(36),u(),l(37,"div",28)(38,"button",29),H("click",function(){return r.toggleFilterDropdown()}),f(39,"L\u1ECDc "),N(40,"i",30),u(),l(41,"button",31),H("click",function(){return r.createNewQuestion()}),f(42,"Th\xEAm c\xE2u h\u1ECFi "),N(43,"i",32),u()()(),G(44,NV,20,4,"div",33),l(45,"div",34)(46,"h2",35),H("click",function(){return r.togglePendingQuestions()}),f(47," C\xE2u h\u1ECFi ch\u1EDD duy\u1EC7t "),N(48,"i",36),u(),G(49,$V,2,1,"div",37),u(),l(50,"div",38)(51,"h2",35),H("click",function(){return r.toggleApprovedQuestions()}),f(52," C\xE2u h\u1ECFi \u0111\xE3 duy\u1EC7t "),N(53,"i",36),u(),G(54,KV,2,1,"div",37),u(),G(55,ZV,3,0,"div",39),u()()),t&2&&(m(11),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(18),te(" T\u1ED5ng s\u1ED1 c\xE2u h\u1ECFi: ",r.filteredQuestions.length," "),m(8),O("ngIf",r.isFilterDropdownVisible),m(4),O("ngClass",Do(11,t2,r.isPendingOpen,!r.isPendingOpen)),m(),O("ngIf",r.isPendingOpen),m(4),O("ngClass",Do(14,t2,r.isApprovedOpen,!r.isApprovedOpen)),m(),O("ngIf",r.isApprovedOpen),m(),O("ngIf",r.approvedQuestions.length===0&&r.pendingQuestions.length===0))},dependencies:[Ue,hr,lt,We,He,gr,xr,jn,Ot,Vt],styles:['@charset "UTF-8";.navbar[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;background-color:#fff;padding:10px 20px;color:#000}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;padding:10px 20px;cursor:pointer;font-size:16px;border-radius:5px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:20px;font-size:20px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{border-radius:50%;cursor:pointer;width:40px;height:40px;object-fit:cover}.navbar[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:20px;background-color:#fff;border-radius:5px;box-shadow:0 4px 8px #0000001a;width:200px}.navbar[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{padding:10px;display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:50px;height:50px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:10px;color:#2c3e50;text-decoration:none;font-size:14px}.navbar[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ecf0f1;color:#2980b9}.content[_ngcontent-%COMP%]{margin:20px}.search-bar[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:20px}.search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:300px;padding:10px;margin-right:10px;border:1px solid #ccc;border-radius:5px}.search-bar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:20px}.question-count[_ngcontent-%COMP%]{font-size:16px;margin-bottom:20px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;border:none;padding:10px 20px;cursor:pointer;margin-right:10px;border-radius:5px;font-size:14px}.actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.filter-dropdown[_ngcontent-%COMP%]{display:block;position:absolute;background-color:#fff;border:1px solid #ccc;box-shadow:0 4px 8px #0000001a;padding:20px;width:420px;top:50px;left:20px;z-index:1000;border-radius:8px;box-sizing:border-box;overflow:hidden}.filter-group[_ngcontent-%COMP%]{margin-bottom:20px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;font-weight:700;margin-bottom:8px;color:#333}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px;border-radius:4px;border:1px solid #ccc;font-size:14px;background-color:#f9f9f9;transition:border-color .3s ease}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a90e2;background-color:#fff}.filter-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]{padding:10px}.filter-actions[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap;justify-content:space-between;width:100%}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:12px;border-radius:4px;border:none;font-size:14px;cursor:pointer;background-color:#4a90e2;color:#fff;transition:background-color .3s ease,transform .3s ease;width:100%;white-space:nowrap;box-sizing:border-box;text-align:center}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#357ab7;transform:translateY(-2px)}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child{background-color:#f44336}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:first-child:hover{background-color:#d32f2f}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child{background-color:#4caf50}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:last-child:hover{background-color:#388e3c}.questions-list[_ngcontent-%COMP%]{margin-top:20px}.question-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;background-color:#ecf0f1;padding:15px;border-radius:5px;margin-bottom:10px;transition:transform .3s ease-in-out}.question-item[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.question-content[_ngcontent-%COMP%]{flex:1}.question-info[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:5px}.question-info[_ngcontent-%COMP%]   .category[_ngcontent-%COMP%], .question-info[_ngcontent-%COMP%]   .group[_ngcontent-%COMP%]{margin-right:10px}.question-info[_ngcontent-%COMP%]   .answers-count[_ngcontent-%COMP%]{margin-left:10px}.question-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{border:none;padding:10px 15px;cursor:pointer;margin-left:5px;border-radius:5px;font-size:16px;color:#fff}.question-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:.8;transform:scale(1.1)}.actions[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]{background-color:#f39c12}.actions[_ngcontent-%COMP%]   .filter[_ngcontent-%COMP%]:hover{background-color:#e67e22}.actions[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]{background-color:#2ecc71}.actions[_ngcontent-%COMP%]   .create[_ngcontent-%COMP%]:hover{background-color:#27ae60}.question-actions[_ngcontent-%COMP%]   .approve-btn[_ngcontent-%COMP%]{background-color:#28a745}.question-actions[_ngcontent-%COMP%]   .approve-btn[_ngcontent-%COMP%]:hover{background-color:#218838}.question-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]{background-color:#3498db}.question-actions[_ngcontent-%COMP%]   .edit-btn[_ngcontent-%COMP%]:hover{background-color:#2980b9}.question-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{background-color:#dc3545}.question-actions[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{background-color:#c82333}.empty-state[_ngcontent-%COMP%]{text-align:center;font-size:18px;color:#7f8c8d;margin-top:50px;font-weight:700}audio[_ngcontent-%COMP%]{width:100%;margin-top:10px;margin-bottom:10px;border-radius:5px}.question-text[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#2c3e50;margin-bottom:10px}.question-answer[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style-type:none;padding-left:0}.question-answer[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:16px;color:#34495e}.question-answer[_ngcontent-%COMP%]   .correct-answer[_ngcontent-%COMP%]{font-weight:700;color:#2ecc71}.question-answer[_ngcontent-%COMP%]   .incorrect-answer[_ngcontent-%COMP%]{color:#9c9c9c}.question-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#3498db}.question-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#2980b9}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{margin-top:10px}.question-item[_ngcontent-%COMP%]{flex-direction:column}.question-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%;margin-left:0;margin-top:5px}.filter-dropdown[_ngcontent-%COMP%], .search-bar[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}}.question-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{cursor:pointer;display:flex;justify-content:space-between;align-items:center}.question-section[_ngcontent-%COMP%]   .questions-list[_ngcontent-%COMP%]{padding-left:20px;margin-top:10px}.question-section[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:transform .3s}.question-section[_ngcontent-%COMP%]   i.fa-chevron-up[_ngcontent-%COMP%]{transform:rotate(180deg)}.question-section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{padding:10px;background-color:#f9f9f9;border:1px solid #ddd;margin-top:10px}.filter-dropdown[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:5px;box-shadow:0 4px 8px #0000001a;margin-bottom:20px;width:200px}.filter-group[_ngcontent-%COMP%]{margin-bottom:15px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:10px}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff;border:none;padding:10px 20px;cursor:pointer;margin-right:10px;border-radius:5px;font-size:14px}.filter-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#c0392b}.dropdown-menu[_ngcontent-%COMP%]{background-color:#fff;display:flex;flex-direction:column;padding:10px 0;width:100%}.dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:12px;color:#2c3e50;text-decoration:none;display:block;font-size:14px;transition:background-color .3s ease}.dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#ecf0f1;color:#2980b9}.dropdown-menu[_ngcontent-%COMP%]   .approved[_ngcontent-%COMP%]{background-color:#dff0d8;color:#3c763d;font-weight:700}.dropdown-menu[_ngcontent-%COMP%]   .approved[_ngcontent-%COMP%]:hover{background-color:#c8e5b8;color:#2d6a31}.dropdown-menu[_ngcontent-%COMP%]   .unapproved[_ngcontent-%COMP%]{background-color:#f2dede;color:#a94442;font-weight:700}.dropdown-menu[_ngcontent-%COMP%]   .unapproved[_ngcontent-%COMP%]:hover{background-color:#f5c6cb;color:#721c24}.filter-dropdown-button[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:10px;border-radius:5px;font-size:16px;cursor:pointer;text-align:center;width:100%;border:none;margin-top:10px}.filter-dropdown-button[_ngcontent-%COMP%]:hover{background-color:#2980b9}.filter-dropdown.active[_ngcontent-%COMP%]{display:block;position:absolute;top:60px;right:10px;z-index:999}.filter-dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:focus, .filter-dropdown[_ngcontent-%COMP%]   .dropdown-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background-color:#e6f7ff;color:#2980b9;outline:none}']})};function JV(e,n){if(e&1){let t=ve();l(0,"button",22),H("click",function(){let i;U(t);let o=D().$implicit,s=D();return j(s.navigateToStatistics((i=o._id)!==null&&i!==void 0?i:""))}),f(1," Xem T\u1ED5ng K\u1EBFt "),u()}}function eU(e,n){if(e&1){let t=ve();l(0,"button",22),H("click",function(){U(t);let i=D().$implicit,o=D();return j(o.updateExamStatus(i))}),f(1," \u0110\u0103ng b\xE0i thi "),u()}}function tU(e,n){if(e&1){let t=ve();l(0,"tr")(1,"td"),f(2),u(),l(3,"td"),f(4),u(),l(5,"td"),f(6),zt(7,"date"),u(),l(8,"td"),f(9),zt(10,"date"),u(),l(11,"td"),f(12),u(),l(13,"td"),f(14),u(),l(15,"td")(16,"button",22),H("click",function(){let i=U(t).$implicit,o=D();return j(o.viewExamDetails(i))}),f(17,"Xem chi ti\u1EBFt"),u(),l(18,"button",22),H("click",function(){let i=U(t).$implicit,o=D();return j(o.deleteExam(i))}),f(19,"X\xF3a"),u(),G(20,JV,2,0,"button",24)(21,eU,2,0,"button",24),u()()}if(e&2){let t,r=n.$implicit,i=n.index,o=D();m(2),ae(i+1),m(2),ae(r.name),m(2),ae(So(7,8,r.startDate,"short")),m(3),ae(So(10,11,r.endDate,"short")),m(3),ae(r.status),m(2),ae(o.getCreatorName((t=r.createdBy)!==null&&t!==void 0?t:"")),m(6),O("ngIf",(r==null?null:r.status)==="published"),m(),O("ngIf",r.status==="pending"||r.status==="draft")}}var gf=class e{constructor(n,t,r){this.examService=n;this.authService=t;this.router=r}user=null;isDropdownActive=!1;exams=[];users=[];ngOnInit(){this.loadExams(),this.loadUsers()}loadExams(){this.examService.getExams().subscribe({next:n=>{this.exams=n},error:n=>{console.error("Error loading exams:",n)}})}loadUsers(){this.authService.getAllUsers().subscribe({next:n=>{this.users=n,console.log("Danh s\xE1ch ng\u01B0\u1EDDi d\xF9ng:",this.users)},error:n=>{console.error("Error loading users:",n)}})}getCreatorName(n){let t=this.users.find(r=>r._id===n);return t?t.username:"Kh\xF4ng x\xE1c \u0111\u1ECBnh"}viewExamDetails(n){this.router.navigate(["/exam-details",n._id])}deleteExam(n){confirm(`Are you sure you want to delete the exam "${n.name}"?`)&&this.examService.deleteExam(n._id).subscribe({next:()=>{this.loadExams(),alert("Exam deleted successfully")},error:t=>{console.error("Error deleting exam:",t)}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}logout(){this.authService.logout().subscribe({next:()=>{window.location.href="/login"},error:n=>{console.error("Logout error:",n)}})}goBack(){this.router.navigate(["/admin-dashboard"])}navigateToStatistics(n){this.router.navigate(["/teacher-statistics",n])}navigateToCreateExam(){this.router.navigate(["/exam-create"])}updateExamStatus(n){n.status="published",this.examService.updateExam(n._id,n).subscribe({next:()=>{this.loadExams(),alert("Exam status updated successfully")},error:t=>{console.error("Error updating exam status:",t)}})}static \u0275fac=function(t){return new(t||e)(Q(It),Q(ze),Q(Re))};static \u0275cmp=Se({type:e,selectors:[["app-admin-exam"]],standalone:!0,features:[Me],decls:51,vars:5,consts:[[1,"navbar"],[1,"logo"],[1,"go-back-button",3,"click"],[1,"nav-links"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","#"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"create-button"],[3,"click"],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"]],template:function(t,r){t&1&&(l(0,"div",0)(1,"div",1)(2,"button",2),H("click",function(){return r.goBack()}),f(3,"Quay l\u1EA1i Dashboard"),u()(),l(4,"div",3)(5,"h1"),f(6,"Qu\u1EA3n l\xFD b\xE0i thi"),u()(),l(7,"div",4),N(8,"i",5)(9,"i",6),l(10,"img",7),H("click",function(){return r.toggleDropdown()}),u(),l(11,"div",8)(12,"div",9),N(13,"img",10),l(14,"div",11)(15,"div",12),f(16),u(),l(17,"div",13),f(18),u()()(),l(19,"div",14)(20,"a",15),N(21,"i",16),f(22," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(23,"a",17),N(24,"i",18),f(25," C\xE0i \u0111\u1EB7t chung"),u(),l(26,"a",19),H("click",function(){return r.logout()}),N(27,"i",20),f(28," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(29,"div",21)(30,"button",22),H("click",function(){return r.navigateToCreateExam()}),f(31,"T\u1EA1o b\xE0i ki\u1EC3m tra m\u1EDBi"),u()(),l(32,"table")(33,"thead")(34,"tr")(35,"th"),f(36,"STT"),u(),l(37,"th"),f(38,"T\xEAn b\xE0i thi"),u(),l(39,"th"),f(40,"Ng\xE0y b\u1EAFt \u0111\u1EA7u"),u(),l(41,"th"),f(42,"Ng\xE0y k\u1EBFt th\xFAc"),u(),l(43,"th"),f(44,"Tr\u1EA1ng th\xE1i"),u(),l(45,"th"),f(46,"T\u1EA1o b\u1EDFi"),u(),l(47,"th"),f(48,"H\xE0nh \u0111\u1ED9ng"),u()()(),l(49,"tbody"),G(50,tU,22,14,"tr",23),u()()),t&2&&(m(11),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(32),O("ngForOf",r.exams))},dependencies:[Ue,lt,We,pr,He],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5;transition:background-color .3s ease}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0;transition:background-color .3s ease}.navbar[_ngcontent-%COMP%]:hover{background-color:#f8f8f8}.logo[_ngcontent-%COMP%]{display:flex;align-items:center}img[_ngcontent-%COMP%]{height:30px;margin-right:10px}span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500;position:relative;transition:color .3s ease}.nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer;transition:transform .3s ease}.user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000;transition:all .3s ease}.dropdown.active[_ngcontent-%COMP%]{display:block;transform:translateY(10px);opacity:1}.profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0;transition:background-color .3s ease}.profile[_ngcontent-%COMP%]:hover{background-color:#f0f0f0}.menu[_ngcontent-%COMP%]{padding:10px 15px}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px;transition:color .3s ease}.menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}h1[_ngcontent-%COMP%]{text-align:center;font-size:24px;color:#333;margin-bottom:20px;transition:all .3s ease}table[_ngcontent-%COMP%]{width:80%;margin:20px auto;border-collapse:collapse;box-shadow:0 2px 10px #0000001a;background-color:#fff;transition:all .3s ease}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:12px;text-align:left;border-bottom:1px solid #ddd;font-size:14px}th[_ngcontent-%COMP%]{background-color:#f4f4f4;color:#333;transition:background-color .3s ease}th[_ngcontent-%COMP%]:hover{background-color:#e0e0e0}tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9;cursor:pointer}button[_ngcontent-%COMP%]{padding:8px 16px;margin:5px;border:none;border-radius:4px;font-size:14px;cursor:pointer;transition:all .3s ease}button[_ngcontent-%COMP%]:hover{transform:scale(1.05)}button[_ngcontent-%COMP%]:focus{outline:none;box-shadow:0 0 5px #007bff80}.create-button[_ngcontent-%COMP%]{text-align:right;margin:20px}.create-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:10px 15px;border:none;border-radius:5px;cursor:pointer;transition:background-color .3s ease}.create-button[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3}button[_ngcontent-%COMP%]:nth-child(1){background-color:#fff;color:#000;border:4px solid #ddd;border-radius:10%;transition:background-color .3s,box-shadow .3s}button[_ngcontent-%COMP%]:nth-child(1):hover{background-color:#9cf9a1;box-shadow:0 4px 8px #0000001a}button[_ngcontent-%COMP%]:nth-child(1):active{background-color:#e0e0e0;box-shadow:none}button[_ngcontent-%COMP%]:nth-child(2){background-color:#fff;color:#000;border-radius:10%;border:4px solid #ddd;transition:background-color .3s,box-shadow .3s}button[_ngcontent-%COMP%]:nth-child(2):hover{background-color:#f69a98;box-shadow:0 4px 8px #0000001a}button[_ngcontent-%COMP%]:nth-child(2):active{background-color:#e0e0e0;box-shadow:none}button[_ngcontent-%COMP%]:nth-child(3){background-color:#fff;color:#000;border-radius:10%;border:4px solid #ddd;transition:background-color .3s,box-shadow .3s}button[_ngcontent-%COMP%]:nth-child(3):hover{background-color:#76a5f6;box-shadow:0 4px 8px #0000001a}button[_ngcontent-%COMP%]:nth-child(3):active{background-color:#e0e0e0;box-shadow:none}@media screen and (max-width: 600px){table[_ngcontent-%COMP%]{font-size:12px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{padding:8px}button[_ngcontent-%COMP%]{font-size:12px;padding:6px 12px}.navbar[_ngcontent-%COMP%]{padding:10px;flex-direction:column;align-items:flex-start}.nav-links[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;margin-top:10px}.user-menu[_ngcontent-%COMP%]{margin-top:10px}}']})};function nU(e,n){if(e&1){let t=ve();l(0,"button",33),H("click",function(){U(t);let i=D().$implicit,o=D(2);return j(o.navigateToStatistics(i._id))}),f(1,"T\u1ED5ng k\u1EBFt"),u()}}function rU(e,n){if(e&1){let t=ve();l(0,"div",29)(1,"h3"),f(2),u(),l(3,"p"),f(4),u(),l(5,"p"),f(6),zt(7,"date"),zt(8,"date"),u(),l(9,"p"),f(10),u(),l(11,"p"),f(12),u(),l(13,"div",30)(14,"button",31),H("click",function(){let i=U(t).$implicit,o=D(2);return j(o.viewExamDetails(i))}),f(15,"Xem chi ti\u1EBFt"),u(),G(16,nU,2,0,"button",32),u()()}if(e&2){let t=n.$implicit;m(2),ae(t.name),m(2),ae(t.description),m(2),Wt("Th\u1EDDi gian: ",tr(7,7,t.startDate)," - ",tr(8,9,t.endDate),""),m(4),te("Th\u1EDDi l\u01B0\u1EE3ng: ",t.duration," ph\xFAt"),m(2),te("\u0110i\u1EC3m t\u1ED1i \u0111a: ",t.maxScore,""),m(4),O("ngIf",t._id)}}function iU(e,n){if(e&1&&(l(0,"div"),G(1,rU,17,11,"div",28),u()),e&2){let t=D();m(),O("ngForOf",t.publishedExams)}}function oU(e,n){e&1&&(l(0,"div",34)(1,"p"),f(2,"Hi\u1EC7n t\u1EA1i kh\xF4ng c\xF3 b\xE0i ki\u1EC3m tra n\xE0o \u0111\xE3 xu\u1EA5t b\u1EA3n."),u()())}var xf=class e{constructor(n,t,r){this.authService=n;this.router=t;this.examService=r}user=null;isDropdownActive=!1;activeExams=[];draftExams=[];publishedExams=[];ngOnInit(){this.user=this.authService.getCurrentUser(),this.loadExams()}loadExams(){this.examService.getExams().subscribe({next:n=>{let t=new Date;this.activeExams=n.filter(r=>new Date(r.startDate)<=t&&new Date(r.endDate)>=t&&r.status!=="published"),this.draftExams=n.filter(r=>new Date(r.startDate)>t&&r.status!=="published"),this.publishedExams=n.filter(r=>r.status==="published")},error:n=>{console.error("Error loading exams:",n)}})}toggleDropdown(){this.isDropdownActive=!this.isDropdownActive}logout(){this.authService.logout().subscribe({next:()=>{this.router.navigate(["/login"])},error:n=>{console.error("Logout error:",n)}})}viewExamDetails(n){this.router.navigate(["/exam-details",n._id])}navigateToStatistics(n){this.router.navigate(["/teacher-statistics",n])}static \u0275fac=function(t){return new(t||e)(Q(ze),Q(Re),Q(It))};static \u0275cmp=Se({type:e,selectors:[["app-teacher-history"]],standalone:!0,features:[Me],decls:39,vars:6,consts:[["noPublishedExams",""],[1,"navbar"],[1,"logo"],["src","../../assets/img/qye-challenge-logo.png","alt","Logo","height","30","width","30"],[1,"nav-links"],["href","/teacher-dashboard"],["href","/teacher-history",1,"active"],["href","/teacher-library"],[1,"user-menu"],[1,"fas","fa-question-circle",2,"margin-right","20px"],[1,"fas","fa-bell",2,"margin-right","20px"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","40","width","40",3,"click"],[1,"dropdown"],[1,"profile"],["src","../../assets/img/skeleton-icon.png","alt","User Avatar","height","50","width","50"],[1,"info"],[1,"name"],[1,"email"],[1,"menu"],["href","/profile"],[1,"fas","fa-user-graduate"],["href","/settings"],[1,"fas","fa-cog"],["href","#",3,"click"],[1,"fas","fa-sign-out-alt"],[1,"content"],[1,"section"],[4,"ngIf","ngIfElse"],["class","exam-item",4,"ngFor","ngForOf"],[1,"exam-item"],[1,"exam-actions"],[1,"view-details-button",3,"click"],["class","summary-button",3,"click",4,"ngIf"],[1,"summary-button",3,"click"],[1,"empty-state"]],template:function(t,r){if(t&1){let i=ve();l(0,"div",1)(1,"div",2),N(2,"img",3),l(3,"span"),f(4,"Quiz your English Challenge"),u()(),l(5,"div",4)(6,"a",5),f(7,"B\xE0i ki\u1EC3m tra"),u(),l(8,"a",6),f(9,"L\u1ECBch s\u1EED b\xE0i ki\u1EC3m tra"),u(),l(10,"a",7),f(11,"Th\u01B0 vi\u1EC7n c\xE2u h\u1ECFi"),u()(),l(12,"div",8),N(13,"i",9)(14,"i",10),l(15,"img",11),H("click",function(){return U(i),j(r.toggleDropdown())}),u(),l(16,"div",12)(17,"div",13),N(18,"img",14),l(19,"div",15)(20,"div",16),f(21),u(),l(22,"div",17),f(23),u()()(),l(24,"div",18)(25,"a",19),N(26,"i",20),f(27," Th\xF4ng tin c\xE1 nh\xE2n"),u(),l(28,"a",21),N(29,"i",22),f(30," C\xE0i \u0111\u1EB7t chung"),u(),l(31,"a",23),H("click",function(){return U(i),j(r.logout())}),N(32,"i",24),f(33," \u0110\u0103ng xu\u1EA5t"),u()()()()(),l(34,"div",25)(35,"div",26),G(36,iU,2,1,"div",27)(37,oU,3,0,"ng-template",null,0,nr),u()()}if(t&2){let i=Nt(38);m(16),xt("active",r.isDropdownActive),m(5),ae(r.user==null?null:r.user.username),m(2),ae(r.user==null?null:r.user.email),m(13),O("ngIf",r.publishedExams.length>0)("ngIfElse",i)}},dependencies:[Ue,lt,We,pr,He],styles:['@charset "UTF-8";body[_ngcontent-%COMP%]{font-family:Roboto,sans-serif;margin:0;padding:0;background-color:#f5f5f5}.nav-links[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#007bff;font-weight:700;border-bottom:2px solid #007bff}.navbar[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 20px;background-color:#fff;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{display:flex;align-items:center}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:30px;margin-right:10px}.navbar[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{display:flex;flex-grow:1;justify-content:center}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 15px;text-decoration:none;color:#333;font-weight:500;transition:color .4s ease,transform .3s ease}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff;transform:scale(1.1)}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{display:flex;align-items:center;position:relative}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;width:40px;border-radius:50%;cursor:pointer;transition:transform .3s ease,box-shadow .3s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 4px 10px #0003}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown[_ngcontent-%COMP%]{display:none;position:absolute;top:50px;right:0;background-color:#fff;box-shadow:0 2px 10px #0000001a;border-radius:5px;width:300px;z-index:1000;animation:_ngcontent-%COMP%_slideDown .4s ease-out}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .dropdown.active[_ngcontent-%COMP%]{display:block}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]{display:flex;align-items:center;padding:15px;border-bottom:1px solid #e0e0e0}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:50px;width:50px;border-radius:50%;margin-right:10px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{font-size:12px;color:#666}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .profile[_ngcontent-%COMP%]   .view-profile[_ngcontent-%COMP%]{background-color:#007bff;color:#fff;padding:5px 10px;border-radius:5px;text-align:center;text-decoration:none;font-size:12px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{padding:10px 15px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:flex;align-items:center;padding:10px 0;text-decoration:none;color:#333;font-size:14px;transition:color .4s ease}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#007bff}.content[_ngcontent-%COMP%]{padding:20px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{background-color:#fff;padding:20px;margin-bottom:20px;border-radius:5px;box-shadow:0 2px 5px #0000001a;transition:transform .3s ease,box-shadow .4s ease}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 4px 12px #0003}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-top:0;font-size:18px;font-weight:500}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]{text-align:center;color:#666;animation:_ngcontent-%COMP%_fadeIn .6s ease-in-out}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]   .empty-state[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100px;margin-bottom:10px}.notification-badge[_ngcontent-%COMP%]{position:absolute;top:-5px;right:-5px;background-color:#f44;color:#fff;border-radius:50%;padding:5px;font-size:14px;font-weight:700;animation:_ngcontent-%COMP%_pulse 1.5s infinite}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);opacity:.9}50%{transform:scale(1.2);opacity:1}to{transform:scale(1);opacity:.9}}.exam-item[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #e0e0e0;border-radius:6px;padding:15px;margin-bottom:15px;transition:transform .2s ease,box-shadow .3s ease}.exam-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.exam-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-top:0;color:#333}.exam-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0;color:#666}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]{display:flex;gap:10px;margin-top:10px}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:8px 15px;border:none;border-radius:4px;cursor:pointer;font-size:14px;transition:background-color .2s ease,transform .2s ease}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:scale(1.1)}.create-button[_ngcontent-%COMP%]{background-color:#3f51b5;color:#fff;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:16px;display:flex;align-items:center;margin-left:20px;margin-bottom:20px;transition:background-color .3s ease,transform .2s ease}.create-button[_ngcontent-%COMP%]:hover{background-color:#283593;transform:scale(1.1)}.create-button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px}@media (max-width: 768px){.navbar[_ngcontent-%COMP%]{flex-direction:column;padding:10px}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]{margin:10px 0;width:100%;justify-content:space-around}.navbar[_ngcontent-%COMP%]   .nav-links[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin:0 5px;font-size:14px}.navbar[_ngcontent-%COMP%]   .user-menu[_ngcontent-%COMP%]{width:100%;justify-content:flex-end}.content[_ngcontent-%COMP%]{padding:10px}.content[_ngcontent-%COMP%]   .section[_ngcontent-%COMP%]{padding:15px}}button[_ngcontent-%COMP%]{padding:12px 24px;font-size:16px;background-color:#007bff;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .3s ease;box-shadow:0 4px 6px #0000001a;font-weight:600}button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px);box-shadow:0 6px 12px #0003}button[_ngcontent-%COMP%]:active{transform:translateY(1px);box-shadow:0 2px 5px #0003}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px;font-size:18px}button[_ngcontent-%COMP%]:focus{outline:none}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.view-details-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.view-details-button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.summary-button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.exam-item[_ngcontent-%COMP%]   .exam-actions[_ngcontent-%COMP%]   button.summary-button[_ngcontent-%COMP%]:hover{background-color:#218838;transform:translateY(-2px)}']})};var r2=[{path:"teacher-history",component:xf},{path:"role",component:wd},{path:"admin-dashboard",component:ff},{path:"admin-user",component:pf},{path:"admin-question",component:mf},{path:"admin-exam",component:gf},{path:"settings",component:cf},{path:"exam-result-detail/:id",component:lf},{path:"exam-take/:id",component:uf},{path:"home",component:Ed},{path:"login",component:hd},{path:"register",component:pd},{path:"forgot-password",component:md},{path:"qrcode",component:gd},{path:"reset-password",component:xd},{path:"terms",component:vd},{path:"privacy",component:_d},{path:"guide",component:Cd},{path:"contact",component:yd},{path:"teacher-dashboard",component:bd},{path:"exam-create",component:Dd},{path:"exam-details/:id",component:Sd},{path:"exam-edit/:id",component:Md},{path:"teacher-library",component:Ad},{path:"question",component:tf},{path:"teacher-statistics/:id",component:nf},{path:"teacher-category",component:rf},{path:"exam-history",component:sf},{path:"student-dashboard",component:of},{path:"profile",component:af},{path:"student-result-detail/:examId/:userId",component:df},{path:"",redirectTo:"/home",pathMatch:"full"},{path:"**",redirectTo:"/home"}];var Ef=class e{title="quizz-app";constructor(){}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=Se({type:e,selectors:[["app-root"]],standalone:!0,features:[Me],decls:1,vars:0,template:function(t,r){t&1&&N(0,"router-outlet")},dependencies:[qm]})};H_(Ef,{providers:[kC(r2),om()]}).catch(e=>console.error(e));
